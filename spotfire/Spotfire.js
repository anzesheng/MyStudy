// JavaScript source code


$(function () {
    var redirect = function (url) { Spotfire.replaceUrl(url); };
    var buildPanelAndLink = function (title, text, details) {
        var $errorPanel = $("<div/>").addClass("errorDialog sf-enable-selection").attr("title", title).text(text);
        if (typeof details === "string" && details !== "") {
            var $detailsPanel = $("<div/>").css("white-space", "pre").text(details).hide();
            var $toggleDetailsLink = $("<a/>").attr("href", "#").text(Spotfire.Localization.resources.ErrorDialog_ShowDetails).click(function () {
                $detailsPanel.toggle();
                $(this).text($detailsPanel.is(":visible") ? Spotfire.Localization.resources.ErrorDialog_HideDetails : Spotfire.Localization.resources.ErrorDialog_ShowDetails);
                return false;
            }); $errorPanel.append("<br/><br/>"); $errorPanel.append($toggleDetailsLink); $errorPanel.append("<br/><br/>");
            $errorPanel.append($detailsPanel);
        } return $errorPanel;
    };

    var showErrorDialog = function (title, error, onClose) {
        var $errorPanel = buildPanelAndLink(title, error.Message, error.Details);
        var buttons = [{ id: "okButton", text: Spotfire.Localization.resources.Ok, isDefault: true }];
        Spotfire.Controls.ModalDialog.initialize($errorPanel, { width: 400, height: 300, buttons: buttons, modal: true, close: onClose });
    };

    var clientError = function (message, details, errorid) {
        if (!Spotfire.isWebPlayer()) {
            window.alert(message + " " + details + " " + errorid);
            return;
        } Ajax.onError(message, details); Spotfire.shutdown(true); Spotfire.LightBox.show(); var data = { errortype: "ClientError", errorMessage: message, errorId: errorid, errorDetails: details, analysisURL: Spotfire.Web.analysisURL, mashup: Spotfire.Web.isMashupContext };
        var showError = function (response) {
            Spotfire.LightBox.hide(); var $errorPanel = buildPanelAndLink(response.title, response.message, response.detailsLiteralVisible ? response.detailsLiteral : null);
            if (response.errorGuid) {
                $("<div/>").text(Spotfire.Localization.resources.ErrorDialog_RefCode + ": " + response.errorGuid).insertBefore($("br", $errorPanel).first());
            } if (response.reportErrorDivVisible) {
                var $reportErrorDiv = $("<div/>"); $("<a/>").text(Spotfire.Localization.resources.ErrorDialog_Report).attr("href", response.reportErrorNavigateUrl).appendTo($reportErrorDiv);
                $errorPanel.append($reportErrorDiv);
            } var onReopenAnalysis = function () {
                redirect("/spotfire/wp/OpenAnalysis?file=" + response.file);
            }; var gotoLibrary = function () { redirect("/spotfire/wp/startPage"); }; var options = { width: 400, height: 400 };
            var buttons = []; if (response.reopenAnalysisVisible) {
                buttons.push({ id: "reopenAnalysisButton", text: Spotfire.Localization.resources.ErrorDialog_Reopen, click: onReopenAnalysis, isDefault: true });
            } if (response.libraryPageLinkVisible) {
                buttons.push({ id: "openLibraryButton", text: Spotfire.Localization.resources.ErrorDialog_OpenLibrary, click: gotoLibrary, isDefault: !response.reopenAnalysisVisible, isCancel: response.reopenAnalysisVisible });
            } if (buttons.length === 1) { options.close = buttons[0].click; buttons[0].click = $.noop; } options.buttons = buttons;
            Spotfire.Controls.ModalDialog.initialize($errorPanel, options);
        }; $.ajax({
            url: "Error.xhr", data: JSON.stringify(data), error: function () {
                var msg = message;
                if (details) { msg += " : " + details; } showError({ title: "Error", message: msg });
            }, success: showError
        });
    };
    var serverErrorHandled = false;
    var serverError = function (error, closedReason, errorid) {
        if (serverErrorHandled) { return; } serverErrorHandled = true;
        switch (closedReason) {
            case "ClosedByAdministrator": case "Idle": redirect(Spotfire.Web.redirectPageOnClosedAnalysis);
                return; case "UserLoggedOut": redirect(Spotfire.Web.redirectPageOnLoggedOut); return; case "ClosedByUser": case "CanceledByUser": redirect(Spotfire.Web.redirectPageOnClosedAnalysis);
                    return; case "DifferentServer": case "Restart": case "Stale": Ajax.redirectIfNotMashup(closedReason, Spotfire.Web.redirectPageOnDocumentLoaded);
                        return; case "Exception": case "ScheduledUpdates": case "Unknown": break; default: break;
        } clientError(error.Message, error.Details, errorid);
    };
    Spotfire.registerNameSpace("Framework", { onServerError: serverError, onError: clientError });
    Spotfire.registerNameSpace("Framework.ErrorDialog", { show: showErrorDialog });
}); 

$(function () {
    var chromeFocusFix = function () {
        var $fogus = null; var trackedInput = null; var onRemoved = null;
        var track = function (target) {
            if (trackedInput !== null) {
                trackedInput.removeEventListener("DOMNodeRemovedFromDocument", onRemoved);
                trackedInput = null;
            } if (target !== undefined && target !== null) {
                target.addEventListener("DOMNodeRemovedFromDocument", onRemoved);
                trackedInput = target;
            }
        }; onRemoved = function (e) {
            var input = e.target; if (input !== trackedInput) {
                throw "Assumed the removed input to be the tracked input.";
            } track(null); window.setTimeout(function () {
                if ($(":focus").length > 0) { return; } $fogus = $("<input type='text'/>").addClass("sf-focus-fix").appendTo(document.body).css({ position: "absolute", width: 0, height: 0, border: 0 }).focus();
            });
        }; window.addEventListener("focusin", function (e) {
            track(null); var $target = $(e.target); if ($fogus !== null) {
                if ($target.is($fogus)) {
                    return;
                } $fogus.remove(); $fogus = null;
            } if ($target.is("input")) { track($target.get(0)); }
        });
    }; var trackAjaxRequests = function () {
        var requestCount = 0;
        var pendingRequests = {}; $(document).ajaxSend(function (event, xhr, requestSettings) {
            requestCount++; requestSettings.index = requestCount;
            pendingRequests[requestSettings.index] = xhr;
        }); $(document).ajaxComplete(function (event, xhr, requestSettings) {
            delete pendingRequests[requestSettings.index];
        }); $(window).unload(function () {
            $.each(pendingRequests, function (index, req) { try { req.abort(); } catch (ignore) { } });
        });
    }; var initializePageBus = function () {
        var onData = function (subj, msg, data) {
            var args = JSON.stringify({ subj: subj, msg: msg, data: data });
            if (Spotfire.cef === true) {
                $.ajax({
                    type: "POST", contentType: "application/json; charset=utf-8", dataType: "json", url: "http://spotfire.browser.json.message", data: args, success: $.noop, error: function (e) {
                        alert("Failed to post JSON message. " + e);
                    }
                }); return;
            } var ext = window.external; if (ext !== undefined && ext !== null && typeof ext.PostJsonMessage === "function") {
                window.external.PostJsonMessage(args);
            }
        }; Spotfire.PageBus.subscribe("**", onData);
    }; Spotfire.registerNameSpace("FormsIntegration", {
        initialize: function () {
            if (window.external !== undefined) {
                window.sfEvalHook = function (code) {
                    try {
                        return JSON.stringify({ v: Spotfire.evaluate(code) });
                    } catch (ignored) { return null; }
                }; trackAjaxRequests();
            } initializePageBus(); $(document.body).on("click", function (e) {
                var $target = $(e.target);
                if (!$target.is("a")) { return; } var href = $target.attr("href"); if ((typeof href === "string" ? href.toLowerCase() : "").indexOf("file://") === 0) {
                    e.preventDefault();
                    Spotfire.PageBus.publish("spotfire.filelinkclicked", { url: href });
                }
            }); $(document.body).on("mousewheel.sf-global", function (e) {
                if (e.ctrlKey) {
                    e.preventDefault();
                }
            }); chromeFocusFix();
        }
    });
}); 

$(function () {
    Spotfire.registerNameSpace("JobQueue"); var create = function (options) {
        var opts = options || {};
        var delay = opts.delay || 0; var jobs = []; var processing = false; var profileSetting = opts.profile; var profileData = {};
        var prevProfilePrintTime = 0; var currentArgument = null; var printProfile = function () {
            var key; Spotfire.log("Function; Duration (" + profileSetting + ")");
            for (key in profileData) {
                if (profileData.hasOwnProperty(key)) {
                    if (profileSetting === "full") {
                        $.each(profileData[key], function () {
                            Spotfire.log(key + ";" + this);
                        });
                    } else {
                        if (profileSetting === "average") {
                            Spotfire.log(key + ";" + (profileData[key].reduce(function (a, b) {
                                return a + b;
                            }) / profileData[key].length));
                        } else {
                            if (profileSetting === "last") {
                                Spotfire.log(key + ";" + profileData[key].slice(-1)[0]);
                            } else { throw new Error("Unknown JobQueue profileSetting [" + profileSetting + "]"); }
                        }
                    }
                }
            }
        }; var processJob = function (job) {
            var beforeTime = Date.now();
            currentArgument = job.func.call(job.context, currentArgument); var deltaTime = Date.now() - beforeTime; if (profileSetting) {
                var jid = job.func.id || job.func.toString().replace(/(;\r\n|\r|\n)/g, "").replace(/ +/g, " ").substring(0, 60);
                if (!profileData[jid]) { profileData[jid] = []; } profileData[jid].push(deltaTime);
            }
        }; var processJobs = function () {
            if (processing) {
                return;
            } processing = true; setTimeout(function loop() {
                var job = jobs.shift(); if (job) {
                    processJob(job); setTimeout(loop, delay);
                } else {
                    processing = false; if (profileSetting) {
                        var now = Date.now(); if (now - prevProfilePrintTime > 3000) {
                            printProfile();
                            prevProfilePrintTime = now;
                        }
                    }
                }
            }, delay);
        }; var add = function (funcs, context) {
            if (Object.prototype.toString.call(funcs) !== "[object Array]") {
                funcs = [funcs];
            } $.each(funcs, function () { jobs.push({ func: this, context: context || {} }); }); processJobs();
        }; var makeBatch = function () {
            if (jobs.length != 0) {
                jobs[jobs.length - 1].isLastInBatch = true;
            }
        }; var remove = function (what) {
            if (what === "jobs") { jobs = []; } else {
                if (what === "batches") {
                    var i; for (i = 0; i < jobs.length;
                    i++) { if (jobs[i].isLastInBatch) { jobs = jobs.slice(0, i + 1); break; } }
                } else {
                    throw new Error("JobQueue.remove() - expected 'jobs' or 'batches'.");
                }
            }
        }; var flush = function () { var job; while (job = jobs.shift()) { processJob(job); } }; return { add: add, makeBatch: makeBatch, remove: remove, flush: flush };
    }; Spotfire.JobQueue.create = create;
}); 

$(function () {
    var Ajax = window.Ajax; if (!Ajax) {
        Ajax = {}; window.Ajax = Ajax;
    } var isMashup = false; var mashupOrigin = null; var pendingApiRequests = []; var apiRequestsStorageKey; var mashupOriginKey;
    var postMashupMessage = function (method, message) {
        if (!isMashup) { return; } message = message || {}; message.method = method;
        message.documentId = Ajax.DocumentId; try {
            window.parent.postMessage(JSON.stringify(message), mashupOrigin);
        } catch (ignore) { }
    }; var executeApiMethod = function (path, argsString, requestId, initialRequest) {
        var apiFunc = window;
        var i; try {
            for (i = 0; i < path.length; i++) { apiFunc = apiFunc[path[i]]; } var jsonArgs = JSON.parse(argsString); if (initialRequest) {
                jsonArgs.push(requestId);
            } pendingApiRequests.push({ path: path, args: JSON.stringify(jsonArgs), requestId: requestId }); apiFunc(jsonArgs);
        } catch (e) { Ajax.apiError(null, "The api function '" + path.join(".") + "' does not exist."); }
    }; var executeLostApiRequests = function () {
        try {
            var postponedRequests = window.sessionStorage.getItem(apiRequestsStorageKey);
            if (postponedRequests) {
                var i, data; window.sessionStorage.removeItem(apiRequestsStorageKey); var requests = JSON.parse(postponedRequests);
                for (i = 0; i < requests.length; i++) {
                    data = requests[i]; executeApiMethod(data.path, data.args, data.requestId, false);
                }
            }
        } catch (ignore) { }
    }; var enableMashup = function () {
        if (isMashup) { return false; } if (window === window.parent) {
            return false;
        } var parseMessageOrigin = function (url) {
            var patIPv4 = /^(https?:\/\/)(?:[a-zA-Z0-9\-.]+@[a-zA-Z0-9\-.]+:)?([a-zA-Z0-9\-.]+)(:[0-9]+)?(.*)$/i;
            var patIPv6 = /^(https?:\/\/)(?:[a-zA-Z0-9\-.]+@[a-zA-Z0-9\-.]+:)?(\[[a-zA-Z0-9:]+\])(:[0-9]+)?(.*)$/i;
            var res = patIPv6.exec(url) || patIPv4.exec(url); if (res) {
                var protocol = res[1]; var address = res[2]; var port = res[3] || "";
                if ((protocol === "http://" && port === ":80") || (protocol === "https://" && port === ":443")) {
                    return protocol + address;
                } return protocol + address + port;
            } return null;
        }; var setMashupOrigin = function () {
            try {
                mashupOrigin = window.sessionStorage.getItem(mashupOriginKey);
                window.sessionStorage.removeItem(mashupOriginKey);
            } catch (ignore) { } if (mashupOrigin) { return; } mashupOrigin = parseMessageOrigin(document.referrer) || window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port : "");
        }; var onMessage = function (event) {
            if (event.origin !== mashupOrigin || event.source !== parent) { return; } var data = JSON.parse(event.data);
            if (data.method === "ExecuteApiMethod") {
                executeApiMethod(data.path, data.args, data.requestId, true); return;
            } if (data.method === "closeAnalysis") { Ajax.close(); return; }
        }; isMashup = true; setMashupOrigin(); window.addEventListener("message", onMessage);
        return function () { postMashupMessage("documentUpdated"); };
    }; Ajax.onClosed = function (scheduledUpdateReload) {
        if (isMashup) {
            try {
                window.sessionStorage.setItem(apiRequestsStorageKey, JSON.stringify(pendingApiRequests));
                window.sessionStorage.setItem(mashupOriginKey, mashupOrigin);
            } catch (ignore) { } postMashupMessage("analysisClosed", { closedReason: scheduledUpdateReload ? "ScheduledUpdates" : "ClosedByUser" });
        } if (scheduledUpdateReload) { Spotfire.reloadPage(); }
    }; Ajax.redirectIfNotMashup = function (closedReaseon, url) {
        if (isMashup) {
            postMashupMessage("analysisClosed", { closedReason: closedReaseon });
        } else { Spotfire.replaceUrl(url); }
    }; Ajax.onError = function (message, details) {
        postMashupMessage("ajaxError", { message: message, details: details });
    }; Ajax.onLoggedOut = function () { postMashupMessage("userLoggedOut", {}); }; Ajax.mashupAnalysisLoaded = function () {
        postMashupMessage("analysisLoaded", { documentId: Ajax.DocumentId, documentViewId: Ajax.DocumentViewId });
        executeLostApiRequests();
    }; Ajax.apiRequestReceipt = function (requestId) {
        postMashupMessage("apiRequestReceipt", { requestId: requestId });
        var i; for (i = 0; i < pendingApiRequests.length; i++) {
            if (pendingApiRequests[i].requestId === requestId) {
                pendingApiRequests.splice(i, 1);
            }
        }
    }; Ajax.apiError = function (code, message) { postMashupMessage("apiError", { code: code, message: message }); };
    Ajax.runCallback = function (id, args, evaluate) {
        postMashupMessage("apiResult", { id: id, args: evaluate ? args : JSON.stringify(args), eval: evaluate });
    }; Spotfire.registerNameSpace("Mashup", {
        enable: function () {
            apiRequestsStorageKey = "API_" + Ajax.DocumentId + "_" + Ajax.DocumentViewId;
            mashupOriginKey = "Origin_" + Ajax.DocumentId + "_" + Ajax.DocumentViewId; return enableMashup();
        }
    });
}); 

$(function () {
    var clearStorage = function () {
        try {
            window.localStorage.clear();
        } catch (ignore) { }
    }; var getItem = function (key) {
        var item; try { item = window.localStorage.getItem(key); } catch (ex) {
            return null;
        } try { return JSON.parse(item); } catch (e) { return item; }
    }; var documentFullId; var browserTabId = Math.random().toString(36).substr(2);
    var setItem = function (key, value) {
        if (typeof value !== "string") { value = JSON.stringify(value); } try {
            window.localStorage.setItem(key, value);
        } catch (ex) { clearStorage(); }
    }; var removeItem = function (key) { try { window.localStorage.removeItem(key); } catch (ignore) { } };
    var modalOwnerAndCount; var unlockCallbacks = []; var registerUnlockCallback = function (callback) {
        unlockCallbacks.push(callback);
    }; var unregisterUnlockCallback = function (callback) {
        var i; for (i = 0; i < unlockCallbacks.length; i++) {
            if (unlockCallbacks[i] === callback) {
                unlockCallbacks.splice(i, 1);
                i--;
            }
        }
    }; var callUnlockCallbacks = function () {
        var cb = unlockCallbacks.pop(); while (cb) {
            cb(); cb = unlockCallbacks.pop();
        }
    }; var lockRemoteViews = function () {
        var current = getItem(modalOwnerAndCount); var owner = current ? current.owner : null;
        var count = current ? current.count : 0; if (owner === browserTabId) { count = Math.max(0, count + 1); } else { count = 1; } setItem(modalOwnerAndCount, { owner: browserTabId, count: count });
    }; var unlockRemoteView = function () {
        var current = getItem(modalOwnerAndCount); var owner = current ? current.owner : null;
        var count = current ? current.count : 0; if (owner === browserTabId) { count = Math.max(0, count - 1); } else { count = 0; } setItem(modalOwnerAndCount, { owner: browserTabId, count: count });
    }; var closeModalBlocker = function () { $("#remoteModalBlocker").remove(); }; var showModalBlocker = function () {
        if ($("#remoteModalBlocker").is(":visible")) {
            return;
        } var modalBlocker = $("<div />"); modalBlocker.css({ position: "absolute", left: 0, top: 0, right: 0, bottom: 0, "background-color": "#000", opacity: 0.5 });
        modalBlocker.attr("id", "remoteModalBlocker"); modalBlocker.appendTo($(document.body)); modalBlocker.on("click", function () {
            if ($("#remoteModalBlockerDialog").is(":visible")) {
                return;
            } var $content = $("<div>" + Spotfire.Localization.resources.MultipleViews_LockedWindowText + "</div>").addClass("confirmContent").attr("id", "remoteModalBlockerDialog");
            Spotfire.Controls.ModalDialog.initialize($content, {
                width: 400, resizable: false, modal: false, autoOpen: true, dialogClass: "confirmDialog", title: Spotfire.Localization.resources.MultipleViews_LockedWindowTitle, buttons: [{
                    text: Spotfire.Localization.resources.Yes, isDefault: true, click: function () {
                        Prompt.cancelPrompt();
                        closeModalBlocker(); setItem(modalOwnerAndCount, { owner: "cancelled", count: 0 });
                    }
                }, { text: Spotfire.Localization.resources.No, isCancel: true }]
            });
        });
    }; var checkForModalDialog = function (event) {
        if (event && event.key !== modalOwnerAndCount) { return; } var current = event ? JSON.parse(event.newValue) : getItem(modalOwnerAndCount);
        var owner = current ? current.owner : null; var count = current ? current.count : 0; if (owner === "unloaded") {
            closeModalBlocker();
            Prompt.cancelPrompt(); removeItem(modalOwnerAndCount);
        } else {
            if (owner === "cancelled") {
                closeModalBlocker();
                if (event && event.oldValue) {
                    var oldValue = JSON.parse(event.oldValue); if (oldValue.owner === browserTabId) {
                        callUnlockCallbacks();
                        $(".modal.in").modal("hide"); $(".ui-dialog-content").dialog("destroy").remove(); Spotfire.Controls.ModalDialog.closeAll();
                    }
                }
            } else { if (owner !== browserTabId) { if (count > 0) { showModalBlocker(); } else { closeModalBlocker(); } } }
        }
    }; var pokeViewKeyPrefix;
    var refreshTimer; var checkNeedsRefresh = function (event) {
        var key = pokeViewKeyPrefix + Ajax.DocumentViewId;
        if (event.key !== key) { return; } removeItem(key); if (!refreshTimer) {
            refreshTimer = window.setTimeout(function () {
                refreshTimer = null;
                Ajax.needsRefresh();
            }, 0);
        }
    }; var pokeViews = function () {
        var i; for (i = 0; i < arguments.length; i++) {
            if (getItem(Ajax.DocumentId + "_" + arguments[i])) {
                setItem(pokeViewKeyPrefix + arguments[i], new Date().getTime());
            }
        }
    }; var revertingKey; var revertPerformedPrefix; var revertToLastSaved = function (data) {
        data.documentId = Ajax.DocumentId;
        try { window.sessionStorage.setItem(revertingKey, JSON.stringify(data)); } catch (ignore) { } Spotfire.replaceUrl(data.url);
    }; var checkForRevert = function (event) {
        var key = Ajax.DocumentId + revertPerformedPrefix + Ajax.DocumentViewId;
        if (event.key !== key) { return; } removeItem(key); Spotfire.replaceUrl(event.newValue);
    }; var getSiblings = function () {
        var maxViewId = parseInt(getItem("MaxView_" + Ajax.DocumentId), 10);
        var siblings = []; var i; for (i = 0; i <= maxViewId; i++) {
            if (i !== parseInt(Ajax.DocumentViewId, 10) && getItem(Ajax.DocumentId + "_" + i)) {
                siblings.push(i.toString());
            }
        } return siblings;
    }; var documentNumber; var updateDocumentNumber = function (args) {
        setItem(documentNumber, args);
        if (args.DocumentNumber < Ajax.DocumentNumber) { return; } window.setTimeout(function () {
            Ajax.onClosed(true);
        }, 0);
    }; var checkForDocumentNumberUpdate = function (event) {
        if (event.key !== documentNumber) { return; } var args = JSON.parse(event.newValue);
        if (Ajax.DocumentNumber > args.DocumentNumber) { return; } Ajax.poll();
    }; var checkInitialDocumentNumber = function () {
        var args = getItem(documentNumber);
        if (!args || Ajax.DocumentNumber > args.DocumentNumber) { return; } Ajax.onClosed(true);
    }; var onClosing = function () {
        if (getItem(documentFullId) === browserTabId) {
            removeItem(documentFullId);
            window.setTimeout(function () { setItem(documentFullId, browserTabId); }, 100);
        }
    }; var focusCallbacks = []; var hasFocus = false;
    var viewReceivedFocus; var onRemoteFocus = function (callback) { focusCallbacks.push(callback); }; var offRemoteFocus = function (callback) {
        var i;
        for (i = 0; i < focusCallbacks.length; i++) {
            if (focusCallbacks[i] === callback) {
                focusCallbacks.splice(i, 1); i--;
            }
        }
    }; var checkForRemoteClicks = function (event) {
        if (event.key.indexOf(viewReceivedFocus) === 0 && event.newValue !== Ajax.DocumentViewId) {
            hasFocus = false;
            var cb = focusCallbacks.pop(); while (cb) { cb(); cb = focusCallbacks.pop(); }
        }
    }; var onFocus = function () {
        if (!hasFocus) {
            hasFocus = true;
            setItem(viewReceivedFocus, Ajax.DocumentViewId);
        }
    }; var showRemoteLightBox = function (popup) {
        if (popup && !popup._isProcessed) {
            popup._isProcessed = true;
            lockRemoteViews();
        } else { if (!popup) { lockRemoteViews(); } }
    }; var hideRemoteLightBox = function () {
        unlockRemoteView();
    }; window.addEventListener("mousedown", onFocus, true); window.addEventListener("keydown", onFocus, true); var spawnTimeout;
    var requestSpawnView = function (owner) {
        setItem(Ajax.DocumentId + "_SpawnRequest_" + owner, browserTabId); spawnTimeout = window.setInterval(function () {
            if (!getItem(documentFullId)) {
                Spotfire.reloadPage();
            }
        }, 100);
    }; var setSpawnResult = function (origin, url) {
        setItem(Ajax.DocumentId + "_SpawnResult_" + origin, url);
    }; var checkForSpawnView = function (event) {
        var requestKey = Ajax.DocumentId + "_SpawnRequest_" + browserTabId;
        var responseKey = Ajax.DocumentId + "_SpawnResult_" + browserTabId; if (event.key === requestKey) {
            removeItem(requestKey);
            Ajax.enqueueRequest(Ajax.DocumentId, "SpawnView", { origin: event.newValue });
        } if (event.key === responseKey) {
            if (spawnTimeout) {
                window.clearTimeout(spawnTimeout);
            } removeItem(responseKey); Spotfire.replaceUrl(event.newValue);
        }
    }; var initialize = function () {
        if (Spotfire.isProfessional()) {
            return true;
        } var pingTime = 60 * 1000; var pingKey = "Ping"; var lastPing = getItem(pingKey); if (!lastPing || lastPing < (new Date().getTime() - 5 * pingTime)) {
            clearStorage();
        } var ping = function () { setItem(pingKey, new Date().getTime()); }; ping(); window.setInterval(ping, pingTime);
        var i; documentFullId = Ajax.DocumentId + "_" + Ajax.DocumentViewId; modalOwnerAndCount = Ajax.DocumentId + "_MOD";
        pokeViewKeyPrefix = Ajax.DocumentId + "_QFC_"; documentNumber = Ajax.DocumentId + "_WLR"; revertingKey = "REV"; revertPerformedPrefix = "_REV_DONE_";
        viewReceivedFocus = Ajax.DocumentId + "_FOC"; $.widget("ui.dialog", $.ui.dialog, {
            open: function () {
                if (this.options.modal && !this._isProcessed) {
                    lockRemoteViews();
                    this._isProcessed = true;
                } return this._super();
            }, close: function () {
                if (this.options.modal && this._isProcessed) {
                    unlockRemoteView();
                    this._isProcessed = false;
                } return this._super();
            }
        }); $(document).on("show.spotfire.modal", function () {
            lockRemoteViews();
        }); $(document).on("hide.spotfire.modal", function () { unlockRemoteView(); }); $(document).on("show.bs.modal", function () {
            lockRemoteViews();
        }); $(document).on("hide.bs.modal", function () { unlockRemoteView(); }); $(document).on("show.spotfire.lightbox", function () {
            lockRemoteViews();
        }); $(document).on("hide.spotfire.lightbox", function () { unlockRemoteView(); }); checkForModalDialog(); try {
            var revertingdata = window.sessionStorage.getItem(revertingKey);
            if (revertingdata) {
                var data = JSON.parse(revertingdata); window.sessionStorage.removeItem(revertingKey); for (i = 0;
                i < data.siblings.length; i++) {
                    setItem(data.documentId + revertPerformedPrefix + data.siblings[i].documentviewid, window.location.href);
                }
            }
        } catch (ignore) { } var storageListener = function (event) {
            if (event.key.indexOf(Ajax.DocumentId + "_") !== 0 || !event.newValue) {
                return;
            } checkForSpawnView(event); checkForModalDialog(event); checkNeedsRefresh(event); checkForRevert(event); checkForRemoteClicks(event);
            checkForDocumentNumberUpdate(event);
        }; window.addEventListener("storage", storageListener); if (getItem(documentFullId)) {
            requestSpawnView(getItem(documentFullId));
            return false;
        } setItem(documentFullId, browserTabId); checkInitialDocumentNumber(); var maxViewId = getItem("MaxView_" + Ajax.DocumentId);
        if (!maxViewId || parseInt(Ajax.DocumentViewId, 10) > parseInt(maxViewId, 10)) {
            setItem("MaxView_" + Ajax.DocumentId, Ajax.DocumentViewId);
        } var id = getItem(documentFullId); if (id !== null && id !== browserTabId) { Spotfire.reloadPage(); return false; } $(window).on("unload", function () {
            if (getItem(documentFullId) === browserTabId) {
                removeItem(documentFullId);
            } removeItem(pokeViewKeyPrefix + Ajax.DocumentViewId); removeItem(Ajax.DocumentId + revertPerformedPrefix + Ajax.DocumentViewId);
            removeItem(Ajax.DocumentId + "_SpawnRequest_" + browserTabId); removeItem(Ajax.DocumentId + "_SpawnResult_" + browserTabId);
            if (getSiblings().length === 0) {
                removeItem(viewReceivedFocus); removeItem("MaxView_" + Ajax.DocumentId); removeItem(modalOwnerAndCount);
            } else {
                var current = getItem(modalOwnerAndCount); if (current && current.owner === browserTabId) {
                    setItem(modalOwnerAndCount, { owner: "unloaded", count: 0 });
                }
            }
        }); return true;
    }; Spotfire.registerNameSpace("MultipleViews", { PokeViews: pokeViews, RegisterView: initialize, ReplaceUrl: revertToLastSaved, OnRemoteFocus: onRemoteFocus, OffRemoteFocus: offRemoteFocus, SetFocus: onFocus, LockSiblingViews: showRemoteLightBox, UnlockSiblingViews: hideRemoteLightBox, RegisterUnlockCallback: registerUnlockCallback, UnregisterUnlockCallback: unregisterUnlockCallback, GetSiblings: getSiblings, ScheduledUpdatesWindowLocationReplace: updateDocumentNumber, SetSpawnResult: setSpawnResult, OnClosing: onClosing });
}); 

var Progress; 

if (!Progress) { Progress = {}; } 

$(function () {
    var setProgressText = function (progress, $popup) {
        $(".progressTitle", $popup).text(progress.Title);
        $(".progressDescription", $popup).text(progress.Description);
    }; var createPopupProgress = function (cancelOperation) {
        var $styledDialog = $("<div>").addClass("sf-element sf-element-styled-dialog progressDialog");
        var $popup = $("<div>").addClass("sf-element sf-element-progress-dialog").css({ width: "400px", height: "300px", position: "absolute", left: $(window).width() / 2 - 200 + "px", top: $(window).height() / 2 - 150 + "px" }).appendTo($styledDialog);
        var $progressImage = $("<div>").addClass("sf-element sf-element-busy-indicator sf-svg-loader-70x70 progressPopupAnimation").css({ "margin-left": "auto", "margin-right": "auto" });
        Spotfire.getSvg("Images/Progress/CircularProgressAnimation.svg", function ($svg) {
            $progressImage.append($svg);
        }); var $progressDialogText = $("<div>").addClass("sf-element sf-element-progress-dialog-text"); $("<div>").addClass("progressTitle").appendTo($progressDialogText);
        $("<div>").addClass("progressDescription").appendTo($progressDialogText); var onCancelClick = function () {
            cancelOperation();
            $popup.remove();
        }; var $cancelLink = $("<div>").addClass("progressCancel").text(Spotfire.Localization.resources.Cancel).click(onCancelClick);
        if (Spotfire.Web.hideCancelButtonWhenLoading) { $cancelLink.hide(); } $popup.append($progressImage); $popup.append($progressDialogText);
        $popup.append($cancelLink); var recenter = function () {
            $popup.css({ position: "absolute", left: $(window).width() / 2 - $popup.width() / 2 + "px", top: $(window).height() / 2 - $popup.height() / 2 + "px" });
        }; $("body").append($styledDialog); $(window).on("resize", recenter); $popup.on("remove", function () {
            $(window).off("resize", recenter);
        }); window.setTimeout(function () {
            $cancelLink.css("left", ($cancelLink.parent().innerWidth() - $cancelLink.outerWidth()) / 2 + "px");
        }, 0); Spotfire.MultipleViews.LockSiblingViews($styledDialog); return $styledDialog;
    }; Progress.setPopupUploadProgressText = function (progress, cancelUploadCallback) {
        var $popup = createPopupProgress(cancelUploadCallback);
        setProgressText(progress, $popup);
    }; Progress.showPlotOverlay = function (parentId) {
        var overlayId = parentId + "_refresh";
        var $parent = $("#" + parentId); if ($("#" + overlayId, $parent).size() > 0) { return; } var $overlay = $(Spotfire.Progress.createProgressAnimation($parent.width(), $parent.height()));
        $overlay.attr("id", overlayId); $parent.append($overlay);
    }; Progress.hidePlotOverlay = function (parentId) {
        var overlayId = parentId + "_refresh";
        var $parent = $("#" + parentId); var $overlay = $("#" + overlayId, $parent); $overlay.remove();
    }; Spotfire.registerNameSpace("Progress", {
        setPopupProgressText: function (progress) {
            var $popup = $(".progressDialog");
            if ($popup.length === 0) {
                $popup = createPopupProgress(Ajax.cancelOperation); var restorers = []; $popup.siblings().each(function () {
                    var $sibling = $(this);
                    var zIndex = parseInt($sibling.css("z-index"), 10); if (zIndex > 0) {
                        $sibling.css("z-index", ""); restorers.push(function () {
                            $sibling.css("z-index", zIndex);
                        });
                    }
                }); $popup.on("sf-progress-dialog-close", function () {
                    while (restorers.length > 0) {
                        restorers.shift()();
                    }
                });
            } setProgressText(progress, $popup);
        }, closePopupProgress: function () {
            if (Spotfire.Data.Upload.uploadProgress) {
                return;
            } var $popup = $(".progressDialog"); if ($popup.length > 0) { Spotfire.MultipleViews.UnlockSiblingViews(); } $popup.trigger("sf-progress-dialog-close");
            $popup.remove();
        }, createProgressAnimation: function (width, height) {
            var $overlay = $("<div/>").css({ position: "absolute", top: "0", left: "0", width: width ? width + "px" : "100%", height: height ? height + "px" : "100%" });
            var animationSize = 30; var animationPadding = 8; var animationOuterSize = animationSize + animationPadding * 2; var $progressContainer = $("<div/>").addClass("sf-element sf-element-progress-animation").css({ "border-radius": "50%", position: "absolute", height: animationSize, width: animationSize, padding: animationPadding, left: width / 2 - animationOuterSize / 2, top: height / 2 - animationOuterSize / 2 }).appendTo($overlay);
            var $progressImage = $("<div/>").addClass("sf-element sf-element-busy-indicator sf-svg-loader-30x30").appendTo($progressContainer);
            Spotfire.getSvg("Images/Progress/CircularProgressAnimation.svg", function ($svg) {
                $progressImage.append($svg);
            }); return $overlay.get(0);
        }, createFadingProgressAnimation: function ($parent, width, height) {
            var fadeInMs = 1000;
            var fadeOutMs = 250; var $element = $(this.createProgressAnimation(width, height)); var $animation = $element.find(".sf-element-progress-animation").fadeIn(fadeInMs);
            $element.appendTo($parent); var remove = function () {
                $element.css("pointer-events", "none"); $animation.stop().fadeOut(fadeOutMs, function () {
                    $element.remove();
                });
            }; return { "$element": $element, remove: remove };
        }
    });
});
var ProgressBlocker = {}; 

$(function () {
    var defaultSettings = { bgColor: undefined, bgOpacity: 0, delay: 0, zIndex: 1000, cancelOperation: undefined };
    var doBlock = function (element, options) {
        var settings = $.extend({}, defaultSettings, options); if ($(".progressBlocker", element).size() > 0) {
            return;
        } var progressContainer = $("<div></div>"); progressContainer.addClass("progressBlocker"); var $progress = Spotfire.Flex.item({ container: "vertical", fill: true, "justify-content": "center", "align-items": "center" }).css({ position: "absolute", top: element.position().top + "px", left: element.position().left + "px", "z-index": settings.zIndex, width: element.width() + "px", height: element.height() + "px" });
        $progress.bind("*", function (event) { event.stopPropagation(); }); $(Spotfire.Progress.createProgressAnimation(30, 30)).css("position", "relative").appendTo($progress);
        if (settings.bgColor) { $progress.css({ "background-color": settings.bgColor }); } if (settings.bgOpacity) {
            $progress.css({ opacity: settings.bgOpacity, "z-index": "1" });
        } if (settings.cancelOperation) {
            $("<p>").addClass("progressCancel").text(Spotfire.Localization.resources.Cancel).appendTo($progress).click(function () {
                settings.cancelOperation();
            });
        } progressContainer.hide().delay(settings.delay).fadeIn(600); progressContainer.append($progress); element.append(progressContainer);
    }; ProgressBlocker.block = function (element, settings) { _.defer(function () { doBlock(element, settings); }); };
    ProgressBlocker.unblock = function (element) {
        _.defer(function () {
            var progressContainer = $(".progressBlocker", element);
            progressContainer.empty(); progressContainer.remove();
        });
    };
});
var Prompt;
if (!Prompt) { Prompt = {}; }
$(function () {
    Prompt._clientValidationOk = true;
    Prompt._errorMessage = ""; Prompt.promptModel = null; Prompt.onPromptLoaded = function () { }; Prompt.onPromptConfirmed = function () { };
    Prompt.onPromptCanceled = function () { }; Prompt.onWizardAdvanced = function () { }; Prompt.onClientValidate = function () { };
    Prompt.controlsEnabled = false; Prompt.resetCallbacks = function () {
        Prompt.onPromptLoaded = function () { }; Prompt.onPromptConfirmed = function () { };
        Prompt.onPromptCanceled = function () { }; Prompt.onWizardAdvanced = function () { }; Prompt.onClientValidate = function () { };
    }; Prompt.updateStyledElements = function updateStyledInput() {
        if (Prompt.inProgress) {
            Spotfire.Filters.StyledFilters.createStyledInput($(".promptContentPanel"), 13, 13);
        }
    }; Prompt.setContents = function (prompt) {
        Prompt.inProgress = true; var popup = $(".promptingPopup"); var contentPanel = $(".promptContentPanel", popup);
        var onClose = function () {
            if (Prompt.inProgress) { Prompt.cancelPrompt(); Prompt.inProgress = false; } if (Prompt.interval) {
                window.clearInterval(Prompt.interval);
                Prompt.interval = null;
            }
        }; if (popup.size() === 0) {
            popup = $("<div/>").addClass("promptingPopup sf-enable-selection");
            contentPanel = $("<div/>").addClass("promptContentPanel").appendTo(popup); popup.data("ModalDialog", Spotfire.Controls.ModalDialog.initialize(popup, {
                type: "wrapped", width: prompt.Width, height: prompt.Height, minWidth: prompt.MinWidth, minHeight: prompt.MinHeight, close: onClose, modal: true, preventAutoClose: function () {
                    return !popup.hasClass("sf-has-default-button");
                }, resize: function () { contentPanel.trigger("sf-resize"); }
            })); Spotfire.LightBox.toggle(false);
        } if (prompt) {
            contentPanel.html("");
            contentPanel.html(prompt.Contents ? prompt.Contents : ""); if (prompt.PromptScripts) {
                Spotfire.evaluate(prompt.PromptScripts);
            } if (prompt.Model) { Prompt.promptModel = JSON.parse(prompt.Model); } if (prompt.ValidationResults) {
                if (prompt.ValidationResults.IsValid === true) {
                    Prompt.setValid();
                } else { Prompt.setInvalid(prompt.ValidationResults.ErrorMessage); }
            } Prompt.updateStyledElements(); if (!Prompt.interval) {
                Prompt.interval = window.setInterval(Prompt.updateStyledElements, 100);
            } popup.find("input").addClass("sf-element-input"); popup.dialog("option", { title: prompt.Title ? prompt.Title : "", height: prompt.Height });
            Prompt.onPromptLoaded(Prompt.promptModel);
        } else {
            contentPanel.html(""); var preparingPanel = $("<div></div>");
            preparingPanel.css({ width: "100%", height: "100%", "text-align": "center" }); var animation = $("<img src='Images/Progress/CircularProgressAnimation.gif'/>");
            animation.css({ width: "32px", height: "32px" }); var text = $("<p></p>"); text.html(Spotfire.Localization.resources.PreparingPromptStep);
            preparingPanel.append($("<br/>")); preparingPanel.append($("<br/>")); preparingPanel.append(animation);
            preparingPanel.append(text); contentPanel.append(preparingPanel);
        } Prompt.controlsEnabled = true;
    }; Prompt.showButtons = function (buttons, clientValidation) {
        var extractFormValues = function () {
            Prompt.promptModel = Spotfire.FormHelper.extractValues("promptForm");
        }; var onNextClick = function () {
            if (clientValidation) {
                extractFormValues(); Prompt.validateAndMoveNextWizardPage();
            } else { Prompt.nextWizardPage(); } return true;
        }; var onBackClick = function () {
            if (clientValidation) {
                extractFormValues();
            } Prompt.previousWizardPage();
        }; var onOkClick = function () {
            if (clientValidation) { extractFormValues(); } Prompt.confirmPrompt();
            return true;
        }; var onSkipClick = function () {
            if (clientValidation) { extractFormValues(); } Prompt.validOkOrSkipped();
            return true;
        }; if (buttons.ok || buttons.finish) { Prompt.clickOk = onOkClick; } var items = []; if (buttons.back) {
            items.push({ text: Spotfire.Localization.resources.Back, click: onBackClick });
        } if (buttons.next) {
            items.push({ text: Spotfire.Localization.resources.Next, isDefault: true, click: onNextClick });
        } if (buttons.ok) {
            items.push({ text: Spotfire.Localization.resources.Ok, isDefault: !buttons.Finish && !buttons.next, click: onOkClick });
        } if (buttons.skip) { items.push({ text: buttons.skipButtonText, isDefault: false, click: onSkipClick }); } if (buttons.finish) {
            items.push({ text: Spotfire.Localization.resources.Finish, click: onOkClick, isDefault: !buttons.next });
        } if (!buttons.hasOwnProperty("nocancel") || buttons.nocancel !== true) {
            items.push({ text: Spotfire.Localization.resources.Cancel, click: Prompt.cancelPrompt, isCancel: true });
        } var hasDefault = _.any(items, function (x) { return true === x.isDefault; }); $(".promptingPopup").toggleClass("sf-has-default-button", hasDefault).dialog("option", { buttons: items, resizeStop: Prompt.resize });
    }; Prompt.resize = function () { }; Prompt.setValid = function () {
        Prompt._clientValidationOk = true; Prompt._errorMessage = "";
    }; Prompt.setInvalid = function (errorMessage) {
        Prompt._clientValidationOk = false; Prompt.setErrorMessage(errorMessage);
    }; Prompt.setErrorMessage = function (errorMessage) {
        Prompt._errorMessage = errorMessage; var popup = $(".promptingPopup");
        $(".promptErrorImage", popup).remove(); var errorImage = $("<img src='Images/Prompt/Exclamation.gif'/>");
        errorImage.addClass("promptErrorImage"); errorImage.css({ position: "absolute", top: "5px", right: "5px", width: "18px", height: "16px", border: "0px" });
        errorImage.attr("alt", Prompt._errorMessage); errorImage.attr("title", Prompt._errorMessage); $(".promptContentPanel", popup).append(errorImage);
    }; Prompt.closePopupPrompt = function () {
        if (Prompt.interval) {
            window.clearInterval(Prompt.interval); Prompt.interval = null;
        } Prompt.inProgress = false; Spotfire.LightBox.toggle(true); $(".promptingPopup").dialog("close"); Prompt.resetCallbacks();
    }; Prompt.cancelPrompt = function () {
        Prompt.onPromptCanceled(); Ajax.cancelOperation(); Prompt.resetCallbacks();
    }; Prompt.promptFunctionCall = function (functionName, args, callback) {
        var serializedArguments = JSON.stringify(args);
        Spotfire.Dxp.Web.Forms.AjaxService.PromptFunctionCall(Ajax.DocumentId, functionName, serializedArguments, callback, Prompt.communicationError);
    }; Prompt.validOkOrSkipped = function () {
        var serializedPromptModel = JSON.stringify(Prompt.promptModel); var callback = function () {
            Prompt.controlsEnabled = true;
            Prompt.closePopupPrompt(); Ajax.setState(Ajax.popupPollState); Ajax.poll();
        }; Spotfire.Dxp.Web.Forms.AjaxService.ConfirmPrompt(Ajax.DocumentId, serializedPromptModel, callback, Prompt.communicationError);
        Prompt.resetCallbacks();
    }; Prompt.confirmPrompt = function () {
        Prompt._clientValidationOk = true; Prompt.onClientValidate();
        if (Prompt._clientValidationOk) {
            if (Prompt.controlsEnabled) { Prompt.controlsEnabled = false; } else { return; } Prompt.onWizardAdvanced(Prompt.promptModel);
            Prompt.onPromptConfirmed(Prompt.promptModel); var serializedPromptModel = JSON.stringify(Prompt.promptModel);
            var callback = function (result) {
                if (result.IsValid) { Prompt.validOkOrSkipped(); } else {
                    Prompt.controlsEnabled = true;
                    Prompt.setErrorMessage(result.ErrorMessage);
                }
            }; Spotfire.Dxp.Web.Forms.AjaxService.ValidatePrompt(Ajax.DocumentId, serializedPromptModel, callback, Prompt.communicationError);
        }
    }; Prompt.validateAndMoveNextWizardPage = function () {
        if (Prompt.controlsEnabled) {
            Prompt.controlsEnabled = false;
        } else { return; } var serializedPromptModel = JSON.stringify(Prompt.promptModel); var callback = function (result) {
            Prompt.controlsEnabled = true;
            if (result.IsValid) { Prompt.setValid(); Prompt.nextWizardPage(); } else {
                Prompt.setInvalid(result.ErrorMessage);
            }
        }; Spotfire.Dxp.Web.Forms.AjaxService.ValidatePrompt(Ajax.DocumentId, serializedPromptModel, callback, Prompt.communicationError);
    }; Prompt.nextWizardPage = function () {
        Prompt._clientValidationOk = true; Prompt.onClientValidate(); if (Prompt._clientValidationOk) {
            if (Prompt.controlsEnabled) {
                Prompt.controlsEnabled = false;
            } else { return; } Prompt.onWizardAdvanced(Prompt.promptModel); var serializedPromptModel = JSON.stringify(Prompt.promptModel);
            Spotfire.Dxp.Web.Forms.AjaxService.NextWizardPage(Ajax.DocumentId, serializedPromptModel, Prompt.wizardPromptPostCallback, Prompt.communicationError);
            Prompt.resetCallbacks();
        }
    }; Prompt.previousWizardPage = function () {
        if (Prompt.controlsEnabled) {
            Prompt.controlsEnabled = false;
        } else { return; } Prompt.onWizardAdvanced(Prompt.promptModel); var serializedPromptModel = JSON.stringify(Prompt.promptModel);
        Spotfire.Dxp.Web.Forms.AjaxService.PreviousWizardPage(Ajax.DocumentId, serializedPromptModel, Prompt.wizardPromptPostCallback, Prompt.communicationError);
        Prompt.resetCallbacks();
    }; Prompt.wizardPromptPostCallback = function () {
        Prompt.controlsEnabled = true; Prompt.setContents();
        Ajax.setState(Ajax.popupPollState); Ajax.poll();
    }; Prompt.communicationError = function (error, retryInterval, functionName) {
        if (Spotfire.connectionLost()) {
            Prompt.cancelPrompt();
            return;
        } var heading = (error.search("Status: 401 Unauthorized") > 0) ? "Session was logged out." : "Communication error in " + functionName;
        Ajax.redirectToErrorPage(heading, error);
    }; Prompt.exists = function () {
        return $(".promptingPopup").size() > 0;
    }; Prompt.availableSize = function () {
        return { width: $(".promptingPopup").width() - 5, height: $(".promptingPopup").height() - 5 };
    };
}); 
$(function () {
    Spotfire.registerNameSpace("Prompt", function () {
        return {
            create: function (viewId) {
                return {
                    modify: function (method, args) {
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(viewId, method, args);
                    }, read: function (method, args, callback) {
                        Spotfire.Dxp.Web.Forms.AjaxService.Read(viewId, method, args, callback);
                    }, confirm: function () {
                        if (Spotfire.isProfessional()) { this.modify("CloseDialog", "OK"); } else {
                            Prompt.confirmPrompt();
                        }
                    }, cancel: function () {
                        if (Spotfire.isProfessional()) { this.modify("CloseDialog", "Cancel"); } else {
                            Prompt.cancelPrompt();
                        }
                    }
                };
            }, init: function (viewId) {
                var $view = $("#" + viewId); var setSize = function ($elem) {
                    $elem.css({ width: "100%", height: "100%" });
                }; var $parent = $view.closest(".sf-element-modal-dialog"); var isModalDialog = $parent.length > 0; if (!isModalDialog) {
                    $parent = $view.parent();
                    $parent.css("overflow", "hidden"); setSize($parent); $view.addClass("sf-element-modal-dialog-body"); $parent.addClass("sf-element-modal-dialog sfpc-compact static-style").css("overflow", "hidden");
                    $(window).on("resize", function () { $parent.trigger("sf-resize"); });
                } else {
                    setSize($parent.find(".promptContentPanel"));
                } setSize($view); $parent.on("sf-resize", function (e) {
                    if ($(e.target).is($view)) { return; } $view.trigger("sf-resize");
                });
            }
        };
    }());
}); 
var Spotfire; 
if (!Spotfire) {
    Spotfire = (function () {
        var clientType = null; var isDebugging = null;
        var loginPage = null; var isCloud = false; var isAuthorMode = false; var reloadTimer; var shutdown = false; return {
            shutdown: function (value) {
                if (typeof value === "boolean") {
                    shutdown = value;
                } return shutdown;
            }, isDebugging: function () { return isDebugging === true; }, isCloud: function () {
                return isCloud === true;
            }, setCloud: function (value) { isCloud = value; }, isAuthorMode: function () { return isAuthorMode === true; }, setAuthorMode: function (value) {
                isAuthorMode = value;
            }, enableDebugging: function (value) {
                if (isDebugging !== null) { throw "Attempt to enable debugging twice"; } isDebugging = value === true;
            }, PROFESSIONAL: 1, WEBPLAYER: 2, handleAbsoluteSessionTimeouts: false, setLoginPage: function (url) {
                loginPage = url;
            }, getLoginPage: function () { return loginPage; }, isWebPlayer: function () {
                return clientType === this.WEBPLAYER;
            }, isProfessional: function () { return clientType === this.PROFESSIONAL; }, setClientType: function (type) {
                if (clientType !== null) {
                    throw "Attempt to set client type twice";
                } if (type !== this.PROFESSIONAL && type !== this.WEBPLAYER) { throw "Invalid client type"; } clientType = type;
            }, registerNameSpace: function (ns, obj) {
                var parent = this, segments = ns.split("."), i, propertyName;
                for (i = 0; i < segments.length; i++) {
                    propertyName = segments[i]; if (!parent.hasOwnProperty(propertyName)) {
                        parent[propertyName] = {};
                    } parent = parent[propertyName];
                } if (typeof obj === "object") { $.extend(parent, obj); }
            }, unwrapException: function (e) {
                var lines = [];
                lines.push("Type: " + e.name); lines.push("Message: " + e.message); var stack = e.stack || e.stacktrace; if (stack) {
                    lines.push("Stacktrace: " + stack);
                } return lines.join("\r\n");
            }, evaluate: function (code, debug) {
                var result; try { result = window.eval(code); } catch (e) {
                    if (debug) {
                        this.log(this.unwrapException(e) + " in '" + code + "'");
                    } throw e;
                } return result;
            }, log: function (args) {
                if (!isDebugging) { return; } var usePageBus = this.isProfessional();
                var consoleLog = function (str) {
                    var console = window.console; if (console) { console.log(str); } if (usePageBus) {
                        Spotfire.PageBus.publish("spotfire.console.log", str);
                    }
                }; if (args === undefined) { consoleLog("undefined"); } else {
                    if (args === null) { consoleLog("null"); } else {
                        if (typeof args === "function") {
                            this.log(args());
                        } else { consoleLog(args.toString()); }
                    }
                }
            }, svgCache: {}, getSvg: function (url, success) {
                url = url.toLowerCase();
                var cacheEntry = this.svgCache[url]; if (cacheEntry === undefined || cacheEntry === null) {
                    var pending = []; pending.push(success);
                    cacheEntry = { pending: pending }; this.svgCache[url] = cacheEntry; var callback = function (xml) {
                        var $svg = $(xml).find("svg").removeAttr("id");
                        if ($svg.attr("xmlns") === undefined) { Spotfire.log(url + " missing xmlns attribute."); return; } $svg = $(document.importNode($svg.get(0), true));
                        cacheEntry.result = $svg; delete cacheEntry.pending; $.each(pending, function () { this($svg.clone()); });
                    }; $.get(url, null, callback, "xml");
                    return;
                } if (cacheEntry.result === undefined) {
                    if (cacheEntry.pending === undefined) {
                        throw "Inconsistent SVG cache state.";
                    } cacheEntry.pending.push(success);
                } else {
                    if (!(cacheEntry.result instanceof jQuery)) {
                        cacheEntry.result = $(cacheEntry.result);
                    } success(cacheEntry.result.clone());
                }
            }, htmlEncode: function (str) { return $("<div/>").text(str).html(); }, newFakeGuid: function () {
                var s = function (len) {
                    var x = Math.pow(2, 4 * len);
                    return Math.floor((Math.random() * x) + x).toString(16).substring(1);
                }; return s(8) + "-" + s(4) + "-" + s(4) + "-" + s(4) + "-" + s(12);
            }, connectionLost: function () { return $("#connectionLostOverlay").is(":visible"); }, PageBus: {
                publish: function (subject, data, viewId) {
                    if (viewId !== undefined) {
                        data.viewId = viewId;
                    } window.PageBus.publish(subject, JSON.stringify(data));
                }, subscribe: function (subject, onMessage) {
                    var callback = function (subj, msg) {
                        onMessage(subj, msg);
                    }; window.PageBus.subscribe(subject, null, callback, null);
                }
            }, replaceUrl: function (url) {
                $(window).off("beforeunload.spotfire");
                window.location.replace(url);
            }, ensureString: function (args) {
                return typeof args === "string" ? args : (args !== null ? JSON.stringify(args) : null);
            }, reloadPage: function () {
                if (reloadTimer) { return; } var reloadInterval = 0; var initialInterval = 300; var maxInterval = 4800;
                try {
                    var lastReload = parseInt(window.sessionStorage.getItem("lastReload") || 0, 10); var lastReloadInterval = parseInt(window.sessionStorage.getItem("reloadInterval") || reloadInterval, 10);
                    if (lastReload > (new Date().getTime() - 10000)) {
                        reloadInterval = Math.min(maxInterval, (lastReloadInterval * 2) || initialInterval);
                    }
                } catch (e) { reloadInterval = initialInterval * 4; } reloadTimer = window.setTimeout(function () {
                    try {
                        window.sessionStorage.setItem("lastReload", new Date().getTime());
                        window.sessionStorage.setItem("reloadInterval", reloadInterval);
                    } catch (ignore) { } $(window).off("beforeunload.spotfire");
                    window.location.hash = ""; window.location.replace(window.location.href);
                }, reloadInterval);
            }, capabilities: {
                supportsDropShadow: function () {
                    return clientType === Spotfire.WEBPLAYER || Spotfire.cefWindowed;
                }, supportsTouch: function () {
                    try { document.createEvent("TouchEvent"); } catch (e) { return false; } return navigator.userAgent.match(/(iphone|ipod|ipad|android)/gi) ? true : false;
                }
            }
        };
    }());
} 
$(function () {
    $(window).on("unload", function () { Spotfire.shutdown(true); }); var formatXmlHttpRequestError = function (jqXhr) {
        return "XmlHttpRequest failed.\nStatus: " + jqXhr.status + " " + jqXhr.statusText + "\n\nResponse:\n" + jqXhr.responseText;
    }; var logError = function (str) {
        if (Spotfire.shutdown()) { return; } Spotfire.WebAnalysis.notifyError("Operation failed", str);
        if (Spotfire.isDebugging()) { throw str; } if (Spotfire.isProfessional()) {
            Spotfire.PageBus.publish("spotfire.log.error", str);
        }
    }; var onError = function (jqXhr, textStatus, errorThrown) {
        logError(textStatus + " " + errorThrown + "\n\n" + formatXmlHttpRequestError(jqXhr));
    }; var onBeforeSend = function (jqXhr, settings) {
        var getCookie = function (name) {
            var cookieValue = null; if (document.cookie && document.cookie !== "") {
                var cookies = document.cookie.split(";");
                var i, cookie; for (i = 0; i < cookies.length; i++) {
                    cookie = jQuery.trim(cookies[i]); if (cookie.substring(0, name.length + 1) === (name + "=")) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            } return cookieValue;
        }; if (!settings.crossDomain) {
            var xsrfToken = getCookie("XSRF-TOKEN"); if (xsrfToken) {
                jqXhr.setRequestHeader("X-XSRF-TOKEN", xsrfToken);
            }
        }
    }; var get401RedirectUrl = function (location) {
        var relativeUrl = location.pathname + location.search + location.hash;
        var formEncodedTargetUrl = encodeURIComponent(relativeUrl).replace("%20", "+").replace(/[!'()*]/g, function (c) {
            return "%" + c.charCodeAt(0).toString(16);
        }); return Spotfire.getLoginPage() + "?targetUrl=" + formEncodedTargetUrl;
    }; var handleAbsoluteSessionTimeouts = function (jqXhr) {
        if (Spotfire.handleAbsoluteSessionTimeouts && jqXhr.status === 401) {
            Ajax.onLoggedOut();
            $(window).off("beforeunload.spotfire"); window.location.href = get401RedirectUrl(window.location); return true;
        } if (Spotfire.handleAbsoluteSessionTimeouts && jqXhr.status === 410) {
            if (!Spotfire.shutdown()) {
                var r = null; try {
                    r = JSON.parse(jqXhr.responseText);
                } catch (ignore) { } var handler = Spotfire.Framework.onServerError; if (r === null || r === undefined || r.Error === null || r.ClosedReason === null || r.ErrorId === null) {
                    handler(null, "UserLoggedOut", null);
                } else { handler(r.Error, r.ClosedReason, r.ErrorId); }
            } return true;
        } return false;
    }; var hideConnectionLostOverlay = function () {
        if (Spotfire.connectionLost()) {
            $("#connectionLostOverlay").remove();
        }
    }; var showConnectionLostOverlay = function () {
        if ($("#connectionLostOverlay").is(":visible")) { return; } var $overlay = $("<div />");
        $overlay.css({ position: "absolute", left: 0, top: 0, right: 0, bottom: 0, "background-color": "#fff", opacity: 0, "z-index": 10000 }).sfFlex({ container: "horizontal", "justify-content": "center", fill: true });
        var $progress = Spotfire.Flex.item({ container: "vertical", "justify-content": "center", "align-items": "center", fill: true }).appendTo($overlay);
        var $progressImage = $("<div/>").css({ "margin-bottom": "10px", color: "#26a2ed" }).addClass("sf-element sf-element-busy-indicator sf-svg-loader-30x30").appendTo($progress);
        Spotfire.getSvg("Images/Progress/CircularProgressAnimation.svg", function ($svg) {
            $progressImage.append($svg);
        }); $("<div />").css("white-space", "pre").text(Spotfire.Localization.resources.ErrorDialog_ConnectionLost).appendTo($progress);
        $overlay.attr("id", "connectionLostOverlay"); $overlay.appendTo($(document.body)); $overlay.fadeTo(500, 0.75);
    }; var tssFormattedErrorHandler = function (jqXhr, error) {
        if (!handleAbsoluteSessionTimeouts(jqXhr)) {
            if (jqXhr.readyState === 0) {
                showConnectionLostOverlay();
            } error(formatXmlHttpRequestError(jqXhr));
        }
    }; var tssErrorHandler = function (jqXhr, textStatus, errorThrown, error) {
        if (!handleAbsoluteSessionTimeouts(jqXhr)) {
            error(jqXhr, textStatus, errorThrown);
        }
    }; $.ajaxSetup({
        type: "POST", contentType: "application/json; charset=utf-8", dataType: "json", error: function (jqXhr, textStatus, errorThrown) {
            tssErrorHandler(jqXhr, textStatus, errorThrown, onError);
        }, beforeSend: onBeforeSend
    }); $(document).ajaxSuccess(hideConnectionLostOverlay); var formatDate = function (args, callback) {
        if (typeof args !== "object" || args === null) {
            throw "Attempt to format non-date value.";
        } var success = function (response) { callback(Spotfire.isWebPlayer() ? JSON.parse(response.d) : response); }; var ms = args.getTime() - (args.getTimezoneOffset() * 60 * 1000);
        var data = { args: ms }; var url = "AjaxService.asmx/FormatDate"; if (Spotfire.isWebPlayer()) {
            url = url + "?waid=" + Ajax.DocumentId;
        } $.ajax({ url: url, data: JSON.stringify(data), success: success });
    }; var parseDate = function (args, callback) {
        if (typeof args !== "string") {
            throw "Attempt to parse non-string value.";
        } var success = function (response) {
            try {
                var s = Spotfire.isWebPlayer() ? JSON.parse(response.d) : response; s = s.substring(s.indexOf("(") + 1, s.indexOf(")"));
                s = new Date(parseInt(s, 10)); callback(s);
            } catch (ex) { callback(null); }
        }; var data = { args: args }; var url = "AjaxService.asmx/ParseDate";
        if (Spotfire.isWebPlayer()) { url = url + "?waid=" + Ajax.DocumentId; } $.ajax({ url: url, data: JSON.stringify(data), success: success });
    }; var callbackCounter = 0; var webViewRead = function (viewId, method, args, callback, errorCallback) {
        var selector = "[viewId=" + viewId + "]";
        var thisCallbackId = "callback" + (++callbackCounter); var isCallbackAttached = $(selector).data(thisCallbackId, callback).length > 0;
        var invokeCallback = function (val) {
            if (val !== null) {
                var cb = isCallbackAttached ? $(selector).data(thisCallbackId) : callback;
                if (typeof cb === "function") { cb(val); return; }
            } if (typeof errorCallback === "function") { errorCallback(); }
        };
        var success = function (value) {
            try {
                if (Spotfire.isWebPlayer() && value) {
                    invokeCallback(value.result); if (value.status === 0 && Spotfire.WebAnalysis.isReady()) {
                        Ajax.poll();
                    } return;
                } invokeCallback(value);
            } catch (e) {
                logError("Read callback '" + method + "' failed.\r\n" + Spotfire.unwrapException(e));
            }
        }; var error = function (jqXhr, textStatus, errorThrown) {
            var expectationFailedStatusCode = 417; if (jqXhr.status !== expectationFailedStatusCode) {
                onError(jqXhr, textStatus, errorThrown);
            }
        }; var wrappedError = function (jqXhr, textStatus, errorThrown) {
            if (typeof errorCallback === "function") {
                errorCallback();
            } tssErrorHandler(jqXhr, textStatus, errorThrown, error);
        }; var data = { viewId: viewId, method: method, args: Spotfire.ensureString(args) };
        var url = "AjaxService.asmx/Read"; if (Spotfire.isWebPlayer()) {
            url = "WebViewRead.ashx?waid=" + Ajax.DocumentId + "&wavid=" + Ajax.DocumentViewId;
        } $.ajax({ url: url, data: JSON.stringify(data), success: success, error: wrappedError });
    }; var webViewModify = function (viewId, method, args, stickyGuid) {
        var data = { viewId: viewId, method: method, args: Spotfire.ensureString(args), stickyGuid: stickyGuid };
        if (Spotfire.isWebPlayer() || Spotfire.WebAnalysis.handleWebViewModify()) {
            Ajax.enqueueRequest("WVM", "", JSON.stringify(data));
        } else { $.ajax({ url: "AjaxService.asmx/Modify", data: JSON.stringify(data), success: $.noop }); }
    }; var request = function (waid, wavid, nodeId, requestId, callback, args, success, error) {
        if (Spotfire.isProfessional()) {
            throw "Request should not be called in Professional";
        } var data = { waid: waid, wavid: wavid, nodeId: nodeId, requestId: requestId, callback: callback, args: args }; $.ajax({
            url: "AjaxService.asmx/Request?waid=" + waid, data: JSON.stringify(data), success: function (response) {
                success(JSON.parse(response.d));
            }, error: function (jqXhr) { tssFormattedErrorHandler(jqXhr, error); }
        });
    }; var needsRefresh = function (waid, success, error) {
        if (Spotfire.isProfessional()) {
            throw "NeedsRefresh should not be called in Professional";
        } var data = { waid: waid, wavid: Ajax.DocumentViewId }; $.ajax({
            url: "AjaxService.asmx/NeedsRefresh?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: function (response) {
                success(response.d);
            }, error: function (jqXhr) { tssFormattedErrorHandler(jqXhr, error); }
        });
    }; var cancelOperation = function (waid, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId };
        $.ajax({
            url: "AjaxService.asmx/CancelOperation?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; var close = function (waid, wavid, success, error) {
        var data = { waid: waid, wavid: wavid }; $.ajax({
            url: "AjaxService.asmx/Close?waid=" + waid + "&wavid=" + wavid, data: JSON.stringify(data), success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; var logout = function (waid, success, error) {
        $.ajax({
            url: "/spotfire/rest/security/logout", method: "GET", dataType: "text", success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; var confirmPrompt = function (waid, serializedPromptModel, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId, serializedPromptModel: serializedPromptModel };
        $.ajax({
            url: "AjaxService.asmx/ConfirmPrompt?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; var promptFunctionCall = function (waid, functionName, serializedArguments, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId, functionName: functionName, args: serializedArguments };
        $.ajax({
            url: "AjaxService.asmx/PromptFunctionCall?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: function (response) {
                success(JSON.parse(response.d));
            }, error: function (jqXhr) { tssFormattedErrorHandler(jqXhr, error); }
        });
    }; var validatePrompt = function (waid, serializedPromptModel, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId, serializedPromptModel: serializedPromptModel };
        $.ajax({
            url: "AjaxService.asmx/ValidatePrompt?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: function (response) {
                success(JSON.parse(response.d));
            }, error: function (jqXhr) { tssFormattedErrorHandler(jqXhr, error); }
        });
    }; var nextWizardPage = function (waid, serializedPromptModel, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId, serializedPromptModel: serializedPromptModel };
        $.ajax({
            url: "AjaxService.asmx/NextWizardPage?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; var previousWizardPage = function (waid, serializedPromptModel, success, error) {
        var data = { waid: waid, wavid: Ajax.DocumentViewId, serializedPromptModel: serializedPromptModel };
        $.ajax({
            url: "AjaxService.asmx/PreviousWizardPage?waid=" + waid + "&wavid=" + Ajax.DocumentViewId, data: JSON.stringify(data), success: success, error: function (jqXhr) {
                tssFormattedErrorHandler(jqXhr, error);
            }
        });
    }; Spotfire.registerNameSpace("Dxp.Web.Forms.AjaxService", { FormatDate: formatDate, ParseDate: parseDate, Read: webViewRead, Modify: webViewModify, Request: request, NeedsRefresh: needsRefresh, CancelOperation: cancelOperation, Close: close, Logout: logout, ConfirmPrompt: confirmPrompt, PromptFunctionCall: promptFunctionCall, ValidatePrompt: validatePrompt, NextWizardPage: nextWizardPage, PreviousWizardPage: previousWizardPage });
    Spotfire.registerNameSpace("WebView", (function () {
        var getAttribute = function (id, attribute) {
            return $("#" + id).closest("[" + attribute + "]").attr(attribute);
        }; return {
            modifyControl: function (id, args, clientGeneration, stickyGuid) {
                var viewId = getAttribute(id, "viewId");
                if (viewId) {
                    var value = JSON.stringify({ id: id, clientGeneration: clientGeneration || 0, args: typeof args !== "string" ? JSON.stringify(args) : args });
                    webViewModify(viewId, "ModifyControl", value, stickyGuid);
                }
            }, readControl: function (id, args, callback, nullCallback) {
                var viewId = getAttribute(id, "viewId");
                if (viewId) {
                    var value = JSON.stringify({ id: id, args: typeof args !== "string" ? JSON.stringify(args) : args }); webViewRead(viewId, "ReadControl", value, callback, nullCallback);
                }
            }
        };
    }()));
}); 
$(function () {
    var error = function (str) {
        if (console !== undefined && console.error !== undefined) {
            console.error(str);
        } else { window.alert(str); }
    }; function WebSocketProxy() {
        var socket = null; var opened = false; var close = function () {
            try {
                if (socket !== null) {
                    socket.close();
                }
            } catch (ignore) { }
        }; var handlers = {}; var registerHandler = function (name, handler) {
            handlers[name] = handler;
        }; var initialize = function (url, onOpen) {
            if (window.WebSocket === undefined) {
                error("Failed to initialize Web Socket communication. Make sure you are running Internet Explorer 10 or later.");
                return;
            } try {
                socket = new WebSocket(url); socket.onopen = function () { opened = true; onOpen(); }; socket.onmessage = function (e) {
                    var msg = e.data;
                    var array = []; var pos = 0; var delimiterIndex, length, i; for (i = 0; i < 3; i++) {
                        delimiterIndex = msg.indexOf(";", pos);
                        length = parseInt(msg.substr(pos, delimiterIndex), 10); pos = delimiterIndex + 1; array.push(msg.substr(pos, length));
                        pos = pos + length + 1;
                    } var handler = handlers[array[0]]; if (typeof handler === "function") {
                        handler(JSON.parse(array[1]), array[2]);
                        return;
                    } error("Unhandled WebSocket message " + msg);
                }; socket.onerror = function () {
                    error("WebSocket ERROR");
                    socket = null;
                }; socket.onclose = function () { error("WebSocket CLOSED"); socket = null; }; $(window).on("unload", close);
            } catch (ex) { error("Failed to initialize Web Socket: " + ex); }
        }; var send = function (data) {
            if (socket === null) {
                return;
            } if (!opened) { var onTimeout = function () { send(data); }; window.setTimeout(onTimeout, 100); return; } socket.send(JSON.stringify(data));
        }; return { initialize: initialize, initialized: function () { return socket !== null && opened; }, send: send, registerHandler: registerHandler, close: close };
    } Spotfire.registerNameSpace("WebSocket", { createProxy: function () { return new WebSocketProxy(); } });
}); 
(function (mod) {
    if (typeof exports == "object" && typeof module == "object") {
        mod(require("../../lib/codemirror"));
    } else {
        if (typeof define == "function" && define.amd) { define(["../../lib/codemirror"], mod); } else {
            mod(CodeMirror);
        }
    }
})
(function (CodeMirror) {
    var DEFAULT_BRACKETS = "()[]{}''\"\""; var DEFAULT_EXPLODE_ON_ENTER = "[]{}"; var SPACE_CHAR_REGEX = /\s/;
    var Pos = CodeMirror.Pos; CodeMirror.defineOption("autoCloseBrackets", false, function (cm, val, old) {
        if (old != CodeMirror.Init && old) {
            cm.removeKeyMap("autoCloseBrackets");
        } if (!val) { return; } var pairs = DEFAULT_BRACKETS, explode = DEFAULT_EXPLODE_ON_ENTER; if (typeof val == "string") {
            pairs = val;
        } else {
            if (typeof val == "object") {
                if (val.pairs != null) { pairs = val.pairs; } if (val.explode != null) {
                    explode = val.explode;
                }
            }
        } var map = buildKeymap(pairs); if (explode) { map.Enter = buildExplodeHandler(explode); } cm.addKeyMap(map);
    });
    function charsAround(cm, pos) {
        var str = cm.getRange(Pos(pos.line, pos.ch - 1), Pos(pos.line, pos.ch + 1)); return str.length == 2 ? str : null;
    } function enteringString(cm, pos, ch) {
        var line = cm.getLine(pos.line); var token = cm.getTokenAt(pos); if (/\bstring2?\b/.test(token.type)) {
            return false;
        } var stream = new CodeMirror.StringStream(line.slice(0, pos.ch) + ch + line.slice(pos.ch), 4); stream.pos = stream.start = token.start;
        for (; ;) {
            var type1 = cm.getMode().token(stream, token.state); if (stream.pos >= pos.ch + 1) {
                return /\bstring2?\b/.test(type1);
            } stream.start = stream.pos;
        }
    } function buildKeymap(pairs) {
        var map = {
            name: "autoCloseBrackets", Backspace: function (cm) {
                if (cm.getOption("disableInput")) {
                    return CodeMirror.Pass;
                } var ranges = cm.listSelections(); for (var i = 0; i < ranges.length; i++) {
                    if (!ranges[i].empty()) {
                        return CodeMirror.Pass;
                    } var around = charsAround(cm, ranges[i].head); if (!around || pairs.indexOf(around) % 2 != 0) {
                        return CodeMirror.Pass;
                    }
                } for (var i = ranges.length - 1; i >= 0; i--) {
                    var cur = ranges[i].head; cm.replaceRange("", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1));
                }
            }
        }; var closingBrackets = ""; for (var i = 0; i < pairs.length; i += 2) {
            (function (left, right) {
                closingBrackets += right;
                map["'" + left + "'"] = function (cm) {
                    if (cm.getOption("disableInput")) { return CodeMirror.Pass; } var ranges = cm.listSelections(), type, next;
                    for (var i = 0; i < ranges.length; i++) {
                        var range = ranges[i], cur = range.head, curType; var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));
                        if (!range.empty()) { curType = "surround"; } else {
                            if (left == right && next == right) {
                                if (cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == left + left + left) {
                                    curType = "skipThree";
                                } else { curType = "skip"; }
                            } else {
                                if (left == right && cur.ch > 1 && cm.getRange(Pos(cur.line, cur.ch - 2), cur) == left + left && (cur.ch <= 2 || cm.getRange(Pos(cur.line, cur.ch - 3), Pos(cur.line, cur.ch - 2)) != left)) {
                                    curType = "addFour";
                                } else {
                                    if (left == '"' || left == "'") {
                                        if (!CodeMirror.isWordChar(next) && enteringString(cm, cur, left)) {
                                            curType = "both";
                                        } else { return CodeMirror.Pass; }
                                    } else {
                                        if (cm.getLine(cur.line).length == cur.ch || closingBrackets.indexOf(next) >= 0 || SPACE_CHAR_REGEX.test(next)) {
                                            curType = "both";
                                        } else { return CodeMirror.Pass; }
                                    }
                                }
                            }
                        } if (!type) { type = curType; } else {
                            if (type != curType) {
                                return CodeMirror.Pass;
                            }
                        }
                    } cm.operation(function () {
                        if (type == "skip") { cm.execCommand("goCharRight"); } else {
                            if (type == "skipThree") {
                                for (var i = 0;
                                i < 3; i++) { cm.execCommand("goCharRight"); }
                            } else {
                                if (type == "surround") {
                                    var sels = cm.getSelections(); for (var i = 0;
                                    i < sels.length; i++) { sels[i] = left + sels[i] + right; } cm.replaceSelections(sels, "around");
                                } else {
                                    if (type == "both") {
                                        cm.replaceSelection(left + right, null);
                                        cm.execCommand("goCharLeft");
                                    } else {
                                        if (type == "addFour") {
                                            cm.replaceSelection(left + left + left + left, "before");
                                            cm.execCommand("goCharRight");
                                        }
                                    }
                                }
                            }
                        }
                    });
                }; if (left != right) {
                    map["'" + right + "'"] = function (cm) {
                        var ranges = cm.listSelections();
                        for (var i = 0; i < ranges.length; i++) {
                            var range = ranges[i]; if (!range.empty() || cm.getRange(range.head, Pos(range.head.line, range.head.ch + 1)) != right) {
                                return CodeMirror.Pass;
                            }
                        } cm.execCommand("goCharRight");
                    };
                }
            })(pairs.charAt(i), pairs.charAt(i + 1));
        } return map;
    } function buildExplodeHandler(pairs) {
        return function (cm) {
            if (cm.getOption("disableInput")) {
                return CodeMirror.Pass;
            } var ranges = cm.listSelections(); for (var i = 0; i < ranges.length; i++) {
                if (!ranges[i].empty()) {
                    return CodeMirror.Pass;
                } var around = charsAround(cm, ranges[i].head); if (!around || pairs.indexOf(around) % 2 != 0) {
                    return CodeMirror.Pass;
                }
            } cm.operation(function () {
                cm.replaceSelection("\n\n", null); cm.execCommand("goCharLeft"); ranges = cm.listSelections();
                for (var i = 0; i < ranges.length; i++) {
                    var line = ranges[i].head.line; cm.indentLine(line, null, true); cm.indentLine(line + 1, null, true);
                }
            });
        };
    }
}); 
!function () {
    function n(n) { return n && (n.ownerDocument || n.document || n).documentElement; } function t(n) {
        return n && (n.ownerDocument && n.ownerDocument.defaultView || n.document && n || n.defaultView);
    } function e(n, t) { return t > n ? -1 : n > t ? 1 : n >= t ? 0 : NaN; } function r(n) { return null === n ? NaN : +n; } function u(n) {
        return !isNaN(n);
    } function i(n) {
        return {
            left: function (t, e, r, u) {
                for (arguments.length < 3 && (r = 0), arguments.length < 4 && (u = t.length) ;
                u > r;) { var i = r + u >>> 1; n(t[i], e) < 0 ? r = i + 1 : u = i; } return r;
            }, right: function (t, e, r, u) {
                for (arguments.length < 3 && (r = 0), arguments.length < 4 && (u = t.length) ;
                u > r;) { var i = r + u >>> 1; n(t[i], e) > 0 ? u = i : r = i + 1; } return r;
            }
        };
    } function a(n) { return n.length; } function o(n) {
        for (var t = 1;
        n * t % 1;) { t *= 10; } return t;
    } function l(n, t) {
        for (var e in t) {
            Object.defineProperty(n.prototype, e, { value: t[e], enumerable: !1 });
        }
    } function c() { this._ = Object.create(null); } function s(n) { return (n += "") === xa || n[0] === ba ? ba + n : n; } function f(n) {
        return (n += "")[0] === ba ? n.slice(1) : n;
    } function h(n) { return s(n) in this._; } function g(n) { return (n = s(n)) in this._ && delete this._[n]; } function p() {
        var n = [];
        for (var t in this._) { n.push(f(t)); } return n;
    } function v() {
        var n = 0; for (var t in this._) { ++n; } return n;
    } function d() { for (var n in this._) { return !1; } return !0; } function m() { this._ = Object.create(null); } function y(n) {
        return n;
    } function M(n, t, e) { return function () { var r = e.apply(t, arguments); return r === t ? n : r; }; } function x(n, t) {
        if (t in n) {
            return t;
        } t = t.charAt(0).toUpperCase() + t.slice(1); for (var e = 0, r = _a.length; r > e; ++e) {
            var u = _a[e] + t; if (u in n) {
                return u;
            }
        }
    } function b() { } function _() { } function w(n) {
        function t() {
            for (var t, r = e, u = -1, i = r.length; ++u < i;) {
                (t = r[u].on) && t.apply(this, arguments);
            } return n;
        } var e = [], r = new c; return t.on = function (t, u) {
            var i, a = r.get(t); return arguments.length < 2 ? a && a.on : (a && (a.on = null, e = e.slice(0, i = e.indexOf(a)).concat(e.slice(i + 1)), r.remove(t)), u && e.push(r.set(t, { on: u })), n);
        }, t;
    } function S() { oa.event.preventDefault(); } function k() {
        for (var n, t = oa.event; n = t.sourceEvent;) {
            t = n;
        } return t;
    } function N(n) {
        for (var t = new _, e = 0, r = arguments.length; ++e < r;) { t[arguments[e]] = w(t); } return t.of = function (e, r) {
            return function (u) {
                try {
                    var i = u.sourceEvent = oa.event;
                    u.target = n, oa.event = u, t[u.type].apply(e, r);
                } finally { oa.event = i; }
            };
        }, t;
    } function E(n) {
        return Sa(n, Aa), n;
    } function A(n) { return "function" == typeof n ? n : function () { return ka(n, this); }; } function C(n) {
        return "function" == typeof n ? n : function () {
            return Na(n, this);
        };
    } function z(n, t) {
        function e() { this.removeAttribute(n); } function r() {
            this.removeAttributeNS(n.space, n.local);
        } function u() { this.setAttribute(n, t); } function i() { this.setAttributeNS(n.space, n.local, t); } function a() {
            var e = t.apply(this, arguments);
            null == e ? this.removeAttribute(n) : this.setAttribute(n, e);
        } function o() {
            var e = t.apply(this, arguments); null == e ? this.removeAttributeNS(n.space, n.local) : this.setAttributeNS(n.space, n.local, e);
        } return n = oa.ns.qualify(n), null == t ? n.local ? r : e : "function" == typeof t ? n.local ? o : a : n.local ? i : u;
    } function L(n) {
        return n.trim().replace(/\s+/g, " ");
    } function q(n) { return new RegExp("(?:^|\\s+)" + oa.requote(n) + "(?:\\s+|$)", "g"); } function T(n) {
        return (n + "").trim().split(/^|\s+/);
    } function R(n, t) {
        function e() { for (var e = -1; ++e < u;) { n[e](this, t); } } function r() {
            for (var e = -1, r = t.apply(this, arguments) ;
            ++e < u;) { n[e](this, r); }
        } n = T(n).map(D); var u = n.length; return "function" == typeof t ? r : e;
    } function D(n) {
        var t = q(n);
        return function (e, r) {
            if (u = e.classList) { return r ? u.add(n) : u.remove(n); } var u = e.getAttribute("class") || "";
            r ? (t.lastIndex = 0, t.test(u) || e.setAttribute("class", L(u + " " + n))) : e.setAttribute("class", L(u.replace(t, " ")));
        };
    } function P(n, t, e) {
        function r() { this.style.removeProperty(n); } function u() {
            this.style.setProperty(n, t, e);
        } function i() {
            var r = t.apply(this, arguments); null == r ? this.style.removeProperty(n) : this.style.setProperty(n, r, e);
        } return null == t ? r : "function" == typeof t ? i : u;
    } function j(n, t) {
        function e() { delete this[n]; } function r() {
            this[n] = t;
        } function u() { var e = t.apply(this, arguments); null == e ? delete this[n] : this[n] = e; } return null == t ? e : "function" == typeof t ? u : r;
    } function U(n) {
        function t() {
            var t = this.ownerDocument, e = this.namespaceURI; return e ? t.createElementNS(e, n) : t.createElement(n);
        } function e() { return this.ownerDocument.createElementNS(n.space, n.local); } return "function" == typeof n ? n : (n = oa.ns.qualify(n)).local ? e : t;
    } function F() { var n = this.parentNode; n && n.removeChild(this); } function H(n) { return { __data__: n }; } function O(n) {
        return function () {
            return Ea(this, n);
        };
    } function I(n) {
        return arguments.length || (n = e), function (t, e) {
            return t && e ? n(t.__data__, e.__data__) : !t - !e;
        };
    } function Y(n, t) {
        for (var e = 0, r = n.length; r > e; e++) {
            for (var u, i = n[e], a = 0, o = i.length; o > a; a++) {
                (u = i[a]) && t(u, a, e);
            }
        } return n;
    } function Z(n) { return Sa(n, za), n; } function V(n) {
        var t, e; return function (r, u, i) {
            var a, o = n[i].update, l = o.length;
            for (i != e && (e = i, t = 0), u >= t && (t = u + 1) ; !(a = o[t]) && ++t < l;) { } return a;
        };
    } function X(n, t, e) {
        function r() {
            var t = this[a];
            t && (this.removeEventListener(n, t, t.$), delete this[a]);
        } function u() {
            var u = l(t, ca(arguments)); r.call(this), this.addEventListener(n, this[a] = u, u.$ = e), u._ = t;
        } function i() {
            var t, e = new RegExp("^__on([^.]+)" + oa.requote(n) + "$"); for (var r in this) {
                if (t = r.match(e)) {
                    var u = this[r];
                    this.removeEventListener(t[1], u, u.$), delete this[r];
                }
            }
        } var a = "__on" + n, o = n.indexOf("."), l = $; o > 0 && (n = n.slice(0, o));
        var c = La.get(n); return c && (n = c, l = B), o ? t ? u : r : t ? b : i;
    } function $(n, t) {
        return function (e) {
            var r = oa.event;
            oa.event = e, t[0] = this.__data__; try { n.apply(this, t); } finally { oa.event = r; }
        };
    } function B(n, t) {
        var e = $(n, t);
        return function (n) {
            var t = this, r = n.relatedTarget; r && (r === t || 8 & r.compareDocumentPosition(t)) || e.call(t, n);
        };
    } function W(e) {
        var r = ".dragsuppress-" + ++Ta, u = "click" + r, i = oa.select(t(e)).on("touchmove" + r, S).on("dragstart" + r, S).on("selectstart" + r, S);
        if (null == qa && (qa = "onselectstart" in e ? !1 : x(e.style, "userSelect")), qa) {
            var a = n(e).style, o = a[qa]; a[qa] = "none";
        } return function (n) {
            if (i.on(r, null), qa && (a[qa] = o), n) {
                var t = function () { i.on(u, null); }; i.on(u, function () {
                    S(), t();
                }, !0), setTimeout(t, 0);
            }
        };
    } function J(n, e) {
        e.changedTouches && (e = e.changedTouches[0]); var r = n.ownerSVGElement || n;
        if (r.createSVGPoint) {
            var u = r.createSVGPoint(); if (0 > Ra) {
                var i = t(n); if (i.scrollX || i.scrollY) {
                    r = oa.select("body").append("svg").style({ position: "absolute", top: 0, left: 0, margin: 0, padding: 0, border: "none" }, "important");
                    var a = r[0][0].getScreenCTM(); Ra = !(a.f || a.e), r.remove();
                }
            } return Ra ? (u.x = e.pageX, u.y = e.pageY) : (u.x = e.clientX, u.y = e.clientY), u = u.matrixTransform(n.getScreenCTM().inverse()), [u.x, u.y];
        } var o = n.getBoundingClientRect(); return [e.clientX - o.left - n.clientLeft, e.clientY - o.top - n.clientTop];
    } function G() {
        return oa.event.changedTouches[0].identifier;
    } function K(n) { return n > 0 ? 1 : 0 > n ? -1 : 0; } function Q(n, t, e) {
        return (t[0] - n[0]) * (e[1] - n[1]) - (t[1] - n[1]) * (e[0] - n[0]);
    } function nn(n) { return n > 1 ? 0 : -1 > n ? ja : Math.acos(n); } function tn(n) {
        return n > 1 ? Ha : -1 > n ? -Ha : Math.asin(n);
    } function en(n) { return ((n = Math.exp(n)) - 1 / n) / 2; } function rn(n) { return ((n = Math.exp(n)) + 1 / n) / 2; } function un(n) {
        return ((n = Math.exp(2 * n)) - 1) / (n + 1);
    } function an(n) { return (n = Math.sin(n / 2)) * n; } function on() { } function ln(n, t, e) {
        return this instanceof ln ? (this.h = +n, this.s = +t, void (this.l = +e)) : arguments.length < 2 ? n instanceof ln ? new ln(n.h, n.s, n.l) : _n("" + n, wn, ln) : new ln(n, t, e);
    } function cn(n, t, e) {
        function r(n) {
            return n > 360 ? n -= 360 : 0 > n && (n += 360), 60 > n ? i + (a - i) * n / 60 : 180 > n ? a : 240 > n ? i + (a - i) * (240 - n) / 60 : i;
        } function u(n) { return Math.round(255 * r(n)); } var i, a; return n = isNaN(n) ? 0 : (n %= 360) < 0 ? n + 360 : n, t = isNaN(t) ? 0 : 0 > t ? 0 : t > 1 ? 1 : t, e = 0 > e ? 0 : e > 1 ? 1 : e, a = 0.5 >= e ? e * (1 + t) : e + t - e * t, i = 2 * e - a, new yn(u(n + 120), u(n), u(n - 120));
    } function sn(n, t, e) {
        return this instanceof sn ? (this.h = +n, this.c = +t, void (this.l = +e)) : arguments.length < 2 ? n instanceof sn ? new sn(n.h, n.c, n.l) : n instanceof hn ? pn(n.l, n.a, n.b) : pn((n = Sn((n = oa.rgb(n)).r, n.g, n.b)).l, n.a, n.b) : new sn(n, t, e);
    } function fn(n, t, e) {
        return isNaN(n) && (n = 0), isNaN(t) && (t = 0), new hn(e, Math.cos(n *= Oa) * t, Math.sin(n) * t);
    } function hn(n, t, e) {
        return this instanceof hn ? (this.l = +n, this.a = +t, void (this.b = +e)) : arguments.length < 2 ? n instanceof hn ? new hn(n.l, n.a, n.b) : n instanceof sn ? fn(n.h, n.c, n.l) : Sn((n = yn(n)).r, n.g, n.b) : new hn(n, t, e);
    } function gn(n, t, e) {
        var r = (n + 16) / 116, u = r + t / 500, i = r - e / 200; return u = vn(u) * Ka, r = vn(r) * Qa, i = vn(i) * no, new yn(mn(3.2404542 * u - 1.5371385 * r - 0.4985314 * i), mn(-0.969266 * u + 1.8760108 * r + 0.041556 * i), mn(0.0556434 * u - 0.2040259 * r + 1.0572252 * i));
    } function pn(n, t, e) { return n > 0 ? new sn(Math.atan2(e, t) * Ia, Math.sqrt(t * t + e * e), n) : new sn(NaN, NaN, n); } function vn(n) {
        return n > 0.206893034 ? n * n * n : (n - 4 / 29) / 7.787037;
    } function dn(n) { return n > 0.008856 ? Math.pow(n, 1 / 3) : 7.787037 * n + 4 / 29; } function mn(n) {
        return Math.round(255 * (0.00304 >= n ? 12.92 * n : 1.055 * Math.pow(n, 1 / 2.4) - 0.055));
    } function yn(n, t, e) {
        return this instanceof yn ? (this.r = ~~n, this.g = ~~t, void (this.b = ~~e)) : arguments.length < 2 ? n instanceof yn ? new yn(n.r, n.g, n.b) : _n("" + n, yn, cn) : new yn(n, t, e);
    } function Mn(n) { return new yn(n >> 16, n >> 8 & 255, 255 & n); } function xn(n) { return Mn(n) + ""; } function bn(n) {
        return 16 > n ? "0" + Math.max(0, n).toString(16) : Math.min(255, n).toString(16);
    } function _n(n, t, e) {
        var r, u, i, a = 0, o = 0, l = 0; if (r = /([a-z]+)\((.*)\)/.exec(n = n.toLowerCase())) {
            switch (u = r[2].split(","), r[1]) {
                case "hsl": return e(parseFloat(u[0]), parseFloat(u[1]) / 100, parseFloat(u[2]) / 100);
                case "rgb": return t(Nn(u[0]), Nn(u[1]), Nn(u[2]));
            }
        } return (i = ro.get(n)) ? t(i.r, i.g, i.b) : (null == n || "#" !== n.charAt(0) || isNaN(i = parseInt(n.slice(1), 16)) || (4 === n.length ? (a = (3840 & i) >> 4, a = a >> 4 | a, o = 240 & i, o = o >> 4 | o, l = 15 & i, l = l << 4 | l) : 7 === n.length && (a = (16711680 & i) >> 16, o = (65280 & i) >> 8, l = 255 & i)), t(a, o, l));
    } function wn(n, t, e) {
        var r, u, i = Math.min(n /= 255, t /= 255, e /= 255), a = Math.max(n, t, e), o = a - i, l = (a + i) / 2; return o ? (u = 0.5 > l ? o / (a + i) : o / (2 - a - i), r = n == a ? (t - e) / o + (e > t ? 6 : 0) : t == a ? (e - n) / o + 2 : (n - t) / o + 4, r *= 60) : (r = NaN, u = l > 0 && 1 > l ? 0 : r), new ln(r, u, l);
    } function Sn(n, t, e) {
        n = kn(n), t = kn(t), e = kn(e); var r = dn((0.4124564 * n + 0.3575761 * t + 0.1804375 * e) / Ka), u = dn((0.2126729 * n + 0.7151522 * t + 0.072175 * e) / Qa), i = dn((0.0193339 * n + 0.119192 * t + 0.9503041 * e) / no);
        return hn(116 * u - 16, 500 * (r - u), 200 * (u - i));
    } function kn(n) {
        return (n /= 255) <= 0.04045 ? n / 12.92 : Math.pow((n + 0.055) / 1.055, 2.4);
    } function Nn(n) { var t = parseFloat(n); return "%" === n.charAt(n.length - 1) ? Math.round(2.55 * t) : t; } function En(n) {
        return "function" == typeof n ? n : function () {
            return n;
        };
    } function An(n) {
        return function (t, e, r) {
            return 2 === arguments.length && "function" == typeof e && (r = e, e = null), Cn(t, e, n, r);
        };
    } function Cn(n, t, e, r) {
        function u() {
            var n, t = l.status; if (!t && Ln(l) || t >= 200 && 300 > t || 304 === t) {
                try {
                    n = e.call(i, l);
                } catch (r) { return void a.error.call(i, r); } a.load.call(i, n);
            } else { a.error.call(i, l); }
        } var i = {}, a = oa.dispatch("beforesend", "progress", "load", "error"), o = {}, l = new XMLHttpRequest, c = null;
        return !this.XDomainRequest || "withCredentials" in l || !/^(http(s)?:)?\/\//.test(n) || (l = new XDomainRequest), "onload" in l ? l.onload = l.onerror = u : l.onreadystatechange = function () {
            l.readyState > 3 && u();
        }, l.onprogress = function (n) { var t = oa.event; oa.event = n; try { a.progress.call(i, l); } finally { oa.event = t; } }, i.header = function (n, t) {
            return n = (n + "").toLowerCase(), arguments.length < 2 ? o[n] : (null == t ? delete o[n] : o[n] = t + "", i);
        }, i.mimeType = function (n) { return arguments.length ? (t = null == n ? null : n + "", i) : t; }, i.responseType = function (n) {
            return arguments.length ? (c = n, i) : c;
        }, i.response = function (n) { return e = n, i; }, ["get", "post"].forEach(function (n) {
            i[n] = function () {
                return i.send.apply(i, [n].concat(ca(arguments)));
            };
        }), i.send = function (e, r, u) {
            if (2 === arguments.length && "function" == typeof r && (u = r, r = null), l.open(e, n, !0), null == t || "accept" in o || (o.accept = t + ",*/*"), l.setRequestHeader) {
                for (var s in o) {
                    l.setRequestHeader(s, o[s]);
                }
            } return null != t && l.overrideMimeType && l.overrideMimeType(t), null != c && (l.responseType = c), null != u && i.on("error", u).on("load", function (n) {
                u(null, n);
            }), a.beforesend.call(i, l), l.send(null == r ? null : r), i;
        }, i.abort = function () { return l.abort(), i; }, oa.rebind(i, a, "on"), null == r ? i : i.get(zn(r));
    } function zn(n) { return 1 === n.length ? function (t, e) { n(null == t ? e : null); } : n; } function Ln(n) {
        var t = n.responseType;
        return t && "text" !== t ? n.response : n.responseText;
    } function qn(n, t, e) {
        var r = arguments.length; 2 > r && (t = 0), 3 > r && (e = Date.now());
        var u = e + t, i = { c: n, t: u, n: null }; return io ? io.n = i : uo = i, io = i, ao || (oo = clearTimeout(oo), ao = 1, lo(Tn)), i;
    } function Tn() {
        var n = Rn(), t = Dn() - n;
        t > 24 ? (isFinite(t) && (clearTimeout(oo), oo = setTimeout(Tn, t)), ao = 0) : (ao = 1, lo(Tn));
    } function Rn() {
        for (var n = Date.now(), t = uo;
        t;) { n >= t.t && t.c(n - t.t) && (t.c = null), t = t.n; } return n;
    } function Dn() {
        for (var n, t = uo, e = 1 / 0; t;) {
            t.c ? (t.t < e && (e = t.t), t = (n = t).n) : t = n ? n.n = t.n : uo = t.n;
        } return io = n, e;
    } function Pn(n, t) { return t - (n ? Math.ceil(Math.log(n) / Math.LN10) : 1); } function jn(n, t) {
        var e = Math.pow(10, 3 * Ma(8 - t));
        return { scale: t > 8 ? function (n) { return n / e; } : function (n) { return n * e; }, symbol: n };
    } function Un(n) {
        var t = n.decimal, e = n.thousands, r = n.grouping, u = n.currency, i = r && e ? function (n, t) {
            for (var u = n.length, i = [], a = 0, o = r[0], l = 0;
            u > 0 && o > 0 && (l + o + 1 > t && (o = Math.max(1, t - l)), i.push(n.substring(u -= o, u + o)), !((l += o + 1) > t)) ;) {
                o = r[a = (a + 1) % r.length];
            } return i.reverse().join(e);
        } : y; return function (n) {
            var e = so.exec(n), r = e[1] || " ", a = e[2] || ">", o = e[3] || "-", l = e[4] || "", c = e[5], s = +e[6], f = e[7], h = e[8], g = e[9], p = 1, v = "", d = "", m = !1, y = !0;
            switch (h && (h = +h.substring(1)), (c || "0" === r && "=" === a) && (c = r = "0", a = "="), g) {
                case "n": f = !0, g = "g"; break; case "%": p = 100, d = "%", g = "f";
                    break; case "p": p = 100, d = "%", g = "r"; break; case "b": case "o": case "x": case "X": "#" === l && (v = "0" + g.toLowerCase());
                case "c": y = !1; case "d": m = !0, h = 0; break; case "s": p = -1, g = "r";
            } "$" === l && (v = u[0], d = u[1]), "r" != g || h || (g = "g"), null != h && ("g" == g ? h = Math.max(1, Math.min(21, h)) : ("e" == g || "f" == g) && (h = Math.max(0, Math.min(20, h)))), g = fo.get(g) || Fn;
            var M = c && f; return function (n) {
                var e = d; if (m && n % 1) { return ""; } var u = 0 > n || 0 === n && 0 > 1 / n ? (n = -n, "-") : "-" === o ? "" : o;
                if (0 > p) { var l = oa.formatPrefix(n, h); n = l.scale(n), e = l.symbol + d; } else { n *= p; } n = g(n, h); var x, b, _ = n.lastIndexOf(".");
                if (0 > _) { var w = y ? n.lastIndexOf("e") : -1; 0 > w ? (x = n, b = "") : (x = n.substring(0, w), b = n.substring(w)); } else {
                    x = n.substring(0, _), b = t + n.substring(_ + 1);
                } !c && f && (x = i(x, 1 / 0)); var S = v.length + x.length + b.length + (M ? 0 : u.length), k = s > S ? new Array(S = s - S + 1).join(r) : "";
                return M && (x = i(k + x, k.length ? s - b.length : 1 / 0)), u += v, n = x + b, ("<" === a ? u + n + k : ">" === a ? k + u + n : "^" === a ? k.substring(0, S >>= 1) + u + n + k.substring(S) : u + (M ? n : k + n)) + e;
            };
        };
    } function Fn(n) { return n + ""; } function Hn() {
        this._ = new Date(arguments.length > 1 ? Date.UTC.apply(this, arguments) : arguments[0]);
    } function On(n, t, e) {
        function r(t) { var e = n(t), r = i(e, 1); return r - t > t - e ? e : r; } function u(e) {
            return t(e = n(new go(e - 1)), 1), e;
        } function i(n, e) { return t(n = new go(+n), e), n; } function a(n, r, i) {
            var a = u(n), o = []; if (i > 1) {
                for (; r > a;) {
                    e(a) % i || o.push(new Date(+a)), t(a, 1);
                }
            } else { for (; r > a;) { o.push(new Date(+a)), t(a, 1); } } return o;
        } function o(n, t, e) {
            try {
                go = Hn; var r = new Hn; return r._ = n, a(r, t, e);
            } finally { go = Date; }
        } n.floor = n, n.round = r, n.ceil = u, n.offset = i, n.range = a; var l = n.utc = In(n); return l.floor = l, l.round = In(r), l.ceil = In(u), l.offset = In(i), l.range = o, n;
    } function In(n) {
        return function (t, e) { try { go = Hn; var r = new Hn; return r._ = t, n(r, e)._; } finally { go = Date; } };
    } function Yn(n) {
        function t(n) {
            function t(t) {
                for (var e, u, i, a = [], o = -1, l = 0; ++o < r;) {
                    37 === n.charCodeAt(o) && (a.push(n.slice(l, o)), null != (u = vo[e = n.charAt(++o)]) && (e = n.charAt(++o)), (i = A[e]) && (e = i(t, null == u ? "e" === e ? " " : "0" : u)), a.push(e), l = o + 1);
                } return a.push(n.slice(l, o)), a.join("");
            } var r = n.length; return t.parse = function (t) {
                var r = { y: 1900, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0, Z: null }, u = e(r, n, t, 0);
                if (u != t.length) { return null; } "p" in r && (r.H = r.H % 12 + 12 * r.p); var i = null != r.Z && go !== Hn, a = new (i ? Hn : go); return "j" in r ? a.setFullYear(r.y, 0, r.j) : "W" in r || "U" in r ? ("w" in r || (r.w = "W" in r ? 1 : 0), a.setFullYear(r.y, 0, 1), a.setFullYear(r.y, 0, "W" in r ? (r.w + 6) % 7 + 7 * r.W - (a.getDay() + 5) % 7 : r.w + 7 * r.U - (a.getDay() + 6) % 7)) : a.setFullYear(r.y, r.m, r.d), a.setHours(r.H + (r.Z / 100 | 0), r.M + r.Z % 100, r.S, r.L), i ? a._ : a;
            }, t.toString = function () { return n; }, t;
        } function e(n, t, e, r) {
            for (var u, i, a, o = 0, l = t.length, c = e.length; l > o;
            ) {
                if (r >= c) { return -1; } if (u = t.charCodeAt(o++), 37 === u) {
                    if (a = t.charAt(o++), i = C[a in vo ? t.charAt(o++) : a], !i || (r = i(n, e, r)) < 0) {
                        return -1;
                    }
                } else { if (u != e.charCodeAt(r++)) { return -1; } }
            } return r;
        } function r(n, t, e) {
            _.lastIndex = 0; var r = _.exec(t.slice(e));
            return r ? (n.w = w.get(r[0].toLowerCase()), e + r[0].length) : -1;
        } function u(n, t, e) {
            x.lastIndex = 0; var r = x.exec(t.slice(e));
            return r ? (n.w = b.get(r[0].toLowerCase()), e + r[0].length) : -1;
        } function i(n, t, e) {
            N.lastIndex = 0; var r = N.exec(t.slice(e));
            return r ? (n.m = E.get(r[0].toLowerCase()), e + r[0].length) : -1;
        } function a(n, t, e) {
            S.lastIndex = 0; var r = S.exec(t.slice(e));
            return r ? (n.m = k.get(r[0].toLowerCase()), e + r[0].length) : -1;
        } function o(n, t, r) {
            return e(n, A.c.toString(), t, r);
        } function l(n, t, r) { return e(n, A.x.toString(), t, r); } function c(n, t, r) { return e(n, A.X.toString(), t, r); } function s(n, t, e) {
            var r = M.get(t.slice(e, e += 2).toLowerCase());
            return null == r ? -1 : (n.p = r, e);
        } var f = n.dateTime, h = n.date, g = n.time, p = n.periods, v = n.days, d = n.shortDays, m = n.months, y = n.shortMonths;
        t.utc = function (n) {
            function e(n) { try { go = Hn; var t = new go; return t._ = n, r(t); } finally { go = Date; } } var r = t(n);
            return e.parse = function (n) { try { go = Hn; var t = r.parse(n); return t && t._; } finally { go = Date; } }, e.toString = r.toString, e;
        }, t.multi = t.utc.multi = ct; var M = oa.map(), x = Vn(v), b = Xn(v), _ = Vn(d), w = Xn(d), S = Vn(m), k = Xn(m), N = Vn(y), E = Xn(y);
        p.forEach(function (n, t) { M.set(n.toLowerCase(), t); }); var A = {
            a: function (n) { return d[n.getDay()]; }, A: function (n) {
                return v[n.getDay()];
            }, b: function (n) { return y[n.getMonth()]; }, B: function (n) { return m[n.getMonth()]; }, c: t(f), d: function (n, t) {
                return Zn(n.getDate(), t, 2);
            }, e: function (n, t) { return Zn(n.getDate(), t, 2); }, H: function (n, t) { return Zn(n.getHours(), t, 2); }, I: function (n, t) {
                return Zn(n.getHours() % 12 || 12, t, 2);
            }, j: function (n, t) { return Zn(1 + ho.dayOfYear(n), t, 3); }, L: function (n, t) {
                return Zn(n.getMilliseconds(), t, 3);
            }, m: function (n, t) { return Zn(n.getMonth() + 1, t, 2); }, M: function (n, t) { return Zn(n.getMinutes(), t, 2); }, p: function (n) {
                return p[+(n.getHours() >= 12)];
            }, S: function (n, t) { return Zn(n.getSeconds(), t, 2); }, U: function (n, t) { return Zn(ho.sundayOfYear(n), t, 2); }, w: function (n) {
                return n.getDay();
            }, W: function (n, t) { return Zn(ho.mondayOfYear(n), t, 2); }, x: t(h), X: t(g), y: function (n, t) {
                return Zn(n.getFullYear() % 100, t, 2);
            }, Y: function (n, t) { return Zn(n.getFullYear() % 10000, t, 4); }, Z: ot, "%": function () { return "%"; }
        }, C = { a: r, A: u, b: i, B: a, c: o, d: tt, e: tt, H: rt, I: rt, j: et, L: at, m: nt, M: ut, p: s, S: it, U: Bn, w: $n, W: Wn, x: l, X: c, y: Gn, Y: Jn, Z: Kn, "%": lt };
        return t;
    } function Zn(n, t, e) {
        var r = 0 > n ? "-" : "", u = (r ? -n : n) + "", i = u.length; return r + (e > i ? new Array(e - i + 1).join(t) + u : u);
    } function Vn(n) { return new RegExp("^(?:" + n.map(oa.requote).join("|") + ")", "i"); } function Xn(n) {
        for (var t = new c, e = -1, r = n.length;
        ++e < r;) { t.set(n[e].toLowerCase(), e); } return t;
    } function $n(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 1));
        return r ? (n.w = +r[0], e + r[0].length) : -1;
    } function Bn(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e)); return r ? (n.U = +r[0], e + r[0].length) : -1;
    } function Wn(n, t, e) { mo.lastIndex = 0; var r = mo.exec(t.slice(e)); return r ? (n.W = +r[0], e + r[0].length) : -1; } function Jn(n, t, e) {
        mo.lastIndex = 0;
        var r = mo.exec(t.slice(e, e + 4)); return r ? (n.y = +r[0], e + r[0].length) : -1;
    } function Gn(n, t, e) {
        mo.lastIndex = 0;
        var r = mo.exec(t.slice(e, e + 2)); return r ? (n.y = Qn(+r[0]), e + r[0].length) : -1;
    } function Kn(n, t, e) {
        return /^[+-]\d{4}$/.test(t = t.slice(e, e + 5)) ? (n.Z = -t, e + 5) : -1;
    } function Qn(n) { return n + (n > 68 ? 1900 : 2000); } function nt(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 2));
        return r ? (n.m = r[0] - 1, e + r[0].length) : -1;
    } function tt(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 2));
        return r ? (n.d = +r[0], e + r[0].length) : -1;
    } function et(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 3));
        return r ? (n.j = +r[0], e + r[0].length) : -1;
    } function rt(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 2));
        return r ? (n.H = +r[0], e + r[0].length) : -1;
    } function ut(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 2));
        return r ? (n.M = +r[0], e + r[0].length) : -1;
    } function it(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 2));
        return r ? (n.S = +r[0], e + r[0].length) : -1;
    } function at(n, t, e) {
        mo.lastIndex = 0; var r = mo.exec(t.slice(e, e + 3));
        return r ? (n.L = +r[0], e + r[0].length) : -1;
    } function ot(n) {
        var t = n.getTimezoneOffset(), e = t > 0 ? "-" : "+", r = Ma(t) / 60 | 0, u = Ma(t) % 60;
        return e + Zn(r, "0", 2) + Zn(u, "0", 2);
    } function lt(n, t, e) {
        yo.lastIndex = 0; var r = yo.exec(t.slice(e, e + 1)); return r ? e + r[0].length : -1;
    } function ct(n) {
        for (var t = n.length, e = -1; ++e < t;) { n[e][0] = this(n[e][0]); } return function (t) {
            for (var e = 0, r = n[e];
            !r[1](t) ;) { r = n[++e]; } return r[0](t);
        };
    } function st() { } function ft(n, t, e) {
        var r = e.s = n + t, u = r - n, i = r - u; e.t = n - i + (t - u);
    } function ht(n, t) { n && _o.hasOwnProperty(n.type) && _o[n.type](n, t); } function gt(n, t, e) {
        var r, u = -1, i = n.length - e;
        for (t.lineStart() ; ++u < i;) { r = n[u], t.point(r[0], r[1], r[2]); } t.lineEnd();
    } function pt(n, t) {
        var e = -1, r = n.length;
        for (t.polygonStart() ; ++e < r;) { gt(n[e], t, 1); } t.polygonEnd();
    } function vt() {
        function n(n, t) {
            n *= Oa, t = t * Oa / 2 + ja / 4;
            var e = n - r, a = e >= 0 ? 1 : -1, o = a * e, l = Math.cos(t), c = Math.sin(t), s = i * c, f = u * l + s * Math.cos(o), h = s * a * Math.sin(o); So.add(Math.atan2(h, f)), r = n, u = l, i = c;
        } var t, e, r, u, i; ko.point = function (a, o) {
            ko.point = n, r = (t = a) * Oa, u = Math.cos(o = (e = o) * Oa / 2 + ja / 4), i = Math.sin(o);
        }, ko.lineEnd = function () { n(t, e); };
    } function dt(n) {
        var t = n[0], e = n[1], r = Math.cos(e); return [r * Math.cos(t), r * Math.sin(t), Math.sin(e)];
    } function mt(n, t) { return n[0] * t[0] + n[1] * t[1] + n[2] * t[2]; } function yt(n, t) {
        return [n[1] * t[2] - n[2] * t[1], n[2] * t[0] - n[0] * t[2], n[0] * t[1] - n[1] * t[0]];
    } function Mt(n, t) { n[0] += t[0], n[1] += t[1], n[2] += t[2]; } function xt(n, t) { return [n[0] * t, n[1] * t, n[2] * t]; } function bt(n) {
        var t = Math.sqrt(n[0] * n[0] + n[1] * n[1] + n[2] * n[2]);
        n[0] /= t, n[1] /= t, n[2] /= t;
    } function _t(n) { return [Math.atan2(n[1], n[0]), tn(n[2])]; } function wt(n, t) {
        return Ma(n[0] - t[0]) < Da && Ma(n[1] - t[1]) < Da;
    } function St(n, t) { n *= Oa; var e = Math.cos(t *= Oa); kt(e * Math.cos(n), e * Math.sin(n), Math.sin(t)); } function kt(n, t, e) {
        ++No, Ao += (n - Ao) / No, Co += (t - Co) / No, zo += (e - zo) / No;
    } function Nt() {
        function n(n, u) {
            n *= Oa; var i = Math.cos(u *= Oa), a = i * Math.cos(n), o = i * Math.sin(n), l = Math.sin(u), c = Math.atan2(Math.sqrt((c = e * l - r * o) * c + (c = r * a - t * l) * c + (c = t * o - e * a) * c), t * a + e * o + r * l);
            Eo += c, Lo += c * (t + (t = a)), qo += c * (e + (e = o)), To += c * (r + (r = l)), kt(t, e, r);
        } var t, e, r; jo.point = function (u, i) {
            u *= Oa;
            var a = Math.cos(i *= Oa); t = a * Math.cos(u), e = a * Math.sin(u), r = Math.sin(i), jo.point = n, kt(t, e, r);
        };
    } function Et() {
        jo.point = St;
    } function At() {
        function n(n, t) {
            n *= Oa; var e = Math.cos(t *= Oa), a = e * Math.cos(n), o = e * Math.sin(n), l = Math.sin(t), c = u * l - i * o, s = i * a - r * l, f = r * o - u * a, h = Math.sqrt(c * c + s * s + f * f), g = r * a + u * o + i * l, p = h && -nn(g) / h, v = Math.atan2(h, g);
            Ro += p * c, Do += p * s, Po += p * f, Eo += v, Lo += v * (r + (r = a)), qo += v * (u + (u = o)), To += v * (i + (i = l)), kt(r, u, i);
        } var t, e, r, u, i;
        jo.point = function (a, o) {
            t = a, e = o, jo.point = n, a *= Oa; var l = Math.cos(o *= Oa); r = l * Math.cos(a), u = l * Math.sin(a), i = Math.sin(o), kt(r, u, i);
        }, jo.lineEnd = function () { n(t, e), jo.lineEnd = Et, jo.point = St; };
    } function Ct(n, t) {
        function e(e, r) {
            return e = n(e, r), t(e[0], e[1]);
        } return n.invert && t.invert && (e.invert = function (e, r) { return e = t.invert(e, r), e && n.invert(e[0], e[1]); }), e;
    } function zt() { return !0; } function Lt(n, t, e, r, u) {
        var i = [], a = []; if (n.forEach(function (n) {
        if (!((t = n.length - 1) <= 0)) {
        var t, e = n[0], r = n[t];
        if (wt(e, r)) { u.lineStart(); for (var o = 0; t > o; ++o) { u.point((e = n[o])[0], e[1]); } return void u.lineEnd(); } var l = new Tt(e, n, null, !0), c = new Tt(e, null, l, !1);
        l.o = c, i.push(l), a.push(c), l = new Tt(r, n, null, !1), c = new Tt(r, null, l, !0), l.o = c, i.push(l), a.push(c);
        }
        }), a.sort(t), qt(i), qt(a), i.length) {
            for (var o = 0, l = e, c = a.length;
            c > o; ++o) { a[o].e = l = !l; } for (var s, f, h = i[0]; ;) {
                for (var g = h, p = !0; g.v;) { if ((g = g.n) === h) { return; } } s = g.z, u.lineStart();
                do {
                    if (g.v = g.o.v = !0, g.e) {
                        if (p) { for (var o = 0, c = s.length; c > o; ++o) { u.point((f = s[o])[0], f[1]); } } else {
                            r(g.x, g.n.x, 1, u);
                        } g = g.n;
                    } else {
                        if (p) { s = g.p.z; for (var o = s.length - 1; o >= 0; --o) { u.point((f = s[o])[0], f[1]); } } else {
                            r(g.x, g.p.x, -1, u);
                        } g = g.p;
                    } g = g.o, s = g.z, p = !p;
                } while (!g.v); u.lineEnd();
            }
        }
    } function qt(n) {
        if (t = n.length) {
            for (var t, e, r = 0, u = n[0];
            ++r < t;) { u.n = e = n[r], e.p = u, u = e; } u.n = e = n[0], e.p = u;
        }
    } function Tt(n, t, e, r) {
        this.x = n, this.z = t, this.o = e, this.e = r, this.v = !1, this.n = this.p = null;
    } function Rt(n, t, e, r) {
        return function (u, i) {
            function a(t, e) {
                var r = u(t, e); n(t = r[0], e = r[1]) && i.point(t, e);
            } function o(n, t) { var e = u(n, t); d.point(e[0], e[1]); } function l() { y.point = o, d.lineStart(); } function c() {
                y.point = a, d.lineEnd();
            } function s(n, t) { v.push([n, t]); var e = u(n, t); x.point(e[0], e[1]); } function f() { x.lineStart(), v = []; } function h() {
                s(v[0][0], v[0][1]), x.lineEnd();
                var n, t = x.clean(), e = M.buffer(), r = e.length; if (v.pop(), p.push(v), v = null, r) {
                    if (1 & t) {
                        n = e[0]; var u, r = n.length - 1, a = -1;
                        if (r > 0) { for (b || (i.polygonStart(), b = !0), i.lineStart() ; ++a < r;) { i.point((u = n[a])[0], u[1]); } i.lineEnd(); }
                    } else {
                        r > 1 && 2 & t && e.push(e.pop().concat(e.shift())), g.push(e.filter(Dt));
                    }
                }
            } var g, p, v, d = t(i), m = u.invert(r[0], r[1]), y = {
                point: a, lineStart: l, lineEnd: c, polygonStart: function () {
                    y.point = s, y.lineStart = f, y.lineEnd = h, g = [], p = [];
                }, polygonEnd: function () {
                    y.point = a, y.lineStart = l, y.lineEnd = c, g = oa.merge(g); var n = Ot(m, p); g.length ? (b || (i.polygonStart(), b = !0), Lt(g, jt, n, e, i)) : n && (b || (i.polygonStart(), b = !0), i.lineStart(), e(null, null, 1, i), i.lineEnd()), b && (i.polygonEnd(), b = !1), g = p = null;
                }, sphere: function () { i.polygonStart(), i.lineStart(), e(null, null, 1, i), i.lineEnd(), i.polygonEnd(); }
            }, M = Pt(), x = t(M), b = !1;
            return y;
        };
    } function Dt(n) { return n.length > 1; } function Pt() {
        var n, t = []; return {
            lineStart: function () {
                t.push(n = []);
            }, point: function (t, e) { n.push([t, e]); }, lineEnd: b, buffer: function () { var e = t; return t = [], n = null, e; }, rejoin: function () {
                t.length > 1 && t.push(t.pop().concat(t.shift()));
            }
        };
    } function jt(n, t) { return ((n = n.x)[0] < 0 ? n[1] - Ha - Da : Ha - n[1]) - ((t = t.x)[0] < 0 ? t[1] - Ha - Da : Ha - t[1]); } function Ut(n) {
        var t, e = NaN, r = NaN, u = NaN;
        return {
            lineStart: function () { n.lineStart(), t = 1; }, point: function (i, a) {
                var o = i > 0 ? ja : -ja, l = Ma(i - e); Ma(l - ja) < Da ? (n.point(e, r = (r + a) / 2 > 0 ? Ha : -Ha), n.point(u, r), n.lineEnd(), n.lineStart(), n.point(o, r), n.point(i, r), t = 0) : u !== o && l >= ja && (Ma(e - u) < Da && (e -= u * Da), Ma(i - o) < Da && (i -= o * Da), r = Ft(e, r, i, a), n.point(u, r), n.lineEnd(), n.lineStart(), n.point(o, r), t = 0), n.point(e = i, r = a), u = o;
            }, lineEnd: function () { n.lineEnd(), e = r = NaN; }, clean: function () { return 2 - t; }
        };
    } function Ft(n, t, e, r) {
        var u, i, a = Math.sin(n - e);
        return Ma(a) > Da ? Math.atan((Math.sin(t) * (i = Math.cos(r)) * Math.sin(e) - Math.sin(r) * (u = Math.cos(t)) * Math.sin(n)) / (u * i * a)) : (t + r) / 2;
    } function Ht(n, t, e, r) {
        var u; if (null == n) {
            u = e * Ha, r.point(-ja, u), r.point(0, u), r.point(ja, u), r.point(ja, 0), r.point(ja, -u), r.point(0, -u), r.point(-ja, -u), r.point(-ja, 0), r.point(-ja, u);
        } else {
            if (Ma(n[0] - t[0]) > Da) { var i = n[0] < t[0] ? ja : -ja; u = e * i / 2, r.point(-i, u), r.point(0, u), r.point(i, u); } else {
                r.point(t[0], t[1]);
            }
        }
    } function Ot(n, t) {
        var e = n[0], r = n[1], u = [Math.sin(e), -Math.cos(e), 0], i = 0, a = 0; So.reset(); for (var o = 0, l = t.length;
        l > o; ++o) {
            var c = t[o], s = c.length; if (s) {
                for (var f = c[0], h = f[0], g = f[1] / 2 + ja / 4, p = Math.sin(g), v = Math.cos(g), d = 1;
                ;) {
                    d === s && (d = 0), n = c[d]; var m = n[0], y = n[1] / 2 + ja / 4, M = Math.sin(y), x = Math.cos(y), b = m - h, _ = b >= 0 ? 1 : -1, w = _ * b, S = w > ja, k = p * M;
                    if (So.add(Math.atan2(k * _ * Math.sin(w), v * x + k * Math.cos(w))), i += S ? b + _ * Ua : b, S ^ h >= e ^ m >= e) {
                        var N = yt(dt(f), dt(n));
                        bt(N); var E = yt(u, N); bt(E); var A = (S ^ b >= 0 ? -1 : 1) * tn(E[2]); (r > A || r === A && (N[0] || N[1])) && (a += S ^ b >= 0 ? 1 : -1);
                    } if (!d++) {
                        break;
                    } h = m, p = M, v = x, f = n;
                }
            }
        } return (-Da > i || Da > i && 0 > So) ^ 1 & a;
    } function It(n) {
        function t(n, t) {
            return Math.cos(n) * Math.cos(t) > i;
        } function e(n) {
            var e, i, l, c, s; return {
                lineStart: function () { c = l = !1, s = 1; }, point: function (f, h) {
                    var g, p = [f, h], v = t(f, h), d = a ? v ? 0 : u(f, h) : v ? u(f + (0 > f ? ja : -ja), h) : 0;
                    if (!e && (c = l = v) && n.lineStart(), v !== l && (g = r(e, p), (wt(e, g) || wt(p, g)) && (p[0] += Da, p[1] += Da, v = t(p[0], p[1]))), v !== l) {
                        s = 0, v ? (n.lineStart(), g = r(p, e), n.point(g[0], g[1])) : (g = r(e, p), n.point(g[0], g[1]), n.lineEnd()), e = g;
                    } else {
                        if (o && e && a ^ v) {
                            var m; d & i || !(m = r(p, e, !0)) || (s = 0, a ? (n.lineStart(), n.point(m[0][0], m[0][1]), n.point(m[1][0], m[1][1]), n.lineEnd()) : (n.point(m[1][0], m[1][1]), n.lineEnd(), n.lineStart(), n.point(m[0][0], m[0][1])));
                        }
                    } !v || e && wt(e, p) || n.point(p[0], p[1]), e = p, l = v, i = d;
                }, lineEnd: function () { l && n.lineEnd(), e = null; }, clean: function () {
                    return s | (c && l) << 1;
                }
            };
        } function r(n, t, e) {
            var r = dt(n), u = dt(t), a = [1, 0, 0], o = yt(r, u), l = mt(o, o), c = o[0], s = l - c * c; if (!s) {
                return !e && n;
            } var f = i * l / s, h = -i * c / s, g = yt(a, o), p = xt(a, f), v = xt(o, h); Mt(p, v); var d = g, m = mt(p, d), y = mt(d, d), M = m * m - y * (mt(p, p) - 1);
            if (!(0 > M)) {
                var x = Math.sqrt(M), b = xt(d, (-m - x) / y); if (Mt(b, p), b = _t(b), !e) { return b; } var _, w = n[0], S = t[0], k = n[1], N = t[1];
                w > S && (_ = w, w = S, S = _); var E = S - w, A = Ma(E - ja) < Da, C = A || Da > E; if (!A && k > N && (_ = k, k = N, N = _), C ? A ? k + N > 0 ^ b[1] < (Ma(b[0] - w) < Da ? k : N) : k <= b[1] && b[1] <= N : E > ja ^ (w <= b[0] && b[0] <= S)) {
                    var z = xt(d, (-m + x) / y);
                    return Mt(z, p), [b, _t(z)];
                }
            }
        } function u(t, e) {
            var r = a ? n : ja - n, u = 0; return -r > t ? u |= 1 : t > r && (u |= 2), -r > e ? u |= 4 : e > r && (u |= 8), u;
        } var i = Math.cos(n), a = i > 0, o = Ma(i) > Da, l = ve(n, 6 * Oa); return Rt(t, e, l, a ? [0, -n] : [-ja, n - ja]);
    } function Yt(n, t, e, r) {
        return function (u) {
            var i, a = u.a, o = u.b, l = a.x, c = a.y, s = o.x, f = o.y, h = 0, g = 1, p = s - l, v = f - c;
            if (i = n - l, p || !(i > 0)) {
                if (i /= p, 0 > p) { if (h > i) { return; } g > i && (g = i); } else {
                    if (p > 0) {
                        if (i > g) { return; } i > h && (h = i);
                    }
                } if (i = e - l, p || !(0 > i)) {
                    if (i /= p, 0 > p) { if (i > g) { return; } i > h && (h = i); } else {
                        if (p > 0) {
                            if (h > i) { return; } g > i && (g = i);
                        }
                    } if (i = t - c, v || !(i > 0)) {
                        if (i /= v, 0 > v) { if (h > i) { return; } g > i && (g = i); } else {
                            if (v > 0) {
                                if (i > g) { return; } i > h && (h = i);
                            }
                        } if (i = r - c, v || !(0 > i)) {
                            if (i /= v, 0 > v) { if (i > g) { return; } i > h && (h = i); } else {
                                if (v > 0) {
                                    if (h > i) { return; } g > i && (g = i);
                                }
                            } return h > 0 && (u.a = { x: l + h * p, y: c + h * v }), 1 > g && (u.b = { x: l + g * p, y: c + g * v }), u;
                        }
                    }
                }
            }
        };
    } function Zt(n, t, e, r) {
        function u(r, u) {
            return Ma(r[0] - n) < Da ? u > 0 ? 0 : 3 : Ma(r[0] - e) < Da ? u > 0 ? 2 : 1 : Ma(r[1] - t) < Da ? u > 0 ? 1 : 0 : u > 0 ? 3 : 2;
        } function i(n, t) { return a(n.x, t.x); } function a(n, t) {
            var e = u(n, 1), r = u(t, 1); return e !== r ? e - r : 0 === e ? t[1] - n[1] : 1 === e ? n[0] - t[0] : 2 === e ? n[1] - t[1] : t[0] - n[0];
        } return function (o) {
            function l(n) {
                for (var t = 0, e = d.length, r = n[1], u = 0; e > u; ++u) {
                    for (var i, a = 1, o = d[u], l = o.length, c = o[0];
                    l > a; ++a) { i = o[a], c[1] <= r ? i[1] > r && Q(c, i, n) > 0 && ++t : i[1] <= r && Q(c, i, n) < 0 && --t, c = i; }
                } return 0 !== t;
            } function c(i, o, l, c) {
                var s = 0, f = 0;
                if (null == i || (s = u(i, l)) !== (f = u(o, l)) || a(i, o) < 0 ^ l > 0) {
                    do { c.point(0 === s || 3 === s ? n : e, s > 1 ? r : t); } while ((s = (s + l + 4) % 4) !== f);
                } else { c.point(o[0], o[1]); }
            } function s(u, i) { return u >= n && e >= u && i >= t && r >= i; } function f(n, t) {
                s(n, t) && o.point(n, t);
            } function h() { C.point = p, d && d.push(m = []), S = !0, w = !1, b = _ = NaN; } function g() {
                v && (p(y, M), x && w && E.rejoin(), v.push(E.buffer())), C.point = f, w && o.lineEnd();
            } function p(n, t) {
                n = Math.max(-Fo, Math.min(Fo, n)), t = Math.max(-Fo, Math.min(Fo, t)); var e = s(n, t); if (d && m.push([n, t]), S) {
                    y = n, M = t, x = e, S = !1, e && (o.lineStart(), o.point(n, t));
                } else {
                    if (e && w) { o.point(n, t); } else {
                        var r = { a: { x: b, y: _ }, b: { x: n, y: t } }; A(r) ? (w || (o.lineStart(), o.point(r.a.x, r.a.y)), o.point(r.b.x, r.b.y), e || o.lineEnd(), k = !1) : e && (o.lineStart(), o.point(n, t), k = !1);
                    }
                } b = n, _ = t, w = e;
            } var v, d, m, y, M, x, b, _, w, S, k, N = o, E = Pt(), A = Yt(n, t, e, r), C = {
                point: f, lineStart: h, lineEnd: g, polygonStart: function () {
                    o = E, v = [], d = [], k = !0;
                }, polygonEnd: function () {
                    o = N, v = oa.merge(v); var t = l([n, r]), e = k && t, u = v.length; (e || u) && (o.polygonStart(), e && (o.lineStart(), c(null, null, 1, o), o.lineEnd()), u && Lt(v, i, t, c, o), o.polygonEnd()), v = d = m = null;
                }
            }; return C;
        };
    } function Vt(n) {
        var t = 0, e = ja / 3, r = oe(n), u = r(t, e); return u.parallels = function (n) {
            return arguments.length ? r(t = n[0] * ja / 180, e = n[1] * ja / 180) : [t / ja * 180, e / ja * 180];
        }, u;
    } function Xt(n, t) {
        function e(n, t) {
            var e = Math.sqrt(i - 2 * u * Math.sin(t)) / u; return [e * Math.sin(n *= u), a - e * Math.cos(n)];
        } var r = Math.sin(n), u = (r + Math.sin(t)) / 2, i = 1 + r * (2 * u - r), a = Math.sqrt(i) / u; return e.invert = function (n, t) {
            var e = a - t;
            return [Math.atan2(n, e) / u, tn((i - (n * n + e * e) * u * u) / (2 * u))];
        }, e;
    } function $t() {
        function n(n, t) {
            Oo += u * n - r * t, r = n, u = t;
        } var t, e, r, u; Xo.point = function (i, a) { Xo.point = n, t = r = i, e = u = a; }, Xo.lineEnd = function () { n(t, e); };
    } function Bt(n, t) {
        Io > n && (Io = n), n > Zo && (Zo = n), Yo > t && (Yo = t), t > Vo && (Vo = t);
    } function Wt() {
        function n(n, t) { a.push("M", n, ",", t, i); } function t(n, t) { a.push("M", n, ",", t), o.point = e; } function e(n, t) {
            a.push("L", n, ",", t);
        } function r() { o.point = n; } function u() { a.push("Z"); } var i = Jt(4.5), a = [], o = {
            point: n, lineStart: function () {
                o.point = t;
            }, lineEnd: r, polygonStart: function () { o.lineEnd = u; }, polygonEnd: function () { o.lineEnd = r, o.point = n; }, pointRadius: function (n) {
                return i = Jt(n), o;
            }, result: function () { if (a.length) { var n = a.join(""); return a = [], n; } }
        }; return o;
    } function Jt(n) {
        return "m0," + n + "a" + n + "," + n + " 0 1,1 0," + -2 * n + "a" + n + "," + n + " 0 1,1 0," + 2 * n + "z";
    } function Gt(n, t) { Ao += n, Co += t, ++zo; } function Kt() {
        function n(n, r) {
            var u = n - t, i = r - e, a = Math.sqrt(u * u + i * i);
            Lo += a * (t + n) / 2, qo += a * (e + r) / 2, To += a, Gt(t = n, e = r);
        } var t, e; Bo.point = function (r, u) {
            Bo.point = n, Gt(t = r, e = u);
        };
    } function Qt() { Bo.point = Gt; } function ne() {
        function n(n, t) {
            var e = n - r, i = t - u, a = Math.sqrt(e * e + i * i); Lo += a * (r + n) / 2, qo += a * (u + t) / 2, To += a, a = u * n - r * t, Ro += a * (r + n), Do += a * (u + t), Po += 3 * a, Gt(r = n, u = t);
        } var t, e, r, u; Bo.point = function (i, a) { Bo.point = n, Gt(t = r = i, e = u = a); }, Bo.lineEnd = function () { n(t, e); };
    } function te(n) {
        function t(t, e) {
            n.moveTo(t + a, e), n.arc(t, e, a, 0, Ua);
        } function e(t, e) { n.moveTo(t, e), o.point = r; } function r(t, e) { n.lineTo(t, e); } function u() { o.point = t; } function i() {
            n.closePath();
        } var a = 4.5, o = {
            point: t, lineStart: function () { o.point = e; }, lineEnd: u, polygonStart: function () {
                o.lineEnd = i;
            }, polygonEnd: function () { o.lineEnd = u, o.point = t; }, pointRadius: function (n) { return a = n, o; }, result: b
        }; return o;
    } function ee(n) {
        function t(n) { return (o ? r : e)(n); } function e(t) {
            return ie(t, function (e, r) {
                e = n(e, r), t.point(e[0], e[1]);
            });
        } function r(t) {
            function e(e, r) { e = n(e, r), t.point(e[0], e[1]); } function r() {
                M = NaN, S.point = i, t.lineStart();
            } function i(e, r) {
                var i = dt([e, r]), a = n(e, r); u(M, x, y, b, _, w, M = a[0], x = a[1], y = e, b = i[0], _ = i[1], w = i[2], o, t), t.point(M, x);
            } function a() { S.point = e, t.lineEnd(); } function l() { r(), S.point = c, S.lineEnd = s; } function c(n, t) {
                i(f = n, h = t), g = M, p = x, v = b, d = _, m = w, S.point = i;
            } function s() { u(M, x, y, b, _, w, g, p, f, v, d, m, o, t), S.lineEnd = a, a(); } var f, h, g, p, v, d, m, y, M, x, b, _, w, S = {
                point: e, lineStart: r, lineEnd: a, polygonStart: function () {
                    t.polygonStart(), S.lineStart = l;
                }, polygonEnd: function () { t.polygonEnd(), S.lineStart = r; }
            }; return S;
        } function u(t, e, r, o, l, c, s, f, h, g, p, v, d, m) {
            var y = s - t, M = f - e, x = y * y + M * M;
            if (x > 4 * i && d--) {
                var b = o + g, _ = l + p, w = c + v, S = Math.sqrt(b * b + _ * _ + w * w), k = Math.asin(w /= S), N = Ma(Ma(w) - 1) < Da || Ma(r - h) < Da ? (r + h) / 2 : Math.atan2(_, b), E = n(N, k), A = E[0], C = E[1], z = A - t, L = C - e, q = M * z - y * L;
                (q * q / x > i || Ma((y * z + M * L) / x - 0.5) > 0.3 || a > o * g + l * p + c * v) && (u(t, e, r, o, l, c, A, C, N, b /= S, _ /= S, w, d, m), m.point(A, C), u(A, C, N, b, _, w, s, f, h, g, p, v, d, m));
            }
        } var i = 0.5, a = Math.cos(30 * Oa), o = 16; return t.precision = function (n) {
            return arguments.length ? (o = (i = n * n) > 0 && 16, t) : Math.sqrt(i);
        }, t;
    } function re(n) {
        var t = ee(function (t, e) { return n([t * Ia, e * Ia]); }); return function (n) {
            return le(t(n));
        };
    } function ue(n) { this.stream = n; } function ie(n, t) {
        return {
            point: t, sphere: function () { n.sphere(); }, lineStart: function () {
                n.lineStart();
            }, lineEnd: function () { n.lineEnd(); }, polygonStart: function () { n.polygonStart(); }, polygonEnd: function () {
                n.polygonEnd();
            }
        };
    } function ae(n) { return oe(function () { return n; })(); } function oe(n) {
        function t(n) {
            return n = o(n[0] * Oa, n[1] * Oa), [n[0] * h + l, c - n[1] * h];
        } function e(n) { return n = o.invert((n[0] - l) / h, (c - n[1]) / h), n && [n[0] * Ia, n[1] * Ia]; } function r() {
            o = Ct(a = fe(m, M, x), i);
            var n = i(v, d); return l = g - n[0] * h, c = p + n[1] * h, u();
        } function u() { return s && (s.valid = !1, s = null), t; } var i, a, o, l, c, s, f = ee(function (n, t) {
            return n = i(n, t), [n[0] * h + l, c - n[1] * h];
        }), h = 150, g = 480, p = 250, v = 0, d = 0, m = 0, M = 0, x = 0, b = Uo, _ = y, w = null, S = null; return t.stream = function (n) {
            return s && (s.valid = !1), s = le(b(a, f(_(n)))), s.valid = !0, s;
        }, t.clipAngle = function (n) { return arguments.length ? (b = null == n ? (w = n, Uo) : It((w = +n) * Oa), u()) : w; }, t.clipExtent = function (n) {
            return arguments.length ? (S = n, _ = n ? Zt(n[0][0], n[0][1], n[1][0], n[1][1]) : y, u()) : S;
        }, t.scale = function (n) { return arguments.length ? (h = +n, r()) : h; }, t.translate = function (n) {
            return arguments.length ? (g = +n[0], p = +n[1], r()) : [g, p];
        }, t.center = function (n) { return arguments.length ? (v = n[0] % 360 * Oa, d = n[1] % 360 * Oa, r()) : [v * Ia, d * Ia]; }, t.rotate = function (n) {
            return arguments.length ? (m = n[0] % 360 * Oa, M = n[1] % 360 * Oa, x = n.length > 2 ? n[2] % 360 * Oa : 0, r()) : [m * Ia, M * Ia, x * Ia];
        }, oa.rebind(t, f, "precision"), function () { return i = n.apply(this, arguments), t.invert = i.invert && e, r(); };
    } function le(n) {
        return ie(n, function (t, e) {
            n.point(t * Oa, e * Oa);
        });
    } function ce(n, t) { return [n, t]; } function se(n, t) { return [n > ja ? n - Ua : -ja > n ? n + Ua : n, t]; } function fe(n, t, e) {
        return n ? t || e ? Ct(ge(n), pe(t, e)) : ge(n) : t || e ? pe(t, e) : se;
    } function he(n) { return function (t, e) { return t += n, [t > ja ? t - Ua : -ja > t ? t + Ua : t, e]; }; } function ge(n) {
        var t = he(n);
        return t.invert = he(-n), t;
    } function pe(n, t) {
        function e(n, t) {
            var e = Math.cos(t), o = Math.cos(n) * e, l = Math.sin(n) * e, c = Math.sin(t), s = c * r + o * u;
            return [Math.atan2(l * i - s * a, o * r - c * u), tn(s * i + l * a)];
        } var r = Math.cos(n), u = Math.sin(n), i = Math.cos(t), a = Math.sin(t);
        return e.invert = function (n, t) {
            var e = Math.cos(t), o = Math.cos(n) * e, l = Math.sin(n) * e, c = Math.sin(t), s = c * i - l * a;
            return [Math.atan2(l * i + c * a, o * r + s * u), tn(s * r - o * u)];
        }, e;
    } function ve(n, t) {
        var e = Math.cos(n), r = Math.sin(n);
        return function (u, i, a, o) {
            var l = a * t; null != u ? (u = de(e, u), i = de(e, i), (a > 0 ? i > u : u > i) && (u += a * Ua)) : (u = n + a * Ua, i = n - 0.5 * l);
            for (var c, s = u; a > 0 ? s > i : i > s; s -= l) { o.point((c = _t([e, -r * Math.cos(s), -r * Math.sin(s)]))[0], c[1]); }
        };
    } function de(n, t) {
        var e = dt(t);
        e[0] -= n, bt(e); var r = nn(-e[1]); return ((-e[2] < 0 ? -r : r) + 2 * Math.PI - Da) % (2 * Math.PI);
    } function me(n, t, e) {
        var r = oa.range(n, t - Da, e).concat(t);
        return function (n) { return r.map(function (t) { return [n, t]; }); };
    } function ye(n, t, e) {
        var r = oa.range(n, t - Da, e).concat(t);
        return function (n) { return r.map(function (t) { return [t, n]; }); };
    } function Me(n) { return n.source; } function xe(n) {
        return n.target;
    } function be(n, t, e, r) {
        var u = Math.cos(t), i = Math.sin(t), a = Math.cos(r), o = Math.sin(r), l = u * Math.cos(n), c = u * Math.sin(n), s = a * Math.cos(e), f = a * Math.sin(e), h = 2 * Math.asin(Math.sqrt(an(r - t) + u * a * an(e - n))), g = 1 / Math.sin(h), p = h ? function (n) {
            var t = Math.sin(n *= h) * g, e = Math.sin(h - n) * g, r = e * l + t * s, u = e * c + t * f, a = e * i + t * o;
            return [Math.atan2(u, r) * Ia, Math.atan2(a, Math.sqrt(r * r + u * u)) * Ia];
        } : function () { return [n * Ia, t * Ia]; }; return p.distance = h, p;
    } function _e() {
        function n(n, u) {
            var i = Math.sin(u *= Oa), a = Math.cos(u), o = Ma((n *= Oa) - t), l = Math.cos(o); Wo += Math.atan2(Math.sqrt((o = a * Math.sin(o)) * o + (o = r * i - e * a * l) * o), e * i + r * a * l), t = n, e = i, r = a;
        } var t, e, r; Jo.point = function (u, i) { t = u * Oa, e = Math.sin(i *= Oa), r = Math.cos(i), Jo.point = n; }, Jo.lineEnd = function () {
            Jo.point = Jo.lineEnd = b;
        };
    } function we(n, t) {
        function e(t, e) {
            var r = Math.cos(t), u = Math.cos(e), i = n(r * u); return [i * u * Math.sin(t), i * Math.sin(e)];
        } return e.invert = function (n, e) {
            var r = Math.sqrt(n * n + e * e), u = t(r), i = Math.sin(u), a = Math.cos(u); return [Math.atan2(n * i, r * a), Math.asin(r && e * i / r)];
        }, e;
    } function Se(n, t) {
        function e(n, t) {
            a > 0 ? -Ha + Da > t && (t = -Ha + Da) : t > Ha - Da && (t = Ha - Da); var e = a / Math.pow(u(t), i);
            return [e * Math.sin(i * n), a - e * Math.cos(i * n)];
        } var r = Math.cos(n), u = function (n) {
            return Math.tan(ja / 4 + n / 2);
        }, i = n === t ? Math.sin(n) : Math.log(r / Math.cos(t)) / Math.log(u(t) / u(n)), a = r * Math.pow(u(n), i) / i; return i ? (e.invert = function (n, t) {
            var e = a - t, r = K(i) * Math.sqrt(n * n + e * e);
            return [Math.atan2(n, e) / i, 2 * Math.atan(Math.pow(a / r, 1 / i)) - Ha];
        }, e) : Ne;
    } function ke(n, t) {
        function e(n, t) {
            var e = i - t;
            return [e * Math.sin(u * n), i - e * Math.cos(u * n)];
        } var r = Math.cos(n), u = n === t ? Math.sin(n) : (r - Math.cos(t)) / (t - n), i = r / u + n;
        return Ma(u) < Da ? ce : (e.invert = function (n, t) {
            var e = i - t; return [Math.atan2(n, e) / u, i - K(u) * Math.sqrt(n * n + e * e)];
        }, e);
    } function Ne(n, t) { return [n, Math.log(Math.tan(ja / 4 + t / 2))]; } function Ee(n) {
        var t, e = ae(n), r = e.scale, u = e.translate, i = e.clipExtent;
        return e.scale = function () { var n = r.apply(e, arguments); return n === e ? t ? e.clipExtent(null) : e : n; }, e.translate = function () {
            var n = u.apply(e, arguments);
            return n === e ? t ? e.clipExtent(null) : e : n;
        }, e.clipExtent = function (n) {
            var a = i.apply(e, arguments); if (a === e) {
                if (t = null == n) {
                    var o = ja * r(), l = u();
                    i([[l[0] - o, l[1] - o], [l[0] + o, l[1] + o]]);
                }
            } else { t && (a = null); } return a;
        }, e.clipExtent(null);
    } function Ae(n, t) {
        return [Math.log(Math.tan(ja / 4 + t / 2)), -n];
    } function Ce(n) { return n[0]; } function ze(n) { return n[1]; } function Le(n) {
        for (var t = n.length, e = [0, 1], r = 2, u = 2;
        t > u; u++) { for (; r > 1 && Q(n[e[r - 2]], n[e[r - 1]], n[u]) <= 0;) { --r; } e[r++] = u; } return e.slice(0, r);
    } function qe(n, t) {
        return n[0] - t[0] || n[1] - t[1];
    } function Te(n, t, e) { return (e[0] - t[0]) * (n[1] - t[1]) < (e[1] - t[1]) * (n[0] - t[0]); } function Re(n, t, e, r) {
        var u = n[0], i = e[0], a = t[0] - u, o = r[0] - i, l = n[1], c = e[1], s = t[1] - l, f = r[1] - c, h = (o * (l - c) - f * (u - i)) / (f * a - o * s);
        return [u + h * a, l + h * s];
    } function De(n) { var t = n[0], e = n[n.length - 1]; return !(t[0] - e[0] || t[1] - e[1]); } function Pe() {
        rr(this), this.edge = this.site = this.circle = null;
    } function je(n) { var t = ll.pop() || new Pe; return t.site = n, t; } function Ue(n) {
        Be(n), il.remove(n), ll.push(n), rr(n);
    } function Fe(n) {
        var t = n.circle, e = t.x, r = t.cy, u = { x: e, y: r }, i = n.P, a = n.N, o = [n]; Ue(n); for (var l = i; l.circle && Ma(e - l.circle.x) < Da && Ma(r - l.circle.cy) < Da;
        ) { i = l.P, o.unshift(l), Ue(l), l = i; } o.unshift(l), Be(l); for (var c = a; c.circle && Ma(e - c.circle.x) < Da && Ma(r - c.circle.cy) < Da;
        ) { a = c.N, o.push(c), Ue(c), c = a; } o.push(c), Be(c); var s, f = o.length; for (s = 1; f > s; ++s) {
            c = o[s], l = o[s - 1], nr(c.edge, l.site, c.site, u);
        } l = o[0], c = o[f - 1], c.edge = Ke(l.site, c.site, null, u), $e(l), $e(c);
    } function He(n) {
        for (var t, e, r, u, i = n.x, a = n.y, o = il._;
        o;) {
            if (r = Oe(o, a) - i, r > Da) { o = o.L; } else {
                if (u = i - Ie(o, a), !(u > Da)) {
                    r > -Da ? (t = o.P, e = o) : u > -Da ? (t = o, e = o.N) : t = e = o;
                    break;
                } if (!o.R) { t = o; break; } o = o.R;
            }
        } var l = je(n); if (il.insert(t, l), t || e) {
            if (t === e) {
                return Be(t), e = je(t.site), il.insert(l, e), l.edge = e.edge = Ke(t.site, l.site), $e(t), void $e(e);
            } if (!e) { return void (l.edge = Ke(t.site, l.site)); } Be(t), Be(e); var c = t.site, s = c.x, f = c.y, h = n.x - s, g = n.y - f, p = e.site, v = p.x - s, d = p.y - f, m = 2 * (h * d - g * v), y = h * h + g * g, M = v * v + d * d, x = { x: (d * y - g * M) / m + s, y: (h * M - v * y) / m + f };
            nr(e.edge, c, p, x), l.edge = Ke(c, n, null, x), e.edge = Ke(n, p, null, x), $e(t), $e(e);
        }
    } function Oe(n, t) {
        var e = n.site, r = e.x, u = e.y, i = u - t;
        if (!i) { return r; } var a = n.P; if (!a) { return -(1 / 0); } e = a.site; var o = e.x, l = e.y, c = l - t; if (!c) { return o; } var s = o - r, f = 1 / i - 1 / c, h = s / c;
        return f ? (-h + Math.sqrt(h * h - 2 * f * (s * s / (-2 * c) - l + c / 2 + u - i / 2))) / f + r : (r + o) / 2;
    } function Ie(n, t) {
        var e = n.N; if (e) {
            return Oe(e, t);
        } var r = n.site; return r.y === t ? r.x : 1 / 0;
    } function Ye(n) { this.site = n, this.edges = []; } function Ze(n) {
        for (var t, e, r, u, i, a, o, l, c, s, f = n[0][0], h = n[1][0], g = n[0][1], p = n[1][1], v = ul, d = v.length;
        d--;) {
            if (i = v[d], i && i.prepare()) {
                for (o = i.edges, l = o.length, a = 0; l > a;) {
                    s = o[a].end(), r = s.x, u = s.y, c = o[++a % l].start(), t = c.x, e = c.y, (Ma(r - t) > Da || Ma(u - e) > Da) && (o.splice(a, 0, new tr(Qe(i.site, s, Ma(r - f) < Da && p - u > Da ? { x: f, y: Ma(t - f) < Da ? e : p } : Ma(u - p) < Da && h - r > Da ? { x: Ma(e - p) < Da ? t : h, y: p } : Ma(r - h) < Da && u - g > Da ? { x: h, y: Ma(t - h) < Da ? e : g } : Ma(u - g) < Da && r - f > Da ? { x: Ma(e - g) < Da ? t : f, y: g } : null), i.site, null)), ++l);
                }
            }
        }
    } function Ve(n, t) { return t.angle - n.angle; } function Xe() {
        rr(this), this.x = this.y = this.arc = this.site = this.cy = null;
    } function $e(n) {
        var t = n.P, e = n.N; if (t && e) {
            var r = t.site, u = n.site, i = e.site; if (r !== i) {
                var a = u.x, o = u.y, l = r.x - a, c = r.y - o, s = i.x - a, f = i.y - o, h = 2 * (l * f - c * s);
                if (!(h >= -Pa)) {
                    var g = l * l + c * c, p = s * s + f * f, v = (f * g - c * p) / h, d = (l * p - s * g) / h, f = d + o, m = cl.pop() || new Xe; m.arc = n, m.site = u, m.x = v + a, m.y = f + Math.sqrt(v * v + d * d), m.cy = f, n.circle = m;
                    for (var y = null, M = ol._; M;) {
                        if (m.y < M.y || m.y === M.y && m.x <= M.x) { if (!M.L) { y = M.P; break; } M = M.L; } else {
                            if (!M.R) {
                                y = M;
                                break;
                            } M = M.R;
                        }
                    } ol.insert(y, m), y || (al = m);
                }
            }
        }
    } function Be(n) {
        var t = n.circle; t && (t.P || (al = t.N), ol.remove(t), cl.push(t), rr(t), n.circle = null);
    } function We(n) {
        for (var t, e = rl, r = Yt(n[0][0], n[0][1], n[1][0], n[1][1]), u = e.length; u--;) {
            t = e[u], (!Je(t, n) || !r(t) || Ma(t.a.x - t.b.x) < Da && Ma(t.a.y - t.b.y) < Da) && (t.a = t.b = null, e.splice(u, 1));
        }
    } function Je(n, t) {
        var e = n.b; if (e) { return !0; } var r, u, i = n.a, a = t[0][0], o = t[1][0], l = t[0][1], c = t[1][1], s = n.l, f = n.r, h = s.x, g = s.y, p = f.x, v = f.y, d = (h + p) / 2, m = (g + v) / 2;
        if (v === g) {
            if (a > d || d >= o) { return; } if (h > p) { if (i) { if (i.y >= c) { return; } } else { i = { x: d, y: l }; } e = { x: d, y: c }; } else {
                if (i) {
                    if (i.y < l) {
                        return;
                    }
                } else { i = { x: d, y: c }; } e = { x: d, y: l };
            }
        } else {
            if (r = (h - p) / (v - g), u = m - r * d, -1 > r || r > 1) {
                if (h > p) {
                    if (i) {
                        if (i.y >= c) {
                            return;
                        }
                    } else { i = { x: (l - u) / r, y: l }; } e = { x: (c - u) / r, y: c };
                } else {
                    if (i) { if (i.y < l) { return; } } else { i = { x: (c - u) / r, y: c }; } e = { x: (l - u) / r, y: l };
                }
            } else {
                if (v > g) { if (i) { if (i.x >= o) { return; } } else { i = { x: a, y: r * a + u }; } e = { x: o, y: r * o + u }; } else {
                    if (i) {
                        if (i.x < a) {
                            return;
                        }
                    } else { i = { x: o, y: r * o + u }; } e = { x: a, y: r * a + u };
                }
            }
        } return n.a = i, n.b = e, !0;
    } function Ge(n, t) {
        this.l = n, this.r = t, this.a = this.b = null;
    } function Ke(n, t, e, r) {
        var u = new Ge(n, t); return rl.push(u), e && nr(u, n, t, e), r && nr(u, t, n, r), ul[n.i].edges.push(new tr(u, n, t)), ul[t.i].edges.push(new tr(u, t, n)), u;
    } function Qe(n, t, e) { var r = new Ge(n, null); return r.a = t, r.b = e, rl.push(r), r; } function nr(n, t, e, r) {
        n.a || n.b ? n.l === e ? n.b = r : n.a = r : (n.a = r, n.l = t, n.r = e);
    } function tr(n, t, e) {
        var r = n.a, u = n.b; this.edge = n, this.site = t, this.angle = e ? Math.atan2(e.y - t.y, e.x - t.x) : n.l === t ? Math.atan2(u.x - r.x, r.y - u.y) : Math.atan2(r.x - u.x, u.y - r.y);
    } function er() { this._ = null; } function rr(n) { n.U = n.C = n.L = n.R = n.P = n.N = null; } function ur(n, t) {
        var e = t, r = t.R, u = e.U;
        u ? u.L === e ? u.L = r : u.R = r : n._ = r, r.U = u, e.U = r, e.R = r.L, e.R && (e.R.U = e), r.L = e;
    } function ir(n, t) {
        var e = t, r = t.L, u = e.U;
        u ? u.L === e ? u.L = r : u.R = r : n._ = r, r.U = u, e.U = r, e.L = r.R, e.L && (e.L.U = e), r.R = e;
    } function ar(n) {
        for (; n.L;) {
            n = n.L;
        } return n;
    } function or(n, t) {
        var e, r, u, i = n.sort(lr).pop(); for (rl = [], ul = new Array(n.length), il = new er, ol = new er;
        ;) {
            if (u = al, i && (!u || i.y < u.y || i.y === u.y && i.x < u.x)) {
                (i.x !== e || i.y !== r) && (ul[i.i] = new Ye(i), He(i), e = i.x, r = i.y), i = n.pop();
            } else { if (!u) { break; } Fe(u.arc); }
        } t && (We(t), Ze(t)); var a = { cells: ul, edges: rl }; return il = ol = rl = ul = null, a;
    } function lr(n, t) { return t.y - n.y || t.x - n.x; } function cr(n, t, e) {
        return (n.x - e.x) * (t.y - n.y) - (n.x - t.x) * (e.y - n.y);
    } function sr(n) { return n.x; } function fr(n) { return n.y; } function hr() {
        return { leaf: !0, nodes: [], point: null, x: null, y: null };
    } function gr(n, t, e, r, u, i) {
        if (!n(t, e, r, u, i)) {
            var a = 0.5 * (e + u), o = 0.5 * (r + i), l = t.nodes; l[0] && gr(n, l[0], e, r, a, o), l[1] && gr(n, l[1], a, r, u, o), l[2] && gr(n, l[2], e, o, a, i), l[3] && gr(n, l[3], a, o, u, i);
        }
    } function pr(n, t, e, r, u, i, a) {
        var o, l = 1 / 0; return function c(n, s, f, h, g) {
            if (!(s > i || f > a || r > h || u > g)) {
                if (p = n.point) {
                    var p, v = t - n.x, d = e - n.y, m = v * v + d * d;
                    if (l > m) { var y = Math.sqrt(l = m); r = t - y, u = e - y, i = t + y, a = e + y, o = p; }
                } for (var M = n.nodes, x = 0.5 * (s + h), b = 0.5 * (f + g), _ = t >= x, w = e >= b, S = w << 1 | _, k = S + 4;
                k > S; ++S) {
                    if (n = M[3 & S]) {
                        switch (3 & S) {
                            case 0: c(n, s, f, x, b); break; case 1: c(n, x, f, h, b); break; case 2: c(n, s, b, x, g);
                                break; case 3: c(n, x, b, h, g);
                        }
                    }
                }
            }
        }(n, r, u, i, a), o;
    } function vr(n, t) {
        n = oa.rgb(n), t = oa.rgb(t); var e = n.r, r = n.g, u = n.b, i = t.r - e, a = t.g - r, o = t.b - u;
        return function (n) { return "#" + bn(Math.round(e + i * n)) + bn(Math.round(r + a * n)) + bn(Math.round(u + o * n)); };
    } function dr(n, t) {
        var e, r = {}, u = {};
        for (e in n) { e in t ? r[e] = Mr(n[e], t[e]) : u[e] = n[e]; } for (e in t) { e in n || (u[e] = t[e]); } return function (n) {
            for (e in r) {
                u[e] = r[e](n);
            } return u;
        };
    } function mr(n, t) { return n = +n, t = +t, function (e) { return n * (1 - e) + t * e; }; } function yr(n, t) {
        var e, r, u, i = fl.lastIndex = hl.lastIndex = 0, a = -1, o = [], l = [];
        for (n += "", t += ""; (e = fl.exec(n)) && (r = hl.exec(t)) ;) {
            (u = r.index) > i && (u = t.slice(i, u), o[a] ? o[a] += u : o[++a] = u), (e = e[0]) === (r = r[0]) ? o[a] ? o[a] += r : o[++a] = r : (o[++a] = null, l.push({ i: a, x: mr(e, r) })), i = hl.lastIndex;
        } return i < t.length && (u = t.slice(i), o[a] ? o[a] += u : o[++a] = u), o.length < 2 ? l[0] ? (t = l[0].x, function (n) {
            return t(n) + "";
        }) : function () { return t; } : (t = l.length, function (n) {
            for (var e, r = 0; t > r; ++r) { o[(e = l[r]).i] = e.x(n); } return o.join("");
        });
    } function Mr(n, t) {
        for (var e, r = oa.interpolators.length; --r >= 0 && !(e = oa.interpolators[r](n, t)) ;) { } return e;
    } function xr(n, t) {
        var e, r = [], u = [], i = n.length, a = t.length, o = Math.min(n.length, t.length); for (e = 0; o > e; ++e) {
            r.push(Mr(n[e], t[e]));
        } for (; i > e; ++e) { u[e] = n[e]; } for (; a > e; ++e) { u[e] = t[e]; } return function (n) {
            for (e = 0; o > e; ++e) { u[e] = r[e](n); } return u;
        };
    } function br(n) { return function (t) { return 0 >= t ? 0 : t >= 1 ? 1 : n(t); }; } function _r(n) {
        return function (t) {
            return 1 - n(1 - t);
        };
    } function wr(n) { return function (t) { return 0.5 * (0.5 > t ? n(2 * t) : 2 - n(2 - 2 * t)); }; } function Sr(n) {
        return n * n;
    } function kr(n) { return n * n * n; } function Nr(n) {
        if (0 >= n) { return 0; } if (n >= 1) { return 1; } var t = n * n, e = t * n; return 4 * (0.5 > n ? e : 3 * (n - t) + e - 0.75);
    } function Er(n) { return function (t) { return Math.pow(t, n); }; } function Ar(n) { return 1 - Math.cos(n * Ha); } function Cr(n) {
        return Math.pow(2, 10 * (n - 1));
    } function zr(n) { return 1 - Math.sqrt(1 - n * n); } function Lr(n, t) {
        var e; return arguments.length < 2 && (t = 0.45), arguments.length ? e = t / Ua * Math.asin(1 / n) : (n = 1, e = t / 4), function (r) {
            return 1 + n * Math.pow(2, -10 * r) * Math.sin((r - e) * Ua / t);
        };
    } function qr(n) { return n || (n = 1.70158), function (t) { return t * t * ((n + 1) * t - n); }; } function Tr(n) {
        return 1 / 2.75 > n ? 7.5625 * n * n : 2 / 2.75 > n ? 7.5625 * (n -= 1.5 / 2.75) * n + 0.75 : 2.5 / 2.75 > n ? 7.5625 * (n -= 2.25 / 2.75) * n + 0.9375 : 7.5625 * (n -= 2.625 / 2.75) * n + 0.984375;
    } function Rr(n, t) {
        n = oa.hcl(n), t = oa.hcl(t); var e = n.h, r = n.c, u = n.l, i = t.h - e, a = t.c - r, o = t.l - u; return isNaN(a) && (a = 0, r = isNaN(r) ? t.c : r), isNaN(i) ? (i = 0, e = isNaN(e) ? t.h : e) : i > 180 ? i -= 360 : -180 > i && (i += 360), function (n) {
            return fn(e + i * n, r + a * n, u + o * n) + "";
        };
    } function Dr(n, t) {
        n = oa.hsl(n), t = oa.hsl(t); var e = n.h, r = n.s, u = n.l, i = t.h - e, a = t.s - r, o = t.l - u; return isNaN(a) && (a = 0, r = isNaN(r) ? t.s : r), isNaN(i) ? (i = 0, e = isNaN(e) ? t.h : e) : i > 180 ? i -= 360 : -180 > i && (i += 360), function (n) {
            return cn(e + i * n, r + a * n, u + o * n) + "";
        };
    } function Pr(n, t) {
        n = oa.lab(n), t = oa.lab(t); var e = n.l, r = n.a, u = n.b, i = t.l - e, a = t.a - r, o = t.b - u; return function (n) {
            return gn(e + i * n, r + a * n, u + o * n) + "";
        };
    } function jr(n, t) { return t -= n, function (e) { return Math.round(n + t * e); }; } function Ur(n) {
        var t = [n.a, n.b], e = [n.c, n.d], r = Hr(t), u = Fr(t, e), i = Hr(Or(e, t, -u)) || 0;
        t[0] * e[1] < e[0] * t[1] && (t[0] *= -1, t[1] *= -1, r *= -1, u *= -1), this.rotate = (r ? Math.atan2(t[1], t[0]) : Math.atan2(-e[0], e[1])) * Ia, this.translate = [n.e, n.f], this.scale = [r, i], this.skew = i ? Math.atan2(u, i) * Ia : 0;
    } function Fr(n, t) { return n[0] * t[0] + n[1] * t[1]; } function Hr(n) {
        var t = Math.sqrt(Fr(n, n)); return t && (n[0] /= t, n[1] /= t), t;
    } function Or(n, t, e) { return n[0] += e * t[0], n[1] += e * t[1], n; } function Ir(n) {
        return n.length ? n.pop() + "," : "";
    } function Yr(n, t, e, r) {
        if (n[0] !== t[0] || n[1] !== t[1]) {
            var u = e.push("translate(", null, ",", null, ")"); r.push({ i: u - 4, x: mr(n[0], t[0]) }, { i: u - 2, x: mr(n[1], t[1]) });
        } else { (t[0] || t[1]) && e.push("translate(" + t + ")"); }
    } function Zr(n, t, e, r) {
        n !== t ? (n - t > 180 ? t += 360 : t - n > 180 && (n += 360), r.push({ i: e.push(Ir(e) + "rotate(", null, ")") - 2, x: mr(n, t) })) : t && e.push(Ir(e) + "rotate(" + t + ")");
    } function Vr(n, t, e, r) {
        n !== t ? r.push({ i: e.push(Ir(e) + "skewX(", null, ")") - 2, x: mr(n, t) }) : t && e.push(Ir(e) + "skewX(" + t + ")");
    } function Xr(n, t, e, r) {
        if (n[0] !== t[0] || n[1] !== t[1]) {
            var u = e.push(Ir(e) + "scale(", null, ",", null, ")"); r.push({ i: u - 4, x: mr(n[0], t[0]) }, { i: u - 2, x: mr(n[1], t[1]) });
        } else { (1 !== t[0] || 1 !== t[1]) && e.push(Ir(e) + "scale(" + t + ")"); }
    } function $r(n, t) {
        var e = [], r = []; return n = oa.transform(n), t = oa.transform(t), Yr(n.translate, t.translate, e, r), Zr(n.rotate, t.rotate, e, r), Vr(n.skew, t.skew, e, r), Xr(n.scale, t.scale, e, r), n = t = null, function (n) {
            for (var t, u = -1, i = r.length;
            ++u < i;) { e[(t = r[u]).i] = t.x(n); } return e.join("");
        };
    } function Br(n, t) {
        return t = (t -= n = +n) || 1 / t, function (e) {
            return (e - n) / t;
        };
    } function Wr(n, t) { return t = (t -= n = +n) || 1 / t, function (e) { return Math.max(0, Math.min(1, (e - n) / t)); }; } function Jr(n) {
        for (var t = n.source, e = n.target, r = Kr(t, e), u = [t];
        t !== r;) { t = t.parent, u.push(t); } for (var i = u.length; e !== r;) { u.splice(i, 0, e), e = e.parent; } return u;
    } function Gr(n) {
        for (var t = [], e = n.parent;
        null != e;) { t.push(n), n = e, e = e.parent; } return t.push(n), t;
    } function Kr(n, t) {
        if (n === t) { return n; } for (var e = Gr(n), r = Gr(t), u = e.pop(), i = r.pop(), a = null;
        u === i;) { a = u, u = e.pop(), i = r.pop(); } return a;
    } function Qr(n) { n.fixed |= 2; } function nu(n) { n.fixed &= -7; } function tu(n) {
        n.fixed |= 4, n.px = n.x, n.py = n.y;
    } function eu(n) { n.fixed &= -5; } function ru(n, t, e) {
        var r = 0, u = 0; if (n.charge = 0, !n.leaf) {
            for (var i, a = n.nodes, o = a.length, l = -1;
            ++l < o;) { i = a[l], null != i && (ru(i, t, e), n.charge += i.charge, r += i.charge * i.cx, u += i.charge * i.cy); }
        } if (n.point) {
            n.leaf || (n.point.x += Math.random() - 0.5, n.point.y += Math.random() - 0.5);
            var c = t * e[n.point.index]; n.charge += n.pointCharge = c, r += c * n.point.x, u += c * n.point.y;
        } n.cx = r / n.charge, n.cy = u / n.charge;
    } function uu(n, t) { return oa.rebind(n, t, "sort", "children", "value"), n.nodes = n, n.links = su, n; } function iu(n, t) {
        for (var e = [n];
        null != (n = e.pop()) ;) { if (t(n), (u = n.children) && (r = u.length)) { for (var r, u; --r >= 0;) { e.push(u[r]); } } }
    } function au(n, t) {
        for (var e = [n], r = [];
        null != (n = e.pop()) ;) {
            if (r.push(n), (i = n.children) && (u = i.length)) {
                for (var u, i, a = -1; ++a < u;) {
                    e.push(i[a]);
                }
            }
        } for (; null != (n = r.pop()) ;) { t(n); }
    } function ou(n) { return n.children; } function lu(n) { return n.value; } function cu(n, t) {
        return t.value - n.value;
    } function su(n) {
        return oa.merge(n.map(function (n) {
            return (n.children || []).map(function (t) {
                return { source: n, target: t };
            });
        }));
    } function fu(n) { return n.x; } function hu(n) { return n.y; } function gu(n, t, e) { n.y0 = t, n.y = e; } function pu(n) {
        return oa.range(n.length);
    } function vu(n) { for (var t = -1, e = n[0].length, r = []; ++t < e;) { r[t] = 0; } return r; } function du(n) {
        for (var t, e = 1, r = 0, u = n[0][1], i = n.length;
        i > e; ++e) { (t = n[e][1]) > u && (r = e, u = t); } return r;
    } function mu(n) { return n.reduce(yu, 0); } function yu(n, t) {
        return n + t[1];
    } function Mu(n, t) { return xu(n, Math.ceil(Math.log(t.length) / Math.LN2 + 1)); } function xu(n, t) {
        for (var e = -1, r = +n[0], u = (n[1] - r) / t, i = [];
        ++e <= t;) { i[e] = u * e + r; } return i;
    } function bu(n) { return [oa.min(n), oa.max(n)]; } function _u(n, t) {
        return n.value - t.value;
    } function wu(n, t) { var e = n._pack_next; n._pack_next = t, t._pack_prev = n, t._pack_next = e, e._pack_prev = t; } function Su(n, t) {
        n._pack_next = t, t._pack_prev = n;
    } function ku(n, t) { var e = t.x - n.x, r = t.y - n.y, u = n.r + t.r; return 0.999 * u * u > e * e + r * r; } function Nu(n) {
        function t(n) {
            s = Math.min(n.x - n.r, s), f = Math.max(n.x + n.r, f), h = Math.min(n.y - n.r, h), g = Math.max(n.y + n.r, g);
        } if ((e = n.children) && (c = e.length)) {
            var e, r, u, i, a, o, l, c, s = 1 / 0, f = -(1 / 0), h = 1 / 0, g = -(1 / 0); if (e.forEach(Eu), r = e[0], r.x = -r.r, r.y = 0, t(r), c > 1 && (u = e[1], u.x = u.r, u.y = 0, t(u), c > 2)) {
                for (i = e[2], zu(r, u, i), t(i), wu(r, i), r._pack_prev = i, wu(i, u), u = r._pack_next, a = 3;
                c > a; a++) {
                    zu(r, u, i = e[a]); var p = 0, v = 1, d = 1; for (o = u._pack_next; o !== u; o = o._pack_next, v++) {
                        if (ku(o, i)) {
                            p = 1;
                            break;
                        }
                    } if (1 == p) { for (l = r._pack_prev; l !== o._pack_prev && !ku(l, i) ; l = l._pack_prev, d++) { } } p ? (d > v || v == d && u.r < r.r ? Su(r, u = o) : Su(r = l, u), a--) : (wu(r, i), u = i, t(i));
                }
            } var m = (s + f) / 2, y = (h + g) / 2, M = 0; for (a = 0; c > a; a++) {
                i = e[a], i.x -= m, i.y -= y, M = Math.max(M, i.r + Math.sqrt(i.x * i.x + i.y * i.y));
            } n.r = M, e.forEach(Au);
        }
    } function Eu(n) { n._pack_next = n._pack_prev = n; } function Au(n) {
        delete n._pack_next, delete n._pack_prev;
    } function Cu(n, t, e, r) {
        var u = n.children; if (n.x = t += r * n.x, n.y = e += r * n.y, n.r *= r, u) {
            for (var i = -1, a = u.length;
            ++i < a;) { Cu(u[i], t, e, r); }
        }
    } function zu(n, t, e) {
        var r = n.r + e.r, u = t.x - n.x, i = t.y - n.y; if (r && (u || i)) {
            var a = t.r + e.r, o = u * u + i * i;
            a *= a, r *= r; var l = 0.5 + (r - a) / (2 * o), c = Math.sqrt(Math.max(0, 2 * a * (r + o) - (r -= o) * r - a * a)) / (2 * o); e.x = n.x + l * u + c * i, e.y = n.y + l * i - c * u;
        } else { e.x = n.x + r, e.y = n.y; }
    } function Lu(n, t) { return n.parent == t.parent ? 1 : 2; } function qu(n) {
        var t = n.children;
        return t.length ? t[0] : n.t;
    } function Tu(n) { var t, e = n.children; return (t = e.length) ? e[t - 1] : n.t; } function Ru(n, t, e) {
        var r = e / (t.i - n.i);
        t.c -= r, t.s += e, n.c += r, t.z += e, t.m += e;
    } function Du(n) {
        for (var t, e = 0, r = 0, u = n.children, i = u.length; --i >= 0;) {
            t = u[i], t.z += e, t.m += e, e += t.s + (r += t.c);
        }
    } function Pu(n, t, e) { return n.a.parent === t.parent ? n.a : e; } function ju(n) {
        return 1 + oa.max(n, function (n) {
            return n.y;
        });
    } function Uu(n) { return n.reduce(function (n, t) { return n + t.x; }, 0) / n.length; } function Fu(n) {
        var t = n.children;
        return t && t.length ? Fu(t[0]) : n;
    } function Hu(n) {
        var t, e = n.children; return e && (t = e.length) ? Hu(e[t - 1]) : n;
    } function Ou(n) { return { x: n.x, y: n.y, dx: n.dx, dy: n.dy }; } function Iu(n, t) {
        var e = n.x + t[3], r = n.y + t[0], u = n.dx - t[1] - t[3], i = n.dy - t[0] - t[2];
        return 0 > u && (e += u / 2, u = 0), 0 > i && (r += i / 2, i = 0), { x: e, y: r, dx: u, dy: i };
    } function Yu(n) {
        var t = n[0], e = n[n.length - 1];
        return e > t ? [t, e] : [e, t];
    } function Zu(n) { return n.rangeExtent ? n.rangeExtent() : Yu(n.range()); } function Vu(n, t, e, r) {
        var u = e(n[0], n[1]), i = r(t[0], t[1]);
        return function (n) { return i(u(n)); };
    } function Xu(n, t) {
        var e, r = 0, u = n.length - 1, i = n[r], a = n[u]; return i > a && (e = r, r = u, u = e, e = i, i = a, a = e), n[r] = t.floor(i), n[u] = t.ceil(a), n;
    } function $u(n) {
        return n ? {
            floor: function (t) { return Math.floor(t / n) * n; }, ceil: function (t) {
                return Math.ceil(t / n) * n;
            }
        } : wl;
    } function Bu(n, t, e, r) {
        var u = [], i = [], a = 0, o = Math.min(n.length, t.length) - 1; for (n[o] < n[0] && (n = n.slice().reverse(), t = t.slice().reverse()) ;
        ++a <= o;) { u.push(e(n[a - 1], n[a])), i.push(r(t[a - 1], t[a])); } return function (t) {
            var e = oa.bisect(n, t, 1, o) - 1;
            return i[e](u[e](t));
        };
    } function Wu(n, t, e, r) {
        function u() {
            var u = Math.min(n.length, t.length) > 2 ? Bu : Vu, l = r ? Wr : Br;
            return a = u(n, t, l, e), o = u(t, n, l, Mr), i;
        } function i(n) { return a(n); } var a, o; return i.invert = function (n) {
            return o(n);
        }, i.domain = function (t) { return arguments.length ? (n = t.map(Number), u()) : n; }, i.range = function (n) {
            return arguments.length ? (t = n, u()) : t;
        }, i.rangeRound = function (n) { return i.range(n).interpolate(jr); }, i.clamp = function (n) {
            return arguments.length ? (r = n, u()) : r;
        }, i.interpolate = function (n) { return arguments.length ? (e = n, u()) : e; }, i.ticks = function (t) {
            return Qu(n, t);
        }, i.tickFormat = function (t, e) { return ni(n, t, e); }, i.nice = function (t) { return Gu(n, t), u(); }, i.copy = function () {
            return Wu(n, t, e, r);
        }, u();
    } function Ju(n, t) { return oa.rebind(n, t, "range", "rangeRound", "interpolate", "clamp"); } function Gu(n, t) {
        return Xu(n, $u(Ku(n, t)[2])), Xu(n, $u(Ku(n, t)[2])), n;
    } function Ku(n, t) {
        null == t && (t = 10); var e = Yu(n), r = e[1] - e[0], u = Math.pow(10, Math.floor(Math.log(r / t) / Math.LN10)), i = t / r * u;
        return 0.15 >= i ? u *= 10 : 0.35 >= i ? u *= 5 : 0.75 >= i && (u *= 2), e[0] = Math.ceil(e[0] / u) * u, e[1] = Math.floor(e[1] / u) * u + 0.5 * u, e[2] = u, e;
    } function Qu(n, t) { return oa.range.apply(oa, Ku(n, t)); } function ni(n, t, e) {
        var r = Ku(n, t); if (e) {
            var u = so.exec(e);
            if (u.shift(), "s" === u[8]) {
                var i = oa.formatPrefix(Math.max(Ma(r[0]), Ma(r[1]))); return u[7] || (u[7] = "." + ti(i.scale(r[2]))), u[8] = "f", e = oa.format(u.join("")), function (n) {
                    return e(i.scale(n)) + i.symbol;
                };
            } u[7] || (u[7] = "." + ei(u[8], r)), e = u.join("");
        } else { e = ",." + ti(r[2]) + "f"; } return oa.format(e);
    } function ti(n) {
        return -Math.floor(Math.log(n) / Math.LN10 + 0.01);
    } function ei(n, t) {
        var e = ti(t[2]); return n in Sl ? Math.abs(e - ti(Math.max(Ma(t[0]), Ma(t[1])))) + +("e" !== n) : e - 2 * ("%" === n);
    } function ri(n, t, e, r) {
        function u(n) { return (e ? Math.log(0 > n ? 0 : n) : -Math.log(n > 0 ? 0 : -n)) / Math.log(t); } function i(n) {
            return e ? Math.pow(t, n) : -Math.pow(t, -n);
        } function a(t) { return n(u(t)); } return a.invert = function (t) { return i(n.invert(t)); }, a.domain = function (t) {
            return arguments.length ? (e = t[0] >= 0, n.domain((r = t.map(Number)).map(u)), a) : r;
        }, a.base = function (e) { return arguments.length ? (t = +e, n.domain(r.map(u)), a) : t; }, a.nice = function () {
            var t = Xu(r.map(u), e ? Math : Nl);
            return n.domain(t), r = t.map(i), a;
        }, a.ticks = function () {
            var n = Yu(r), a = [], o = n[0], l = n[1], c = Math.floor(u(o)), s = Math.ceil(u(l)), f = t % 1 ? 2 : t;
            if (isFinite(s - c)) {
                if (e) { for (; s > c; c++) { for (var h = 1; f > h; h++) { a.push(i(c) * h); } } a.push(i(c)); } else {
                    for (a.push(i(c)) ;
                    c++ < s;) { for (var h = f - 1; h > 0; h--) { a.push(i(c) * h); } }
                } for (c = 0; a[c] < o; c++) { } for (s = a.length; a[s - 1] > l; s--) { } a = a.slice(c, s);
            } return a;
        }, a.tickFormat = function (n, e) {
            if (!arguments.length) { return kl; } arguments.length < 2 ? e = kl : "function" != typeof e && (e = oa.format(e));
            var r = Math.max(1, t * n / a.ticks().length); return function (n) {
                var a = n / i(Math.round(u(n))); return t - 0.5 > a * t && (a *= t), r >= a ? e(n) : "";
            };
        }, a.copy = function () { return ri(n.copy(), t, e, r); }, Ju(a, n);
    } function ui(n, t, e) {
        function r(t) {
            return n(u(t));
        } var u = ii(t), i = ii(1 / t); return r.invert = function (t) { return i(n.invert(t)); }, r.domain = function (t) {
            return arguments.length ? (n.domain((e = t.map(Number)).map(u)), r) : e;
        }, r.ticks = function (n) { return Qu(e, n); }, r.tickFormat = function (n, t) { return ni(e, n, t); }, r.nice = function (n) {
            return r.domain(Gu(e, n));
        }, r.exponent = function (a) { return arguments.length ? (u = ii(t = a), i = ii(1 / t), n.domain(e.map(u)), r) : t; }, r.copy = function () {
            return ui(n.copy(), t, e);
        }, Ju(r, n);
    } function ii(n) { return function (t) { return 0 > t ? -Math.pow(-t, n) : Math.pow(t, n); }; } function ai(n, t) {
        function e(e) {
            return i[((u.get(e) || ("range" === t.t ? u.set(e, n.push(e)) : NaN)) - 1) % i.length];
        } function r(t, e) { return oa.range(n.length).map(function (n) { return t + e * n; }); } var u, i, a; return e.domain = function (r) {
            if (!arguments.length) {
                return n;
            } n = [], u = new c; for (var i, a = -1, o = r.length; ++a < o;) { u.has(i = r[a]) || u.set(i, n.push(i)); } return e[t.t].apply(e, t.a);
        }, e.range = function (n) { return arguments.length ? (i = n, a = 0, t = { t: "range", a: arguments }, e) : i; }, e.rangePoints = function (u, o) {
            arguments.length < 2 && (o = 0);
            var l = u[0], c = u[1], s = n.length < 2 ? (l = (l + c) / 2, 0) : (c - l) / (n.length - 1 + o); return i = r(l + s * o / 2, s), a = 0, t = { t: "rangePoints", a: arguments }, e;
        }, e.rangeRoundPoints = function (u, o) {
            arguments.length < 2 && (o = 0); var l = u[0], c = u[1], s = n.length < 2 ? (l = c = Math.round((l + c) / 2), 0) : (c - l) / (n.length - 1 + o) | 0;
            return i = r(l + Math.round(s * o / 2 + (c - l - (n.length - 1 + o) * s) / 2), s), a = 0, t = { t: "rangeRoundPoints", a: arguments }, e;
        }, e.rangeBands = function (u, o, l) {
            arguments.length < 2 && (o = 0), arguments.length < 3 && (l = o); var c = u[1] < u[0], s = u[c - 0], f = u[1 - c], h = (f - s) / (n.length - o + 2 * l);
            return i = r(s + h * l, h), c && i.reverse(), a = h * (1 - o), t = { t: "rangeBands", a: arguments }, e;
        }, e.rangeRoundBands = function (u, o, l) {
            arguments.length < 2 && (o = 0), arguments.length < 3 && (l = o);
            var c = u[1] < u[0], s = u[c - 0], f = u[1 - c], h = Math.floor((f - s) / (n.length - o + 2 * l)); return i = r(s + Math.round((f - s - (n.length - o) * h) / 2), h), c && i.reverse(), a = Math.round(h * (1 - o)), t = { t: "rangeRoundBands", a: arguments }, e;
        }, e.rangeBand = function () { return a; }, e.rangeExtent = function () { return Yu(t.a[0]); }, e.copy = function () {
            return ai(n, t);
        }, e.domain(n);
    } function oi(n, t) {
        function i() {
            var e = 0, r = t.length; for (o = []; ++e < r;) {
                o[e - 1] = oa.quantile(n, e / r);
            } return a;
        } function a(n) { return isNaN(n = +n) ? void 0 : t[oa.bisect(o, n)]; } var o; return a.domain = function (t) {
            return arguments.length ? (n = t.map(r).filter(u).sort(e), i()) : n;
        }, a.range = function (n) { return arguments.length ? (t = n, i()) : t; }, a.quantiles = function () { return o; }, a.invertExtent = function (e) {
            return e = t.indexOf(e), 0 > e ? [NaN, NaN] : [e > 0 ? o[e - 1] : n[0], e < o.length ? o[e] : n[n.length - 1]];
        }, a.copy = function () { return oi(n, t); }, i();
    } function li(n, t, e) {
        function r(t) {
            return e[Math.max(0, Math.min(a, Math.floor(i * (t - n))))];
        } function u() { return i = e.length / (t - n), a = e.length - 1, r; } var i, a; return r.domain = function (e) {
            return arguments.length ? (n = +e[0], t = +e[e.length - 1], u()) : [n, t];
        }, r.range = function (n) { return arguments.length ? (e = n, u()) : e; }, r.invertExtent = function (t) {
            return t = e.indexOf(t), t = 0 > t ? NaN : t / i + n, [t, t + 1 / i];
        }, r.copy = function () { return li(n, t, e); }, u();
    } function ci(n, t) {
        function e(e) {
            return e >= e ? t[oa.bisect(n, e)] : void 0;
        } return e.domain = function (t) { return arguments.length ? (n = t, e) : n; }, e.range = function (n) {
            return arguments.length ? (t = n, e) : t;
        }, e.invertExtent = function (e) { return e = t.indexOf(e), [n[e - 1], n[e]]; }, e.copy = function () { return ci(n, t); }, e;
    } function si(n) {
        function t(n) { return +n; } return t.invert = t, t.domain = t.range = function (e) {
            return arguments.length ? (n = e.map(t), t) : n;
        }, t.ticks = function (t) { return Qu(n, t); }, t.tickFormat = function (t, e) { return ni(n, t, e); }, t.copy = function () {
            return si(n);
        }, t;
    } function fi() { return 0; } function hi(n) { return n.innerRadius; } function gi(n) {
        return n.outerRadius;
    } function pi(n) { return n.startAngle; } function vi(n) { return n.endAngle; } function di(n) {
        return n && n.padAngle;
    } function mi(n, t, e, r) { return (n - e) * t - (t - r) * n > 0 ? 0 : 1; } function yi(n, t, e, r, u) {
        var i = n[0] - t[0], a = n[1] - t[1], o = (u ? r : -r) / Math.sqrt(i * i + a * a), l = o * a, c = -o * i, s = n[0] + l, f = n[1] + c, h = t[0] + l, g = t[1] + c, p = (s + h) / 2, v = (f + g) / 2, d = h - s, m = g - f, y = d * d + m * m, M = e - r, x = s * g - h * f, b = (0 > m ? -1 : 1) * Math.sqrt(Math.max(0, M * M * y - x * x)), _ = (x * m - d * b) / y, w = (-x * d - m * b) / y, S = (x * m + d * b) / y, k = (-x * d + m * b) / y, N = _ - p, E = w - v, A = S - p, C = k - v;
        return N * N + E * E > A * A + C * C && (_ = S, w = k), [[_ - l, w - c], [_ * e / M, w * e / M]];
    } function Mi(n) {
        function t(t) {
            function a() {
                c.push("M", i(n(s), o));
            } for (var l, c = [], s = [], f = -1, h = t.length, g = En(e), p = En(r) ; ++f < h;) {
                u.call(this, l = t[f], f) ? s.push([+g.call(this, l, f), +p.call(this, l, f)]) : s.length && (a(), s = []);
            } return s.length && a(), c.length ? c.join("") : null;
        } var e = Ce, r = ze, u = zt, i = xi, a = i.key, o = 0.7; return t.x = function (n) {
            return arguments.length ? (e = n, t) : e;
        }, t.y = function (n) { return arguments.length ? (r = n, t) : r; }, t.defined = function (n) {
            return arguments.length ? (u = n, t) : u;
        }, t.interpolate = function (n) {
            return arguments.length ? (a = "function" == typeof n ? i = n : (i = ql.get(n) || xi).key, t) : a;
        }, t.tension = function (n) { return arguments.length ? (o = n, t) : o; }, t;
    } function xi(n) {
        return n.length > 1 ? n.join("L") : n + "Z";
    } function bi(n) { return n.join("L") + "Z"; } function _i(n) {
        for (var t = 0, e = n.length, r = n[0], u = [r[0], ",", r[1]];
        ++t < e;) { u.push("H", (r[0] + (r = n[t])[0]) / 2, "V", r[1]); } return e > 1 && u.push("H", r[0]), u.join("");
    } function wi(n) {
        for (var t = 0, e = n.length, r = n[0], u = [r[0], ",", r[1]];
        ++t < e;) { u.push("V", (r = n[t])[1], "H", r[0]); } return u.join("");
    } function Si(n) {
        for (var t = 0, e = n.length, r = n[0], u = [r[0], ",", r[1]];
        ++t < e;) { u.push("H", (r = n[t])[0], "V", r[1]); } return u.join("");
    } function ki(n, t) {
        return n.length < 4 ? xi(n) : n[1] + Ai(n.slice(1, -1), Ci(n, t));
    } function Ni(n, t) {
        return n.length < 3 ? bi(n) : n[0] + Ai((n.push(n[0]), n), Ci([n[n.length - 2]].concat(n, [n[1]]), t));
    } function Ei(n, t) { return n.length < 3 ? xi(n) : n[0] + Ai(n, Ci(n, t)); } function Ai(n, t) {
        if (t.length < 1 || n.length != t.length && n.length != t.length + 2) {
            return xi(n);
        } var e = n.length != t.length, r = "", u = n[0], i = n[1], a = t[0], o = a, l = 1; if (e && (r += "Q" + (i[0] - 2 * a[0] / 3) + "," + (i[1] - 2 * a[1] / 3) + "," + i[0] + "," + i[1], u = n[1], l = 2), t.length > 1) {
            o = t[1], i = n[l], l++, r += "C" + (u[0] + a[0]) + "," + (u[1] + a[1]) + "," + (i[0] - o[0]) + "," + (i[1] - o[1]) + "," + i[0] + "," + i[1];
            for (var c = 2; c < t.length; c++, l++) { i = n[l], o = t[c], r += "S" + (i[0] - o[0]) + "," + (i[1] - o[1]) + "," + i[0] + "," + i[1]; }
        } if (e) {
            var s = n[l];
            r += "Q" + (i[0] + 2 * o[0] / 3) + "," + (i[1] + 2 * o[1] / 3) + "," + s[0] + "," + s[1];
        } return r;
    } function Ci(n, t) {
        for (var e, r = [], u = (1 - t) / 2, i = n[0], a = n[1], o = 1, l = n.length;
        ++o < l;) { e = i, i = a, a = n[o], r.push([u * (a[0] - e[0]), u * (a[1] - e[1])]); } return r;
    } function zi(n) {
        if (n.length < 3) {
            return xi(n);
        } var t = 1, e = n.length, r = n[0], u = r[0], i = r[1], a = [u, u, u, (r = n[1])[0]], o = [i, i, i, r[1]], l = [u, ",", i, "L", Ri(Dl, a), ",", Ri(Dl, o)];
        for (n.push(n[e - 1]) ; ++t <= e;) { r = n[t], a.shift(), a.push(r[0]), o.shift(), o.push(r[1]), Di(l, a, o); } return n.pop(), l.push("L", r), l.join("");
    } function Li(n) {
        if (n.length < 4) { return xi(n); } for (var t, e = [], r = -1, u = n.length, i = [0], a = [0]; ++r < 3;) {
            t = n[r], i.push(t[0]), a.push(t[1]);
        } for (e.push(Ri(Dl, i) + "," + Ri(Dl, a)), --r; ++r < u;) {
            t = n[r], i.shift(), i.push(t[0]), a.shift(), a.push(t[1]), Di(e, i, a);
        } return e.join("");
    } function qi(n) {
        for (var t, e, r = -1, u = n.length, i = u + 4, a = [], o = []; ++r < 4;) {
            e = n[r % u], a.push(e[0]), o.push(e[1]);
        } for (t = [Ri(Dl, a), ",", Ri(Dl, o)], --r; ++r < i;) {
            e = n[r % u], a.shift(), a.push(e[0]), o.shift(), o.push(e[1]), Di(t, a, o);
        } return t.join("");
    } function Ti(n, t) {
        var e = n.length - 1; if (e) {
            for (var r, u, i = n[0][0], a = n[0][1], o = n[e][0] - i, l = n[e][1] - a, c = -1;
            ++c <= e;) { r = n[c], u = c / e, r[0] = t * r[0] + (1 - t) * (i + u * o), r[1] = t * r[1] + (1 - t) * (a + u * l); }
        } return zi(n);
    } function Ri(n, t) {
        return n[0] * t[0] + n[1] * t[1] + n[2] * t[2] + n[3] * t[3];
    } function Di(n, t, e) {
        n.push("C", Ri(Tl, t), ",", Ri(Tl, e), ",", Ri(Rl, t), ",", Ri(Rl, e), ",", Ri(Dl, t), ",", Ri(Dl, e));
    } function Pi(n, t) { return (t[1] - n[1]) / (t[0] - n[0]); } function ji(n) {
        for (var t = 0, e = n.length - 1, r = [], u = n[0], i = n[1], a = r[0] = Pi(u, i) ;
        ++t < e;) { r[t] = (a + (a = Pi(u = i, i = n[t + 1]))) / 2; } return r[t] = a, r;
    } function Ui(n) {
        for (var t, e, r, u, i = [], a = ji(n), o = -1, l = n.length - 1;
        ++o < l;) {
            t = Pi(n[o], n[o + 1]), Ma(t) < Da ? a[o] = a[o + 1] = 0 : (e = a[o] / t, r = a[o + 1] / t, u = e * e + r * r, u > 9 && (u = 3 * t / Math.sqrt(u), a[o] = u * e, a[o + 1] = u * r));
        } for (o = -1; ++o <= l;) {
            u = (n[Math.min(l, o + 1)][0] - n[Math.max(0, o - 1)][0]) / (6 * (1 + a[o] * a[o])), i.push([u || 0, a[o] * u || 0]);
        } return i;
    } function Fi(n) { return n.length < 3 ? xi(n) : n[0] + Ai(n, Ui(n)); } function Hi(n) {
        for (var t, e, r, u = -1, i = n.length;
        ++u < i;) { t = n[u], e = t[0], r = t[1] - Ha, t[0] = e * Math.cos(r), t[1] = e * Math.sin(r); } return n;
    } function Oi(n) {
        function t(t) {
            function l() {
                v.push("M", o(n(m), f), s, c(n(d.reverse()), f), "Z");
            } for (var h, g, p, v = [], d = [], m = [], y = -1, M = t.length, x = En(e), b = En(u), _ = e === r ? function () { return g; } : En(r), w = u === i ? function () {
            return p;
            } : En(i) ; ++y < M;) {
                a.call(this, h = t[y], y) ? (d.push([g = +x.call(this, h, y), p = +b.call(this, h, y)]), m.push([+_.call(this, h, y), +w.call(this, h, y)])) : d.length && (l(), d = [], m = []);
            } return d.length && l(), v.length ? v.join("") : null;
        } var e = Ce, r = Ce, u = 0, i = ze, a = zt, o = xi, l = o.key, c = o, s = "L", f = 0.7;
        return t.x = function (n) { return arguments.length ? (e = r = n, t) : r; }, t.x0 = function (n) {
            return arguments.length ? (e = n, t) : e;
        }, t.x1 = function (n) { return arguments.length ? (r = n, t) : r; }, t.y = function (n) {
            return arguments.length ? (u = i = n, t) : i;
        }, t.y0 = function (n) { return arguments.length ? (u = n, t) : u; }, t.y1 = function (n) {
            return arguments.length ? (i = n, t) : i;
        }, t.defined = function (n) { return arguments.length ? (a = n, t) : a; }, t.interpolate = function (n) {
            return arguments.length ? (l = "function" == typeof n ? o = n : (o = ql.get(n) || xi).key, c = o.reverse || o, s = o.closed ? "M" : "L", t) : l;
        }, t.tension = function (n) { return arguments.length ? (f = n, t) : f; }, t;
    } function Ii(n) { return n.radius; } function Yi(n) {
        return [n.x, n.y];
    } function Zi(n) {
        return function () {
            var t = n.apply(this, arguments), e = t[0], r = t[1] - Ha; return [e * Math.cos(r), e * Math.sin(r)];
        };
    } function Vi() { return 64; } function Xi() { return "circle"; } function $i(n) {
        var t = Math.sqrt(n / ja); return "M0," + t + "A" + t + "," + t + " 0 1,1 0," + -t + "A" + t + "," + t + " 0 1,1 0," + t + "Z";
    } function Bi(n) {
        return function () {
            var t, e, r; (t = this[n]) && (r = t[e = t.active]) && (r.timer.c = null, r.timer.t = NaN, --t.count ? delete t[e] : delete this[n], t.active += 0.5, r.event && r.event.interrupt.call(this, this.__data__, r.index));
        };
    } function Wi(n, t, e) { return Sa(n, Il), n.namespace = t, n.id = e, n; } function Ji(n, t, e, r) {
        var u = n.id, i = n.namespace;
        return Y(n, "function" == typeof e ? function (n, a, o) { n[i][u].tween.set(t, r(e.call(n, n.__data__, a, o))); } : (e = r(e), function (n) {
            n[i][u].tween.set(t, e);
        }));
    } function Gi(n) { return null == n && (n = ""), function () { this.textContent = n; }; } function Ki(n) {
        return null == n ? "__transition__" : "__transition_" + n + "__";
    } function Qi(n, t, e, r, u) {
        function i(n) { var t = v.delay; return s.t = t + l, n >= t ? a(n - t) : void (s.c = a); } function a(e) {
            var u = p.active, i = p[u];
            i && (i.timer.c = null, i.timer.t = NaN, --p.count, delete p[u], i.event && i.event.interrupt.call(n, n.__data__, i.index));
            for (var a in p) { if (r > +a) { var c = p[a]; c.timer.c = null, c.timer.t = NaN, --p.count, delete p[a]; } } s.c = o, qn(function () {
                return s.c && o(e || 1) && (s.c = null, s.t = NaN), 1;
            }, 0, l), p.active = r, v.event && v.event.start.call(n, n.__data__, t), g = [], v.tween.forEach(function (e, r) {
                (r = r.call(n, n.__data__, t)) && g.push(r);
            }), h = v.ease, f = v.duration;
        } function o(u) {
            for (var i = u / f, a = h(i), o = g.length; o > 0;) { g[--o].call(n, a); } return i >= 1 ? (v.event && v.event.end.call(n, n.__data__, t), --p.count ? delete p[r] : delete n[e], 1) : void 0;
        } var l, s, f, h, g, p = n[e] || (n[e] = { active: 0, count: 0 }), v = p[r]; v || (l = u.time, s = qn(i, 0, l), v = p[r] = { tween: new c, time: l, timer: s, delay: u.delay, duration: u.duration, ease: u.ease, index: t }, u = null, ++p.count);
    } function na(n, t, e) {
        n.attr("transform", function (n) {
            var r = t(n); return "translate(" + (isFinite(r) ? r : e(n)) + ",0)";
        });
    } function ta(n, t, e) {
        n.attr("transform", function (n) {
            var r = t(n); return "translate(0," + (isFinite(r) ? r : e(n)) + ")";
        });
    } function ea(n) { return n.toISOString(); } function ra(n, t, e) {
        function r(t) { return n(t); } function u(n, e) {
            var r = n[1] - n[0], u = r / e, i = oa.bisect(Gl, u);
            return i == Gl.length ? [t.year, Ku(n.map(function (n) { return n / 31536000000; }), e)[2]] : i ? t[u / Gl[i - 1] < Gl[i] / u ? i - 1 : i] : [nc, Ku(n, e)[2]];
        } return r.invert = function (t) { return ua(n.invert(t)); }, r.domain = function (t) {
            return arguments.length ? (n.domain(t), r) : n.domain().map(ua);
        }, r.nice = function (n, t) {
            function e(e) { return !isNaN(e) && !n.range(e, ua(+e + 1), t).length; } var i = r.domain(), a = Yu(i), o = null == n ? u(a, 10) : "number" == typeof n && u(a, n);
            return o && (n = o[0], t = o[1]), r.domain(Xu(i, t > 1 ? {
                floor: function (t) {
                    for (; e(t = n.floor(t)) ;) { t = ua(t - 1); } return t;
                }, ceil: function (t) { for (; e(t = n.ceil(t)) ;) { t = ua(+t + 1); } return t; }
            } : n));
        }, r.ticks = function (n, t) {
            var e = Yu(r.domain()), i = null == n ? u(e, 10) : "number" == typeof n ? u(e, n) : !n.range && [{ range: n }, t];
            return i && (n = i[0], t = i[1]), n.range(e[0], ua(+e[1] + 1), 1 > t ? 1 : t);
        }, r.tickFormat = function () { return e; }, r.copy = function () {
            return ra(n.copy(), t, e);
        }, Ju(r, n);
    } function ua(n) { return new Date(n); } function ia(n) { return JSON.parse(n.responseText); } function aa(n) {
        var t = sa.createRange();
        return t.selectNode(sa.body), t.createContextualFragment(n.responseText);
    } var oa = { version: "3.5.12" }, la = [].slice, ca = function (n) {
        return la.call(n);
    }, sa = this.document; if (sa) {
        try { ca(sa.documentElement.childNodes)[0].nodeType; } catch (fa) {
            ca = function (n) {
                for (var t = n.length, e = new Array(t) ;
                t--;) { e[t] = n[t]; } return e;
            };
        }
    } if (Date.now || (Date.now = function () { return +new Date; }), sa) {
        try {
            sa.createElement("DIV").style.setProperty("opacity", 0, "");
        } catch (ha) {
            var ga = this.Element.prototype, pa = ga.setAttribute, va = ga.setAttributeNS, da = this.CSSStyleDeclaration.prototype, ma = da.setProperty;
            ga.setAttribute = function (n, t) { pa.call(this, n, t + ""); }, ga.setAttributeNS = function (n, t, e) {
                va.call(this, n, t, e + "");
            }, da.setProperty = function (n, t, e) { ma.call(this, n, t + "", e); };
        }
    } oa.ascending = e, oa.descending = function (n, t) {
        return n > t ? -1 : t > n ? 1 : t >= n ? 0 : NaN;
    }, oa.min = function (n, t) {
        var e, r, u = -1, i = n.length; if (1 === arguments.length) {
            for (; ++u < i;) {
                if (null != (r = n[u]) && r >= r) {
                    e = r;
                    break;
                }
            } for (; ++u < i;) { null != (r = n[u]) && e > r && (e = r); }
        } else {
            for (; ++u < i;) {
                if (null != (r = t.call(n, n[u], u)) && r >= r) {
                    e = r;
                    break;
                }
            } for (; ++u < i;) { null != (r = t.call(n, n[u], u)) && e > r && (e = r); }
        } return e;
    }, oa.max = function (n, t) {
        var e, r, u = -1, i = n.length;
        if (1 === arguments.length) {
            for (; ++u < i;) { if (null != (r = n[u]) && r >= r) { e = r; break; } } for (; ++u < i;) {
                null != (r = n[u]) && r > e && (e = r);
            }
        } else {
            for (; ++u < i;) { if (null != (r = t.call(n, n[u], u)) && r >= r) { e = r; break; } } for (; ++u < i;) {
                null != (r = t.call(n, n[u], u)) && r > e && (e = r);
            }
        } return e;
    }, oa.extent = function (n, t) {
        var e, r, u, i = -1, a = n.length; if (1 === arguments.length) {
            for (; ++i < a;) {
                if (null != (r = n[i]) && r >= r) {
                    e = u = r;
                    break;
                }
            } for (; ++i < a;) { null != (r = n[i]) && (e > r && (e = r), r > u && (u = r)); }
        } else {
            for (; ++i < a;) {
                if (null != (r = t.call(n, n[i], i)) && r >= r) {
                    e = u = r;
                    break;
                }
            } for (; ++i < a;) { null != (r = t.call(n, n[i], i)) && (e > r && (e = r), r > u && (u = r)); }
        } return [e, u];
    }, oa.sum = function (n, t) {
        var e, r = 0, i = n.length, a = -1;
        if (1 === arguments.length) { for (; ++a < i;) { u(e = +n[a]) && (r += e); } } else {
            for (; ++a < i;) {
                u(e = +t.call(n, n[a], a)) && (r += e);
            }
        } return r;
    }, oa.mean = function (n, t) {
        var e, i = 0, a = n.length, o = -1, l = a; if (1 === arguments.length) {
            for (; ++o < a;
            ) { u(e = r(n[o])) ? i += e : --l; }
        } else { for (; ++o < a;) { u(e = r(t.call(n, n[o], o))) ? i += e : --l; } } return l ? i / l : void 0;
    }, oa.quantile = function (n, t) {
        var e = (n.length - 1) * t + 1, r = Math.floor(e), u = +n[r - 1], i = e - r;
        return i ? u + i * (n[r] - u) : u;
    }, oa.median = function (n, t) {
        var i, a = [], o = n.length, l = -1; if (1 === arguments.length) {
            for (;
            ++l < o;) { u(i = r(n[l])) && a.push(i); }
        } else { for (; ++l < o;) { u(i = r(t.call(n, n[l], l))) && a.push(i); } } return a.length ? oa.quantile(a.sort(e), 0.5) : void 0;
    }, oa.variance = function (n, t) {
        var e, i, a = n.length, o = 0, l = 0, c = -1, s = 0; if (1 === arguments.length) {
            for (; ++c < a;) {
                u(e = r(n[c])) && (i = e - o, o += i / ++s, l += i * (e - o));
            }
        } else { for (; ++c < a;) { u(e = r(t.call(n, n[c], c))) && (i = e - o, o += i / ++s, l += i * (e - o)); } } return s > 1 ? l / (s - 1) : void 0;
    }, oa.deviation = function () { var n = oa.variance.apply(this, arguments); return n ? Math.sqrt(n) : n; }; var ya = i(e);
    oa.bisectLeft = ya.left, oa.bisect = oa.bisectRight = ya.right, oa.bisector = function (n) {
        return i(1 === n.length ? function (t, r) {
            return e(n(t), r);
        } : n);
    }, oa.shuffle = function (n, t, e) {
        (i = arguments.length) < 3 && (e = n.length, 2 > i && (t = 0)); for (var r, u, i = e - t; i;
        ) { u = Math.random() * i-- | 0, r = n[i + t], n[i + t] = n[u + t], n[u + t] = r; } return n;
    }, oa.permute = function (n, t) {
        for (var e = t.length, r = new Array(e) ;
        e--;) { r[e] = n[t[e]]; } return r;
    }, oa.pairs = function (n) {
        for (var t, e = 0, r = n.length - 1, u = n[0], i = new Array(0 > r ? 0 : r) ;
        r > e;) { i[e] = [t = u, u = n[++e]]; } return i;
    }, oa.zip = function () {
        if (!(r = arguments.length)) { return []; } for (var n = -1, t = oa.min(arguments, a), e = new Array(t) ;
        ++n < t;) { for (var r, u = -1, i = e[n] = new Array(r) ; ++u < r;) { i[u] = arguments[u][n]; } } return e;
    }, oa.transpose = function (n) {
        return oa.zip.apply(oa, n);
    }, oa.keys = function (n) { var t = []; for (var e in n) { t.push(e); } return t; }, oa.values = function (n) {
        var t = []; for (var e in n) {
            t.push(n[e]);
        } return t;
    }, oa.entries = function (n) { var t = []; for (var e in n) { t.push({ key: e, value: n[e] }); } return t; }, oa.merge = function (n) {
        for (var t, e, r, u = n.length, i = -1, a = 0;
        ++i < u;) { a += n[i].length; } for (e = new Array(a) ; --u >= 0;) { for (r = n[u], t = r.length; --t >= 0;) { e[--a] = r[t]; } } return e;
    }; var Ma = Math.abs; oa.range = function (n, t, e) {
        if (arguments.length < 3 && (e = 1, arguments.length < 2 && (t = n, n = 0)), (t - n) / e === 1 / 0) {
            throw new Error("infinite range");
        } var r, u = [], i = o(Ma(e)), a = -1; if (n *= i, t *= i, e *= i, 0 > e) { for (; (r = n + e * ++a) > t;) { u.push(r / i); } } else {
            for (; (r = n + e * ++a) < t;
            ) { u.push(r / i); }
        } return u;
    }, oa.map = function (n, t) {
        var e = new c; if (n instanceof c) {
            n.forEach(function (n, t) {
                e.set(n, t);
            });
        } else {
            if (Array.isArray(n)) {
                var r, u = -1, i = n.length; if (1 === arguments.length) {
                    for (; ++u < i;) {
                        e.set(u, n[u]);
                    }
                } else { for (; ++u < i;) { e.set(t.call(n, r = n[u], u), r); } }
            } else { for (var a in n) { e.set(a, n[a]); } }
        } return e;
    }; var xa = "__proto__", ba = "\x00";
    l(c, {
        has: h, get: function (n) { return this._[s(n)]; }, set: function (n, t) { return this._[s(n)] = t; }, remove: g, keys: p, values: function () {
            var n = [];
            for (var t in this._) { n.push(this._[t]); } return n;
        }, entries: function () {
            var n = []; for (var t in this._) {
                n.push({ key: f(t), value: this._[t] });
            } return n;
        }, size: v, empty: d, forEach: function (n) { for (var t in this._) { n.call(this, f(t), this._[t]); } }
    }), oa.nest = function () {
        function n(t, a, o) {
            if (o >= i.length) {
                return r ? r.call(u, a) : e ? a.sort(e) : a;
            } for (var l, s, f, h, g = -1, p = a.length, v = i[o++], d = new c; ++g < p;) {
                (h = d.get(l = v(s = a[g]))) ? h.push(s) : d.set(l, [s]);
            } return t ? (s = t(), f = function (e, r) { s.set(e, n(t, r, o)); }) : (s = {}, f = function (e, r) { s[e] = n(t, r, o); }), d.forEach(f), s;
        } function t(n, e) {
            if (e >= i.length) { return n; } var r = [], u = a[e++]; return n.forEach(function (n, u) {
                r.push({ key: n, values: t(u, e) });
            }), u ? r.sort(function (n, t) { return u(n.key, t.key); }) : r;
        } var e, r, u = {}, i = [], a = []; return u.map = function (t, e) {
            return n(e, t, 0);
        }, u.entries = function (e) { return t(n(oa.map, e, 0), 0); }, u.key = function (n) { return i.push(n), u; }, u.sortKeys = function (n) {
            return a[i.length - 1] = n, u;
        }, u.sortValues = function (n) { return e = n, u; }, u.rollup = function (n) { return r = n, u; }, u;
    }, oa.set = function (n) {
        var t = new m;
        if (n) { for (var e = 0, r = n.length; r > e; ++e) { t.add(n[e]); } } return t;
    }, l(m, {
        has: h, add: function (n) {
            return this._[s(n += "")] = !0, n;
        }, remove: g, values: p, size: v, empty: d, forEach: function (n) { for (var t in this._) { n.call(this, f(t)); } }
    }), oa.behavior = {}, oa.rebind = function (n, t) {
        for (var e, r = 1, u = arguments.length;
        ++r < u;) { n[e = arguments[r]] = M(n, t, t[e]); } return n;
    }; var _a = ["webkit", "ms", "moz", "Moz", "o", "O"]; oa.dispatch = function () {
        for (var n = new _, t = -1, e = arguments.length;
        ++t < e;) { n[arguments[t]] = w(n); } return n;
    }, _.prototype.on = function (n, t) {
        var e = n.indexOf("."), r = ""; if (e >= 0 && (r = n.slice(e + 1), n = n.slice(0, e)), n) {
            return arguments.length < 2 ? this[n].on(r) : this[n].on(r, t);
        } if (2 === arguments.length) {
            if (null == t) { for (n in this) { this.hasOwnProperty(n) && this[n].on(r, null); } } return this;
        }
    }, oa.event = null, oa.requote = function (n) { return n.replace(wa, "\\$&"); }; var wa = /[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g, Sa = {}.__proto__ ? function (n, t) {
        n.__proto__ = t;
    } : function (n, t) { for (var e in t) { n[e] = t[e]; } }, ka = function (n, t) { return t.querySelector(n); }, Na = function (n, t) {
        return t.querySelectorAll(n);
    }, Ea = function (n, t) {
        var e = n.matches || n[x(n, "matchesSelector")]; return (Ea = function (n, t) {
            return e.call(n, t);
        })(n, t);
    }; "function" == typeof Sizzle && (ka = function (n, t) { return Sizzle(n, t)[0] || null; }, Na = Sizzle, Ea = Sizzle.matchesSelector), oa.selection = function () {
        return oa.select(sa.documentElement);
    }; var Aa = oa.selection.prototype = []; Aa.select = function (n) {
        var t, e, r, u, i = []; n = A(n); for (var a = -1, o = this.length;
        ++a < o;) {
            i.push(t = []), t.parentNode = (r = this[a]).parentNode; for (var l = -1, c = r.length; ++l < c;) {
                (u = r[l]) ? (t.push(e = n.call(u, u.__data__, l, a)), e && "__data__" in u && (e.__data__ = u.__data__)) : t.push(null);
            }
        } return E(i);
    }, Aa.selectAll = function (n) {
        var t, e, r = []; n = C(n); for (var u = -1, i = this.length; ++u < i;) {
            for (var a = this[u], o = -1, l = a.length;
            ++o < l;) { (e = a[o]) && (r.push(t = ca(n.call(e, e.__data__, o, u))), t.parentNode = e); }
        } return E(r);
    }; var Ca = { svg: "http://www.w3.org/2000/svg", xhtml: "http://www.w3.org/1999/xhtml", xlink: "http://www.w3.org/1999/xlink", xml: "http://www.w3.org/XML/1998/namespace", xmlns: "http://www.w3.org/2000/xmlns/" };
    oa.ns = {
        prefix: Ca, qualify: function (n) {
            var t = n.indexOf(":"), e = n; return t >= 0 && "xmlns" !== (e = n.slice(0, t)) && (n = n.slice(t + 1)), Ca.hasOwnProperty(e) ? { space: Ca[e], local: n } : n;
        }
    }, Aa.attr = function (n, t) {
        if (arguments.length < 2) {
            if ("string" == typeof n) {
                var e = this.node(); return n = oa.ns.qualify(n), n.local ? e.getAttributeNS(n.space, n.local) : e.getAttribute(n);
            } for (t in n) { this.each(z(t, n[t])); } return this;
        } return this.each(z(n, t));
    }, Aa.classed = function (n, t) {
        if (arguments.length < 2) {
            if ("string" == typeof n) {
                var e = this.node(), r = (n = T(n)).length, u = -1;
                if (t = e.classList) { for (; ++u < r;) { if (!t.contains(n[u])) { return !1; } } } else {
                    for (t = e.getAttribute("class") ;
                    ++u < r;) { if (!q(n[u]).test(t)) { return !1; } }
                } return !0;
            } for (t in n) { this.each(R(t, n[t])); } return this;
        } return this.each(R(n, t));
    }, Aa.style = function (n, e, r) {
        var u = arguments.length; if (3 > u) {
            if ("string" != typeof n) {
                2 > u && (e = ""); for (r in n) {
                    this.each(P(r, n[r], e));
                } return this;
            } if (2 > u) { var i = this.node(); return t(i).getComputedStyle(i, null).getPropertyValue(n); } r = "";
        } return this.each(P(n, e, r));
    }, Aa.property = function (n, t) {
        if (arguments.length < 2) {
            if ("string" == typeof n) {
                return this.node()[n];
            } for (t in n) { this.each(j(t, n[t])); } return this;
        } return this.each(j(n, t));
    }, Aa.text = function (n) {
        return arguments.length ? this.each("function" == typeof n ? function () {
            var t = n.apply(this, arguments);
            this.textContent = null == t ? "" : t;
        } : null == n ? function () { this.textContent = ""; } : function () {
            this.textContent = n;
        }) : this.node().textContent;
    }, Aa.html = function (n) {
        return arguments.length ? this.each("function" == typeof n ? function () {
            var t = n.apply(this, arguments);
            this.innerHTML = null == t ? "" : t;
        } : null == n ? function () { this.innerHTML = ""; } : function () { this.innerHTML = n; }) : this.node().innerHTML;
    }, Aa.append = function (n) {
        return n = U(n), this.select(function () {
            return this.appendChild(n.apply(this, arguments));
        });
    }, Aa.insert = function (n, t) {
        return n = U(n), t = A(t), this.select(function () {
            return this.insertBefore(n.apply(this, arguments), t.apply(this, arguments) || null);
        });
    }, Aa.remove = function () { return this.each(F); }, Aa.data = function (n, t) {
        function e(n, e) {
            var r, u, i, a = n.length, f = e.length, h = Math.min(a, f), g = new Array(f), p = new Array(f), v = new Array(a);
            if (t) {
                var d, m = new c, y = new Array(a); for (r = -1; ++r < a;) {
                    (u = n[r]) && (m.has(d = t.call(u, u.__data__, r)) ? v[r] = u : m.set(d, u), y[r] = d);
                } for (r = -1; ++r < f;) {
                    (u = m.get(d = t.call(e, i = e[r], r))) ? u !== !0 && (g[r] = u, u.__data__ = i) : p[r] = H(i), m.set(d, !0);
                } for (r = -1; ++r < a;) { r in y && m.get(y[r]) !== !0 && (v[r] = n[r]); }
            } else {
                for (r = -1; ++r < h;) {
                    u = n[r], i = e[r], u ? (u.__data__ = i, g[r] = u) : p[r] = H(i);
                } for (; f > r; ++r) { p[r] = H(e[r]); } for (; a > r; ++r) { v[r] = n[r]; }
            } p.update = g, p.parentNode = g.parentNode = v.parentNode = n.parentNode, o.push(p), l.push(g), s.push(v);
        } var r, u, i = -1, a = this.length; if (!arguments.length) {
            for (n = new Array(a = (r = this[0]).length) ; ++i < a;) {
                (u = r[i]) && (n[i] = u.__data__);
            } return n;
        } var o = Z([]), l = E([]), s = E([]); if ("function" == typeof n) {
            for (; ++i < a;) {
                e(r = this[i], n.call(r, r.parentNode.__data__, i));
            }
        } else { for (; ++i < a;) { e(r = this[i], n); } } return l.enter = function () { return o; }, l.exit = function () {
            return s;
        }, l;
    }, Aa.datum = function (n) {
        return arguments.length ? this.property("__data__", n) : this.property("__data__");
    }, Aa.filter = function (n) {
        var t, e, r, u = []; "function" != typeof n && (n = O(n)); for (var i = 0, a = this.length; a > i; i++) {
            u.push(t = []), t.parentNode = (e = this[i]).parentNode;
            for (var o = 0, l = e.length; l > o; o++) { (r = e[o]) && n.call(r, r.__data__, o, i) && t.push(r); }
        } return E(u);
    }, Aa.order = function () {
        for (var n = -1, t = this.length;
        ++n < t;) {
            for (var e, r = this[n], u = r.length - 1, i = r[u]; --u >= 0;) {
                (e = r[u]) && (i && i !== e.nextSibling && i.parentNode.insertBefore(e, i), i = e);
            }
        } return this;
    }, Aa.sort = function (n) {
        n = I.apply(this, arguments); for (var t = -1, e = this.length; ++t < e;) {
            this[t].sort(n);
        } return this.order();
    }, Aa.each = function (n) {
        return Y(this, function (t, e, r) { n.call(t, t.__data__, e, r); });
    }, Aa.call = function (n) { var t = ca(arguments); return n.apply(t[0] = this, t), this; }, Aa.empty = function () {
        return !this.node();
    }, Aa.node = function () {
        for (var n = 0, t = this.length; t > n; n++) {
            for (var e = this[n], r = 0, u = e.length; u > r; r++) {
                var i = e[r];
                if (i) { return i; }
            }
        } return null;
    }, Aa.size = function () { var n = 0; return Y(this, function () { ++n; }), n; }; var za = [];
    oa.selection.enter = Z, oa.selection.enter.prototype = za, za.append = Aa.append, za.empty = Aa.empty, za.node = Aa.node, za.call = Aa.call, za.size = Aa.size, za.select = function (n) {
        for (var t, e, r, u, i, a = [], o = -1, l = this.length;
        ++o < l;) {
            r = (u = this[o]).update, a.push(t = []), t.parentNode = u.parentNode; for (var c = -1, s = u.length; ++c < s;) {
                (i = u[c]) ? (t.push(r[c] = e = n.call(u.parentNode, i.__data__, c, o)), e.__data__ = i.__data__) : t.push(null);
            }
        } return E(a);
    }, za.insert = function (n, t) {
        return arguments.length < 2 && (t = V(this)), Aa.insert.call(this, n, t);
    }, oa.select = function (t) {
        var e; return "string" == typeof t ? (e = [ka(t, sa)], e.parentNode = sa.documentElement) : (e = [t], e.parentNode = n(t)), E([e]);
    }, oa.selectAll = function (n) {
        var t; return "string" == typeof n ? (t = ca(Na(n, sa)), t.parentNode = sa.documentElement) : (t = ca(n), t.parentNode = null), E([t]);
    }, Aa.on = function (n, t, e) {
        var r = arguments.length; if (3 > r) {
            if ("string" != typeof n) {
                2 > r && (t = !1); for (e in n) {
                    this.each(X(e, n[e], t));
                } return this;
            } if (2 > r) { return (r = this.node()["__on" + n]) && r._; } e = !1;
        } return this.each(X(n, t, e));
    }; var La = oa.map({ mouseenter: "mouseover", mouseleave: "mouseout" });
    sa && La.forEach(function (n) { "on" + n in sa && La.remove(n); }); var qa, Ta = 0; oa.mouse = function (n) {
        return J(n, k());
    }; var Ra = this.navigator && /WebKit/.test(this.navigator.userAgent) ? -1 : 0; oa.touch = function (n, t, e) {
        if (arguments.length < 3 && (e = t, t = k().changedTouches), t) {
            for (var r, u = 0, i = t.length;
            i > u; ++u) { if ((r = t[u]).identifier === e) { return J(n, r); } }
        }
    }, oa.behavior.drag = function () {
        function n() {
            this.on("mousedown.drag", i).on("touchstart.drag", a);
        } function e(n, t, e, i, a) {
            return function () {
                function o() {
                    var n, e, r = t(h, v); r && (n = r[0] - M[0], e = r[1] - M[1], p |= n | e, M = r, g({ type: "drag", x: r[0] + c[0], y: r[1] + c[1], dx: n, dy: e }));
                } function l() { t(h, v) && (m.on(i + d, null).on(a + d, null), y(p), g({ type: "dragend" })); } var c, s = this, f = oa.event.target, h = s.parentNode, g = r.of(s, arguments), p = 0, v = n(), d = ".drag" + (null == v ? "" : "-" + v), m = oa.select(e(f)).on(i + d, o).on(a + d, l), y = W(f), M = t(h, v);
                u ? (c = u.apply(s, arguments), c = [c.x - M[0], c.y - M[1]]) : c = [0, 0], g({ type: "dragstart" });
            };
        } var r = N(n, "drag", "dragstart", "dragend"), u = null, i = e(b, oa.mouse, t, "mousemove", "mouseup"), a = e(G, oa.touch, y, "touchmove", "touchend");
        return n.origin = function (t) { return arguments.length ? (u = t, n) : u; }, oa.rebind(n, r, "on");
    }, oa.touches = function (n, t) {
        return arguments.length < 2 && (t = k().touches), t ? ca(t).map(function (t) {
            var e = J(n, t);
            return e.identifier = t.identifier, e;
        }) : [];
    }; var Da = 0.000001, Pa = Da * Da, ja = Math.PI, Ua = 2 * ja, Fa = Ua - Da, Ha = ja / 2, Oa = ja / 180, Ia = 180 / ja, Ya = Math.SQRT2, Za = 2, Va = 4;
    oa.interpolateZoom = function (n, t) {
        var e, r, u = n[0], i = n[1], a = n[2], o = t[0], l = t[1], c = t[2], s = o - u, f = l - i, h = s * s + f * f;
        if (Pa > h) { r = Math.log(c / a) / Ya, e = function (n) { return [u + n * s, i + n * f, a * Math.exp(Ya * n * r)]; }; } else {
            var g = Math.sqrt(h), p = (c * c - a * a + Va * h) / (2 * a * Za * g), v = (c * c - a * a - Va * h) / (2 * c * Za * g), d = Math.log(Math.sqrt(p * p + 1) - p), m = Math.log(Math.sqrt(v * v + 1) - v);
            r = (m - d) / Ya, e = function (n) {
                var t = n * r, e = rn(d), o = a / (Za * g) * (e * un(Ya * t + d) - en(d)); return [u + o * s, i + o * f, a * e / rn(Ya * t + d)];
            };
        } return e.duration = 1000 * r, e;
    }, oa.behavior.zoom = function () {
        function n(n) {
            n.on(L, f).on($a + ".zoom", g).on("dblclick.zoom", p).on(R, h);
        } function e(n) { return [(n[0] - k.x) / k.k, (n[1] - k.y) / k.k]; } function r(n) {
            return [n[0] * k.k + k.x, n[1] * k.k + k.y];
        } function u(n) { k.k = Math.max(A[0], Math.min(A[1], n)); } function i(n, t) {
            t = r(t), k.x += n[0] - t[0], k.y += n[1] - t[1];
        } function a(t, e, r, a) {
            t.__chart__ = { x: k.x, y: k.y, k: k.k }, u(Math.pow(2, a)), i(d = e, r), t = oa.select(t), C > 0 && (t = t.transition().duration(C)), t.call(n.event);
        } function o() {
            b && b.domain(x.range().map(function (n) { return (n - k.x) / k.k; }).map(x.invert)), w && w.domain(_.range().map(function (n) {
                return (n - k.y) / k.k;
            }).map(_.invert));
        } function l(n) { z++ || n({ type: "zoomstart" }); } function c(n) {
            o(), n({ type: "zoom", scale: k.k, translate: [k.x, k.y] });
        } function s(n) { --z || (n({ type: "zoomend" }), d = null); } function f() {
            function n() {
                o = 1, i(oa.mouse(u), h), c(a);
            } function r() { f.on(q, null).on(T, null), g(o), s(a); } var u = this, a = D.of(u, arguments), o = 0, f = oa.select(t(u)).on(q, n).on(T, r), h = e(oa.mouse(u)), g = W(u);
            Ol.call(u), l(a);
        } function h() {
            function n() {
                var n = oa.touches(p); return g = k.k, n.forEach(function (n) {
                    n.identifier in d && (d[n.identifier] = e(n));
                }), n;
            } function t() {
                var t = oa.event.target; oa.select(t).on(x, r).on(b, o), _.push(t); for (var e = oa.event.changedTouches, u = 0, i = e.length;
                i > u; ++u) { d[e[u].identifier] = null; } var l = n(), c = Date.now(); if (1 === l.length) {
                    if (500 > c - M) {
                        var s = l[0]; a(p, s, d[s.identifier], Math.floor(Math.log(k.k) / Math.LN2) + 1), S();
                    } M = c;
                } else { if (l.length > 1) { var s = l[0], f = l[1], h = s[0] - f[0], g = s[1] - f[1]; m = h * h + g * g; } }
            } function r() {
                var n, t, e, r, a = oa.touches(p);
                Ol.call(p); for (var o = 0, l = a.length; l > o; ++o, r = null) { if (e = a[o], r = d[e.identifier]) { if (t) { break; } n = e, t = r; } } if (r) {
                    var s = (s = e[0] - n[0]) * s + (s = e[1] - n[1]) * s, f = m && Math.sqrt(s / m);
                    n = [(n[0] + e[0]) / 2, (n[1] + e[1]) / 2], t = [(t[0] + r[0]) / 2, (t[1] + r[1]) / 2], u(f * g);
                } M = null, i(n, t), c(v);
            } function o() {
                if (oa.event.touches.length) {
                    for (var t = oa.event.changedTouches, e = 0, r = t.length;
                    r > e; ++e) { delete d[t[e].identifier]; } for (var u in d) { return void n(); }
                } oa.selectAll(_).on(y, null), w.on(L, f).on(R, h), N(), s(v);
            } var g, p = this, v = D.of(p, arguments), d = {}, m = 0, y = ".zoom-" + oa.event.changedTouches[0].identifier, x = "touchmove" + y, b = "touchend" + y, _ = [], w = oa.select(p), N = W(p);
            t(), l(v), w.on(L, null).on(R, t);
        } function g() {
            var n = D.of(this, arguments); y ? clearTimeout(y) : (Ol.call(this), v = e(d = m || oa.mouse(this)), l(n)), y = setTimeout(function () {
                y = null, s(n);
            }, 50), S(), u(Math.pow(2, 0.002 * Xa()) * k.k), i(d, v), c(n);
        } function p() {
            var n = oa.mouse(this), t = Math.log(k.k) / Math.LN2;
            a(this, n, e(n), oa.event.shiftKey ? Math.ceil(t) - 1 : Math.floor(t) + 1);
        } var v, d, m, y, M, x, b, _, w, k = { x: 0, y: 0, k: 1 }, E = [960, 500], A = Ba, C = 250, z = 0, L = "mousedown.zoom", q = "mousemove.zoom", T = "mouseup.zoom", R = "touchstart.zoom", D = N(n, "zoomstart", "zoom", "zoomend");
        return $a || ($a = "onwheel" in sa ? (Xa = function () { return -oa.event.deltaY * (oa.event.deltaMode ? 120 : 1); }, "wheel") : "onmousewheel" in sa ? (Xa = function () {
            return oa.event.wheelDelta;
        }, "mousewheel") : (Xa = function () { return -oa.event.detail; }, "MozMousePixelScroll")), n.event = function (n) {
            n.each(function () {
                var n = D.of(this, arguments), t = k;
                Fl ? oa.select(this).transition().each("start.zoom", function () { k = this.__chart__ || { x: 0, y: 0, k: 1 }, l(n); }).tween("zoom:zoom", function () {
                    var e = E[0], r = E[1], u = d ? d[0] : e / 2, i = d ? d[1] : r / 2, a = oa.interpolateZoom([(u - k.x) / k.k, (i - k.y) / k.k, e / k.k], [(u - t.x) / t.k, (i - t.y) / t.k, e / t.k]);
                    return function (t) { var r = a(t), o = e / r[2]; this.__chart__ = k = { x: u - r[0] * o, y: i - r[1] * o, k: o }, c(n); };
                }).each("interrupt.zoom", function () {
                    s(n);
                }).each("end.zoom", function () { s(n); }) : (this.__chart__ = k, l(n), c(n), s(n));
            });
        }, n.translate = function (t) {
            return arguments.length ? (k = { x: +t[0], y: +t[1], k: k.k }, o(), n) : [k.x, k.y];
        }, n.scale = function (t) { return arguments.length ? (k = { x: k.x, y: k.y, k: null }, u(+t), o(), n) : k.k; }, n.scaleExtent = function (t) {
            return arguments.length ? (A = null == t ? Ba : [+t[0], +t[1]], n) : A;
        }, n.center = function (t) { return arguments.length ? (m = t && [+t[0], +t[1]], n) : m; }, n.size = function (t) {
            return arguments.length ? (E = t && [+t[0], +t[1]], n) : E;
        }, n.duration = function (t) { return arguments.length ? (C = +t, n) : C; }, n.x = function (t) {
            return arguments.length ? (b = t, x = t.copy(), k = { x: 0, y: 0, k: 1 }, n) : b;
        }, n.y = function (t) { return arguments.length ? (w = t, _ = t.copy(), k = { x: 0, y: 0, k: 1 }, n) : w; }, oa.rebind(n, D, "on");
    }; var Xa, $a, Ba = [0, 1 / 0]; oa.color = on, on.prototype.toString = function () { return this.rgb() + ""; }, oa.hsl = ln;
    var Wa = ln.prototype = new on; Wa.brighter = function (n) {
        return n = Math.pow(0.7, arguments.length ? n : 1), new ln(this.h, this.s, this.l / n);
    }, Wa.darker = function (n) { return n = Math.pow(0.7, arguments.length ? n : 1), new ln(this.h, this.s, n * this.l); }, Wa.rgb = function () {
        return cn(this.h, this.s, this.l);
    }, oa.hcl = sn; var Ja = sn.prototype = new on; Ja.brighter = function (n) {
        return new sn(this.h, this.c, Math.min(100, this.l + Ga * (arguments.length ? n : 1)));
    }, Ja.darker = function (n) { return new sn(this.h, this.c, Math.max(0, this.l - Ga * (arguments.length ? n : 1))); }, Ja.rgb = function () {
        return fn(this.h, this.c, this.l).rgb();
    }, oa.lab = hn; var Ga = 18, Ka = 0.95047, Qa = 1, no = 1.08883, to = hn.prototype = new on; to.brighter = function (n) {
        return new hn(Math.min(100, this.l + Ga * (arguments.length ? n : 1)), this.a, this.b);
    }, to.darker = function (n) { return new hn(Math.max(0, this.l - Ga * (arguments.length ? n : 1)), this.a, this.b); }, to.rgb = function () {
        return gn(this.l, this.a, this.b);
    }, oa.rgb = yn; var eo = yn.prototype = new on; eo.brighter = function (n) {
        n = Math.pow(0.7, arguments.length ? n : 1); var t = this.r, e = this.g, r = this.b, u = 30;
        return t || e || r ? (t && u > t && (t = u), e && u > e && (e = u), r && u > r && (r = u), new yn(Math.min(255, t / n), Math.min(255, e / n), Math.min(255, r / n))) : new yn(u, u, u);
    }, eo.darker = function (n) {
        return n = Math.pow(0.7, arguments.length ? n : 1), new yn(n * this.r, n * this.g, n * this.b);
    }, eo.hsl = function () { return wn(this.r, this.g, this.b); }, eo.toString = function () {
        return "#" + bn(this.r) + bn(this.g) + bn(this.b);
    }; var ro = oa.map({ aliceblue: 15792383, antiquewhite: 16444375, aqua: 65535, aquamarine: 8388564, azure: 15794175, beige: 16119260, bisque: 16770244, black: 0, blanchedalmond: 16772045, blue: 255, blueviolet: 9055202, brown: 10824234, burlywood: 14596231, cadetblue: 6266528, chartreuse: 8388352, chocolate: 13789470, coral: 16744272, cornflowerblue: 6591981, cornsilk: 16775388, crimson: 14423100, cyan: 65535, darkblue: 139, darkcyan: 35723, darkgoldenrod: 12092939, darkgray: 11119017, darkgreen: 25600, darkgrey: 11119017, darkkhaki: 12433259, darkmagenta: 9109643, darkolivegreen: 5597999, darkorange: 16747520, darkorchid: 10040012, darkred: 9109504, darksalmon: 15308410, darkseagreen: 9419919, darkslateblue: 4734347, darkslategray: 3100495, darkslategrey: 3100495, darkturquoise: 52945, darkviolet: 9699539, deeppink: 16716947, deepskyblue: 49151, dimgray: 6908265, dimgrey: 6908265, dodgerblue: 2003199, firebrick: 11674146, floralwhite: 16775920, forestgreen: 2263842, fuchsia: 16711935, gainsboro: 14474460, ghostwhite: 16316671, gold: 16766720, goldenrod: 14329120, gray: 8421504, green: 32768, greenyellow: 11403055, grey: 8421504, honeydew: 15794160, hotpink: 16738740, indianred: 13458524, indigo: 4915330, ivory: 16777200, khaki: 15787660, lavender: 15132410, lavenderblush: 16773365, lawngreen: 8190976, lemonchiffon: 16775885, lightblue: 11393254, lightcoral: 15761536, lightcyan: 14745599, lightgoldenrodyellow: 16448210, lightgray: 13882323, lightgreen: 9498256, lightgrey: 13882323, lightpink: 16758465, lightsalmon: 16752762, lightseagreen: 2142890, lightskyblue: 8900346, lightslategray: 7833753, lightslategrey: 7833753, lightsteelblue: 11584734, lightyellow: 16777184, lime: 65280, limegreen: 3329330, linen: 16445670, magenta: 16711935, maroon: 8388608, mediumaquamarine: 6737322, mediumblue: 205, mediumorchid: 12211667, mediumpurple: 9662683, mediumseagreen: 3978097, mediumslateblue: 8087790, mediumspringgreen: 64154, mediumturquoise: 4772300, mediumvioletred: 13047173, midnightblue: 1644912, mintcream: 16121850, mistyrose: 16770273, moccasin: 16770229, navajowhite: 16768685, navy: 128, oldlace: 16643558, olive: 8421376, olivedrab: 7048739, orange: 16753920, orangered: 16729344, orchid: 14315734, palegoldenrod: 15657130, palegreen: 10025880, paleturquoise: 11529966, palevioletred: 14381203, papayawhip: 16773077, peachpuff: 16767673, peru: 13468991, pink: 16761035, plum: 14524637, powderblue: 11591910, purple: 8388736, rebeccapurple: 6697881, red: 16711680, rosybrown: 12357519, royalblue: 4286945, saddlebrown: 9127187, salmon: 16416882, sandybrown: 16032864, seagreen: 3050327, seashell: 16774638, sienna: 10506797, silver: 12632256, skyblue: 8900331, slateblue: 6970061, slategray: 7372944, slategrey: 7372944, snow: 16775930, springgreen: 65407, steelblue: 4620980, tan: 13808780, teal: 32896, thistle: 14204888, tomato: 16737095, turquoise: 4251856, violet: 15631086, wheat: 16113331, white: 16777215, whitesmoke: 16119285, yellow: 16776960, yellowgreen: 10145074 });
    ro.forEach(function (n, t) { ro.set(n, Mn(t)); }), oa.functor = En, oa.xhr = An(y), oa.dsv = function (n, t) {
        function e(n, e, i) {
            arguments.length < 3 && (i = e, e = null);
            var a = Cn(n, t, null == e ? r : u(e), i); return a.row = function (n) {
                return arguments.length ? a.response(null == (e = n) ? r : u(n)) : e;
            }, a;
        } function r(n) { return e.parse(n.responseText); } function u(n) {
            return function (t) {
                return e.parse(t.responseText, n);
            };
        } function i(t) { return t.map(a).join(n); } function a(n) {
            return o.test(n) ? '"' + n.replace(/\"/g, '""') + '"' : n;
        } var o = new RegExp('["' + n + "\n]"), l = n.charCodeAt(0); return e.parse = function (n, t) {
            var r; return e.parseRows(n, function (n, e) {
                if (r) {
                    return r(n, e - 1);
                } var u = new Function("d", "return {" + n.map(function (n, t) { return JSON.stringify(n) + ": d[" + t + "]"; }).join(",") + "}");
                r = t ? function (n, e) { return t(u(n), e); } : u;
            });
        }, e.parseRows = function (n, t) {
            function e() {
                if (s >= c) {
                    return a;
                } if (u) { return u = !1, i; } var t = s; if (34 === n.charCodeAt(t)) {
                    for (var e = t; e++ < c;) {
                        if (34 === n.charCodeAt(e)) {
                            if (34 !== n.charCodeAt(e + 1)) {
                                break;
                            } ++e;
                        }
                    } s = e + 2; var r = n.charCodeAt(e + 1); return 13 === r ? (u = !0, 10 === n.charCodeAt(e + 2) && ++s) : 10 === r && (u = !0), n.slice(t + 1, e).replace(/""/g, '"');
                } for (; c > s;) {
                    var r = n.charCodeAt(s++), o = 1; if (10 === r) { u = !0; } else {
                        if (13 === r) {
                            u = !0, 10 === n.charCodeAt(s) && (++s, ++o);
                        } else { if (r !== l) { continue; } }
                    } return n.slice(t, s - o);
                } return n.slice(t);
            } for (var r, u, i = {}, a = {}, o = [], c = n.length, s = 0, f = 0;
            (r = e()) !== a;) { for (var h = []; r !== i && r !== a;) { h.push(r), r = e(); } t && null == (h = t(h, f++)) || o.push(h); } return o;
        }, e.format = function (t) {
            if (Array.isArray(t[0])) { return e.formatRows(t); } var r = new m, u = []; return t.forEach(function (n) {
                for (var t in n) {
                    r.has(t) || u.push(r.add(t));
                }
            }), [u.map(a).join(n)].concat(t.map(function (t) { return u.map(function (n) { return a(t[n]); }).join(n); })).join("\n");
        }, e.formatRows = function (n) { return n.map(i).join("\n"); }, e;
    }, oa.csv = oa.dsv(",", "text/csv"), oa.tsv = oa.dsv("	", "text/tab-separated-values");
    var uo, io, ao, oo, lo = this[x(this, "requestAnimationFrame")] || function (n) { setTimeout(n, 17); }; oa.timer = function () {
        qn.apply(this, arguments);
    }, oa.timer.flush = function () { Rn(), Dn(); }, oa.round = function (n, t) {
        return t ? Math.round(n * (t = Math.pow(10, t))) / t : Math.round(n);
    }; var co = ["y", "z", "a", "f", "p", "n", "\xb5", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y"].map(jn); oa.formatPrefix = function (n, t) {
        var e = 0;
        return (n = +n) && (0 > n && (n *= -1), t && (n = oa.round(n, Pn(n, t))), e = 1 + Math.floor(1e-12 + Math.log(n) / Math.LN10), e = Math.max(-24, Math.min(24, 3 * Math.floor((e - 1) / 3)))), co[8 + e / 3];
    }; var so = /(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i, fo = oa.map({
        b: function (n) {
            return n.toString(2);
        }, c: function (n) { return String.fromCharCode(n); }, o: function (n) { return n.toString(8); }, x: function (n) {
            return n.toString(16);
        }, X: function (n) { return n.toString(16).toUpperCase(); }, g: function (n, t) { return n.toPrecision(t); }, e: function (n, t) {
            return n.toExponential(t);
        }, f: function (n, t) { return n.toFixed(t); }, r: function (n, t) {
            return (n = oa.round(n, Pn(n, t))).toFixed(Math.max(0, Math.min(20, Pn(n * (1 + 1e-15), t))));
        }
    }), ho = oa.time = {}, go = Date; Hn.prototype = {
        getDate: function () { return this._.getUTCDate(); }, getDay: function () {
            return this._.getUTCDay();
        }, getFullYear: function () { return this._.getUTCFullYear(); }, getHours: function () {
            return this._.getUTCHours();
        }, getMilliseconds: function () { return this._.getUTCMilliseconds(); }, getMinutes: function () {
            return this._.getUTCMinutes();
        }, getMonth: function () { return this._.getUTCMonth(); }, getSeconds: function () {
            return this._.getUTCSeconds();
        }, getTime: function () { return this._.getTime(); }, getTimezoneOffset: function () { return 0; }, valueOf: function () {
            return this._.valueOf();
        }, setDate: function () { po.setUTCDate.apply(this._, arguments); }, setDay: function () {
            po.setUTCDay.apply(this._, arguments);
        }, setFullYear: function () { po.setUTCFullYear.apply(this._, arguments); }, setHours: function () {
            po.setUTCHours.apply(this._, arguments);
        }, setMilliseconds: function () { po.setUTCMilliseconds.apply(this._, arguments); }, setMinutes: function () {
            po.setUTCMinutes.apply(this._, arguments);
        }, setMonth: function () { po.setUTCMonth.apply(this._, arguments); }, setSeconds: function () {
            po.setUTCSeconds.apply(this._, arguments);
        }, setTime: function () { po.setTime.apply(this._, arguments); }
    }; var po = Date.prototype; ho.year = On(function (n) {
        return n = ho.day(n), n.setMonth(0, 1), n;
    }, function (n, t) { n.setFullYear(n.getFullYear() + t); }, function (n) { return n.getFullYear(); }), ho.years = ho.year.range, ho.years.utc = ho.year.utc.range, ho.day = On(function (n) {
        var t = new go(2000, 0);
        return t.setFullYear(n.getFullYear(), n.getMonth(), n.getDate()), t;
    }, function (n, t) {
        n.setDate(n.getDate() + t);
    }, function (n) { return n.getDate() - 1; }), ho.days = ho.day.range, ho.days.utc = ho.day.utc.range, ho.dayOfYear = function (n) {
        var t = ho.year(n);
        return Math.floor((n - t - 60000 * (n.getTimezoneOffset() - t.getTimezoneOffset())) / 86400000);
    }, ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"].forEach(function (n, t) {
        t = 7 - t;
        var e = ho[n] = On(function (n) { return (n = ho.day(n)).setDate(n.getDate() - (n.getDay() + t) % 7), n; }, function (n, t) {
            n.setDate(n.getDate() + 7 * Math.floor(t));
        }, function (n) { var e = ho.year(n).getDay(); return Math.floor((ho.dayOfYear(n) + (e + t) % 7) / 7) - (e !== t); }); ho[n + "s"] = e.range, ho[n + "s"].utc = e.utc.range, ho[n + "OfYear"] = function (n) {
            var e = ho.year(n).getDay();
            return Math.floor((ho.dayOfYear(n) + (e + t) % 7) / 7);
        };
    }), ho.week = ho.sunday, ho.weeks = ho.sunday.range, ho.weeks.utc = ho.sunday.utc.range, ho.weekOfYear = ho.sundayOfYear;
    var vo = { "-": "", _: " ", 0: "0" }, mo = /^\s*\d+/, yo = /^%/; oa.locale = function (n) {
        return { numberFormat: Un(n), timeFormat: Yn(n) };
    }; var Mo = oa.locale({ decimal: ".", thousands: ",", grouping: [3], currency: ["$", ""], dateTime: "%a %b %e %X %Y", date: "%m/%d/%Y", time: "%H:%M:%S", periods: ["AM", "PM"], days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] });
    oa.format = Mo.numberFormat, oa.geo = {}, st.prototype = {
        s: 0, t: 0, add: function (n) {
            ft(n, this.t, xo), ft(xo.s, this.s, this), this.s ? this.t += xo.t : this.s = xo.t;
        }, reset: function () { this.s = this.t = 0; }, valueOf: function () { return this.s; }
    }; var xo = new st; oa.geo.stream = function (n, t) {
        n && bo.hasOwnProperty(n.type) ? bo[n.type](n, t) : ht(n, t);
    }; var bo = {
        Feature: function (n, t) { ht(n.geometry, t); }, FeatureCollection: function (n, t) {
            for (var e = n.features, r = -1, u = e.length;
            ++r < u;) { ht(e[r].geometry, t); }
        }
    }, _o = {
        Sphere: function (n, t) { t.sphere(); }, Point: function (n, t) {
            n = n.coordinates, t.point(n[0], n[1], n[2]);
        }, MultiPoint: function (n, t) {
            for (var e = n.coordinates, r = -1, u = e.length; ++r < u;) {
                n = e[r], t.point(n[0], n[1], n[2]);
            }
        }, LineString: function (n, t) { gt(n.coordinates, t, 0); }, MultiLineString: function (n, t) {
            for (var e = n.coordinates, r = -1, u = e.length;
            ++r < u;) { gt(e[r], t, 0); }
        }, Polygon: function (n, t) { pt(n.coordinates, t); }, MultiPolygon: function (n, t) {
            for (var e = n.coordinates, r = -1, u = e.length;
            ++r < u;) { pt(e[r], t); }
        }, GeometryCollection: function (n, t) {
            for (var e = n.geometries, r = -1, u = e.length; ++r < u;) {
                ht(e[r], t);
            }
        }
    }; oa.geo.area = function (n) { return wo = 0, oa.geo.stream(n, ko), wo; }; var wo, So = new st, ko = {
        sphere: function () {
            wo += 4 * ja;
        }, point: b, lineStart: b, lineEnd: b, polygonStart: function () { So.reset(), ko.lineStart = vt; }, polygonEnd: function () {
            var n = 2 * So;
            wo += 0 > n ? 4 * ja + n : n, ko.lineStart = ko.lineEnd = ko.point = b;
        }
    }; oa.geo.bounds = function () {
        function n(n, t) {
            M.push(x = [s = n, h = n]), f > t && (f = t), t > g && (g = t);
        } function t(t, e) {
            var r = dt([t * Oa, e * Oa]); if (m) {
                var u = yt(m, r), i = [u[1], -u[0], 0], a = yt(i, u); bt(a), a = _t(a); var l = t - p, c = l > 0 ? 1 : -1, v = a[0] * Ia * c, d = Ma(l) > 180;
                if (d ^ (v > c * p && c * t > v)) { var y = a[1] * Ia; y > g && (g = y); } else {
                    if (v = (v + 360) % 360 - 180, d ^ (v > c * p && c * t > v)) {
                        var y = -a[1] * Ia;
                        f > y && (f = y);
                    } else { f > e && (f = e), e > g && (g = e); }
                } d ? p > t ? o(s, t) > o(s, h) && (h = t) : o(t, h) > o(s, h) && (s = t) : h >= s ? (s > t && (s = t), t > h && (h = t)) : t > p ? o(s, t) > o(s, h) && (h = t) : o(t, h) > o(s, h) && (s = t);
            } else { n(t, e); } m = r, p = t;
        } function e() { b.point = t; } function r() { x[0] = s, x[1] = h, b.point = n, m = null; } function u(n, e) {
            if (m) {
                var r = n - p;
                y += Ma(r) > 180 ? r + (r > 0 ? 360 : -360) : r;
            } else { v = n, d = e; } ko.point(n, e), t(n, e);
        } function i() { ko.lineStart(); } function a() {
            u(v, d), ko.lineEnd(), Ma(y) > Da && (s = -(h = 180)), x[0] = s, x[1] = h, m = null;
        } function o(n, t) { return (t -= n) < 0 ? t + 360 : t; } function l(n, t) { return n[0] - t[0]; } function c(n, t) {
            return t[0] <= t[1] ? t[0] <= n && n <= t[1] : n < t[0] || t[1] < n;
        } var s, f, h, g, p, v, d, m, y, M, x, b = {
            point: n, lineStart: e, lineEnd: r, polygonStart: function () {
                b.point = u, b.lineStart = i, b.lineEnd = a, y = 0, ko.polygonStart();
            }, polygonEnd: function () {
                ko.polygonEnd(), b.point = n, b.lineStart = e, b.lineEnd = r, 0 > So ? (s = -(h = 180), f = -(g = 90)) : y > Da ? g = 90 : -Da > y && (f = -90), x[0] = s, x[1] = h;
            }
        }; return function (n) {
            g = h = -(s = f = 1 / 0), M = [], oa.geo.stream(n, b); var t = M.length; if (t) {
                M.sort(l); for (var e, r = 1, u = M[0], i = [u];
                t > r; ++r) {
                    e = M[r], c(e[0], u) || c(e[1], u) ? (o(u[0], e[1]) > o(u[0], u[1]) && (u[1] = e[1]), o(e[0], u[1]) > o(u[0], u[1]) && (u[0] = e[0])) : i.push(u = e);
                } for (var a, e, p = -(1 / 0), t = i.length - 1, r = 0, u = i[t]; t >= r; u = e, ++r) {
                    e = i[r], (a = o(u[1], e[0])) > p && (p = a, s = e[0], h = u[1]);
                }
            } return M = x = null, s === 1 / 0 || f === 1 / 0 ? [[NaN, NaN], [NaN, NaN]] : [[s, f], [h, g]];
        };
    }(), oa.geo.centroid = function (n) {
        No = Eo = Ao = Co = zo = Lo = qo = To = Ro = Do = Po = 0, oa.geo.stream(n, jo);
        var t = Ro, e = Do, r = Po, u = t * t + e * e + r * r; return Pa > u && (t = Lo, e = qo, r = To, Da > Eo && (t = Ao, e = Co, r = zo), u = t * t + e * e + r * r, Pa > u) ? [NaN, NaN] : [Math.atan2(e, t) * Ia, tn(r / Math.sqrt(u)) * Ia];
    }; var No, Eo, Ao, Co, zo, Lo, qo, To, Ro, Do, Po, jo = {
        sphere: b, point: St, lineStart: Nt, lineEnd: Et, polygonStart: function () {
            jo.lineStart = At;
        }, polygonEnd: function () { jo.lineStart = Nt; }
    }, Uo = Rt(zt, Ut, Ht, [-ja, -ja / 2]), Fo = 1000000000; oa.geo.clipExtent = function () {
        var n, t, e, r, u, i, a = {
            stream: function (n) {
                return u && (u.valid = !1), u = i(n), u.valid = !0, u;
            }, extent: function (o) {
                return arguments.length ? (i = Zt(n = +o[0][0], t = +o[0][1], e = +o[1][0], r = +o[1][1]), u && (u.valid = !1, u = null), a) : [[n, t], [e, r]];
            }
        }; return a.extent([[0, 0], [960, 500]]);
    }, (oa.geo.conicEqualArea = function () { return Vt(Xt); }).raw = Xt, oa.geo.albers = function () {
        return oa.geo.conicEqualArea().rotate([96, 0]).center([-0.6, 38.7]).parallels([29.5, 45.5]).scale(1070);
    }, oa.geo.albersUsa = function () {
        function n(n) {
            var i = n[0], a = n[1]; return t = null, e(i, a), t || (r(i, a), t) || u(i, a), t;
        } var t, e, r, u, i = oa.geo.albers(), a = oa.geo.conicEqualArea().rotate([154, 0]).center([-2, 58.5]).parallels([55, 65]), o = oa.geo.conicEqualArea().rotate([157, 0]).center([-3, 19.9]).parallels([8, 18]), l = {
            point: function (n, e) {
                t = [n, e];
            }
        }; return n.invert = function (n) {
            var t = i.scale(), e = i.translate(), r = (n[0] - e[0]) / t, u = (n[1] - e[1]) / t; return (u >= 0.12 && 0.234 > u && r >= -0.425 && -0.214 > r ? a : u >= 0.166 && 0.234 > u && r >= -0.214 && -0.115 > r ? o : i).invert(n);
        }, n.stream = function (n) {
            var t = i.stream(n), e = a.stream(n), r = o.stream(n); return {
                point: function (n, u) {
                    t.point(n, u), e.point(n, u), r.point(n, u);
                }, sphere: function () { t.sphere(), e.sphere(), r.sphere(); }, lineStart: function () {
                    t.lineStart(), e.lineStart(), r.lineStart();
                }, lineEnd: function () { t.lineEnd(), e.lineEnd(), r.lineEnd(); }, polygonStart: function () {
                    t.polygonStart(), e.polygonStart(), r.polygonStart();
                }, polygonEnd: function () { t.polygonEnd(), e.polygonEnd(), r.polygonEnd(); }
            };
        }, n.precision = function (t) {
            return arguments.length ? (i.precision(t), a.precision(t), o.precision(t), n) : i.precision();
        }, n.scale = function (t) {
            return arguments.length ? (i.scale(t), a.scale(0.35 * t), o.scale(t), n.translate(i.translate())) : i.scale();
        }, n.translate = function (t) {
            if (!arguments.length) { return i.translate(); } var c = i.scale(), s = +t[0], f = +t[1];
            return e = i.translate(t).clipExtent([[s - 0.455 * c, f - 0.238 * c], [s + 0.455 * c, f + 0.238 * c]]).stream(l).point, r = a.translate([s - 0.307 * c, f + 0.201 * c]).clipExtent([[s - 0.425 * c + Da, f + 0.12 * c + Da], [s - 0.214 * c - Da, f + 0.234 * c - Da]]).stream(l).point, u = o.translate([s - 0.205 * c, f + 0.212 * c]).clipExtent([[s - 0.214 * c + Da, f + 0.166 * c + Da], [s - 0.115 * c - Da, f + 0.234 * c - Da]]).stream(l).point, n;
        }, n.scale(1070);
    }; var Ho, Oo, Io, Yo, Zo, Vo, Xo = {
        point: b, lineStart: b, lineEnd: b, polygonStart: function () {
            Oo = 0, Xo.lineStart = $t;
        }, polygonEnd: function () { Xo.lineStart = Xo.lineEnd = Xo.point = b, Ho += Ma(Oo / 2); }
    }, $o = { point: Bt, lineStart: b, lineEnd: b, polygonStart: b, polygonEnd: b }, Bo = {
        point: Gt, lineStart: Kt, lineEnd: Qt, polygonStart: function () {
            Bo.lineStart = ne;
        }, polygonEnd: function () { Bo.point = Gt, Bo.lineStart = Kt, Bo.lineEnd = Qt; }
    }; oa.geo.path = function () {
        function n(n) {
            return n && ("function" == typeof o && i.pointRadius(+o.apply(this, arguments)), a && a.valid || (a = u(i)), oa.geo.stream(n, a)), i.result();
        } function t() { return a = null, n; } var e, r, u, i, a, o = 4.5; return n.area = function (n) {
            return Ho = 0, oa.geo.stream(n, u(Xo)), Ho;
        }, n.centroid = function (n) {
            return Ao = Co = zo = Lo = qo = To = Ro = Do = Po = 0, oa.geo.stream(n, u(Bo)), Po ? [Ro / Po, Do / Po] : To ? [Lo / To, qo / To] : zo ? [Ao / zo, Co / zo] : [NaN, NaN];
        }, n.bounds = function (n) { return Zo = Vo = -(Io = Yo = 1 / 0), oa.geo.stream(n, u($o)), [[Io, Yo], [Zo, Vo]]; }, n.projection = function (n) {
            return arguments.length ? (u = (e = n) ? n.stream || re(n) : y, t()) : e;
        }, n.context = function (n) {
            return arguments.length ? (i = null == (r = n) ? new Wt : new te(n), "function" != typeof o && i.pointRadius(o), t()) : r;
        }, n.pointRadius = function (t) {
            return arguments.length ? (o = "function" == typeof t ? t : (i.pointRadius(+t), +t), n) : o;
        }, n.projection(oa.geo.albersUsa()).context(null);
    }, oa.geo.transform = function (n) {
        return {
            stream: function (t) {
                var e = new ue(t);
                for (var r in n) { e[r] = n[r]; } return e;
            }
        };
    }, ue.prototype = {
        point: function (n, t) { this.stream.point(n, t); }, sphere: function () {
            this.stream.sphere();
        }, lineStart: function () { this.stream.lineStart(); }, lineEnd: function () { this.stream.lineEnd(); }, polygonStart: function () {
            this.stream.polygonStart();
        }, polygonEnd: function () { this.stream.polygonEnd(); }
    }, oa.geo.projection = ae, oa.geo.projectionMutator = oe, (oa.geo.equirectangular = function () {
        return ae(ce);
    }).raw = ce.invert = ce, oa.geo.rotation = function (n) {
        function t(t) {
            return t = n(t[0] * Oa, t[1] * Oa), t[0] *= Ia, t[1] *= Ia, t;
        } return n = fe(n[0] % 360 * Oa, n[1] * Oa, n.length > 2 ? n[2] * Oa : 0), t.invert = function (t) {
            return t = n.invert(t[0] * Oa, t[1] * Oa), t[0] *= Ia, t[1] *= Ia, t;
        }, t;
    }, se.invert = ce, oa.geo.circle = function () {
        function n() {
            var n = "function" == typeof r ? r.apply(this, arguments) : r, t = fe(-n[0] * Oa, -n[1] * Oa, 0).invert, u = [];
            return e(null, null, 1, { point: function (n, e) { u.push(n = t(n, e)), n[0] *= Ia, n[1] *= Ia; } }), { type: "Polygon", coordinates: [u] };
        } var t, e, r = [0, 0], u = 6; return n.origin = function (t) { return arguments.length ? (r = t, n) : r; }, n.angle = function (r) {
            return arguments.length ? (e = ve((t = +r) * Oa, u * Oa), n) : t;
        }, n.precision = function (r) { return arguments.length ? (e = ve(t * Oa, (u = +r) * Oa), n) : u; }, n.angle(90);
    }, oa.geo.distance = function (n, t) {
        var e, r = (t[0] - n[0]) * Oa, u = n[1] * Oa, i = t[1] * Oa, a = Math.sin(r), o = Math.cos(r), l = Math.sin(u), c = Math.cos(u), s = Math.sin(i), f = Math.cos(i);
        return Math.atan2(Math.sqrt((e = f * a) * e + (e = c * s - l * f * o) * e), l * s + c * f * o);
    }, oa.geo.graticule = function () {
        function n() {
            return { type: "MultiLineString", coordinates: t() };
        } function t() {
            return oa.range(Math.ceil(i / d) * d, u, d).map(h).concat(oa.range(Math.ceil(c / m) * m, l, m).map(g)).concat(oa.range(Math.ceil(r / p) * p, e, p).filter(function (n) {
                return Ma(n % d) > Da;
            }).map(s)).concat(oa.range(Math.ceil(o / v) * v, a, v).filter(function (n) { return Ma(n % m) > Da; }).map(f));
        } var e, r, u, i, a, o, l, c, s, f, h, g, p = 10, v = p, d = 90, m = 360, y = 2.5;
        return n.lines = function () { return t().map(function (n) { return { type: "LineString", coordinates: n }; }); }, n.outline = function () {
            return { type: "Polygon", coordinates: [h(i).concat(g(l).slice(1), h(u).reverse().slice(1), g(c).reverse().slice(1))] };
        }, n.extent = function (t) { return arguments.length ? n.majorExtent(t).minorExtent(t) : n.minorExtent(); }, n.majorExtent = function (t) {
            return arguments.length ? (i = +t[0][0], u = +t[1][0], c = +t[0][1], l = +t[1][1], i > u && (t = i, i = u, u = t), c > l && (t = c, c = l, l = t), n.precision(y)) : [[i, c], [u, l]];
        }, n.minorExtent = function (t) {
            return arguments.length ? (r = +t[0][0], e = +t[1][0], o = +t[0][1], a = +t[1][1], r > e && (t = r, r = e, e = t), o > a && (t = o, o = a, a = t), n.precision(y)) : [[r, o], [e, a]];
        }, n.step = function (t) { return arguments.length ? n.majorStep(t).minorStep(t) : n.minorStep(); }, n.majorStep = function (t) {
            return arguments.length ? (d = +t[0], m = +t[1], n) : [d, m];
        }, n.minorStep = function (t) { return arguments.length ? (p = +t[0], v = +t[1], n) : [p, v]; }, n.precision = function (t) {
            return arguments.length ? (y = +t, s = me(o, a, 90), f = ye(r, e, y), h = me(c, l, 90), g = ye(i, u, y), n) : y;
        }, n.majorExtent([[-180, -90 + Da], [180, 90 - Da]]).minorExtent([[-180, -80 - Da], [180, 80 + Da]]);
    }, oa.geo.greatArc = function () {
        function n() {
            return { type: "LineString", coordinates: [t || r.apply(this, arguments), e || u.apply(this, arguments)] };
        } var t, e, r = Me, u = xe; return n.distance = function () {
            return oa.geo.distance(t || r.apply(this, arguments), e || u.apply(this, arguments));
        }, n.source = function (e) { return arguments.length ? (r = e, t = "function" == typeof e ? null : e, n) : r; }, n.target = function (t) {
            return arguments.length ? (u = t, e = "function" == typeof t ? null : t, n) : u;
        }, n.precision = function () { return arguments.length ? n : 0; }, n;
    }, oa.geo.interpolate = function (n, t) {
        return be(n[0] * Oa, n[1] * Oa, t[0] * Oa, t[1] * Oa);
    }, oa.geo.length = function (n) { return Wo = 0, oa.geo.stream(n, Jo), Wo; }; var Wo, Jo = { sphere: b, point: b, lineStart: _e, lineEnd: b, polygonStart: b, polygonEnd: b }, Go = we(function (n) {
        return Math.sqrt(2 / (1 + n));
    }, function (n) { return 2 * Math.asin(n / 2); }); (oa.geo.azimuthalEqualArea = function () { return ae(Go); }).raw = Go;
    var Ko = we(function (n) { var t = Math.acos(n); return t && t / Math.sin(t); }, y); (oa.geo.azimuthalEquidistant = function () {
        return ae(Ko);
    }).raw = Ko, (oa.geo.conicConformal = function () { return Vt(Se); }).raw = Se, (oa.geo.conicEquidistant = function () {
        return Vt(ke);
    }).raw = ke; var Qo = we(function (n) { return 1 / n; }, Math.atan); (oa.geo.gnomonic = function () { return ae(Qo); }).raw = Qo, Ne.invert = function (n, t) {
        return [n, 2 * Math.atan(Math.exp(t)) - Ha];
    }, (oa.geo.mercator = function () { return Ee(Ne); }).raw = Ne; var nl = we(function () { return 1; }, Math.asin); (oa.geo.orthographic = function () {
        return ae(nl);
    }).raw = nl; var tl = we(function (n) { return 1 / (1 + n); }, function (n) { return 2 * Math.atan(n); }); (oa.geo.stereographic = function () {
        return ae(tl);
    }).raw = tl, Ae.invert = function (n, t) { return [-t, 2 * Math.atan(Math.exp(n)) - Ha]; }, (oa.geo.transverseMercator = function () {
        var n = Ee(Ae), t = n.center, e = n.rotate;
        return n.center = function (n) { return n ? t([-n[1], n[0]]) : (n = t(), [n[1], -n[0]]); }, n.rotate = function (n) {
            return n ? e([n[0], n[1], n.length > 2 ? n[2] + 90 : 90]) : (n = e(), [n[0], n[1], n[2] - 90]);
        }, e([0, 0, 90]);
    }).raw = Ae, oa.geom = {}, oa.geom.hull = function (n) {
        function t(n) {
            if (n.length < 3) { return []; } var t, u = En(e), i = En(r), a = n.length, o = [], l = [];
            for (t = 0; a > t; t++) { o.push([+u.call(this, n[t], t), +i.call(this, n[t], t), t]); } for (o.sort(qe), t = 0; a > t; t++) {
                l.push([o[t][0], -o[t][1]]);
            } var c = Le(o), s = Le(l), f = s[0] === c[0], h = s[s.length - 1] === c[c.length - 1], g = []; for (t = c.length - 1; t >= 0; --t) {
                g.push(n[o[c[t]][2]]);
            } for (t = +f; t < s.length - h; ++t) { g.push(n[o[s[t]][2]]); } return g;
        } var e = Ce, r = ze; return arguments.length ? t(n) : (t.x = function (n) {
            return arguments.length ? (e = n, t) : e;
        }, t.y = function (n) { return arguments.length ? (r = n, t) : r; }, t);
    }, oa.geom.polygon = function (n) {
        return Sa(n, el), n;
    }; var el = oa.geom.polygon.prototype = []; el.area = function () {
        for (var n, t = -1, e = this.length, r = this[e - 1], u = 0;
        ++t < e;) { n = r, r = this[t], u += n[1] * r[0] - n[0] * r[1]; } return 0.5 * u;
    }, el.centroid = function (n) {
        var t, e, r = -1, u = this.length, i = 0, a = 0, o = this[u - 1];
        for (arguments.length || (n = -1 / (6 * this.area())) ; ++r < u;) {
            t = o, o = this[r], e = t[0] * o[1] - o[0] * t[1], i += (t[0] + o[0]) * e, a += (t[1] + o[1]) * e;
        } return [i * n, a * n];
    }, el.clip = function (n) {
        for (var t, e, r, u, i, a, o = De(n), l = -1, c = this.length - De(this), s = this[c - 1];
        ++l < c;) {
            for (t = n.slice(), n.length = 0, u = this[l], i = t[(r = t.length - o) - 1], e = -1; ++e < r;) {
                a = t[e], Te(a, s, u) ? (Te(i, s, u) || n.push(Re(i, a, s, u)), n.push(a)) : Te(i, s, u) && n.push(Re(i, a, s, u)), i = a;
            } o && n.push(n[0]), s = u;
        } return n;
    }; var rl, ul, il, al, ol, ll = [], cl = []; Ye.prototype.prepare = function () {
        for (var n, t = this.edges, e = t.length;
        e--;) { n = t[e].edge, n.b && n.a || t.splice(e, 1); } return t.sort(Ve), t.length;
    }, tr.prototype = {
        start: function () {
            return this.edge.l === this.site ? this.edge.a : this.edge.b;
        }, end: function () { return this.edge.l === this.site ? this.edge.b : this.edge.a; }
    }, er.prototype = {
        insert: function (n, t) {
            var e, r, u;
            if (n) { if (t.P = n, t.N = n.N, n.N && (n.N.P = t), n.N = t, n.R) { for (n = n.R; n.L;) { n = n.L; } n.L = t; } else { n.R = t; } e = n; } else {
                this._ ? (n = ar(this._), t.P = null, t.N = n, n.P = n.L = t, e = n) : (t.P = t.N = null, this._ = t, e = null);
            } for (t.L = t.R = null, t.U = e, t.C = !0, n = t; e && e.C;) {
                r = e.U, e === r.L ? (u = r.R, u && u.C ? (e.C = u.C = !1, r.C = !0, n = r) : (n === e.R && (ur(this, e), n = e, e = n.U), e.C = !1, r.C = !0, ir(this, r))) : (u = r.L, u && u.C ? (e.C = u.C = !1, r.C = !0, n = r) : (n === e.L && (ir(this, e), n = e, e = n.U), e.C = !1, r.C = !0, ur(this, r))), e = n.U;
            } this._.C = !1;
        }, remove: function (n) {
            n.N && (n.N.P = n.P), n.P && (n.P.N = n.N), n.N = n.P = null; var t, e, r, u = n.U, i = n.L, a = n.R;
            if (e = i ? a ? ar(a) : i : a, u ? u.L === n ? u.L = e : u.R = e : this._ = e, i && a ? (r = e.C, e.C = n.C, e.L = i, i.U = e, e !== a ? (u = e.U, e.U = n.U, n = e.R, u.L = n, e.R = a, a.U = e) : (e.U = u, u = e, n = e.R)) : (r = n.C, n = e), n && (n.U = u), !r) {
                if (n && n.C) {
                    return void (n.C = !1);
                } do {
                    if (n === this._) { break; } if (n === u.L) {
                        if (t = u.R, t.C && (t.C = !1, u.C = !0, ur(this, u), t = u.R), t.L && t.L.C || t.R && t.R.C) {
                            t.R && t.R.C || (t.L.C = !1, t.C = !0, ir(this, t), t = u.R), t.C = u.C, u.C = t.R.C = !1, ur(this, u), n = this._;
                            break;
                        }
                    } else {
                        if (t = u.L, t.C && (t.C = !1, u.C = !0, ir(this, u), t = u.L), t.L && t.L.C || t.R && t.R.C) {
                            t.L && t.L.C || (t.R.C = !1, t.C = !0, ur(this, t), t = u.L), t.C = u.C, u.C = t.L.C = !1, ir(this, u), n = this._;
                            break;
                        }
                    } t.C = !0, n = u, u = u.U;
                } while (!n.C); n && (n.C = !1);
            }
        }
    }, oa.geom.voronoi = function (n) {
        function t(n) {
            var t = new Array(n.length), r = o[0][0], u = o[0][1], i = o[1][0], a = o[1][1];
            return or(e(n), o).cells.forEach(function (e, o) {
                var l = e.edges, c = e.site, s = t[o] = l.length ? l.map(function (n) {
                    var t = n.start();
                    return [t.x, t.y];
                }) : c.x >= r && c.x <= i && c.y >= u && c.y <= a ? [[r, a], [i, a], [i, u], [r, u]] : []; s.point = n[o];
            }), t;
        } function e(n) {
            return n.map(function (n, t) {
                return { x: Math.round(i(n, t) / Da) * Da, y: Math.round(a(n, t) / Da) * Da, i: t };
            });
        } var r = Ce, u = ze, i = r, a = u, o = sl; return n ? t(n) : (t.links = function (n) {
            return or(e(n)).edges.filter(function (n) {
                return n.l && n.r;
            }).map(function (t) { return { source: n[t.l.i], target: n[t.r.i] }; });
        }, t.triangles = function (n) {
            var t = []; return or(e(n)).cells.forEach(function (e, r) {
                for (var u, i, a = e.site, o = e.edges.sort(Ve), l = -1, c = o.length, s = o[c - 1].edge, f = s.l === a ? s.r : s.l;
                ++l < c;) {
                    u = s, i = f, s = o[l].edge, f = s.l === a ? s.r : s.l, r < i.i && r < f.i && cr(a, i, f) < 0 && t.push([n[r], n[i.i], n[f.i]]);
                }
            }), t;
        }, t.x = function (n) { return arguments.length ? (i = En(r = n), t) : r; }, t.y = function (n) {
            return arguments.length ? (a = En(u = n), t) : u;
        }, t.clipExtent = function (n) { return arguments.length ? (o = null == n ? sl : n, t) : o === sl ? null : o; }, t.size = function (n) {
            return arguments.length ? t.clipExtent(n && [[0, 0], n]) : o === sl ? null : o && o[1];
        }, t);
    }; var sl = [[-1000000, -1000000], [1000000, 1000000]]; oa.geom.delaunay = function (n) {
        return oa.geom.voronoi().triangles(n);
    }, oa.geom.quadtree = function (n, t, e, r, u) {
        function i(n) {
            function i(n, t, e, r, u, i, a, o) {
                if (!isNaN(e) && !isNaN(r)) {
                    if (n.leaf) {
                        var l = n.x, s = n.y;
                        if (null != l) {
                            if (Ma(l - e) + Ma(s - r) < 0.01) { c(n, t, e, r, u, i, a, o); } else {
                                var f = n.point; n.x = n.y = n.point = null, c(n, f, l, s, u, i, a, o), c(n, t, e, r, u, i, a, o);
                            }
                        } else { n.x = e, n.y = r, n.point = t; }
                    } else { c(n, t, e, r, u, i, a, o); }
                }
            } function c(n, t, e, r, u, a, o, l) {
                var c = 0.5 * (u + o), s = 0.5 * (a + l), f = e >= c, h = r >= s, g = h << 1 | f;
                n.leaf = !1, n = n.nodes[g] || (n.nodes[g] = hr()), f ? u = c : o = c, h ? a = s : l = s, i(n, t, e, r, u, a, o, l);
            } var s, f, h, g, p, v, d, m, y, M = En(o), x = En(l);
            if (null != t) { v = t, d = e, m = r, y = u; } else {
                if (m = y = -(v = d = 1 / 0), f = [], h = [], p = n.length, a) {
                    for (g = 0; p > g; ++g) {
                        s = n[g], s.x < v && (v = s.x), s.y < d && (d = s.y), s.x > m && (m = s.x), s.y > y && (y = s.y), f.push(s.x), h.push(s.y);
                    }
                } else {
                    for (g = 0; p > g; ++g) {
                        var b = +M(s = n[g], g), _ = +x(s, g); v > b && (v = b), d > _ && (d = _), b > m && (m = b), _ > y && (y = _), f.push(b), h.push(_);
                    }
                }
            } var w = m - v, S = y - d; w > S ? y = d + w : m = v + S; var k = hr(); if (k.add = function (n) { i(k, n, +M(n, ++g), +x(n, g), v, d, m, y); }, k.visit = function (n) {
            gr(n, k, v, d, m, y);
            }, k.find = function (n) { return pr(k, n[0], n[1], v, d, m, y); }, g = -1, null == t) {
                for (; ++g < p;) {
                    i(k, n[g], f[g], h[g], v, d, m, y);
                } --g;
            } else { n.forEach(k.add); } return f = h = n = s = null, k;
        } var a, o = Ce, l = ze; return (a = arguments.length) ? (o = sr, l = fr, 3 === a && (u = e, r = t, e = t = 0), i(n)) : (i.x = function (n) {
            return arguments.length ? (o = n, i) : o;
        }, i.y = function (n) { return arguments.length ? (l = n, i) : l; }, i.extent = function (n) {
            return arguments.length ? (null == n ? t = e = r = u = null : (t = +n[0][0], e = +n[0][1], r = +n[1][0], u = +n[1][1]), i) : null == t ? null : [[t, e], [r, u]];
        }, i.size = function (n) {
            return arguments.length ? (null == n ? t = e = r = u = null : (t = e = 0, r = +n[0], u = +n[1]), i) : null == t ? null : [r - t, u - e];
        }, i);
    }, oa.interpolateRgb = vr, oa.interpolateObject = dr, oa.interpolateNumber = mr, oa.interpolateString = yr; var fl = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, hl = new RegExp(fl.source, "g");
    oa.interpolate = Mr, oa.interpolators = [function (n, t) {
        var e = typeof t; return ("string" === e ? ro.has(t.toLowerCase()) || /^(#|rgb\(|hsl\()/i.test(t) ? vr : yr : t instanceof on ? vr : Array.isArray(t) ? xr : "object" === e && isNaN(t) ? dr : mr)(n, t);
    }], oa.interpolateArray = xr; var gl = function () { return y; }, pl = oa.map({
        linear: gl, poly: Er, quad: function () {
            return Sr;
        }, cubic: function () { return kr; }, sin: function () { return Ar; }, exp: function () { return Cr; }, circle: function () {
            return zr;
        }, elastic: Lr, back: qr, bounce: function () { return Tr; }
    }), vl = oa.map({
        "in": y, out: _r, "in-out": wr, "out-in": function (n) {
            return wr(_r(n));
        }
    }); oa.ease = function (n) {
        var t = n.indexOf("-"), e = t >= 0 ? n.slice(0, t) : n, r = t >= 0 ? n.slice(t + 1) : "in"; return e = pl.get(e) || gl, r = vl.get(r) || y, br(r(e.apply(null, la.call(arguments, 1))));
    }, oa.interpolateHcl = Rr, oa.interpolateHsl = Dr, oa.interpolateLab = Pr, oa.interpolateRound = jr, oa.transform = function (n) {
        var t = sa.createElementNS(oa.ns.prefix.svg, "g");
        return (oa.transform = function (n) {
            if (null != n) {
                t.setAttribute("transform", n); var e = t.transform.baseVal.consolidate();
            } return new Ur(e ? e.matrix : dl);
        })(n);
    }, Ur.prototype.toString = function () {
        return "translate(" + this.translate + ")rotate(" + this.rotate + ")skewX(" + this.skew + ")scale(" + this.scale + ")";
    }; var dl = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0 }; oa.interpolateTransform = $r, oa.layout = {}, oa.layout.bundle = function () {
        return function (n) {
            for (var t = [], e = -1, r = n.length;
            ++e < r;) { t.push(Jr(n[e])); } return t;
        };
    }, oa.layout.chord = function () {
        function n() {
            var n, c, f, h, g, p = {}, v = [], d = oa.range(i), m = [];
            for (e = [], r = [], n = 0, h = -1; ++h < i;) { for (c = 0, g = -1; ++g < i;) { c += u[h][g]; } v.push(c), m.push(oa.range(i)), n += c; } for (a && d.sort(function (n, t) {
            return a(v[n], v[t]);
            }), o && m.forEach(function (n, t) { n.sort(function (n, e) { return o(u[t][n], u[t][e]); }); }), n = (Ua - s * i) / n, c = 0, h = -1;
            ++h < i;) {
                for (f = c, g = -1; ++g < i;) {
                    var y = d[h], M = m[y][g], x = u[y][M], b = c, _ = c += x * n; p[y + "-" + M] = { index: y, subindex: M, startAngle: b, endAngle: _, value: x };
                } r[y] = { index: y, startAngle: f, endAngle: c, value: v[y] }, c += s;
            } for (h = -1; ++h < i;) {
                for (g = h - 1; ++g < i;) {
                    var w = p[h + "-" + g], S = p[g + "-" + h];
                    (w.value || S.value) && e.push(w.value < S.value ? { source: S, target: w } : { source: w, target: S });
                }
            } l && t();
        } function t() {
            e.sort(function (n, t) {
                return l((n.source.value + n.target.value) / 2, (t.source.value + t.target.value) / 2);
            });
        } var e, r, u, i, a, o, l, c = {}, s = 0; return c.matrix = function (n) {
            return arguments.length ? (i = (u = n) && u.length, e = r = null, c) : u;
        }, c.padding = function (n) { return arguments.length ? (s = n, e = r = null, c) : s; }, c.sortGroups = function (n) {
            return arguments.length ? (a = n, e = r = null, c) : a;
        }, c.sortSubgroups = function (n) { return arguments.length ? (o = n, e = null, c) : o; }, c.sortChords = function (n) {
            return arguments.length ? (l = n, e && t(), c) : l;
        }, c.chords = function () { return e || n(), e; }, c.groups = function () { return r || n(), r; }, c;
    }, oa.layout.force = function () {
        function n(n) {
            return function (t, e, r, u) {
                if (t.point !== n) {
                    var i = t.cx - n.x, a = t.cy - n.y, o = u - e, l = i * i + a * a;
                    if (l > o * o / m) { if (v > l) { var c = t.charge / l; n.px -= i * c, n.py -= a * c; } return !0; } if (t.point && l && v > l) {
                        var c = t.pointCharge / l;
                        n.px -= i * c, n.py -= a * c;
                    }
                } return !t.charge;
            };
        } function t(n) { n.px = oa.event.x, n.py = oa.event.y, l.resume(); } var e, r, u, i, a, o, l = {}, c = oa.dispatch("start", "tick", "end"), s = [1, 1], f = 0.9, h = ml, g = yl, p = -30, v = Ml, d = 0.1, m = 0.64, M = [], x = [];
        return l.tick = function () {
            if ((u *= 0.99) < 0.005) { return e = null, c.end({ type: "end", alpha: u = 0 }), !0; } var t, r, l, h, g, v, m, y, b, _ = M.length, w = x.length;
            for (r = 0; w > r; ++r) {
                l = x[r], h = l.source, g = l.target, y = g.x - h.x, b = g.y - h.y, (v = y * y + b * b) && (v = u * a[r] * ((v = Math.sqrt(v)) - i[r]) / v, y *= v, b *= v, g.x -= y * (m = h.weight + g.weight ? h.weight / (h.weight + g.weight) : 0.5), g.y -= b * m, h.x += y * (m = 1 - m), h.y += b * m);
            } if ((m = u * d) && (y = s[0] / 2, b = s[1] / 2, r = -1, m)) { for (; ++r < _;) { l = M[r], l.x += (y - l.x) * m, l.y += (b - l.y) * m; } } if (p) {
                for (ru(t = oa.geom.quadtree(M), u, o), r = -1;
                ++r < _;) { (l = M[r]).fixed || t.visit(n(l)); }
            } for (r = -1; ++r < _;) {
                l = M[r], l.fixed ? (l.x = l.px, l.y = l.py) : (l.x -= (l.px - (l.px = l.x)) * f, l.y -= (l.py - (l.py = l.y)) * f);
            } c.tick({ type: "tick", alpha: u });
        }, l.nodes = function (n) { return arguments.length ? (M = n, l) : M; }, l.links = function (n) {
            return arguments.length ? (x = n, l) : x;
        }, l.size = function (n) { return arguments.length ? (s = n, l) : s; }, l.linkDistance = function (n) {
            return arguments.length ? (h = "function" == typeof n ? n : +n, l) : h;
        }, l.distance = l.linkDistance, l.linkStrength = function (n) {
            return arguments.length ? (g = "function" == typeof n ? n : +n, l) : g;
        }, l.friction = function (n) { return arguments.length ? (f = +n, l) : f; }, l.charge = function (n) {
            return arguments.length ? (p = "function" == typeof n ? n : +n, l) : p;
        }, l.chargeDistance = function (n) { return arguments.length ? (v = n * n, l) : Math.sqrt(v); }, l.gravity = function (n) {
            return arguments.length ? (d = +n, l) : d;
        }, l.theta = function (n) { return arguments.length ? (m = n * n, l) : Math.sqrt(m); }, l.alpha = function (n) {
            return arguments.length ? (n = +n, u ? n > 0 ? u = n : (e.c = null, e.t = NaN, e = null, c.end({ type: "end", alpha: u = 0 })) : n > 0 && (c.start({ type: "start", alpha: u = n }), e = qn(l.tick)), l) : u;
        }, l.start = function () {
            function n(n, r) {
                if (!e) {
                    for (e = new Array(u), l = 0; u > l; ++l) { e[l] = []; } for (l = 0; c > l; ++l) {
                        var i = x[l];
                        e[i.source.index].push(i.target), e[i.target.index].push(i.source);
                    }
                } for (var a, o = e[t], l = -1, s = o.length;
                ++l < s;) { if (!isNaN(a = o[l][n])) { return a; } } return Math.random() * r;
            } var t, e, r, u = M.length, c = x.length, f = s[0], v = s[1];
            for (t = 0; u > t; ++t) { (r = M[t]).index = t, r.weight = 0; } for (t = 0; c > t; ++t) {
                r = x[t], "number" == typeof r.source && (r.source = M[r.source]), "number" == typeof r.target && (r.target = M[r.target]), ++r.source.weight, ++r.target.weight;
            } for (t = 0; u > t; ++t) {
                r = M[t], isNaN(r.x) && (r.x = n("x", f)), isNaN(r.y) && (r.y = n("y", v)), isNaN(r.px) && (r.px = r.x), isNaN(r.py) && (r.py = r.y);
            } if (i = [], "function" == typeof h) { for (t = 0; c > t; ++t) { i[t] = +h.call(this, x[t], t); } } else {
                for (t = 0; c > t; ++t) {
                    i[t] = h;
                }
            } if (a = [], "function" == typeof g) { for (t = 0; c > t; ++t) { a[t] = +g.call(this, x[t], t); } } else {
                for (t = 0; c > t; ++t) {
                    a[t] = g;
                }
            } if (o = [], "function" == typeof p) { for (t = 0; u > t; ++t) { o[t] = +p.call(this, M[t], t); } } else {
                for (t = 0; u > t; ++t) {
                    o[t] = p;
                }
            } return l.resume();
        }, l.resume = function () { return l.alpha(0.1); }, l.stop = function () { return l.alpha(0); }, l.drag = function () {
            return r || (r = oa.behavior.drag().origin(y).on("dragstart.force", Qr).on("drag.force", t).on("dragend.force", nu)), arguments.length ? void this.on("mouseover.force", tu).on("mouseout.force", eu).call(r) : r;
        }, oa.rebind(l, c, "on");
    }; var ml = 20, yl = 1, Ml = 1 / 0; oa.layout.hierarchy = function () {
        function n(u) {
            var i, a = [u], o = [];
            for (u.depth = 0; null != (i = a.pop()) ;) {
                if (o.push(i), (c = e.call(n, i, i.depth)) && (l = c.length)) {
                    for (var l, c, s; --l >= 0;
                    ) { a.push(s = c[l]), s.parent = i, s.depth = i.depth + 1; } r && (i.value = 0), i.children = c;
                } else {
                    r && (i.value = +r.call(n, i, i.depth) || 0), delete i.children;
                }
            } return au(u, function (n) { var e, u; t && (e = n.children) && e.sort(t), r && (u = n.parent) && (u.value += n.value); }), o;
        } var t = cu, e = ou, r = lu; return n.sort = function (e) { return arguments.length ? (t = e, n) : t; }, n.children = function (t) {
            return arguments.length ? (e = t, n) : e;
        }, n.value = function (t) { return arguments.length ? (r = t, n) : r; }, n.revalue = function (t) {
            return r && (iu(t, function (n) {
                n.children && (n.value = 0);
            }), au(t, function (t) {
                var e; t.children || (t.value = +r.call(n, t, t.depth) || 0), (e = t.parent) && (e.value += t.value);
            })), t;
        }, n;
    }, oa.layout.partition = function () {
        function n(t, e, r, u) {
            var i = t.children; if (t.x = e, t.y = t.depth * u, t.dx = r, t.dy = u, i && (a = i.length)) {
                var a, o, l, c = -1;
                for (r = t.value ? r / t.value : 0; ++c < a;) { n(o = i[c], e, l = o.value * r, u), e += l; }
            }
        } function t(n) {
            var e = n.children, r = 0;
            if (e && (u = e.length)) { for (var u, i = -1; ++i < u;) { r = Math.max(r, t(e[i])); } } return 1 + r;
        } function e(e, i) {
            var a = r.call(this, e, i);
            return n(a[0], 0, u[0], u[1] / t(a[0])), a;
        } var r = oa.layout.hierarchy(), u = [1, 1]; return e.size = function (n) {
            return arguments.length ? (u = n, e) : u;
        }, uu(e, r);
    }, oa.layout.pie = function () {
        function n(a) {
            var o, l = a.length, c = a.map(function (e, r) {
                return +t.call(n, e, r);
            }), s = +("function" == typeof r ? r.apply(this, arguments) : r), f = ("function" == typeof u ? u.apply(this, arguments) : u) - s, h = Math.min(Math.abs(f) / l, +("function" == typeof i ? i.apply(this, arguments) : i)), g = h * (0 > f ? -1 : 1), p = oa.sum(c), v = p ? (f - l * g) / p : 0, d = oa.range(l), m = [];
            return null != e && d.sort(e === xl ? function (n, t) { return c[t] - c[n]; } : function (n, t) { return e(a[n], a[t]); }), d.forEach(function (n) {
                m[n] = { data: a[n], value: o = c[n], startAngle: s, endAngle: s += o * v + g, padAngle: h };
            }), m;
        } var t = Number, e = xl, r = 0, u = Ua, i = 0; return n.value = function (e) { return arguments.length ? (t = e, n) : t; }, n.sort = function (t) {
            return arguments.length ? (e = t, n) : e;
        }, n.startAngle = function (t) { return arguments.length ? (r = t, n) : r; }, n.endAngle = function (t) {
            return arguments.length ? (u = t, n) : u;
        }, n.padAngle = function (t) { return arguments.length ? (i = t, n) : i; }, n;
    }; var xl = {}; oa.layout.stack = function () {
        function n(o, l) {
            if (!(h = o.length)) {
                return o;
            } var c = o.map(function (e, r) { return t.call(n, e, r); }), s = c.map(function (t) {
                return t.map(function (t, e) {
                    return [i.call(n, t, e), a.call(n, t, e)];
                });
            }), f = e.call(n, s, l); c = oa.permute(c, f), s = oa.permute(s, f); var h, g, p, v, d = r.call(n, s, l), m = c[0].length; for (p = 0;
            m > p; ++p) {
                for (u.call(n, c[0][p], v = d[p], s[0][p][1]), g = 1; h > g; ++g) {
                    u.call(n, c[g][p], v += s[g - 1][p][1], s[g][p][1]);
                }
            } return o;
        } var t = y, e = pu, r = vu, u = gu, i = fu, a = hu; return n.values = function (e) {
            return arguments.length ? (t = e, n) : t;
        }, n.order = function (t) { return arguments.length ? (e = "function" == typeof t ? t : bl.get(t) || pu, n) : e; }, n.offset = function (t) {
            return arguments.length ? (r = "function" == typeof t ? t : _l.get(t) || vu, n) : r;
        }, n.x = function (t) { return arguments.length ? (i = t, n) : i; }, n.y = function (t) {
            return arguments.length ? (a = t, n) : a;
        }, n.out = function (t) { return arguments.length ? (u = t, n) : u; }, n;
    }; var bl = oa.map({
        "inside-out": function (n) {
            var t, e, r = n.length, u = n.map(du), i = n.map(mu), a = oa.range(r).sort(function (n, t) {
                return u[n] - u[t];
            }), o = 0, l = 0, c = [], s = []; for (t = 0; r > t; ++t) { e = a[t], l > o ? (o += i[e], c.push(e)) : (l += i[e], s.push(e)); } return s.reverse().concat(c);
        }, reverse: function (n) { return oa.range(n.length).reverse(); }, "default": pu
    }), _l = oa.map({
        silhouette: function (n) {
            var t, e, r, u = n.length, i = n[0].length, a = [], o = 0, l = [];
            for (e = 0; i > e; ++e) { for (t = 0, r = 0; u > t; t++) { r += n[t][e][1]; } r > o && (o = r), a.push(r); } for (e = 0; i > e; ++e) {
                l[e] = (o - a[e]) / 2;
            } return l;
        }, wiggle: function (n) {
            var t, e, r, u, i, a, o, l, c, s = n.length, f = n[0], h = f.length, g = []; for (g[0] = l = c = 0, e = 1;
            h > e; ++e) {
                for (t = 0, u = 0; s > t; ++t) { u += n[t][e][1]; } for (t = 0, i = 0, o = f[e][0] - f[e - 1][0]; s > t; ++t) {
                    for (r = 0, a = (n[t][e][1] - n[t][e - 1][1]) / (2 * o) ;
                    t > r; ++r) { a += (n[r][e][1] - n[r][e - 1][1]) / o; } i += a * n[t][e][1];
                } g[e] = l -= u ? i / u * o : 0, c > l && (c = l);
            } for (e = 0; h > e; ++e) {
                g[e] -= c;
            } return g;
        }, expand: function (n) {
            var t, e, r, u = n.length, i = n[0].length, a = 1 / u, o = []; for (e = 0; i > e; ++e) {
                for (t = 0, r = 0;
                u > t; t++) { r += n[t][e][1]; } if (r) { for (t = 0; u > t; t++) { n[t][e][1] /= r; } } else { for (t = 0; u > t; t++) { n[t][e][1] = a; } }
            } for (e = 0;
            i > e; ++e) { o[e] = 0; } return o;
        }, zero: vu
    }); oa.layout.histogram = function () {
        function n(n, i) {
            for (var a, o, l = [], c = n.map(e, this), s = r.call(this, c, i), f = u.call(this, s, c, i), i = -1, h = c.length, g = f.length - 1, p = t ? 1 : 1 / h;
            ++i < g;) { a = l[i] = [], a.dx = f[i + 1] - (a.x = f[i]), a.y = 0; } if (g > 0) {
                for (i = -1; ++i < h;) {
                    o = c[i], o >= s[0] && o <= s[1] && (a = l[oa.bisect(f, o, 1, g) - 1], a.y += p, a.push(n[i]));
                }
            } return l;
        } var t = !0, e = Number, r = bu, u = Mu; return n.value = function (t) {
            return arguments.length ? (e = t, n) : e;
        }, n.range = function (t) { return arguments.length ? (r = En(t), n) : r; }, n.bins = function (t) {
            return arguments.length ? (u = "number" == typeof t ? function (n) {
                return xu(n, t);
            } : En(t), n) : u;
        }, n.frequency = function (e) { return arguments.length ? (t = !!e, n) : t; }, n;
    }, oa.layout.pack = function () {
        function n(n, i) {
            var a = e.call(this, n, i), o = a[0], l = u[0], c = u[1], s = null == t ? Math.sqrt : "function" == typeof t ? t : function () {
                return t;
            }; if (o.x = o.y = 0, au(o, function (n) { n.r = +s(n.value); }), au(o, Nu), r) {
                var f = r * (t ? 1 : Math.max(2 * o.r / l, 2 * o.r / c)) / 2;
                au(o, function (n) { n.r += f; }), au(o, Nu), au(o, function (n) { n.r -= f; });
            } return Cu(o, l / 2, c / 2, t ? 1 : 1 / Math.max(2 * o.r / l, 2 * o.r / c)), a;
        } var t, e = oa.layout.hierarchy().sort(_u), r = 0, u = [1, 1]; return n.size = function (t) {
            return arguments.length ? (u = t, n) : u;
        }, n.radius = function (e) { return arguments.length ? (t = null == e || "function" == typeof e ? e : +e, n) : t; }, n.padding = function (t) {
            return arguments.length ? (r = +t, n) : r;
        }, uu(n, e);
    }, oa.layout.tree = function () {
        function n(n, u) {
            var s = a.call(this, n, u), f = s[0], h = t(f); if (au(h, e), h.parent.m = -h.z, iu(h, r), c) {
                iu(f, i);
            } else {
                var g = f, p = f, v = f; iu(f, function (n) { n.x < g.x && (g = n), n.x > p.x && (p = n), n.depth > v.depth && (v = n); }); var d = o(g, p) / 2 - g.x, m = l[0] / (p.x + o(p, g) / 2 + d), y = l[1] / (v.depth || 1);
                iu(f, function (n) { n.x = (n.x + d) * m, n.y = n.depth * y; });
            } return s;
        } function t(n) {
            for (var t, e = { A: null, children: [n] }, r = [e];
            null != (t = r.pop()) ;) {
                for (var u, i = t.children, a = 0, o = i.length; o > a; ++a) {
                    r.push((i[a] = u = { _: i[a], parent: t, children: (u = i[a].children) && u.slice() || [], A: null, a: null, z: 0, m: 0, c: 0, s: 0, t: null, i: a }).a = u);
                }
            } return e.children[0];
        } function e(n) {
            var t = n.children, e = n.parent.children, r = n.i ? e[n.i - 1] : null; if (t.length) {
                Du(n);
                var i = (t[0].z + t[t.length - 1].z) / 2; r ? (n.z = r.z + o(n._, r._), n.m = n.z - i) : n.z = i;
            } else {
                r && (n.z = r.z + o(n._, r._));
            } n.parent.A = u(n, r, n.parent.A || e[0]);
        } function r(n) { n._.x = n.z + n.parent.m, n.m += n.parent.m; } function u(n, t, e) {
            if (t) {
                for (var r, u = n, i = n, a = t, l = u.parent.children[0], c = u.m, s = i.m, f = a.m, h = l.m;
                a = Tu(a), u = qu(u), a && u;) {
                    l = qu(l), i = Tu(i), i.a = n, r = a.z + f - u.z - c + o(a._, u._), r > 0 && (Ru(Pu(a, n, e), n, r), c += r, s += r), f += a.m, c += u.m, h += l.m, s += i.m;
                } a && !Tu(i) && (i.t = a, i.m += f - s), u && !qu(l) && (l.t = u, l.m += c - h, e = n);
            } return e;
        } function i(n) {
            n.x *= l[0], n.y = n.depth * l[1];
        } var a = oa.layout.hierarchy().sort(null).value(null), o = Lu, l = [1, 1], c = null; return n.separation = function (t) {
            return arguments.length ? (o = t, n) : o;
        }, n.size = function (t) { return arguments.length ? (c = null == (l = t) ? i : null, n) : c ? null : l; }, n.nodeSize = function (t) {
            return arguments.length ? (c = null == (l = t) ? null : i, n) : c ? l : null;
        }, uu(n, a);
    }, oa.layout.cluster = function () {
        function n(n, i) {
            var a, o = t.call(this, n, i), l = o[0], c = 0; au(l, function (n) {
                var t = n.children;
                t && t.length ? (n.x = Uu(t), n.y = ju(t)) : (n.x = a ? c += e(n, a) : 0, n.y = 0, a = n);
            }); var s = Fu(l), f = Hu(l), h = s.x - e(s, f) / 2, g = f.x + e(f, s) / 2;
            return au(l, u ? function (n) { n.x = (n.x - l.x) * r[0], n.y = (l.y - n.y) * r[1]; } : function (n) {
                n.x = (n.x - h) / (g - h) * r[0], n.y = (1 - (l.y ? n.y / l.y : 1)) * r[1];
            }), o;
        } var t = oa.layout.hierarchy().sort(null).value(null), e = Lu, r = [1, 1], u = !1; return n.separation = function (t) {
            return arguments.length ? (e = t, n) : e;
        }, n.size = function (t) { return arguments.length ? (u = null == (r = t), n) : u ? null : r; }, n.nodeSize = function (t) {
            return arguments.length ? (u = null != (r = t), n) : u ? r : null;
        }, uu(n, t);
    }, oa.layout.treemap = function () {
        function n(n, t) {
            for (var e, r, u = -1, i = n.length; ++u < i;) {
                r = (e = n[u]).value * (0 > t ? 0 : t), e.area = isNaN(r) || 0 >= r ? 0 : r;
            }
        } function t(e) {
            var i = e.children; if (i && i.length) {
                var a, o, l, c = f(e), s = [], h = i.slice(), p = 1 / 0, v = "slice" === g ? c.dx : "dice" === g ? c.dy : "slice-dice" === g ? 1 & e.depth ? c.dy : c.dx : Math.min(c.dx, c.dy);
                for (n(h, c.dx * c.dy / e.value), s.area = 0; (l = h.length) > 0;) {
                    s.push(a = h[l - 1]), s.area += a.area, "squarify" !== g || (o = r(s, v)) <= p ? (h.pop(), p = o) : (s.area -= s.pop().area, u(s, v, c, !1), v = Math.min(c.dx, c.dy), s.length = s.area = 0, p = 1 / 0);
                } s.length && (u(s, v, c, !0), s.length = s.area = 0), i.forEach(t);
            }
        } function e(t) {
            var r = t.children; if (r && r.length) {
                var i, a = f(t), o = r.slice(), l = [];
                for (n(o, a.dx * a.dy / t.value), l.area = 0; i = o.pop() ;) {
                    l.push(i), l.area += i.area, null != i.z && (u(l, i.z ? a.dx : a.dy, a, !o.length), l.length = l.area = 0);
                } r.forEach(e);
            }
        } function r(n, t) {
            for (var e, r = n.area, u = 0, i = 1 / 0, a = -1, o = n.length; ++a < o;) {
                (e = n[a].area) && (i > e && (i = e), e > u && (u = e));
            } return r *= r, t *= t, r ? Math.max(t * u * p / r, r / (t * i * p)) : 1 / 0;
        } function u(n, t, e, r) {
            var u, i = -1, a = n.length, o = e.x, c = e.y, s = t ? l(n.area / t) : 0;
            if (t == e.dx) {
                for ((r || s > e.dy) && (s = e.dy) ; ++i < a;) {
                    u = n[i], u.x = o, u.y = c, u.dy = s, o += u.dx = Math.min(e.x + e.dx - o, s ? l(u.area / s) : 0);
                } u.z = !0, u.dx += e.x + e.dx - o, e.y += s, e.dy -= s;
            } else {
                for ((r || s > e.dx) && (s = e.dx) ; ++i < a;) {
                    u = n[i], u.x = o, u.y = c, u.dx = s, c += u.dy = Math.min(e.y + e.dy - c, s ? l(u.area / s) : 0);
                } u.z = !1, u.dy += e.y + e.dy - c, e.x += s, e.dx -= s;
            }
        } function i(r) {
            var u = a || o(r), i = u[0]; return i.x = i.y = 0, i.value ? (i.dx = c[0], i.dy = c[1]) : i.dx = i.dy = 0, a && o.revalue(i), n([i], i.dx * i.dy / i.value), (a ? e : t)(i), h && (a = u), u;
        } var a, o = oa.layout.hierarchy(), l = Math.round, c = [1, 1], s = null, f = Ou, h = !1, g = "squarify", p = 0.5 * (1 + Math.sqrt(5));
        return i.size = function (n) { return arguments.length ? (c = n, i) : c; }, i.padding = function (n) {
            function t(t) {
                var e = n.call(i, t, t.depth);
                return null == e ? Ou(t) : Iu(t, "number" == typeof e ? [e, e, e, e] : e);
            } function e(t) { return Iu(t, n); } if (!arguments.length) {
                return s;
            } var r; return f = null == (s = n) ? Ou : "function" == (r = typeof n) ? t : "number" === r ? (n = [n, n, n, n], e) : e, i;
        }, i.round = function (n) {
            return arguments.length ? (l = n ? Math.round : Number, i) : l != Number;
        }, i.sticky = function (n) { return arguments.length ? (h = n, a = null, i) : h; }, i.ratio = function (n) {
            return arguments.length ? (p = n, i) : p;
        }, i.mode = function (n) { return arguments.length ? (g = n + "", i) : g; }, uu(i, o);
    }, oa.random = {
        normal: function (n, t) {
            var e = arguments.length;
            return 2 > e && (t = 1), 1 > e && (n = 0), function () {
                var e, r, u; do {
                    e = 2 * Math.random() - 1, r = 2 * Math.random() - 1, u = e * e + r * r;
                } while (!u || u > 1); return n + t * e * Math.sqrt(-2 * Math.log(u) / u);
            };
        }, logNormal: function () {
            var n = oa.random.normal.apply(oa, arguments);
            return function () { return Math.exp(n()); };
        }, bates: function (n) {
            var t = oa.random.irwinHall(n); return function () {
                return t() / n;
            };
        }, irwinHall: function (n) { return function () { for (var t = 0, e = 0; n > e; e++) { t += Math.random(); } return t; }; }
    }, oa.scale = {};
    var wl = { floor: y, ceil: y }; oa.scale.linear = function () { return Wu([0, 1], [0, 1], Mr, !1); }; var Sl = { s: 1, g: 1, p: 1, r: 1, e: 1 };
    oa.scale.log = function () { return ri(oa.scale.linear().domain([0, 1]), 10, !0, [1, 10]); }; var kl = oa.format(".0e"), Nl = {
        floor: function (n) {
            return -Math.ceil(-n);
        }, ceil: function (n) { return -Math.floor(-n); }
    }; oa.scale.pow = function () {
        return ui(oa.scale.linear(), 1, [0, 1]);
    }, oa.scale.sqrt = function () { return oa.scale.pow().exponent(0.5); }, oa.scale.ordinal = function () {
        return ai([], { t: "range", a: [[]] });
    }, oa.scale.category10 = function () { return oa.scale.ordinal().range(El); }, oa.scale.category20 = function () {
        return oa.scale.ordinal().range(Al);
    }, oa.scale.category20b = function () { return oa.scale.ordinal().range(Cl); }, oa.scale.category20c = function () {
        return oa.scale.ordinal().range(zl);
    }; var El = [2062260, 16744206, 2924588, 14034728, 9725885, 9197131, 14907330, 8355711, 12369186, 1556175].map(xn), Al = [2062260, 11454440, 16744206, 16759672, 2924588, 10018698, 14034728, 16750742, 9725885, 12955861, 9197131, 12885140, 14907330, 16234194, 8355711, 13092807, 12369186, 14408589, 1556175, 10410725].map(xn), Cl = [3750777, 5395619, 7040719, 10264286, 6519097, 9216594, 11915115, 13556636, 9202993, 12426809, 15186514, 15190932, 8666169, 11356490, 14049643, 15177372, 8077683, 10834324, 13528509, 14589654].map(xn), zl = [3244733, 7057110, 10406625, 13032431, 15095053, 16616764, 16625259, 16634018, 3253076, 7652470, 10607003, 13101504, 7695281, 10394312, 12369372, 14342891, 6513507, 9868950, 12434877, 14277081].map(xn);
    oa.scale.quantile = function () { return oi([], []); }, oa.scale.quantize = function () { return li(0, 1, [0, 1]); }, oa.scale.threshold = function () {
        return ci([0.5], [0, 1]);
    }, oa.scale.identity = function () { return si([0, 1]); }, oa.svg = {}, oa.svg.arc = function () {
        function n() {
            var n = Math.max(0, +e.apply(this, arguments)), c = Math.max(0, +r.apply(this, arguments)), s = a.apply(this, arguments) - Ha, f = o.apply(this, arguments) - Ha, h = Math.abs(f - s), g = s > f ? 0 : 1;
            if (n > c && (p = c, c = n, n = p), h >= Fa) { return t(c, g) + (n ? t(n, 1 - g) : "") + "Z"; } var p, v, d, m, y, M, x, b, _, w, S, k, N = 0, E = 0, A = [];
            if ((m = (+l.apply(this, arguments) || 0) / 2) && (d = i === Ll ? Math.sqrt(n * n + c * c) : +i.apply(this, arguments), g || (E *= -1), c && (E = tn(d / c * Math.sin(m))), n && (N = tn(d / n * Math.sin(m)))), c) {
                y = c * Math.cos(s + E), M = c * Math.sin(s + E), x = c * Math.cos(f - E), b = c * Math.sin(f - E);
                var C = Math.abs(f - s - 2 * E) <= ja ? 0 : 1; if (E && mi(y, M, x, b) === g ^ C) {
                    var z = (s + f) / 2; y = c * Math.cos(z), M = c * Math.sin(z), x = b = null;
                }
            } else { y = M = 0; } if (n) {
                _ = n * Math.cos(f - N), w = n * Math.sin(f - N), S = n * Math.cos(s + N), k = n * Math.sin(s + N); var L = Math.abs(s - f + 2 * N) <= ja ? 0 : 1;
                if (N && mi(_, w, S, k) === 1 - g ^ L) { var q = (s + f) / 2; _ = n * Math.cos(q), w = n * Math.sin(q), S = k = null; }
            } else { _ = w = 0; } if (h > Da && (p = Math.min(Math.abs(c - n) / 2, +u.apply(this, arguments))) > 0.001) {
                v = c > n ^ g ? 0 : 1;
                var T = p, R = p; if (ja > h) {
                    var D = null == S ? [_, w] : null == x ? [y, M] : Re([y, M], [S, k], [x, b], [_, w]), P = y - D[0], j = M - D[1], U = x - D[0], F = b - D[1], H = 1 / Math.sin(Math.acos((P * U + j * F) / (Math.sqrt(P * P + j * j) * Math.sqrt(U * U + F * F))) / 2), O = Math.sqrt(D[0] * D[0] + D[1] * D[1]);
                    R = Math.min(p, (n - O) / (H - 1)), T = Math.min(p, (c - O) / (H + 1));
                } if (null != x) {
                    var I = yi(null == S ? [_, w] : [S, k], [y, M], c, T, g), Y = yi([x, b], [_, w], c, T, g);
                    p === T ? A.push("M", I[0], "A", T, ",", T, " 0 0,", v, " ", I[1], "A", c, ",", c, " 0 ", 1 - g ^ mi(I[1][0], I[1][1], Y[1][0], Y[1][1]), ",", g, " ", Y[1], "A", T, ",", T, " 0 0,", v, " ", Y[0]) : A.push("M", I[0], "A", T, ",", T, " 0 1,", v, " ", Y[0]);
                } else { A.push("M", y, ",", M); } if (null != S) {
                    var Z = yi([y, M], [S, k], n, -R, g), V = yi([_, w], null == x ? [y, M] : [x, b], n, -R, g);
                    p === R ? A.push("L", V[0], "A", R, ",", R, " 0 0,", v, " ", V[1], "A", n, ",", n, " 0 ", g ^ mi(V[1][0], V[1][1], Z[1][0], Z[1][1]), ",", 1 - g, " ", Z[1], "A", R, ",", R, " 0 0,", v, " ", Z[0]) : A.push("L", V[0], "A", R, ",", R, " 0 0,", v, " ", Z[0]);
                } else { A.push("L", _, ",", w); }
            } else {
                A.push("M", y, ",", M), null != x && A.push("A", c, ",", c, " 0 ", C, ",", g, " ", x, ",", b), A.push("L", _, ",", w), null != S && A.push("A", n, ",", n, " 0 ", L, ",", 1 - g, " ", S, ",", k);
            } return A.push("Z"), A.join("");
        } function t(n, t) {
            return "M0," + n + "A" + n + "," + n + " 0 1," + t + " 0," + -n + "A" + n + "," + n + " 0 1," + t + " 0," + n;
        } var e = hi, r = gi, u = fi, i = Ll, a = pi, o = vi, l = di; return n.innerRadius = function (t) {
            return arguments.length ? (e = En(t), n) : e;
        }, n.outerRadius = function (t) { return arguments.length ? (r = En(t), n) : r; }, n.cornerRadius = function (t) {
            return arguments.length ? (u = En(t), n) : u;
        }, n.padRadius = function (t) { return arguments.length ? (i = t == Ll ? Ll : En(t), n) : i; }, n.startAngle = function (t) {
            return arguments.length ? (a = En(t), n) : a;
        }, n.endAngle = function (t) { return arguments.length ? (o = En(t), n) : o; }, n.padAngle = function (t) {
            return arguments.length ? (l = En(t), n) : l;
        }, n.centroid = function () {
            var n = (+e.apply(this, arguments) + +r.apply(this, arguments)) / 2, t = (+a.apply(this, arguments) + +o.apply(this, arguments)) / 2 - Ha;
            return [Math.cos(t) * n, Math.sin(t) * n];
        }, n;
    }; var Ll = "auto"; oa.svg.line = function () { return Mi(y); }; var ql = oa.map({ linear: xi, "linear-closed": bi, step: _i, "step-before": wi, "step-after": Si, basis: zi, "basis-open": Li, "basis-closed": qi, bundle: Ti, cardinal: Ei, "cardinal-open": ki, "cardinal-closed": Ni, monotone: Fi });
    ql.forEach(function (n, t) { t.key = n, t.closed = /-closed$/.test(n); }); var Tl = [0, 2 / 3, 1 / 3, 0], Rl = [0, 1 / 3, 2 / 3, 0], Dl = [0, 1 / 6, 2 / 3, 1 / 6];
    oa.svg.line.radial = function () { var n = Mi(Hi); return n.radius = n.x, delete n.x, n.angle = n.y, delete n.y, n; }, wi.reverse = Si, Si.reverse = wi, oa.svg.area = function () {
        return Oi(y);
    }, oa.svg.area.radial = function () {
        var n = Oi(Hi); return n.radius = n.x, delete n.x, n.innerRadius = n.x0, delete n.x0, n.outerRadius = n.x1, delete n.x1, n.angle = n.y, delete n.y, n.startAngle = n.y0, delete n.y0, n.endAngle = n.y1, delete n.y1, n;
    }, oa.svg.chord = function () {
        function n(n, o) {
            var l = t(this, i, n, o), c = t(this, a, n, o); return "M" + l.p0 + r(l.r, l.p1, l.a1 - l.a0) + (e(l, c) ? u(l.r, l.p1, l.r, l.p0) : u(l.r, l.p1, c.r, c.p0) + r(c.r, c.p1, c.a1 - c.a0) + u(c.r, c.p1, l.r, l.p0)) + "Z";
        } function t(n, t, e, r) {
            var u = t.call(n, e, r), i = o.call(n, u, r), a = l.call(n, u, r) - Ha, s = c.call(n, u, r) - Ha; return { r: i, a0: a, a1: s, p0: [i * Math.cos(a), i * Math.sin(a)], p1: [i * Math.cos(s), i * Math.sin(s)] };
        } function e(n, t) { return n.a0 == t.a0 && n.a1 == t.a1; } function r(n, t, e) {
            return "A" + n + "," + n + " 0 " + +(e > ja) + ",1 " + t;
        } function u(n, t, e, r) { return "Q 0,0 " + r; } var i = Me, a = xe, o = Ii, l = pi, c = vi; return n.radius = function (t) {
            return arguments.length ? (o = En(t), n) : o;
        }, n.source = function (t) { return arguments.length ? (i = En(t), n) : i; }, n.target = function (t) {
            return arguments.length ? (a = En(t), n) : a;
        }, n.startAngle = function (t) { return arguments.length ? (l = En(t), n) : l; }, n.endAngle = function (t) {
            return arguments.length ? (c = En(t), n) : c;
        }, n;
    }, oa.svg.diagonal = function () {
        function n(n, u) {
            var i = t.call(this, n, u), a = e.call(this, n, u), o = (i.y + a.y) / 2, l = [i, { x: i.x, y: o }, { x: a.x, y: o }, a];
            return l = l.map(r), "M" + l[0] + "C" + l[1] + " " + l[2] + " " + l[3];
        } var t = Me, e = xe, r = Yi; return n.source = function (e) {
            return arguments.length ? (t = En(e), n) : t;
        }, n.target = function (t) { return arguments.length ? (e = En(t), n) : e; }, n.projection = function (t) {
            return arguments.length ? (r = t, n) : r;
        }, n;
    }, oa.svg.diagonal.radial = function () {
        var n = oa.svg.diagonal(), t = Yi, e = n.projection; return n.projection = function (n) {
            return arguments.length ? e(Zi(t = n)) : t;
        }, n;
    }, oa.svg.symbol = function () {
        function n(n, r) {
            return (Pl.get(t.call(this, n, r)) || $i)(e.call(this, n, r));
        } var t = Xi, e = Vi; return n.type = function (e) { return arguments.length ? (t = En(e), n) : t; }, n.size = function (t) {
            return arguments.length ? (e = En(t), n) : e;
        }, n;
    }; var Pl = oa.map({
        circle: $i, cross: function (n) {
            var t = Math.sqrt(n / 5) / 2; return "M" + -3 * t + "," + -t + "H" + -t + "V" + -3 * t + "H" + t + "V" + -t + "H" + 3 * t + "V" + t + "H" + t + "V" + 3 * t + "H" + -t + "V" + t + "H" + -3 * t + "Z";
        }, diamond: function (n) { var t = Math.sqrt(n / (2 * Ul)), e = t * Ul; return "M0," + -t + "L" + e + ",0 0," + t + " " + -e + ",0Z"; }, square: function (n) {
            var t = Math.sqrt(n) / 2;
            return "M" + -t + "," + -t + "L" + t + "," + -t + " " + t + "," + t + " " + -t + "," + t + "Z";
        }, "triangle-down": function (n) {
            var t = Math.sqrt(n / jl), e = t * jl / 2;
            return "M0," + e + "L" + t + "," + -e + " " + -t + "," + -e + "Z";
        }, "triangle-up": function (n) {
            var t = Math.sqrt(n / jl), e = t * jl / 2;
            return "M0," + -e + "L" + t + "," + e + " " + -t + "," + e + "Z";
        }
    }); oa.svg.symbolTypes = Pl.keys(); var jl = Math.sqrt(3), Ul = Math.tan(30 * Oa);
    Aa.transition = function (n) {
        for (var t, e, r = Fl || ++Yl, u = Ki(n), i = [], a = Hl || { time: Date.now(), ease: Nr, delay: 0, duration: 250 }, o = -1, l = this.length;
        ++o < l;) { i.push(t = []); for (var c = this[o], s = -1, f = c.length; ++s < f;) { (e = c[s]) && Qi(e, s, u, r, a), t.push(e); } } return Wi(i, u, r);
    }, Aa.interrupt = function (n) { return this.each(null == n ? Ol : Bi(Ki(n))); }; var Fl, Hl, Ol = Bi(Ki()), Il = [], Yl = 0;
    Il.call = Aa.call, Il.empty = Aa.empty, Il.node = Aa.node, Il.size = Aa.size, oa.transition = function (n, t) {
        return n && n.transition ? Fl ? n.transition(t) : n : oa.selection().transition(n);
    }, oa.transition.prototype = Il, Il.select = function (n) {
        var t, e, r, u = this.id, i = this.namespace, a = []; n = A(n); for (var o = -1, l = this.length;
        ++o < l;) {
            a.push(t = []); for (var c = this[o], s = -1, f = c.length; ++s < f;) {
                (r = c[s]) && (e = n.call(r, r.__data__, s, o)) ? ("__data__" in r && (e.__data__ = r.__data__), Qi(e, s, i, u, r[i][u]), t.push(e)) : t.push(null);
            }
        } return Wi(a, i, u);
    }, Il.selectAll = function (n) {
        var t, e, r, u, i, a = this.id, o = this.namespace, l = []; n = C(n); for (var c = -1, s = this.length;
        ++c < s;) {
            for (var f = this[c], h = -1, g = f.length; ++h < g;) {
                if (r = f[h]) {
                    i = r[o][a], e = n.call(r, r.__data__, h, c), l.push(t = []);
                    for (var p = -1, v = e.length; ++p < v;) { (u = e[p]) && Qi(u, p, o, a, i), t.push(u); }
                }
            }
        } return Wi(l, o, a);
    }, Il.filter = function (n) {
        var t, e, r, u = [];
        "function" != typeof n && (n = O(n)); for (var i = 0, a = this.length; a > i; i++) {
            u.push(t = []); for (var e = this[i], o = 0, l = e.length;
            l > o; o++) { (r = e[o]) && n.call(r, r.__data__, o, i) && t.push(r); }
        } return Wi(u, this.namespace, this.id);
    }, Il.tween = function (n, t) {
        var e = this.id, r = this.namespace;
        return arguments.length < 2 ? this.node()[r][e].tween.get(n) : Y(this, null == t ? function (t) {
            t[r][e].tween.remove(n);
        } : function (u) { u[r][e].tween.set(n, t); });
    }, Il.attr = function (n, t) {
        function e() {
            this.removeAttribute(o);
        } function r() { this.removeAttributeNS(o.space, o.local); } function u(n) {
            return null == n ? e : (n += "", function () {
                var t, e = this.getAttribute(o);
                return e !== n && (t = a(e, n), function (n) { this.setAttribute(o, t(n)); });
            });
        } function i(n) {
            return null == n ? r : (n += "", function () {
                var t, e = this.getAttributeNS(o.space, o.local);
                return e !== n && (t = a(e, n), function (n) { this.setAttributeNS(o.space, o.local, t(n)); });
            });
        } if (arguments.length < 2) {
            for (t in n) {
                this.attr(t, n[t]);
            } return this;
        } var a = "transform" == n ? $r : Mr, o = oa.ns.qualify(n); return Ji(this, "attr." + n, t, o.local ? i : u);
    }, Il.attrTween = function (n, t) {
        function e(n, e) {
            var r = t.call(this, n, e, this.getAttribute(u));
            return r && function (n) { this.setAttribute(u, r(n)); };
        } function r(n, e) {
            var r = t.call(this, n, e, this.getAttributeNS(u.space, u.local));
            return r && function (n) { this.setAttributeNS(u.space, u.local, r(n)); };
        } var u = oa.ns.qualify(n); return this.tween("attr." + n, u.local ? r : e);
    }, Il.style = function (n, e, r) {
        function u() { this.style.removeProperty(n); } function i(e) {
            return null == e ? u : (e += "", function () {
                var u, i = t(this).getComputedStyle(this, null).getPropertyValue(n);
                return i !== e && (u = Mr(i, e), function (t) { this.style.setProperty(n, u(t), r); });
            });
        } var a = arguments.length; if (3 > a) {
            if ("string" != typeof n) {
                2 > a && (e = "");
                for (r in n) { this.style(r, n[r], e); } return this;
            } r = "";
        } return Ji(this, "style." + n, e, i);
    }, Il.styleTween = function (n, e, r) {
        function u(u, i) {
            var a = e.call(this, u, i, t(this).getComputedStyle(this, null).getPropertyValue(n));
            return a && function (t) { this.style.setProperty(n, a(t), r); };
        } return arguments.length < 3 && (r = ""), this.tween("style." + n, u);
    }, Il.text = function (n) { return Ji(this, "text", n, Gi); }, Il.remove = function () {
        var n = this.namespace; return this.each("end.transition", function () {
            var t;
            this[n].count < 2 && (t = this.parentNode) && t.removeChild(this);
        });
    }, Il.ease = function (n) {
        var t = this.id, e = this.namespace;
        return arguments.length < 1 ? this.node()[e][t].ease : ("function" != typeof n && (n = oa.ease.apply(oa, arguments)), Y(this, function (r) {
            r[e][t].ease = n;
        }));
    }, Il.delay = function (n) {
        var t = this.id, e = this.namespace; return arguments.length < 1 ? this.node()[e][t].delay : Y(this, "function" == typeof n ? function (r, u, i) {
            r[e][t].delay = +n.call(r, r.__data__, u, i);
        } : (n = +n, function (r) { r[e][t].delay = n; }));
    }, Il.duration = function (n) {
        var t = this.id, e = this.namespace; return arguments.length < 1 ? this.node()[e][t].duration : Y(this, "function" == typeof n ? function (r, u, i) {
            r[e][t].duration = Math.max(1, n.call(r, r.__data__, u, i));
        } : (n = Math.max(1, n), function (r) { r[e][t].duration = n; }));
    }, Il.each = function (n, t) {
        var e = this.id, r = this.namespace;
        if (arguments.length < 2) {
            var u = Hl, i = Fl; try {
                Fl = e, Y(this, function (t, u, i) {
                    Hl = t[r][e], n.call(t, t.__data__, u, i);
                });
            } finally { Hl = u, Fl = i; }
        } else {
            Y(this, function (u) {
                var i = u[r][e]; (i.event || (i.event = oa.dispatch("start", "end", "interrupt"))).on(n, t);
            });
        } return this;
    }, Il.transition = function () {
        for (var n, t, e, r, u = this.id, i = ++Yl, a = this.namespace, o = [], l = 0, c = this.length;
        c > l; l++) {
            o.push(n = []); for (var t = this[l], s = 0, f = t.length; f > s; s++) {
                (e = t[s]) && (r = e[a][u], Qi(e, s, a, i, { time: r.time, ease: r.ease, delay: r.delay + r.duration, duration: r.duration })), n.push(e);
            }
        } return Wi(o, a, i);
    }, oa.svg.axis = function () {
        function n(n) {
            n.each(function () {
                var n, c = oa.select(this), s = this.__chart__ || e, f = this.__chart__ = e.copy(), h = null == l ? f.ticks ? f.ticks.apply(f, o) : f.domain() : l, g = null == t ? f.tickFormat ? f.tickFormat.apply(f, o) : y : t, p = c.selectAll(".tick").data(h, f), v = p.enter().insert("g", ".domain").attr("class", "tick").style("opacity", Da), d = oa.transition(p.exit()).style("opacity", Da).remove(), m = oa.transition(p.order()).style("opacity", 1), M = Math.max(u, 0) + a, x = Zu(f), b = c.selectAll(".domain").data([0]), _ = (b.enter().append("path").attr("class", "domain"), oa.transition(b));
                v.append("line"), v.append("text"); var w, S, k, N, E = v.select("line"), A = m.select("line"), C = p.select("text").text(g), z = v.select("text"), L = m.select("text"), q = "top" === r || "left" === r ? -1 : 1;
                if ("bottom" === r || "top" === r ? (n = na, w = "x", k = "y", S = "x2", N = "y2", C.attr("dy", 0 > q ? "0em" : ".71em").style("text-anchor", "middle"), _.attr("d", "M" + x[0] + "," + q * i + "V0H" + x[1] + "V" + q * i)) : (n = ta, w = "y", k = "x", S = "y2", N = "x2", C.attr("dy", ".32em").style("text-anchor", 0 > q ? "end" : "start"), _.attr("d", "M" + q * i + "," + x[0] + "H0V" + x[1] + "H" + q * i)), E.attr(N, q * u), z.attr(k, q * M), A.attr(S, 0).attr(N, q * u), L.attr(w, 0).attr(k, q * M), f.rangeBand) {
                    var T = f, R = T.rangeBand() / 2;
                    s = f = function (n) { return T(n) + R; };
                } else { s.rangeBand ? s = f : d.call(n, f, s); } v.call(n, s, f), m.call(n, f, f);
            });
        } var t, e = oa.scale.linear(), r = Zl, u = 6, i = 6, a = 3, o = [10], l = null;
        return n.scale = function (t) { return arguments.length ? (e = t, n) : e; }, n.orient = function (t) {
            return arguments.length ? (r = t in Vl ? t + "" : Zl, n) : r;
        }, n.ticks = function () { return arguments.length ? (o = ca(arguments), n) : o; }, n.tickValues = function (t) {
            return arguments.length ? (l = t, n) : l;
        }, n.tickFormat = function (e) { return arguments.length ? (t = e, n) : t; }, n.tickSize = function (t) {
            var e = arguments.length;
            return e ? (u = +t, i = +arguments[e - 1], n) : u;
        }, n.innerTickSize = function (t) {
            return arguments.length ? (u = +t, n) : u;
        }, n.outerTickSize = function (t) { return arguments.length ? (i = +t, n) : i; }, n.tickPadding = function (t) {
            return arguments.length ? (a = +t, n) : a;
        }, n.tickSubdivide = function () { return arguments.length && n; }, n;
    }; var Zl = "bottom", Vl = { top: 1, right: 1, bottom: 1, left: 1 };
    oa.svg.brush = function () {
        function n(t) {
            t.each(function () {
                var t = oa.select(this).style("pointer-events", "all").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)").on("mousedown.brush", i).on("touchstart.brush", i), a = t.selectAll(".background").data([0]);
                a.enter().append("rect").attr("class", "background").style("visibility", "hidden").style("cursor", "crosshair"), t.selectAll(".extent").data([0]).enter().append("rect").attr("class", "extent").style("cursor", "move");
                var o = t.selectAll(".resize").data(v, y); o.exit().remove(), o.enter().append("g").attr("class", function (n) {
                    return "resize " + n;
                }).style("cursor", function (n) { return Xl[n]; }).append("rect").attr("x", function (n) {
                    return /[ew]$/.test(n) ? -3 : null;
                }).attr("y", function (n) { return /^[ns]/.test(n) ? -3 : null; }).attr("width", 6).attr("height", 6).style("visibility", "hidden"), o.style("display", n.empty() ? "none" : null);
                var l, f = oa.transition(t), h = oa.transition(a); c && (l = Zu(c), h.attr("x", l[0]).attr("width", l[1] - l[0]), r(f)), s && (l = Zu(s), h.attr("y", l[0]).attr("height", l[1] - l[0]), u(f)), e(f);
            });
        } function e(n) {
            n.selectAll(".resize").attr("transform", function (n) {
                return "translate(" + f[+/e$/.test(n)] + "," + h[+/^s/.test(n)] + ")";
            });
        } function r(n) {
            n.select(".extent").attr("x", f[0]), n.selectAll(".extent,.n>rect,.s>rect").attr("width", f[1] - f[0]);
        } function u(n) {
            n.select(".extent").attr("y", h[0]), n.selectAll(".extent,.e>rect,.w>rect").attr("height", h[1] - h[0]);
        } function i() {
            function i() { 32 == oa.event.keyCode && (C || (M = null, L[0] -= f[1], L[1] -= h[1], C = 2), S()); } function v() {
                32 == oa.event.keyCode && 2 == C && (L[0] += f[1], L[1] += h[1], C = 0, S());
            } function d() {
                var n = oa.mouse(b), t = !1; x && (n[0] += x[0], n[1] += x[1]), C || (oa.event.altKey ? (M || (M = [(f[0] + f[1]) / 2, (h[0] + h[1]) / 2]), L[0] = f[+(n[0] < M[0])], L[1] = h[+(n[1] < M[1])]) : M = null), E && m(n, c, 0) && (r(k), t = !0), A && m(n, s, 1) && (u(k), t = !0), t && (e(k), w({ type: "brush", mode: C ? "move" : "resize" }));
            } function m(n, t, e) {
                var r, u, i = Zu(t), l = i[0], c = i[1], s = L[e], v = e ? h : f, d = v[1] - v[0]; return C && (l -= s, c -= d + s), r = (e ? p : g) ? Math.max(l, Math.min(c, n[e])) : n[e], C ? u = (r += s) + d : (M && (s = Math.max(l, Math.min(c, 2 * M[e] - r))), r > s ? (u = r, r = s) : u = s), v[0] != r || v[1] != u ? (e ? o = null : a = null, v[0] = r, v[1] = u, !0) : void 0;
            } function y() {
                d(), k.style("pointer-events", "all").selectAll(".resize").style("display", n.empty() ? "none" : null), oa.select("body").style("cursor", null), q.on("mousemove.brush", null).on("mouseup.brush", null).on("touchmove.brush", null).on("touchend.brush", null).on("keydown.brush", null).on("keyup.brush", null), z(), w({ type: "brushend" });
            } var M, x, b = this, _ = oa.select(oa.event.target), w = l.of(b, arguments), k = oa.select(b), N = _.datum(), E = !/^(n|s)$/.test(N) && c, A = !/^(e|w)$/.test(N) && s, C = _.classed("extent"), z = W(b), L = oa.mouse(b), q = oa.select(t(b)).on("keydown.brush", i).on("keyup.brush", v);
            if (oa.event.changedTouches ? q.on("touchmove.brush", d).on("touchend.brush", y) : q.on("mousemove.brush", d).on("mouseup.brush", y), k.interrupt().selectAll("*").interrupt(), C) {
                L[0] = f[0] - L[0], L[1] = h[0] - L[1];
            } else {
                if (N) { var T = +/w$/.test(N), R = +/^n/.test(N); x = [f[1 - T] - L[0], h[1 - R] - L[1]], L[0] = f[T], L[1] = h[R]; } else {
                    oa.event.altKey && (M = L.slice());
                }
            } k.style("pointer-events", "none").selectAll(".resize").style("display", null), oa.select("body").style("cursor", _.style("cursor")), w({ type: "brushstart" }), d();
        } var a, o, l = N(n, "brushstart", "brush", "brushend"), c = null, s = null, f = [0, 0], h = [0, 0], g = !0, p = !0, v = $l[0]; return n.event = function (n) {
            n.each(function () {
                var n = l.of(this, arguments), t = { x: f, y: h, i: a, j: o }, e = this.__chart__ || t;
                this.__chart__ = t, Fl ? oa.select(this).transition().each("start.brush", function () {
                    a = e.i, o = e.j, f = e.x, h = e.y, n({ type: "brushstart" });
                }).tween("brush:brush", function () {
                    var e = xr(f, t.x), r = xr(h, t.y); return a = o = null, function (u) {
                        f = t.x = e(u), h = t.y = r(u), n({ type: "brush", mode: "resize" });
                    };
                }).each("end.brush", function () { a = t.i, o = t.j, n({ type: "brush", mode: "resize" }), n({ type: "brushend" }); }) : (n({ type: "brushstart" }), n({ type: "brush", mode: "resize" }), n({ type: "brushend" }));
            });
        }, n.x = function (t) { return arguments.length ? (c = t, v = $l[!c << 1 | !s], n) : c; }, n.y = function (t) {
            return arguments.length ? (s = t, v = $l[!c << 1 | !s], n) : s;
        }, n.clamp = function (t) {
            return arguments.length ? (c && s ? (g = !!t[0], p = !!t[1]) : c ? g = !!t : s && (p = !!t), n) : c && s ? [g, p] : c ? g : s ? p : null;
        }, n.extent = function (t) {
            var e, r, u, i, l; return arguments.length ? (c && (e = t[0], r = t[1], s && (e = e[0], r = r[0]), a = [e, r], c.invert && (e = c(e), r = c(r)), e > r && (l = e, e = r, r = l), (e != f[0] || r != f[1]) && (f = [e, r])), s && (u = t[0], i = t[1], c && (u = u[1], i = i[1]), o = [u, i], s.invert && (u = s(u), i = s(i)), u > i && (l = u, u = i, i = l), (u != h[0] || i != h[1]) && (h = [u, i])), n) : (c && (a ? (e = a[0], r = a[1]) : (e = f[0], r = f[1], c.invert && (e = c.invert(e), r = c.invert(r)), e > r && (l = e, e = r, r = l))), s && (o ? (u = o[0], i = o[1]) : (u = h[0], i = h[1], s.invert && (u = s.invert(u), i = s.invert(i)), u > i && (l = u, u = i, i = l))), c && s ? [[e, u], [r, i]] : c ? [e, r] : s && [u, i]);
        }, n.clear = function () { return n.empty() || (f = [0, 0], h = [0, 0], a = o = null), n; }, n.empty = function () {
            return !!c && f[0] == f[1] || !!s && h[0] == h[1];
        }, oa.rebind(n, l, "on");
    }; var Xl = { n: "ns-resize", e: "ew-resize", s: "ns-resize", w: "ew-resize", nw: "nwse-resize", ne: "nesw-resize", se: "nwse-resize", sw: "nesw-resize" }, $l = [["n", "e", "s", "w", "nw", "ne", "se", "sw"], ["e", "w"], ["n", "s"], []], Bl = ho.format = Mo.timeFormat, Wl = Bl.utc, Jl = Wl("%Y-%m-%dT%H:%M:%S.%LZ");
    Bl.iso = Date.prototype.toISOString && +new Date("2000-01-01T00:00:00.000Z") ? ea : Jl, ea.parse = function (n) {
        var t = new Date(n);
        return isNaN(t) ? null : t;
    }, ea.toString = Jl.toString, ho.second = On(function (n) {
        return new go(1000 * Math.floor(n / 1000));
    }, function (n, t) { n.setTime(n.getTime() + 1000 * Math.floor(t)); }, function (n) { return n.getSeconds(); }), ho.seconds = ho.second.range, ho.seconds.utc = ho.second.utc.range, ho.minute = On(function (n) {
        return new go(60000 * Math.floor(n / 60000));
    }, function (n, t) { n.setTime(n.getTime() + 60000 * Math.floor(t)); }, function (n) { return n.getMinutes(); }), ho.minutes = ho.minute.range, ho.minutes.utc = ho.minute.utc.range, ho.hour = On(function (n) {
        var t = n.getTimezoneOffset() / 60;
        return new go(3600000 * (Math.floor(n / 3600000 - t) + t));
    }, function (n, t) {
        n.setTime(n.getTime() + 3600000 * Math.floor(t));
    }, function (n) { return n.getHours(); }), ho.hours = ho.hour.range, ho.hours.utc = ho.hour.utc.range, ho.month = On(function (n) {
        return n = ho.day(n), n.setDate(1), n;
    }, function (n, t) { n.setMonth(n.getMonth() + t); }, function (n) { return n.getMonth(); }), ho.months = ho.month.range, ho.months.utc = ho.month.utc.range;
    var Gl = [1000, 5000, 15000, 30000, 60000, 300000, 900000, 1800000, 3600000, 10800000, 21600000, 43200000, 86400000, 172800000, 604800000, 2592000000, 7776000000, 31536000000], Kl = [[ho.second, 1], [ho.second, 5], [ho.second, 15], [ho.second, 30], [ho.minute, 1], [ho.minute, 5], [ho.minute, 15], [ho.minute, 30], [ho.hour, 1], [ho.hour, 3], [ho.hour, 6], [ho.hour, 12], [ho.day, 1], [ho.day, 2], [ho.week, 1], [ho.month, 1], [ho.month, 3], [ho.year, 1]], Ql = Bl.multi([[".%L", function (n) {
        return n.getMilliseconds();
    }], [":%S", function (n) { return n.getSeconds(); }], ["%I:%M", function (n) { return n.getMinutes(); }], ["%I %p", function (n) {
        return n.getHours();
    }], ["%a %d", function (n) { return n.getDay() && 1 != n.getDate(); }], ["%b %d", function (n) {
        return 1 != n.getDate();
    }], ["%B", function (n) { return n.getMonth(); }], ["%Y", zt]]), nc = {
        range: function (n, t, e) {
            return oa.range(Math.ceil(n / e) * e, +t, e).map(ua);
        }, floor: y, ceil: y
    }; Kl.year = ho.year, ho.scale = function () { return ra(oa.scale.linear(), Kl, Ql); }; var tc = Kl.map(function (n) {
        return [n[0].utc, n[1]];
    }), ec = Wl.multi([[".%L", function (n) { return n.getUTCMilliseconds(); }], [":%S", function (n) {
        return n.getUTCSeconds();
    }], ["%I:%M", function (n) { return n.getUTCMinutes(); }], ["%I %p", function (n) { return n.getUTCHours(); }], ["%a %d", function (n) {
        return n.getUTCDay() && 1 != n.getUTCDate();
    }], ["%b %d", function (n) { return 1 != n.getUTCDate(); }], ["%B", function (n) { return n.getUTCMonth(); }], ["%Y", zt]]);
    tc.year = ho.year.utc, ho.scale.utc = function () { return ra(oa.scale.linear(), tc, ec); }, oa.text = An(function (n) {
        return n.responseText;
    }), oa.json = function (n, t) { return Cn(n, "application/json", ia, t); }, oa.html = function (n, t) {
        return Cn(n, "text/html", aa, t);
    }, oa.xml = An(function (n) { return n.responseXML; }), "function" == typeof define && define.amd ? (this.d3 = oa, define(oa)) : "object" == typeof module && module.exports ? module.exports = oa : this.d3 = oa;
}(); 
(function () {
    function iScroll(el, eventTarget, options) {
        this.element = typeof el == "object" ? el : document.getElementById(el);
        this.wrapper = this.element.parentNode; this.eventTarget = eventTarget ? eventTarget : this.element; this.setScrollStyles(this.element);
        this.options = { bounce: has3d, momentum: has3d, checkDOMChanges: true, topOnDOMChanges: false, hScrollbar: has3d, vScrollbar: has3d, hScrollbarEnabled: true, vhScrollbarEnabled: true, fadeScrollbar: isIphone || isIpad || !isTouch, shrinkScrollbar: isIphone || isIpad, desktopCompatibility: false, overflow: "hidden", notifyOnPositionChanged: false, disableWhenZoomed: true };
        if (typeof options == "object") { for (var i in options) { this.options[i] = options[i]; } } if (this.options.desktopCompatibility) {
            this.options.overflow = "hidden";
        } this.wrapper.style.overflow = this.options.overflow; this.refresh(); if (isTouch || this.options.desktopCompatibility) {
            this.eventTarget.addEventListener(START_EVENT, this, false);
        } if (this.options.checkDOMChanges) {
            this.eventTarget.addEventListener("DOMSubtreeModified", this, false);
        } if (this.options.disableWhenZoomed) {
            var me = this; var disableWhenZoomed = function () {
                window.setTimeout(function () {
                    me.disabled = Math.abs(window.innerWidth - document.body.scrollWidth) > 5;
                }, 0);
            }; document.addEventListener("gestureend", disableWhenZoomed, false); document.addEventListener("touchend", disableWhenZoomed, false);
        }
    } iScroll.prototype = {
        x: 0, y: 0, dist: 0, setScrollPositionAndTargets: function (xPosition, yPosition, scrollTargets) {
            this.scrollTargets = scrollTargets;
            for (var i = 0; i < scrollTargets.length; i++) {
                var elementDiv = document.getElementById(scrollTargets[i].id); this.setScrollStyles(elementDiv);
            } this.setPositionPrivate(xPosition, yPosition, true);
        }, setScrollStyles: function (element) {
            element.style.webkitTransitionProperty = "-webkit-transform";
            element.style.webkitTransitionTimingFunction = "cubic-bezier(0,0,0.25,1)"; element.style.webkitTransitionDuration = "0";
            element.style.top = 0; element.style.left = 0;
        }, handleEvent: function (e) {
            switch (e.type) {
                case START_EVENT: this.touchStart(e);
                    break; case MOVE_EVENT: this.touchMove(e); break; case END_EVENT: this.touchEnd(e); break; case "webkitTransitionEnd": this.transitionEnd(e);
                        break; case "DOMSubtreeModified": this.onDOMModified(e); break;
            }
        }, onDOMModified: function (e) {
            this.refresh();
            if (this.options.topOnDOMChanges && (this.x != 0 || this.y != 0)) { this.scrollTo(0, 0, "0"); }
        }, refresh: function () {
            window.clearTimeout(this.refreshTimer);
            var me = this; this.refreshTimer = window.setTimeout(function () { me.refreshCore(); }, 500);
        }, refreshCore: function () {
            this.scrollWidth = this.wrapper.clientWidth;
            this.scrollHeight = this.wrapper.clientHeight; this.maxScrollX = this.scrollWidth - this.getWidth(); this.maxScrollY = this.scrollHeight - this.getHeight();
            var resetX = this.x, resetY = this.y; if (this.scrollX) {
                if (this.maxScrollX >= 0) { resetX = 0; } else {
                    if (this.x < this.maxScrollX) {
                        resetX = this.maxScrollX;
                    }
                }
            } if (this.scrollY) {
                if (this.maxScrollY >= 0) { resetY = 0; } else {
                    if (this.y < this.maxScrollY) {
                        resetY = this.maxScrollY;
                    }
                }
            } if (resetX != this.x || resetY != this.y) { this.setTransitionTime("0"); this.setPosition(resetX, resetY); } this.scrollX = this.getWidth() > this.scrollWidth && this.options.hScrollbarEnabled ? true : false;
            this.scrollY = this.getHeight() > this.scrollHeight && this.options.vhScrollbarEnabled ? true : false; if (this.options.hScrollbar && this.scrollX) {
                this.scrollBarX = (this.scrollBarX instanceof scrollbar) ? this.scrollBarX : new scrollbar("horizontal", this.wrapper, this.options.fadeScrollbar, this.options.shrinkScrollbar);
                this.scrollBarX.init(this.scrollWidth, this.getWidth()); this.scrollBarX.setPosition(this.x, true);
            } else {
                if (this.scrollBarX) {
                    this.scrollBarX = this.scrollBarX.remove();
                }
            } if (this.options.vScrollbar && this.scrollY && this.getHeight() > this.scrollHeight) {
                this.scrollBarY = (this.scrollBarY instanceof scrollbar) ? this.scrollBarY : new scrollbar("vertical", this.wrapper, this.options.fadeScrollbar, this.options.shrinkScrollbar);
                this.scrollBarY.init(this.scrollHeight, this.getHeight()); this.scrollBarY.setPosition(this.y, true);
            } else {
                if (this.scrollBarY) {
                    this.scrollBarY = this.scrollBarY.remove();
                }
            }
        }, getWidth: function () { return this.element.scrollWidth; }, getHeight: function () {
            return this.element.offsetHeight;
        }, setPosition: function (x, y) { this.setPositionPrivate(x, y, true); }, scrollTop: function (value) {
            if (value === undefined) {
                var pos = this.getPosition();
                return -pos.y;
            } else { var pos = this.getPosition(); this.setPosition(pos.x, -value); }
        }, scrollLeft: function (value) {
            if (value === undefined) {
                var pos = this.getPosition();
                return -pos.x;
            } else { var pos = this.getPosition(); this.setPosition(-value, pos.y); }
        }, getPosition: function () {
            var offset = { x: 0, y: 0 };
            if (this.element.style.webkitTransform) {
                var transform = this.element.style.webkitTransform; var index = transform.indexOf("translate3d");
                if (index != -1) {
                    var first = transform.indexOf(","); var second = transform.lastIndexOf(","); var yStr = transform.substring(first + 1, second);
                    offset.y += parseInt(yStr); first = transform.indexOf("("); second = transform.indexOf(","); var xStr = transform.substring(first + 1, second);
                    offset.x += parseInt(xStr);
                }
            } return offset;
        }, setPositionPrivate: function (x, y, hideScrollBars) {
            this.x = this.options.hScrollbarEnabled ? x : 0;
            this.y = this.options.vhScrollbarEnabled ? y : 0; this.element.style.webkitTransform = has3d ? "translate3d(" + this.x + "px," + this.y + "px,0px)" : "translate(" + this.x + "px," + this.y + "px)";
            if (this.scrollTargets) {
                for (var i = 0; i < this.scrollTargets.length; i++) {
                    var target = this.scrollTargets[i];
                    var targetDiv = document.getElementById(target.id); if (!targetDiv) { continue; } var targetX = this.x; var targetY = this.y;
                    switch (target.scroll) { case "horizontal": targetY = 0; break; case "vertical": targetX = 0; break; default: break; } targetDiv.style.webkitTransform = has3d ? "translate3d(" + targetX + "px," + targetY + "px,0px)" : "translate(" + targetX + "px," + targetY + "px)";
                }
            } if (!hideScrollBars) {
                if (this.scrollBarX) { this.scrollBarX.setPosition(this.x); } if (this.scrollBarY) {
                    this.scrollBarY.setPosition(this.y);
                }
            } if (this.options.notifyOnPositionChanged) {
                if (this.onScroll) {
                    this.onScroll(this.x, this.y, this.wrapper);
                }
            }
        }, setTransitionTime: function (time) {
            time = time || "0"; this.element.style.webkitTransitionDuration = time;
            if (this.scrollTargets) {
                for (var i = 0; i < this.scrollTargets.length; i++) {
                    var targetDiv = document.getElementById(this.scrollTargets[i].id);
                    if (targetDiv) { targetDiv.style.webkitTransitionDuration = time; }
                }
            } if (this.scrollBarX) {
                this.scrollBarX.bar.style.webkitTransitionDuration = time;
                this.scrollBarX.wrapper.style.webkitTransitionDuration = has3d && this.options.fadeScrollbar ? "300ms" : "0";
            } if (this.scrollBarY) {
                this.scrollBarY.bar.style.webkitTransitionDuration = time; this.scrollBarY.wrapper.style.webkitTransitionDuration = has3d && this.options.fadeScrollbar ? "300ms" : "0";
            }
        }, touchStart: function (e) {
            if (e.touches.length != 1) { return false; } if (this.disabled) { return false; } e.stopPropagation();
            this.moved = false; this.dist = 0; this.setTransitionTime("0"); if (this.options.momentum) {
                var matrix = new WebKitCSSMatrix(window.getComputedStyle(this.element).webkitTransform);
                if (matrix.e != this.x || matrix.f != this.y) {
                    this.element.removeEventListener("webkitTransitionEnd", this, false);
                    this.setPositionPrivate(matrix.e, matrix.f, false); this.moved = true;
                }
            } this.refreshCore(); this.touchStartX = isTouch ? e.touches[0].pageX : e.pageX;
            this.scrollStartX = this.x; this.touchStartY = isTouch ? e.touches[0].pageY : e.pageY; this.scrollStartY = this.y;
            this.scrollStartTime = e.timeStamp; this.eventTarget.addEventListener(MOVE_EVENT, this, false); this.eventTarget.addEventListener(END_EVENT, this, false);
        }, touchMove: function (e) {
            if (e.touches.length != 1) { return false; } if (this.disabled) { return false; } Touch.clickBlocker();
            e.preventDefault(); var pageX = isTouch ? e.touches[0].pageX : e.pageX, pageY = isTouch ? e.touches[0].pageY : e.pageY, leftDelta = this.scrollX === true ? pageX - this.touchStartX : 0, topDelta = this.scrollY === true ? pageY - this.touchStartY : 0, newX = this.x + leftDelta, newY = this.y + topDelta;
            this.dist += Math.abs(this.touchStartX - pageX) + Math.abs(this.touchStartY - pageY); this.touchStartX = pageX; this.touchStartY = pageY;
            if (newX > 0 || newX < this.maxScrollX) {
                newX = this.options.bounce ? Math.round(this.x + leftDelta / 3) : newX >= 0 ? 0 : this.maxScrollX;
            } if (newY > 0 || newY < this.maxScrollY) {
                newY = this.options.bounce ? Math.round(this.y + topDelta / 3) : newY >= 0 ? 0 : this.maxScrollY;
            } if (this.dist > 5) { this.setPositionPrivate(newX, newY, false); this.moved = true; }
        }, touchEnd: function (e) {
            this.eventTarget.removeEventListener(MOVE_EVENT, this, false);
            this.eventTarget.removeEventListener(END_EVENT, this, false); var time = e.timeStamp - this.scrollStartTime;
            if (!this.moved) { this.resetPosition(); return false; } if (!this.options.momentum || time > 250) {
                this.resetPosition();
                if (this.onScroll) { this.onScroll(this.x, this.y, this.wrapper); } return false;
            } var momentumX = this.scrollX === true ? this.momentum(this.x - this.scrollStartX, time, this.options.bounce ? -this.x + this.scrollWidth / 5 : -this.x, this.options.bounce ? this.x + this.getWidth() - this.scrollWidth + this.scrollWidth / 5 : this.x + this.getWidth() - this.scrollWidth) : { dist: 0, time: 0 };
            var momentumY = this.scrollY === true ? this.momentum(this.y - this.scrollStartY, time, this.options.bounce ? -this.y + this.scrollHeight / 5 : -this.y, this.options.bounce ? (this.maxScrollY < 0 ? this.y + this.getHeight() - this.scrollHeight : 0) + this.scrollHeight / 5 : this.y + this.getHeight() - this.scrollHeight) : { dist: 0, time: 0 };
            if (!momentumX.dist && !momentumY.dist) { this.resetPosition(); return false; } var newDuration = Math.max(Math.max(momentumX.time, momentumY.time), 1);
            var newPositionX = this.x + momentumX.dist; var newPositionY = this.y + momentumY.dist; this.scrollTo(newPositionX, newPositionY, newDuration + "ms");
        }, transitionEnd: function () {
            this.element.removeEventListener("webkitTransitionEnd", this, false); this.resetPosition();
            if (this.onScroll) { this.onScroll(this.x, this.y, this.wrapper); }
        }, resetPosition: function (time) {
            var resetX = this.x, resetY = this.y, that = this, time = time || "500ms";
            if (this.x >= 0) { resetX = 0; } else { if (this.x < this.maxScrollX) { resetX = this.maxScrollX; } } if (this.y >= 0 || this.maxScrollY > 0) {
                resetY = 0;
            } else { if (this.y < this.maxScrollY) { resetY = this.maxScrollY; } } if (resetX != this.x || resetY != this.y) {
                this.scrollTo(resetX, resetY, time);
            } else {
                this.setPositionPrivate(this.x, this.y, true); if (this.scrollBarX || this.scrollBarY) {
                    if (this.scrollBarX) {
                        this.scrollBarX.hide();
                    } if (this.scrollBarY) { this.scrollBarY.hide(); }
                }
            }
        }, scrollTo: function (destX, destY, runtime) {
            this.eventTarget.addEventListener("webkitTransitionEnd", this, false);
            this.setTransitionTime(runtime || "450ms"); this.setPositionPrivate(destX, destY, false);
        }, momentum: function (dist, time, maxDistUpper, maxDistLower) {
            var friction = 2.5, deceleration = 1.2, speed = Math.abs(dist) / time * 1000, newDist = speed * speed / friction / 1000, newTime = 0;
            if (dist > 0 && newDist > maxDistUpper) { speed = speed * maxDistUpper / newDist / friction; newDist = maxDistUpper; } else {
                if (dist < 0 && newDist > maxDistLower) {
                    speed = speed * maxDistLower / newDist / friction;
                    newDist = maxDistLower;
                }
            } newDist = newDist * (dist < 0 ? -1 : 1); newTime = speed / deceleration; return { dist: Math.round(newDist), time: Math.round(newTime) };
        }, destroy: function (full) {
            this.element.removeEventListener(START_EVENT, this, false); this.element.removeEventListener(MOVE_EVENT, this, false);
            this.element.removeEventListener(END_EVENT, this, false); this.element.removeEventListener("DOMSubtreeModified", this, false);
            this.element.removeEventListener("webkitTransitionEnd", this, false); if (this.scrollBarX) {
                this.scrollBarX = this.scrollBarX.remove();
            } if (this.scrollBarY) { this.scrollBarY = this.scrollBarY.remove(); } if (full) {
                this.wrapper.parentNode.removeChild(this.wrapper);
            } return null;
        }
    }; var scrollbar = function (dir, wrapper, fade, shrink) {
        this.dir = dir; this.fade = fade; this.shrink = shrink;
        this.bar = document.createElement("div"); var style = "position:absolute;top:0;left:0;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);pointer-events:none;-webkit-transition-duration:0;-webkit-transition-delay:0;-webkit-transition-property:-webkit-transform;background:rgba(0,0,0,0.5);" + (has3d ? "-webkit-transform:translate3d(0,0,0);" : "-webkit-transform:translate(0,0);") + (dir == "horizontal" ? "-webkit-border-radius:3px 2px;min-width:6px;min-height:5px" : "-webkit-border-radius:2px 3px;min-width:5px;min-height:6px"), size, ctx;
        this.bar.setAttribute("style", style); this.wrapper = document.createElement("div"); style = "-webkit-mask:-webkit-canvas(scrollbar" + this.dir + ");position:absolute;pointer-events:none;overflow:hidden;opacity:0;-webkit-transition-duration:" + (fade ? "300ms" : "0") + ";-webkit-transition-delay:0;-webkit-transition-property:opacity;z-index:10;" + (this.dir == "horizontal" ? "bottom:2px;left:1px;right:7px;height:5px" : "top:1px;right:2px;bottom:7px;width:5px;");
        this.wrapper.setAttribute("style", style); this.wrapper.appendChild(this.bar); wrapper.appendChild(this.wrapper);
        if (this.dir == "horizontal") {
            size = this.wrapper.offsetWidth; ctx = document.getCSSCanvasContext("2d", "scrollbar" + this.dir, size, 5);
            ctx.fillStyle = "rgb(0,0,0)"; ctx.beginPath(); ctx.arc(2.5, 2.5, 2.5, Math.PI / 2, -Math.PI / 2, false); ctx.lineTo(size - 2.5, 0);
            ctx.arc(size - 2.5, 2.5, 2.5, -Math.PI / 2, Math.PI / 2, false); ctx.closePath(); ctx.fill();
        } else {
            size = this.wrapper.offsetHeight;
            ctx = document.getCSSCanvasContext("2d", "scrollbar" + this.dir, 5, size); ctx.fillStyle = "rgb(0,0,0)"; ctx.beginPath();
            ctx.arc(2.5, 2.5, 2.5, Math.PI, 0, false); ctx.lineTo(5, size - 2.5); ctx.arc(2.5, size - 2.5, 2.5, 0, Math.PI, false);
            ctx.closePath(); ctx.fill();
        }
    }; scrollbar.prototype = {
        init: function (scroll, size) {
            this.maxSize = this.dir == "horizontal" ? this.wrapper.clientWidth : this.wrapper.clientHeight;
            this.size = Math.round(this.maxSize * this.maxSize / size); this.maxScroll = this.maxSize - this.size; this.toWrapperProp = this.maxScroll / (scroll - size);
            this.bar.style[this.dir == "horizontal" ? "width" : "height"] = this.size + "px";
        }, setPosition: function (pos, hidden) {
            if (!hidden && this.wrapper.style.opacity != "1") {
                this.show();
            } pos = this.toWrapperProp * pos; if (pos < 0) {
                pos = this.shrink ? pos + pos * 3 : 0; if (this.size + pos < 5) {
                    pos = -this.size + 5;
                }
            } else {
                if (pos > this.maxScroll) {
                    pos = this.shrink ? pos + (pos - this.maxScroll) * 3 : this.maxScroll; if (this.size + this.maxScroll - pos < 5) {
                        pos = this.size + this.maxScroll - 5;
                    }
                }
            } if (has3d) {
                pos = this.dir == "horizontal" ? "translate3d(" + Math.round(pos) + "px,0,0)" : "translate3d(0," + Math.round(pos) + "px,0)";
            } else {
                pos = this.dir == "horizontal" ? "translate(" + Math.round(pos) + "px,0)" : "translate(0," + Math.round(pos) + "px)";
            } this.bar.style.webkitTransform = pos;
        }, show: function () {
            if (has3d) {
                this.wrapper.style.webkitTransitionDelay = "0";
            } this.wrapper.style.opacity = "1";
        }, hide: function () {
            if (has3d) {
                this.wrapper.style.webkitTransitionDelay = "200ms";
            } this.wrapper.style.opacity = "0";
        }, remove: function () {
            if (this.wrapper.parentNode) {
                this.wrapper.parentNode.removeChild(this.wrapper);
            } return null;
        }
    }; var has3d = ("WebKitCSSMatrix" in window && "m11" in new WebKitCSSMatrix()), isIphone = navigator.appVersion.match(/iphone/gi) ? true : false, isIpad = navigator.appVersion.match(/ipad/gi) ? true : false, isAndroid = navigator.appVersion.match(/android/gi) ? true : false, isTouch = isIphone || isIpad || isAndroid, START_EVENT = isTouch ? "touchstart" : "mousedown", MOVE_EVENT = isTouch ? "touchmove" : "mousemove", END_EVENT = isTouch ? "touchend" : "mouseup";
    window.IScroll = iScroll;
})(); 
if (typeof JSON !== "object") { JSON = {}; } 
(function () {
    var rx_one = /^[\],:{}\s]*$/, rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, rx_three = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, rx_four = /(?:^|:|,)(?:\s*\[)+/g, rx_escapable = /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, rx_dangerous = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
    function f(n) { return n < 10 ? "0" + n : n; } function this_value() { return this.valueOf(); } if (typeof Date.prototype.toJSON !== "function") {
        Date.prototype.toJSON = function () {
            return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null;
        }; Boolean.prototype.toJSON = this_value; Number.prototype.toJSON = this_value; String.prototype.toJSON = this_value;
    } var gap, indent, meta, rep; function quote(string) {
        rx_escapable.lastIndex = 0; return rx_escapable.test(string) ? '"' + string.replace(rx_escapable, function (a) {
            var c = meta[a];
            return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
        }) + '"' : '"' + string + '"';
    } function str(key, holder) {
        var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === "object" && typeof value.toJSON === "function") {
            value = value.toJSON(key);
        } if (typeof rep === "function") { value = rep.call(holder, key, value); } switch (typeof value) {
            case "string": return quote(value);
            case "number": return isFinite(value) ? String(value) : "null"; case "boolean": case "null": return String(value);
            case "object": if (!value) { return "null"; } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === "[object Array]") {
                length = value.length;
                for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || "null"; } v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]";
                gap = mind; return v;
            } if (rep && typeof rep === "object") {
                length = rep.length; for (i = 0; i < length; i += 1) {
                    if (typeof rep[i] === "string") {
                        k = rep[i];
                        v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v); }
                    }
                }
            } else {
                for (k in value) {
                    if (Object.prototype.hasOwnProperty.call(value, k)) {
                        v = str(k, value);
                        if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v); }
                    }
                }
            } v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}";
                gap = mind; return v;
        }
    } if (typeof JSON.stringify !== "function") {
        meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" };
        JSON.stringify = function (value, replacer, space) {
            var i; gap = ""; indent = ""; if (typeof space === "number") {
                for (i = 0;
                i < space; i += 1) { indent += " "; }
            } else { if (typeof space === "string") { indent = space; } } rep = replacer; if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) {
                throw new Error("JSON.stringify");
            } return str("", { "": value });
        };
    } if (typeof JSON.parse !== "function") {
        JSON.parse = function (text, reviver) {
            var j;
            function walk(holder, key) {
                var k, v, value = holder[key]; if (value && typeof value === "object") {
                    for (k in value) {
                        if (Object.prototype.hasOwnProperty.call(value, k)) {
                            v = walk(value, k);
                            if (v !== undefined) { value[k] = v; } else { delete value[k]; }
                        }
                    }
                } return reviver.call(holder, key, value);
            } text = String(text);
            rx_dangerous.lastIndex = 0; if (rx_dangerous.test(text)) {
                text = text.replace(rx_dangerous, function (a) {
                    return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
                });
            } if (rx_one.test(text.replace(rx_two, "@").replace(rx_three, "]").replace(rx_four, ""))) {
                j = eval("(" + text + ")");
                return typeof reviver === "function" ? walk({ "": j }, "") : j;
            } throw new SyntaxError("JSON.parse");
        };
    }
}()); 
(function (mod) {
    if (typeof exports == "object" && typeof module == "object") {
        mod(require("../../lib/codemirror"));
    } else {
        if (typeof define == "function" && define.amd) { define(["../../lib/codemirror"], mod); } else {
            mod(CodeMirror);
        }
    }
})
(function (CodeMirror) {
    var ie_lt8 = /MSIE \d/.test(navigator.userAgent) && (document.documentMode == null || document.documentMode < 8);
    var Pos = CodeMirror.Pos; var matching = { "(": ")>", ")": "(<", "[": "]>", "]": "[<", "{": "}>", "}": "{<" }; function findMatchingBracket(cm, where, strict, config) {
        var line = cm.getLineHandle(where.line), pos = where.ch - 1;
        var match = (pos >= 0 && matching[line.text.charAt(pos)]) || matching[line.text.charAt(++pos)]; if (!match) {
            return null;
        } var dir = match.charAt(1) == ">" ? 1 : -1; if (strict && (dir > 0) != (pos == where.ch)) { return null; } var style = cm.getTokenTypeAt(Pos(where.line, pos + 1));
        var found = scanForBracket(cm, Pos(where.line, pos + (dir > 0 ? 1 : 0)), dir, style || null, config); if (found == null) {
            return null;
        } return { from: Pos(where.line, pos), to: found && found.pos, match: found && found.ch == match.charAt(0), forward: dir > 0 };
    } function scanForBracket(cm, where, dir, style, config) {
        var maxScanLen = (config && config.maxScanLineLength) || 10000;
        var maxScanLines = (config && config.maxScanLines) || 1000; var stack = []; var re = config && config.bracketRegex ? config.bracketRegex : /[(){}[\]]/;
        var lineEnd = dir > 0 ? Math.min(where.line + maxScanLines, cm.lastLine() + 1) : Math.max(cm.firstLine() - 1, where.line - maxScanLines);
        for (var lineNo = where.line; lineNo != lineEnd; lineNo += dir) {
            var line = cm.getLine(lineNo); if (!line) {
                continue;
            } var pos = dir > 0 ? 0 : line.length - 1, end = dir > 0 ? line.length : -1; if (line.length > maxScanLen) { continue; } if (lineNo == where.line) {
                pos = where.ch - (dir < 0 ? 1 : 0);
            } for (; pos != end; pos += dir) {
                var ch = line.charAt(pos); if (re.test(ch) && (style === undefined || cm.getTokenTypeAt(Pos(lineNo, pos + 1)) == style)) {
                    var match = matching[ch];
                    if ((match.charAt(1) == ">") == (dir > 0)) { stack.push(ch); } else {
                        if (!stack.length) {
                            return { pos: Pos(lineNo, pos), ch: ch };
                        } else { stack.pop(); }
                    }
                }
            }
        } return lineNo - dir == (dir > 0 ? cm.lastLine() : cm.firstLine()) ? false : null;
    } function matchBrackets(cm, autoclear, config) {
        var maxHighlightLen = cm.state.matchBrackets.maxHighlightLineLength || 1000;
        var marks = [], ranges = cm.listSelections(); for (var i = 0; i < ranges.length; i++) {
            var match = ranges[i].empty() && findMatchingBracket(cm, ranges[i].head, false, config);
            if (match && cm.getLine(match.from.line).length <= maxHighlightLen) {
                var style = match.match ? "CodeMirror-matchingbracket" : "CodeMirror-nonmatchingbracket";
                marks.push(cm.markText(match.from, Pos(match.from.line, match.from.ch + 1), { className: style })); if (match.to && cm.getLine(match.to.line).length <= maxHighlightLen) {
                    marks.push(cm.markText(match.to, Pos(match.to.line, match.to.ch + 1), { className: style }));
                }
            }
        } if (marks.length) {
            if (ie_lt8 && cm.state.focused) { cm.display.input.focus(); } var clear = function () {
                cm.operation(function () {
                    for (var i = 0;
                    i < marks.length; i++) { marks[i].clear(); }
                });
            }; if (autoclear) { setTimeout(clear, 800); } else { return clear; }
        }
    } var currentlyHighlighted = null;
    function doMatchBrackets(cm) {
        cm.operation(function () {
            if (currentlyHighlighted) {
                currentlyHighlighted();
                currentlyHighlighted = null;
            } currentlyHighlighted = matchBrackets(cm, false, cm.state.matchBrackets);
        });
    } CodeMirror.defineOption("matchBrackets", false, function (cm, val, old) {
        if (old && old != CodeMirror.Init) {
            cm.off("cursorActivity", doMatchBrackets);
        } if (val) { cm.state.matchBrackets = typeof val == "object" ? val : {}; cm.on("cursorActivity", doMatchBrackets); }
    });
    CodeMirror.defineExtension("matchBrackets", function () { matchBrackets(this, true); }); CodeMirror.defineExtension("findMatchingBracket", function (pos, strict, config) {
        return findMatchingBracket(this, pos, strict, config);
    }); CodeMirror.defineExtension("scanForBracket", function (pos, dir, style, config) {
        return scanForBracket(this, pos, dir, style, config);
    });
}); 
if (!window.OpenAjax) {
    OpenAjax = new function () {
        var t = true; var f = false; var g = window; var ooh = "org.openajax.hub.";
        var h = {}; this.hub = h; h.implementer = "http://openajax.org"; h.implVersion = "2.0"; h.specVersion = "2.0"; h.implExtraData = {};
        var libs = {}; h.libraries = libs; h.registerLibrary = function (prefix, nsURL, version, extra) {
            libs[prefix] = { prefix: prefix, namespaceURI: nsURL, version: version, extraData: extra };
            this.publish(ooh + "registerLibrary", libs[prefix]);
        }; h.unregisterLibrary = function (prefix) {
            this.publish(ooh + "unregisterLibrary", libs[prefix]);
            delete libs[prefix];
        }; h._subscriptions = { c: {}, s: [] }; h._cleanup = []; h._subIndex = 0; h._pubDepth = 0; h.subscribe = function (name, callback, scope, subscriberData, filter) {
            if (!scope) {
                scope = window;
            } var handle = name + "." + this._subIndex; var sub = { scope: scope, cb: callback, fcb: filter, data: subscriberData, sid: this._subIndex++, hdl: handle };
            var path = name.split("."); this._subscribe(this._subscriptions, path, 0, sub); return handle;
        }; h.publish = function (name, message) {
            var path = name.split(".");
            this._pubDepth++; this._publish(this._subscriptions, path, 0, name, message); this._pubDepth--; if ((this._cleanup.length > 0) && (this._pubDepth == 0)) {
                for (var i = 0;
                i < this._cleanup.length; i++) { this.unsubscribe(this._cleanup[i].hdl); } delete (this._cleanup); this._cleanup = [];
            }
        }; h.unsubscribe = function (sub) {
            var path = sub.split("."); var sid = path.pop(); this._unsubscribe(this._subscriptions, path, 0, sid);
        }; h._subscribe = function (tree, path, index, sub) {
            var token = path[index]; if (index == path.length) {
                tree.s.push(sub);
            } else {
                if (typeof tree.c == "undefined") { tree.c = {}; } if (typeof tree.c[token] == "undefined") {
                    tree.c[token] = { c: {}, s: [] };
                    this._subscribe(tree.c[token], path, index + 1, sub);
                } else {
                    this._subscribe(tree.c[token], path, index + 1, sub);
                }
            }
        }; h._publish = function (tree, path, index, name, msg, pid) {
            if (typeof tree != "undefined") {
                var node; if (index == path.length) {
                    node = tree;
                } else {
                    this._publish(tree.c[path[index]], path, index + 1, name, msg, pid); this._publish(tree.c["*"], path, index + 1, name, msg, pid);
                    node = tree.c["**"];
                } if (typeof node != "undefined") {
                    var callbacks = node.s; var max = callbacks.length; for (var i = 0;
                    i < max; i++) {
                        if (callbacks[i].cb) {
                            var sc = callbacks[i].scope; var cb = callbacks[i].cb; var fcb = callbacks[i].fcb;
                            var d = callbacks[i].data; if (typeof cb == "string") { cb = sc[cb]; } if (typeof fcb == "string") { fcb = sc[fcb]; } if ((!fcb) || (fcb.call(sc, name, msg, d))) {
                                cb.call(sc, name, msg, d, pid);
                            }
                        }
                    }
                }
            }
        }; h._unsubscribe = function (tree, path, index, sid) {
            if (typeof tree != "undefined") {
                if (index < path.length) {
                    var childNode = tree.c[path[index]];
                    this._unsubscribe(childNode, path, index + 1, sid); if (childNode.s.length == 0) {
                        for (var x in childNode.c) {
                            return;
                        } delete tree.c[path[index]];
                    } return;
                } else {
                    var callbacks = tree.s; var max = callbacks.length; for (var i = 0; i < max;
                    i++) {
                        if (sid == callbacks[i].sid) {
                            if (this._pubDepth > 0) {
                                callbacks[i].cb = null; this._cleanup.push(callbacks[i]);
                            } else { callbacks.splice(i, 1); } return;
                        }
                    }
                }
            }
        };
    }; OpenAjax.hub.registerLibrary("OpenAjax", "http://openajax.org/hub", "1.0", {});
} 
if (!window.PageBus) {
    PageBus = new function () {
        var D = 0; var Q = []; var that = this; this.version = "2.0.0"; this._debug = function () { };
        _badParm = function () { throw new Error("OpenAjax.hub.Errors.BadParameters"); }; _valPub = function (name) {
            if ((name == null) || (name.indexOf("*") != -1) || (name.indexOf("..") != -1) || (name.charAt(0) == ".") || (name.charAt(name.length - 1) == ".")) {
                _badParm();
            }
        }; _valSub = function (name) {
            var path = name.split("."); var len = path.length; for (var i = 0; i < len; i++) {
                if ((path[i] == "") || ((path[i].indexOf("*") != -1) && (path[i] != "*") && (path[i] != "**"))) {
                    _badParm();
                } if ((path[i] == "**") && (i < len - 1)) { _badParm(); }
            } return path;
        }; _cacheIt = function (subData) {
            return ((subData) && (typeof subData == "object") && (subData.PageBus) && (subData.PageBus.cache));
        }; _TopicMatcher = function () { this._items = {}; }; _TopicMatcher.prototype.store = function (topic, val) {
            var path = topic.split(".");
            var len = path.length; _recurse = function (tree, index) {
                if (index == len) { tree["."] = { topic: topic, value: val }; } else {
                    var token = path[index];
                    if (!tree[token]) { tree[token] = {}; } _recurse(tree[token], index + 1);
                }
            }; _recurse(this._items, 0);
        }; _TopicMatcher.prototype.match = function (topic, exactMatch) {
            var path = topic.split(".");
            var len = path.length; var res = []; _recurse = function (tree, index) {
                if (!tree) { return; } var node; if (index == len) {
                    node = tree;
                } else {
                    _recurse(tree[path[index]], index + 1); if (exactMatch) { return; } if (path[index] != "**") {
                        _recurse(tree["*"], index + 1);
                    } node = tree["**"];
                } if ((!node) || (!node["."])) { return; } res.push(node["."]);
            }; _recurse(this._items, 0); return res;
        }; _TopicMatcher.prototype.exists = function (topic, exactMatch) {
            var path = topic.split("."); var len = path.length;
            var res = false; _recurse = function (tree, index) {
                if (!tree) { return; } var node; if (index == len) { node = tree; } else {
                    _recurse(tree[path[index]], index + 1);
                    if (res || exactMatch) { return; } if (path[index] != "**") { _recurse(tree["*"], index + 1); if (res) { return; } } node = tree["**"];
                } if ((!node) || (!node["."])) { return; } res = true;
            }; _recurse(this._items, 0); return res;
        }; _TopicMatcher.prototype.clear = function (topic) {
            var path = topic.split(".");
            var len = path.length; _recurse = function (tree, index) {
                if (!tree) { return; } if (index == len) {
                    if (tree["."]) {
                        delete tree["."];
                    }
                } else {
                    _recurse(tree[path[index]], index + 1); for (var x in tree[path[index]]) { return; } delete tree[path[index]];
                }
            }; _recurse(this._items, 0);
        }; _TopicMatcher.prototype.wildcardMatch = function (topic) {
            var path = topic.split(".");
            var len = path.length; var res = []; _recurse = function (tree, index) {
                var tok = path[index]; var node; if ((!tree) || (index == len)) {
                    return;
                } if (tok == "**") {
                    for (var n in tree) {
                        if (n != ".") {
                            node = tree[n]; if (node["."]) { res.push(node["."]); } _recurse(node, index);
                        }
                    }
                } else {
                    if (tok == "*") {
                        for (var n in tree) {
                            if ((n != ".") && (n != "**")) {
                                node = tree[n]; if (index == len - 1) {
                                    if (node["."]) {
                                        res.push(node["."]);
                                    }
                                } else { _recurse(node, index + 1); }
                            }
                        }
                    } else {
                        node = tree[tok]; if (!node) { return; } if (index == len - 1) {
                            if (node["."]) {
                                res.push(node["."]);
                            }
                        } else { _recurse(node, index + 1); }
                    }
                }
            }; _recurse(this._items, 0); return res;
        }; this._refs = {}; this._doCache = new _TopicMatcher();
        this._caches = new _TopicMatcher(); _isCaching = function (topic) {
            return that._doCache.exists(topic, false);
        }; _copy = function (obj) {
            var c; if (typeof (obj) == "object") {
                if (obj == null) { return null; } else {
                    if (obj.constructor == Array) {
                        c = [];
                        for (var i = 0; i < obj.length; i++) { c[i] = _copy(obj[i]); } return c;
                    } else {
                        if (obj.constructor == Date) {
                            c = new Date();
                            c.setDate(obj.getDate()); return c;
                        }
                    }
                } c = {}; for (var p in obj) { c[p] = _copy(obj[p]); } return c;
            } else {
                return obj;
            }
        }; this._add = function (topic, subID) {
            var dc; var dca = this._doCache.match(topic, true); if (dca.length > 0) {
                dc = dca[0].value;
            } else { dc = { rc: 0 }; this._doCache.store(topic, dc); } dc.rc++; this._refs[subID] = topic;
        }; this._remove = function (subID) {
            var topic = this._refs[subID];
            if (!topic) { return; } delete this._refs[subID]; var dca = this._doCache.match(topic, true); if (dca.length == 0) {
                return;
            } dca[0].value.rc--; if (dca[0].value.rc == 0) {
                this._doCache.clear(topic); var caches = this._caches.wildcardMatch(topic);
                for (var i = 0; i < caches.length; i++) {
                    if (!(this._doCache.exists(caches[i].topic, false))) {
                        this._caches.clear(caches[i].topic);
                    }
                }
            }
        }; this.subscribe = function (topic, scope, onData, subscriberData) {
            if (!subscriberData) {
                subscriberData = null;
            } var sid = OpenAjax.hub.subscribe(topic, onData, scope, subscriberData); if (_cacheIt(subscriberData)) {
                this._add(topic, sid);
                var vals = this.query(topic); for (var i = 0; i < vals.length; i++) {
                    try {
                        onData.call(scope ? scope : window, vals[i].topic, vals[i].value, subscriberData);
                    } catch (e) { PageBus._debug(); }
                }
            } return sid;
        }; this.publish = function (topic, data) {
            _valPub(topic); Q.push({ n: topic, m: data, d: (D + 1) });
            if (_isCaching(topic)) { try { this._caches.store(topic, data); } catch (e) { _badParm(); } } if (D == 0) {
                while (Q.length > 0) {
                    var qitem = Q.shift();
                    var path = qitem.n.split("."); try { D = qitem.d; OpenAjax.hub.publish(qitem.n, qitem.m); D = 0; } catch (err) {
                        D = 0; throw (err);
                    }
                }
            }
        }; this.unsubscribe = function (sub) {
            try { this._remove(sub); OpenAjax.hub.unsubscribe(sub); } catch (err) {
                _badParm();
            }
        }; this.store = function (topic, data) {
            if (!_isCaching(topic)) { throw new Error("PageBus.cache.NoCache"); } this.publish(topic, data);
        }; this.query = function (topic) {
            try { _valSub(topic); return this._caches.wildcardMatch(topic); } catch (e) {
                _badParm();
            }
        };
    }; OpenAjax.hub.registerLibrary("PageBus", "http://tibco.com/PageBus", "1.2.0", {});
} 
(function (mod) {
    if (typeof exports == "object" && typeof module == "object") {
        mod(require("../../lib/codemirror"));
    } else {
        if (typeof define == "function" && define.amd) { define(["../../lib/codemirror"], mod); } else {
            mod(CodeMirror);
        }
    }
})
(function (CodeMirror) {
    var HINT_ELEMENT_CLASS = "CodeMirror-hint"; var ACTIVE_HINT_ELEMENT_CLASS = "CodeMirror-hint-active";
    CodeMirror.showHint = function (cm, getHints, options) {
        if (!getHints) { return cm.showHint(options); } if (options && options.async) {
            getHints.async = true;
        } var newOpts = { hint: getHints }; if (options) { for (var prop in options) { newOpts[prop] = options[prop]; } } return cm.showHint(newOpts);
    }; CodeMirror.defineExtension("showHint", function (options) {
        if (this.listSelections().length > 1 || this.somethingSelected()) {
            return;
        } if (this.state.completionActive) { this.state.completionActive.close(); } var completion = this.state.completionActive = new Completion(this, options);
        var getHints = completion.options.hint; if (!getHints) { return; } CodeMirror.signal(this, "startCompletion", this);
        if (getHints.async) { getHints(this, function (hints) { completion.showHints(hints); }, completion.options); } else {
            return completion.showHints(getHints(this, completion.options));
        }
    }); function Completion(cm, options) {
        this.cm = cm; this.options = this.buildOptions(options); this.widget = this.onClose = null;
    } Completion.prototype = {
        close: function () {
            if (!this.active()) { return; } this.cm.state.completionActive = null;
            if (this.widget) { this.widget.close(); } if (this.onClose) { this.onClose(); } CodeMirror.signal(this.cm, "endCompletion", this.cm);
        }, active: function () { return this.cm.state.completionActive == this; }, pick: function (data, i) {
            var completion = data.list[i];
            if (completion.hint) { completion.hint(this.cm, data, completion); } else {
                this.cm.replaceRange(getText(completion), completion.from || data.from, completion.to || data.to, "complete");
            } CodeMirror.signal(data, "pick", completion); this.close();
        }, showHints: function (data) {
            if (!data || !data.list.length || !this.active()) {
                return this.close();
            } if (this.options.completeSingle && data.list.length == 1) { this.pick(data, 0); } else { this.showWidget(data); }
        }, showWidget: function (data) {
            this.widget = new Widget(this, data);
            CodeMirror.signal(data, "shown"); var debounce = 0, completion = this, finished; var closeOn = this.options.closeCharacters;
            var startPos = this.cm.getCursor(), startLen = this.cm.getLine(startPos.line).length; var requestAnimationFrame = window.requestAnimationFrame || function (fn) {
                return setTimeout(fn, 1000 / 60);
            }; var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout; function done() {
                if (finished) {
                    return;
                } finished = true; completion.close(); completion.cm.off("cursorActivity", activity); if (data) {
                    CodeMirror.signal(data, "close");
                }
            } function update() {
                if (finished) { return; } CodeMirror.signal(data, "update"); var getHints = completion.options.hint;
                if (getHints.async) { getHints(completion.cm, finishUpdate, completion.options); } else {
                    finishUpdate(getHints(completion.cm, completion.options));
                }
            } function finishUpdate(data_) {
                data = data_; if (finished) { return; } if (!data || !data.list.length) {
                    return done();
                } if (completion.widget) { completion.widget.close(); } completion.widget = new Widget(completion, data);
            } function clearDebounce() {
                if (debounce) {
                    cancelAnimationFrame(debounce);
                    debounce = 0;
                }
            } function activity() {
                clearDebounce(); var pos = completion.cm.getCursor(), line = completion.cm.getLine(pos.line);
                if (pos.line != startPos.line || line.length - pos.ch != startLen - startPos.ch || pos.ch < startPos.ch || completion.cm.somethingSelected() || (pos.ch && closeOn.test(line.charAt(pos.ch - 1)))) {
                    completion.close();
                } else { debounce = requestAnimationFrame(update); if (completion.widget) { completion.widget.close(); } }
            } this.cm.on("cursorActivity", activity);
            this.onClose = done;
        }, buildOptions: function (options) {
            var editor = this.cm.options.hintOptions; var out = {};
            for (var prop in defaultOptions) { out[prop] = defaultOptions[prop]; } if (editor) {
                for (var prop in editor) {
                    if (editor[prop] !== undefined) {
                        out[prop] = editor[prop];
                    }
                }
            } if (options) { for (var prop in options) { if (options[prop] !== undefined) { out[prop] = options[prop]; } } } return out;
        }
    }; function getText(completion) {
        if (typeof completion == "string") { return completion; } else {
            return completion.text;
        }
    } function buildKeyMap(completion, handle) {
        var baseMap = {
            Up: function () { handle.moveFocus(-1); }, Down: function () {
                handle.moveFocus(1);
            }, PageUp: function () { handle.moveFocus(-handle.menuSize() + 1, true); }, PageDown: function () {
                handle.moveFocus(handle.menuSize() - 1, true);
            }, Home: function () { handle.setFocus(0); }, End: function () { handle.setFocus(handle.length - 1); }, Enter: handle.pick, Tab: handle.pick, Esc: handle.close
        };
        var custom = completion.options.customKeys; var ourMap = custom ? {} : baseMap; function addBinding(key, val) {
            var bound;
            if (typeof val != "string") { bound = function (cm) { return val(cm, handle); }; } else {
                if (baseMap.hasOwnProperty(val)) {
                    bound = baseMap[val];
                } else { bound = val; }
            } ourMap[key] = bound;
        } if (custom) {
            for (var key in custom) {
                if (custom.hasOwnProperty(key)) {
                    addBinding(key, custom[key]);
                }
            }
        } var extra = completion.options.extraKeys; if (extra) {
            for (var key in extra) {
                if (extra.hasOwnProperty(key)) {
                    addBinding(key, extra[key]);
                }
            }
        } return ourMap;
    } function getHintElement(hintsElement, el) {
        while (el && el != hintsElement) {
            if (el.nodeName.toUpperCase() === "LI" && el.parentNode == hintsElement) {
                return el;
            } el = el.parentNode;
        }
    } function Widget(completion, data) {
        this.completion = completion; this.data = data; var widget = this, cm = completion.cm;
        var hints = this.hints = document.createElement("ul"); hints.className = "CodeMirror-hints"; this.selectedHint = data.selectedHint || 0;
        var completions = data.list; for (var i = 0; i < completions.length; ++i) {
            var elt = hints.appendChild(document.createElement("li")), cur = completions[i];
            var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? "" : " " + ACTIVE_HINT_ELEMENT_CLASS); if (cur.className != null) {
                className = cur.className + " " + className;
            } elt.className = className; if (cur.render) { cur.render(elt, data, cur); } else {
                elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));
            } elt.hintId = i;
        } var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null); var left = pos.left, top = pos.bottom, below = true;
        hints.style.left = left + "px"; hints.style.top = top + "px"; var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);
        var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);
        (completion.options.container || document.body).appendChild(hints); var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;
        if (overlapY > 0) {
            var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top); if (curTop - height > 0) {
                hints.style.top = (top = pos.top - height) + "px";
                below = false;
            } else {
                if (height > winH) {
                    hints.style.height = (winH - 5) + "px"; hints.style.top = (top = pos.bottom - box.top) + "px";
                    var cursor = cm.getCursor(); if (data.from.ch != cursor.ch) {
                        pos = cm.cursorCoords(cursor); hints.style.left = (left = pos.left) + "px";
                        box = hints.getBoundingClientRect();
                    }
                }
            }
        } var overlapX = box.right - winW; if (overlapX > 0) {
            if (box.right - box.left > winW) {
                hints.style.width = (winW - 5) + "px";
                overlapX -= (box.right - box.left) - winW;
            } hints.style.left = (left = pos.left - overlapX) + "px";
        } cm.addKeyMap(this.keyMap = buildKeyMap(completion, {
            moveFocus: function (n, avoidWrap) {
                widget.changeActive(widget.selectedHint + n, avoidWrap);
            }, setFocus: function (n) { widget.changeActive(n); }, menuSize: function () { return widget.screenAmount(); }, length: completions.length, close: function () {
                completion.close();
            }, pick: function () { widget.pick(); }, data: data
        })); if (completion.options.closeOnUnfocus) {
            var closingOnBlur;
            cm.on("blur", this.onBlur = function () { closingOnBlur = setTimeout(function () { completion.close(); }, 100); });
            cm.on("focus", this.onFocus = function () { clearTimeout(closingOnBlur); });
        } var startScroll = cm.getScrollInfo();
        cm.on("scroll", this.onScroll = function () {
            var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();
            var newTop = top + startScroll.top - curScroll.top; var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);
            if (!below) { point += hints.offsetHeight; } if (point <= editor.top || point >= editor.bottom) {
                return completion.close();
            } hints.style.top = newTop + "px"; hints.style.left = (left + startScroll.left - curScroll.left) + "px";
        }); CodeMirror.on(hints, "dblclick", function (e) {
            var t = getHintElement(hints, e.target || e.srcElement);
            if (t && t.hintId != null) { widget.changeActive(t.hintId); widget.pick(); }
        }); CodeMirror.on(hints, "click", function (e) {
            var t = getHintElement(hints, e.target || e.srcElement);
            if (t && t.hintId != null) {
                widget.changeActive(t.hintId); if (completion.options.completeOnSingleClick) {
                    widget.pick();
                }
            }
        }); CodeMirror.on(hints, "mousedown", function () { setTimeout(function () { cm.focus(); }, 20); }); $(hints).StyledScrollbar({ adaptContentToScrollbar: true });
        if (completion.options.onScroll) { $(hints).scroll(completion.options.onScroll); } CodeMirror.signal(data, "select", completions[0], hints.firstChild);
        return true;
    } Widget.prototype = {
        close: function () {
            if (this.completion.widget != this) { return; } this.completion.widget = null;
            $(this.hints.parentNode).remove(); this.completion.cm.removeKeyMap(this.keyMap); var cm = this.completion.cm;
            if (this.completion.options.closeOnUnfocus) { cm.off("blur", this.onBlur); cm.off("focus", this.onFocus); } cm.off("scroll", this.onScroll);
        }, pick: function () { this.completion.pick(this.data, this.selectedHint); }, changeActive: function (i, avoidWrap) {
            if (i >= this.data.list.length) {
                i = avoidWrap ? this.data.list.length - 1 : 0;
            } else { if (i < 0) { i = avoidWrap ? 0 : this.data.list.length - 1; } } if (this.selectedHint == i) { return; } var node = this.hints.childNodes[this.selectedHint];
            node.className = node.className.replace(" " + ACTIVE_HINT_ELEMENT_CLASS, ""); node = this.hints.childNodes[this.selectedHint = i];
            node.className += " " + ACTIVE_HINT_ELEMENT_CLASS; if (node.offsetTop < this.hints.scrollTop) {
                this.hints.scrollTop = node.offsetTop - 3;
            } else {
                if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight) {
                    this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;
                }
            } CodeMirror.signal(this.data, "select", this.data.list[this.selectedHint], node);
        }, screenAmount: function () {
            return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;
        }
    }; CodeMirror.registerHelper("hint", "auto", function (cm, options) {
        var helpers = cm.getHelpers(cm.getCursor(), "hint"), words;
        if (helpers.length) {
            for (var i = 0; i < helpers.length; i++) {
                var cur = helpers[i](cm, options); if (cur && cur.list.length) {
                    return cur;
                }
            }
        } else {
            if (words = cm.getHelper(cm.getCursor(), "hintWords")) {
                if (words) {
                    return CodeMirror.hint.fromList(cm, { words: words });
                }
            } else { if (CodeMirror.hint.anyword) { return CodeMirror.hint.anyword(cm, options); } }
        }
    }); CodeMirror.registerHelper("hint", "fromList", function (cm, options) {
        var cur = cm.getCursor(), token = cm.getTokenAt(cur);
        var found = []; for (var i = 0; i < options.words.length; i++) {
            var word = options.words[i]; if (word.slice(0, token.string.length) == token.string) {
                found.push(word);
            }
        } if (found.length) {
            return { list: found, from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end) };
        }
    }); CodeMirror.commands.autocomplete = CodeMirror.showHint; var defaultOptions = { hint: CodeMirror.hint.auto, completeSingle: true, alignWithWord: true, closeCharacters: /[\s()\[\]{};:>,]/, closeOnUnfocus: true, completeOnSingleClick: false, container: null, customKeys: null, extraKeys: null, onScroll: null };
    CodeMirror.defineOption("hintOptions", null);
}); 
(function (window, $, undefined) {
    var defaultOpts = { beforeShow: noop, move: noop, change: noop, show: noop, hide: noop, cancel: noop, color: false, flat: false, showInput: false, showButtons: true, clickoutFiresChange: false, dragstopFiresChanges: false, showInitial: false, showPalette: false, showPaletteOnly: false, showMoreColorsButton: false, showSelectionPalette: true, localStorageKey: false, appendTo: "body", maxSelectionSize: 7, cancelText: "cancel", chooseText: "choose", preferredFormat: false, className: "", showAlpha: false, theme: "sp-light", palette: ["fff", "000"], selectionPalette: [], disabled: false }, spectrums = [], IE = !!/msie/i.exec(window.navigator.userAgent), rgbaSupport = (function () {
        function contains(str, substr) {
            return !!~("" + str).indexOf(substr);
        } var elem = document.createElement("div"); var style = elem.style; style.cssText = "background-color:rgba(0,0,0,.5)";
        return contains(style.backgroundColor, "rgba") || contains(style.backgroundColor, "hsla");
    })(), replaceInput = ["<div class='sp-replacer'>", "<div class='sp-preview'><div class='sp-preview-inner'><img class='sp-preview-inner-image' /></div></div>", "<div class='sp-dd'>&#9660;</div>", "</div>"].join(""), markup = (function () {
        var gradientFix = "";
        if (IE) { for (var i = 1; i <= 6; i++) { gradientFix += "<div class='sp-" + i + "'></div>"; } } return ["<div class='sp-container sp-hidden'>", "<div class='sp-palette-container'>", "<div class='sp-palette sp-thumb sp-cf' id='sp-palette'></div>", "<div class='sp-more-colors-container' >", "<span class='sp-more-colors' />", "<span class='sp-less-colors' />", "<span class='sp-palette sp-thumb sp-cf' id='sp-selection-palette' />", "</div>", "</div>", "<div class='sp-picker-container'>", "<div class='sp-top sp-cf'>", "<div class='sp-fill'></div>", "<div class='sp-top-inner'>", "<div class='sp-color'>", "<div class='sp-sat'>", "<div class='sp-val'>", "<div class='sp-dragger'></div>", "</div>", "</div>", "</div>", "<div class='sp-hue'>", "<div class='sp-slider'></div>", gradientFix, "</div>", "</div>", "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>", "</div>", "<div class='sp-input-container sp-cf'>", "<span>#</span><input class='sp-input' type='text' spellcheck='false'  />&nbsp;", "</div>", "<div class='sp-initial sp-thumb sp-cf'></div>", "<div class='sp-button-container sp-cf'>", "<button class='sp-cancel'></button>", "<button class='sp-choose'></button>", "</div>", "</div>", "</div>"].join("");
    })(); function paletteTemplate(p, color, className) {
        var html = []; for (var i = 0; i < p.length; i++) {
            var tiny = tinycolor(p[i]);
            var c = tiny.toHsl().l < 0.5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light"; c += (tinycolor.equals(color, p[i])) ? " sp-thumb-active" : "";
            c += " " + tiny.id; var swatchStyle = ""; var innerImage = ""; if (tiny.image.length > 0) {
                innerImage = '<img src="' + tiny.image + '" class="sp-inner-image"/>';
            } else {
                swatchStyle = (rgbaSupport ? ("background-color:" + tiny.toRgbString()) : "filter:" + tiny.toFilter()) + ";";
            } var innerTextHtml = ""; if (tiny.text !== undefined && tiny.text.length > 0) {
                innerTextHtml = '<span class="sp-text-inner">' + tiny.text + "</span>";
            } html.push('<span data-color="' + tiny.toRgbString() + "|" + tiny.id + '" class="' + c + '">' + innerTextHtml + '<span class="sp-thumb-inner" style="' + swatchStyle + '">' + innerImage + "</span></span>");
        } return "<div class='sp-cf " + className + "'>" + html.join("") + "</div>";
    } function hideAll() {
        for (var i = 0; i < spectrums.length;
        i++) { if (spectrums[i]) { spectrums[i].hide(); } }
    } function instanceOptions(o, callbackContext) {
        var opts = $.extend({}, defaultOpts, o);
        opts.callbacks = { move: bind(opts.move, callbackContext), change: bind(opts.change, callbackContext), show: bind(opts.show, callbackContext), hide: bind(opts.hide, callbackContext), beforeShow: bind(opts.beforeShow, callbackContext), cancel: bind(opts.cancel, callbackContext) };
        return opts;
    } function spectrum(element, o) {
        var opts = instanceOptions(o, element), flat = opts.flat, showSelectionPalette = opts.showSelectionPalette, localStorageKey = opts.localStorageKey, theme = opts.theme, callbacks = opts.callbacks, resize = throttle(reflow, 10), visible = false, dragWidth = 0, dragHeight = 0, dragHelperHeight = 0, slideHeight = 0, slideWidth = 0, alphaWidth = 0, alphaSlideHelperWidth = 0, slideHelperHeight = 0, currentHue = 0, currentSaturation = 0, currentValue = 0, currentAlpha = 1, currentId = "", currentImage = "", currentText = "", palette = opts.palette.slice(0), paletteArray = $.isArray(palette[0]) ? palette : [palette], selectionPalette = opts.selectionPalette.slice(0), maxSelectionSize = opts.maxSelectionSize, draggingClass = "sp-dragging", shiftMovementDirection = null;
        var doc = element.ownerDocument, body = doc.body, boundElement = $(element), disabled = false, container = $(markup, doc).addClass(theme), dragger = container.find(".sp-color"), dragHelper = container.find(".sp-dragger"), slider = container.find(".sp-hue"), slideHelper = container.find(".sp-slider"), alphaSliderInner = container.find(".sp-alpha-inner"), alphaSlider = container.find(".sp-alpha"), alphaSlideHelper = container.find(".sp-alpha-handle"), textInput = container.find(".sp-input"), moreColors = container.find(".sp-more-colors"), lessColors = container.find(".sp-less-colors"), paletteContainer = container.find("#sp-palette"), selectionPaletteContainer = container.find("#sp-selection-palette"), initialColorContainer = container.find(".sp-initial"), cancelButton = container.find(".sp-cancel"), chooseButton = container.find(".sp-choose"), isInput = boundElement.is("input"), shouldReplace = isInput && !flat, replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className) : $([]), offsetElement = (shouldReplace) ? replacer : boundElement, previewElement = replacer.find(".sp-preview-inner"), previewImageElement = replacer.find(".sp-preview-inner-image"), initialColor = opts.color || (isInput && boundElement.val()), colorOnShow = false, preferredFormat = opts.preferredFormat, currentPreferredFormat = preferredFormat, clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange, dragstopFiresChanges = opts.dragstopFiresChanges;
        function applyOptions() {
            container.toggleClass("sp-flat", flat); container.toggleClass("sp-input-disabled", !opts.showInput);
            container.toggleClass("sp-alpha-enabled", opts.showAlpha); container.toggleClass("sp-buttons-disabled", !opts.showButtons);
            container.toggleClass("sp-palette-disabled", !opts.showPalette); container.toggleClass("sp-palette-only", opts.showPaletteOnly);
            container.toggleClass("sp-show-more-colors", opts.showMoreColorsButton); container.toggleClass("sp-more-colors-hidden", opts.showPalette);
            container.toggleClass("sp-initial-disabled", !opts.showInitial); container.addClass(opts.className); reflow();
        } function initialize() {
            if (IE) { container.find("*:not(input)").attr("unselectable", "on"); } applyOptions();
            if (shouldReplace) { boundElement.after(replacer).hide(); } if (flat) {
                boundElement.after(container).hide();
            } else {
                var appendTo = opts.appendTo === "parent" ? boundElement.parent() : $(opts.appendTo); if (appendTo.length !== 1) {
                    appendTo = $("body");
                } appendTo.append(container);
            } if (localStorageKey && window.localStorage) {
                try {
                    var oldPalette = window.localStorage[localStorageKey].split(",#");
                    if (oldPalette.length > 1) {
                        delete window.localStorage[localStorageKey]; $.each(oldPalette, function (i, c) {
                            addColorToSelectionPalette(c);
                        });
                    }
                } catch (e) { } try { selectionPalette = window.localStorage[localStorageKey].split(";"); } catch (e) { }
            } offsetElement.bind("click.spectrum touchstart.spectrum", function (e) {
                if (!disabled) {
                    toggle();
                } e.stopPropagation(); if (!$(e.target).is("input")) { e.preventDefault(); }
            }); if (boundElement.is(":disabled") || (opts.disabled === true)) {
                disable();
            } container.click(stopPropagation); textInput.change(setFromTextInput); textInput.bind("paste", function () {
                setTimeout(setFromTextInput, 1);
            }); textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } }); moreColors.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault(); if (isValid()) {
                    container.removeClass("sp-more-colors-hidden"); reflow(); container.change();
                }
            }); lessColors.bind("click.spectrum", function (e) {
                e.stopPropagation(); e.preventDefault(); if (isValid()) {
                    container.addClass("sp-more-colors-hidden");
                    container.change();
                }
            }); cancelButton.text(opts.cancelText); cancelButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault(); callbacks.cancel(); hide("cancel");
            }); chooseButton.text(opts.chooseText); chooseButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault(); if (isValid()) { updateOriginalInput(true, false); hide(); }
            }); draggable(alphaSlider, function (dragX, dragY, e) {
                currentAlpha = (dragX / alphaWidth);
                if (e.shiftKey) { currentAlpha = Math.round(currentAlpha * 10) / 10; } move();
            }); draggable(slider, function (dragX, dragY) {
                currentHue = parseFloat(dragY / slideHeight);
                move();
            }, dragStart, dragStop); draggable(dragger, function (dragX, dragY, e) {
                if (!e.shiftKey) {
                    shiftMovementDirection = null;
                } else {
                    if (!shiftMovementDirection) {
                        var oldDragX = currentSaturation * dragWidth; var oldDragY = dragHeight - (currentValue * dragHeight);
                        var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY); shiftMovementDirection = furtherFromX ? "x" : "y";
                    }
                } var setSaturation = !shiftMovementDirection || shiftMovementDirection === "x"; var setValue = !shiftMovementDirection || shiftMovementDirection === "y";
                if (setSaturation) { currentSaturation = parseFloat(dragX / dragWidth); } if (setValue) {
                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);
                } move();
            }, dragStart, dragStop); if (!!initialColor) {
                set(initialColor); updateUI(); currentPreferredFormat = preferredFormat || tinycolor(initialColor).format;
                addColorToSelectionPalette(initialColor);
            } else { updateUI(); } if (flat) { show(); } function palletElementClick(ex) {
                if (ex.data && ex.data.ignore) {
                    set($(this).data("color"));
                    move();
                } else { set($(this).data("color")); updateOriginalInput(true, false); move(); hide(); } return false;
            } var paletteEvent = IE ? "mousedown.spectrum" : "click.spectrum";
            paletteContainer.on(paletteEvent, ".sp-thumb-el", palletElementClick); selectionPaletteContainer.on(paletteEvent, ".sp-thumb-el", palletElementClick);
            initialColorContainer.on(paletteEvent, ".sp-thumb-el:nth-child(1)", { ignore: true }, palletElementClick);
        } function addColorToSelectionPalette(color) {
            if (showSelectionPalette) {
                var colorRgb = tinycolor(color).toRgbString();
                if ($.inArray(colorRgb, selectionPalette) === -1) {
                    selectionPalette.push(colorRgb); while (selectionPalette.length > maxSelectionSize) {
                        selectionPalette.shift();
                    }
                } if (localStorageKey && window.localStorage) {
                    try {
                        window.localStorage[localStorageKey] = selectionPalette.join(";");
                    } catch (e) { }
                }
            }
        } function getUniqueSelectionPalette() {
            var unique = []; var p = selectionPalette; var paletteLookup = {};
            var rgb; if (opts.showPalette) {
                for (var i = 0; i < paletteArray.length; i++) {
                    for (var j = 0; j < paletteArray[i].length;
                    j++) { rgb = tinycolor(paletteArray[i][j]).toRgbString(); paletteLookup[rgb] = true; }
                } for (i = 0; i < p.length; i++) {
                    rgb = tinycolor(p[i]).toRgbString();
                    if (!paletteLookup.hasOwnProperty(rgb)) { unique.push(p[i]); paletteLookup[rgb] = true; }
                }
            } return unique.reverse().slice(0, opts.maxSelectionSize);
        } function drawPalette() {
            var currentColor = get(); var html = $.map(paletteArray, function (palette, i) {
                return paletteTemplate(palette, currentColor, "sp-palette-row sp-palette-row-" + i);
            }); if (selectionPalette) { } paletteContainer.html(html.join("")); if (selectionPalette) {
                html = $.map(getUniqueSelectionPalette(), function (palette, i) {
                    return paletteTemplate(selectionPalette, currentColor, "sp-palette-row sp-palette-row-" + i);
                }); selectionPaletteContainer.html(html.join(""));
            }
        } function drawInitial() {
            if (opts.showInitial) {
                var initial = colorOnShow;
                var current = get(); initialColorContainer.html(paletteTemplate([initial, current], current, "sp-palette-row-initial"));
            }
        } function dragStart() {
            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) { reflow(); } container.addClass(draggingClass);
            shiftMovementDirection = null;
        } function dragStop() {
            container.removeClass(draggingClass); if (dragstopFiresChanges) {
                updateOriginalInput(true, true);
                updateUI();
            }
        } function setFromTextInput() {
            var tiny = tinycolor(textInput.val()); if (tiny.ok) {
                set(tiny); updateOriginalInput(true, true);
                updateUI();
            } else { textInput.addClass("sp-validation-error"); }
        } function toggle() {
            if (visible) { hide(); } else {
                show();
            }
        } function show() {
            var event = $.Event("beforeShow.spectrum"); if (visible) { reflow(); return; } boundElement.trigger(event, [get()]);
            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) { return; } hideAll(); visible = true; $(doc).bind("click.spectrum", hide);
            $(doc).bind("mousedown.spectrum", hideIfClickedOutsideThis); $(window).bind("resize.spectrum", resize); replacer.addClass("sp-active");
            container.removeClass("sp-hidden"); if (opts.showPalette) { drawPalette(); } reflow(); updateUI(); colorOnShow = get();
            drawInitial(); callbacks.show(colorOnShow); boundElement.trigger("show.spectrum", [colorOnShow]);
        } function hideIfClickedOutsideThis(e) {
            if (e && e.type == "click" && e.button == 2) {
                return;
            } if (!visible || flat) { return; } var $parent = $(e.target); while (true) {
                if ($parent.length == 0) { break; } else {
                    if ($parent.is(container)) {
                        return;
                    }
                } $parent = $parent.parent();
            } visible = false; $(doc).unbind("mousedown.spectrum", hideIfClickedOutsideThis);
            replacer.removeClass("sp-active"); container.addClass("sp-hidden");
        } function hide(e) {
            if (e && e.type == "click" && e.button == 2) {
                return;
            } if (!visible || flat) { return; } visible = false; $(doc).unbind("click.spectrum", hide); $(window).unbind("resize.spectrum", resize);
            replacer.removeClass("sp-active"); container.addClass("sp-hidden"); var colorHasChanged = !tinycolor.equals(get(), colorOnShow);
            if (colorHasChanged) {
                if (clickoutFiresChange && e !== "cancel") { updateOriginalInput(true, false); } else {
                    revert();
                }
            } callbacks.hide(get()); boundElement.trigger("hide.spectrum", [get()]);
        } function revert() {
            set(colorOnShow, true);
        } function set(color, ignoreFormatChange) {
            if (tinycolor.equals(color, get())) { return; } var newColor = tinycolor(color);
            var newHsv = newColor.toHsv(); currentHue = (newHsv.h % 360) / 360; currentSaturation = newHsv.s; currentValue = newHsv.v;
            currentAlpha = newHsv.a; currentId = newColor.id; currentImage = newColor.image; currentText = newColor.text; updateUI();
            if (newColor.ok && !ignoreFormatChange) { currentPreferredFormat = preferredFormat || newColor.format; }
        } function get(opts) {
            opts = opts || {};
            return tinycolor.fromRatio({ h: currentHue, s: currentSaturation, v: currentValue, a: Math.round(currentAlpha * 100) / 100 }, { format: currentPreferredFormat, id: currentId, image: currentImage, text: currentText });
        } function isValid() { return !textInput.hasClass("sp-validation-error"); } function move() {
            updateUI(); callbacks.move(get());
            boundElement.trigger("move.spectrum", [get()]);
        } function updateUI() {
            textInput.removeClass("sp-validation-error");
            updateHelperLocations(); var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 }); dragger.css("background-color", flatColor.toHexString());
            var format = currentPreferredFormat; if (currentAlpha < 1) {
                if (format === "hex" || format === "hex3" || format === "hex6" || format === "name") {
                    format = "rgb";
                }
            } var realColor = get({ format: format }), realHex = realColor.toHexString(), realRgb = realColor.toRgbString();
            if (rgbaSupport || realColor.alpha === 1) { previewElement.css("background-color", realRgb); } else {
                previewElement.css("background-color", "transparent");
                previewElement.css("filter", realColor.toFilter());
            } if (realColor.image.length > 0) {
                previewImageElement.attr("src", realColor.image);
                previewImageElement.css("display", "block");
            } else { previewImageElement.css("display", "none"); } if (opts.showAlpha) {
                var rgb = realColor.toRgb();
                rgb.a = 0; var realAlpha = tinycolor(rgb).toRgbString(); var gradient = "linear-gradient(left, " + realAlpha + ", " + realHex + ")";
                if (IE) { alphaSliderInner.css("filter", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex)); } else {
                    alphaSliderInner.css("background", "-webkit-" + gradient);
                    alphaSliderInner.css("background", "-moz-" + gradient); alphaSliderInner.css("background", "-ms-" + gradient);
                    alphaSliderInner.css("background", gradient);
                }
            } if (opts.showInput) {
                textInput.val(realColor.toString("hex6").substring(1, 7));
            } if (opts.showPalette) { drawPalette(); } drawInitial();
        } function updateHelperLocations() {
            var s = currentSaturation;
            var v = currentValue; var dragX = s * dragWidth; var dragY = dragHeight - (v * dragHeight); dragX = Math.max(-dragHelperHeight, Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight));
            dragY = Math.max(-dragHelperHeight, Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)); dragHelper.css({ top: dragY, left: dragX });
            var alphaX = currentAlpha * alphaWidth; alphaSlideHelper.css({ left: alphaX - (alphaSlideHelperWidth / 2) }); var slideY = (currentHue) * slideHeight;
            slideHelper.css({ top: slideY - slideHelperHeight });
        } function updateOriginalInput(fireCallback, stayopen) {
            var color = get();
            if (isInput) { boundElement.val(color.toString(currentPreferredFormat)).change(); } var hasChanged = !tinycolor.equals(color, colorOnShow);
            colorOnShow = color; addColorToSelectionPalette(color); if (fireCallback && hasChanged) {
                callbacks.change(color, !stayopen);
                boundElement.trigger("change.spectrum", [color]);
            }
        } function reflow() {
            dragWidth = dragger.width(); dragHeight = dragger.height();
            dragHelperHeight = dragHelper.height(); slideWidth = slider.width(); slideHeight = slider.height(); slideHelperHeight = slideHelper.height();
            alphaWidth = alphaSlider.width(); alphaSlideHelperWidth = alphaSlideHelper.width(); if (!flat) {
                container.css("position", "absolute");
                container.offset(getOffset(container, offsetElement));
            } updateHelperLocations();
        } function destroy() {
            boundElement.show();
            offsetElement.unbind("click.spectrum touchstart.spectrum"); container.remove(); replacer.remove(); spectrums[spect.id] = null;
        } function option(optionName, optionValue) {
            if (optionName === undefined) { return $.extend({}, opts); } if (optionValue === undefined) {
                return opts[optionName];
            } opts[optionName] = optionValue; applyOptions();
        } function enable() {
            disabled = false; boundElement.attr("disabled", false);
            offsetElement.removeClass("sp-disabled");
        } function disable() {
            hide(); disabled = true; boundElement.attr("disabled", true);
            offsetElement.addClass("sp-disabled");
        } function getColorById(id) {
            for (var row = 0; row < palette.length; row++) {
                for (var col = 0;
                col < palette[row].length; col++) { color = tinycolor(palette[row][col]); if (color.id == id) { return color; } }
            }
        } initialize();
        var spect = {
            show: show, hide: hide, toggle: toggle, reflow: reflow, option: option, enable: enable, disable: disable, setById: function (id) {
                set(getColorById(id));
            }, set: function (c) { set(c); updateOriginalInput(); }, get: get, destroy: destroy, container: container
        }; spect.id = spectrums.push(spect) - 1;
        return spect;
    } function getOffset(picker, input) {
        var extraY = 0; var dpWidth = picker.outerWidth(); var dpHeight = picker.outerHeight();
        var inputHeight = input.outerHeight(); var doc = picker[0].ownerDocument; var docElem = doc.documentElement; var viewWidth = docElem.clientWidth + $(doc).scrollLeft();
        var viewHeight = docElem.clientHeight + $(doc).scrollTop(); var offset = input.offset(); offset.top += inputHeight;
        offset.left -= Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ? Math.abs(offset.left + dpWidth - viewWidth) : 0);
        offset.top -= Math.min(offset.top, ((offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ? Math.abs(dpHeight + inputHeight - extraY) : extraY));
        return offset;
    } function noop() { } function stopPropagation(e) { e.stopPropagation(); } function bind(func, obj) {
        var slice = Array.prototype.slice;
        var args = slice.call(arguments, 2); return function () {
            return func.apply(obj, args.concat(slice.call(arguments)));
        };
    } function draggable(element, onmove, onstart, onstop) {
        onmove = onmove || function () { }; onstart = onstart || function () { };
        onstop = onstop || function () { }; var doc = element.ownerDocument || document; var dragging = false; var offset = {};
        var maxHeight = 0; var maxWidth = 0; var hasTouch = ("ontouchstart" in window); var duringDragEvents = {}; duringDragEvents.selectstart = prevent;
        duringDragEvents.dragstart = prevent; duringDragEvents["touchmove mousemove"] = move; duringDragEvents["touchend mouseup"] = stop;
        function prevent(e) {
            if (e.stopPropagation) { e.stopPropagation(); } if (e.preventDefault) {
                e.preventDefault();
            } e.returnValue = false;
        } function move(e) {
            if (dragging) {
                if (IE && document.documentMode < 9 && !e.button) {
                    return stop();
                } var touches = e.originalEvent.touches; var pageX = touches ? touches[0].pageX : e.pageX; var pageY = touches ? touches[0].pageY : e.pageY;
                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth)); var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));
                if (hasTouch) { prevent(e); } onmove.apply(element, [dragX, dragY, e]);
            }
        } function start(e) {
            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);
            var touches = e.originalEvent.touches; if (!rightclick && !dragging) {
                if (onstart.apply(element, arguments) !== false) {
                    dragging = true;
                    maxHeight = $(element).height(); maxWidth = $(element).width(); offset = $(element).offset(); $(doc).bind(duringDragEvents);
                    $(doc.body).addClass("sp-dragging"); if (!hasTouch) { move(e); } prevent(e);
                }
            }
        } function stop() {
            if (dragging) {
                $(doc).unbind(duringDragEvents);
                $(doc.body).removeClass("sp-dragging"); onstop.apply(element, arguments);
            } dragging = false;
        } $(element).bind("touchstart mousedown", start);
    } function throttle(func, wait, debounce) {
        var timeout; return function () {
            var context = this, args = arguments;
            var throttler = function () { timeout = null; func.apply(context, args); }; if (debounce) { clearTimeout(timeout); } if (debounce || !timeout) {
                timeout = setTimeout(throttler, wait);
            }
        };
    } function log() {
        if (window.console) {
            if (Function.prototype.bind) {
                log = Function.prototype.bind.call(console.log, console);
            } else { log = function () { Function.prototype.apply.call(console.log, console, arguments); }; } log.apply(this, arguments);
        }
    } var dataID = "spectrum.id"; $.fn.spectrum = function (opts, extra) {
        if (typeof opts == "string") {
            var returnValue = this;
            var args = Array.prototype.slice.call(arguments, 1); this.each(function () {
                var spect = spectrums[$(this).data(dataID)];
                if (spect) {
                    var method = spect[opts]; if (!method) {
                        throw new Error("Spectrum: no such method: '" + opts + "'");
                    } if (opts == "get") { returnValue = spect.get(); } else {
                        if (opts == "container") { returnValue = spect.container; } else {
                            if (opts == "option") {
                                returnValue = spect.option.apply(spect, args);
                            } else { if (opts == "destroy") { spect.destroy(); $(this).removeData(dataID); } else { method.apply(spect, args); } }
                        }
                    }
                }
            });
            return returnValue;
        } return this.spectrum("destroy").each(function () {
            var spect = spectrum(this, opts); $(this).data(dataID, spect.id);
        });
    }; $.fn.spectrum.load = false; $.fn.spectrum.loadOpts = {}; $.fn.spectrum.draggable = draggable; $.fn.spectrum.defaults = defaultOpts;
    $.spectrum = {}; $.spectrum.localization = {}; $.spectrum.palettes = {}; $.fn.spectrum.processNativeColorInputs = function () {
        var colorInput = $("<input type='color' value='!' />")[0];
        var supportsColor = colorInput.type === "color" && colorInput.value != "!"; if (!supportsColor) {
            $("input[type=color]").spectrum({ preferredFormat: "hex6" });
        }
    }; (function (root) {
        var trimLeft = /^[\s,#]+/, trimRight = /\s+$/, tinyCounter = 0, math = Math, mathRound = math.round, mathMin = math.min, mathMax = math.max, mathRandom = math.random;
        function tinycolor(color, opts) {
            color = (color) ? color : ""; opts = opts || {}; if (typeof color == "object" && color.hasOwnProperty("_tc_id")) {
                return color;
            } var rgb = inputToRGB(color); var r = rgb.r, g = rgb.g, b = rgb.b, a = rgb.a, roundA = mathRound(100 * a) / 100, format = opts.format || rgb.format, id = opts.id || rgb.id, image = opts.image || rgb.image, text = opts.text || rgb.text;
            if (r < 1) { r = mathRound(r); } if (g < 1) { g = mathRound(g); } if (b < 1) { b = mathRound(b); } if (r == 255 && g == 0 && b == 255) {
                r = 254;
                b = 254;
            } return {
                ok: rgb.ok, format: format, id: id, image: image, text: text, _tc_id: tinyCounter++, alpha: a, toHsv: function () {
                    var hsv = rgbToHsv(r, g, b);
                    return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: a };
                }, toHsvString: function () {
                    var hsv = rgbToHsv(r, g, b); var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);
                    return (a == 1) ? "hsv(" + h + ", " + s + "%, " + v + "%)" : "hsva(" + h + ", " + s + "%, " + v + "%, " + roundA + ")";
                }, toHsl: function () {
                    var hsl = rgbToHsl(r, g, b);
                    return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: a };
                }, toHslString: function () {
                    var hsl = rgbToHsl(r, g, b); var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);
                    return (a == 1) ? "hsl(" + h + ", " + s + "%, " + l + "%)" : "hsla(" + h + ", " + s + "%, " + l + "%, " + roundA + ")";
                }, toHex: function (allow3Char) {
                    return rgbToHex(r, g, b, allow3Char);
                }, toHexString: function (allow3Char) { return "#" + rgbToHex(r, g, b, allow3Char); }, toRgb: function () {
                    return { r: mathRound(r), g: mathRound(g), b: mathRound(b), a: a, id: id, image: image, text: text };
                }, toRgbString: function () {
                    return (a == 1) ? "rgb(" + mathRound(r) + ", " + mathRound(g) + ", " + mathRound(b) + ")" : "rgba(" + mathRound(r) + ", " + mathRound(g) + ", " + mathRound(b) + ", " + roundA + ")";
                }, toPercentageRgb: function () {
                    return { r: mathRound(bound01(r, 255) * 100) + "%", g: mathRound(bound01(g, 255) * 100) + "%", b: mathRound(bound01(b, 255) * 100) + "%", a: a, id: id, image: image, text: text };
                }, toPercentageRgbString: function () {
                    return (a == 1) ? "rgb(" + mathRound(bound01(r, 255) * 100) + "%, " + mathRound(bound01(g, 255) * 100) + "%, " + mathRound(bound01(b, 255) * 100) + "%)" : "rgba(" + mathRound(bound01(r, 255) * 100) + "%, " + mathRound(bound01(g, 255) * 100) + "%, " + mathRound(bound01(b, 255) * 100) + "%, " + roundA + ")";
                }, toName: function () { return hexNames[rgbToHex(r, g, b, true)] || false; }, toFilter: function (secondColor) {
                    var hex = rgbToHex(r, g, b);
                    var secondHex = hex; var alphaHex = Math.round(parseFloat(a) * 255).toString(16); var secondAlphaHex = alphaHex;
                    var gradientType = opts && opts.gradientType ? "GradientType = 1, " : ""; if (secondColor) {
                        var s = tinycolor(secondColor);
                        secondHex = s.toHex(); secondAlphaHex = Math.round(parseFloat(s.alpha) * 255).toString(16);
                    } return "progid:DXImageTransform.Microsoft.gradient(" + gradientType + "startColorstr=#" + pad2(alphaHex) + hex + ",endColorstr=#" + pad2(secondAlphaHex) + secondHex + ")";
                }, toString: function (format) {
                    format = format || this.format; var formattedString = false; if (format === "rgb") {
                        formattedString = this.toRgbString();
                    } if (format === "prgb") { formattedString = this.toPercentageRgbString(); } if (format === "hex" || format === "hex6") {
                        formattedString = this.toHexString();
                    } if (format === "hex3") { formattedString = this.toHexString(true); } if (format === "name") {
                        formattedString = this.toName();
                    } if (format === "hsl") { formattedString = this.toHslString(); } if (format === "hsv") {
                        formattedString = this.toHsvString();
                    } return formattedString || this.toHexString();
                }
            };
        } tinycolor.fromRatio = function (color, opts) {
            if (typeof color == "object") {
                var newColor = {};
                for (var i in color) {
                    if (color.hasOwnProperty(i)) {
                        if (i === "a") { newColor[i] = color[i]; } else {
                            newColor[i] = convertToPercentage(color[i]);
                        }
                    }
                } color = newColor;
            } return tinycolor(color, opts);
        }; function inputToRGB(color) {
            var rgb = { r: 0, g: 0, b: 0 }; var a = 1;
            var ok = false; var format = false; var id = ""; var image = ""; var text = ""; if (typeof color == "string") {
                color = stringInputToObject(color);
                id = color.id; image = color.image; text = color.text;
            } if (typeof color == "object") {
                if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {
                    rgb = rgbToRgb(color.r, color.g, color.b);
                    ok = true; format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";
                } else {
                    if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {
                        color.s = convertToPercentage(color.s);
                        color.v = convertToPercentage(color.v); rgb = hsvToRgb(color.h, color.s, color.v); ok = true; format = "hsv";
                    } else {
                        if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {
                            color.s = convertToPercentage(color.s);
                            color.l = convertToPercentage(color.l); rgb = hslToRgb(color.h, color.s, color.l); ok = true; format = "hsl";
                        }
                    }
                } if (color.hasOwnProperty("a")) {
                    a = color.a;
                }
            } a = parseFloat(a); if (isNaN(a) || a < 0 || a > 1) { a = 1; } return { ok: ok, format: color.format || format, r: mathMin(255, mathMax(rgb.r, 0)), g: mathMin(255, mathMax(rgb.g, 0)), b: mathMin(255, mathMax(rgb.b, 0)), a: a, id: id, image: image, text: text };
        } function rgbToRgb(r, g, b) { return { r: bound01(r, 255) * 255, g: bound01(g, 255) * 255, b: bound01(b, 255) * 255 }; } function rgbToHsl(r, g, b) {
            r = bound01(r, 255);
            g = bound01(g, 255); b = bound01(b, 255); var max = mathMax(r, g, b), min = mathMin(r, g, b); var h, s, l = (max + min) / 2; if (max == min) {
                h = s = 0;
            } else {
                var d = max - min; s = l > 0.5 ? d / (2 - max - min) : d / (max + min); switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break; case g: h = (b - r) / d + 2;
                        break; case b: h = (r - g) / d + 4; break;
                } h /= 6;
            } return { h: h, s: s, l: l };
        } function hslToRgb(h, s, l) {
            var r, g, b; h = bound01(h, 360);
            s = bound01(s, 100); l = bound01(l, 100); function hue2rgb(p, q, t) {
                if (t < 0) { t += 1; } if (t > 1) { t -= 1; } if (t < 1 / 6) {
                    return p + (q - p) * 6 * t;
                } if (t < 1 / 2) { return q; } if (t < 2 / 3) { return p + (q - p) * (2 / 3 - t) * 6; } return p;
            } if (s === 0) { r = g = b = l; } else {
                var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                var p = 2 * l - q; r = hue2rgb(p, q, h + 1 / 3); g = hue2rgb(p, q, h); b = hue2rgb(p, q, h - 1 / 3);
            } return { r: r * 255, g: g * 255, b: b * 255 };
        } function rgbToHsv(r, g, b) {
            r = bound01(r, 255); g = bound01(g, 255); b = bound01(b, 255); var max = mathMax(r, g, b), min = mathMin(r, g, b);
            var h, s, v = max; var d = max - min; s = max === 0 ? 0 : d / max; if (max == min) { h = 0; } else {
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0);
                        break; case g: h = (b - r) / d + 2; break; case b: h = (r - g) / d + 4; break;
                } h /= 6;
            } return { h: h, s: s, v: v };
        } function hsvToRgb(h, s, v) {
            h = bound01(h, 360) * 6;
            s = bound01(s, 100); v = bound01(v, 100); var i = math.floor(h), f = h - i, p = v * (1 - s), q = v * (1 - f * s), t = v * (1 - (1 - f) * s), mod = i % 6, r = [v, q, p, p, t, v][mod], g = [t, v, v, q, p, p][mod], b = [p, p, t, v, v, q][mod];
            return { r: r * 255, g: g * 255, b: b * 255 };
        } function rgbToHex(r, g, b, allow3Char) {
            var hex = [pad2(mathRound(r).toString(16)), pad2(mathRound(g).toString(16)), pad2(mathRound(b).toString(16))];
            if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {
                return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
            } return hex.join("");
        } tinycolor.equals = function (color1, color2) {
            if (!color1 || !color2) { return false; } var tc1 = tinycolor(color1);
            var tc2 = tinycolor(color2); return tc1.toRgbString() == tc2.toRgbString() && tc1.id == tc2.id && tc1.image == tc2.image;
        }; tinycolor.random = function () {
            return tinycolor.fromRatio({ r: mathRandom(), g: mathRandom(), b: mathRandom() });
        }; tinycolor.desaturate = function (color, amount) {
            var hsl = tinycolor(color).toHsl(); hsl.s -= ((amount || 10) / 100);
            hsl.s = clamp01(hsl.s); return tinycolor(hsl);
        }; tinycolor.saturate = function (color, amount) {
            var hsl = tinycolor(color).toHsl();
            hsl.s += ((amount || 10) / 100); hsl.s = clamp01(hsl.s); return tinycolor(hsl);
        }; tinycolor.greyscale = function (color) {
            return tinycolor.desaturate(color, 100);
        }; tinycolor.lighten = function (color, amount) {
            var hsl = tinycolor(color).toHsl(); hsl.l += ((amount || 10) / 100);
            hsl.l = clamp01(hsl.l); return tinycolor(hsl);
        }; tinycolor.darken = function (color, amount) {
            var hsl = tinycolor(color).toHsl();
            hsl.l -= ((amount || 10) / 100); hsl.l = clamp01(hsl.l); return tinycolor(hsl);
        }; tinycolor.complement = function (color) {
            var hsl = tinycolor(color).toHsl();
            hsl.h = (hsl.h + 180) % 360; return tinycolor(hsl);
        }; tinycolor.triad = function (color) {
            var hsl = tinycolor(color).toHsl();
            var h = hsl.h; return [tinycolor(color), tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }), tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })];
        }; tinycolor.tetrad = function (color) {
            var hsl = tinycolor(color).toHsl(); var h = hsl.h; return [tinycolor(color), tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }), tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }), tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })];
        }; tinycolor.splitcomplement = function (color) {
            var hsl = tinycolor(color).toHsl(); var h = hsl.h; return [tinycolor(color), tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l }), tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l })];
        }; tinycolor.analogous = function (color, results, slices) {
            results = results || 6; slices = slices || 30; var hsl = tinycolor(color).toHsl();
            var part = 360 / slices; var ret = [tinycolor(color)]; for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results;
            ) { hsl.h = (hsl.h + part) % 360; ret.push(tinycolor(hsl)); } return ret;
        }; tinycolor.monochromatic = function (color, results) {
            results = results || 6;
            var hsv = tinycolor(color).toHsv(); var h = hsv.h, s = hsv.s, v = hsv.v; var ret = []; var modification = 1 / results; while (results--) {
                ret.push(tinycolor({ h: h, s: s, v: v }));
                v = (v + modification) % 1;
            } return ret;
        }; tinycolor.readability = function (color1, color2) {
            var a = tinycolor(color1).toRgb();
            var b = tinycolor(color2).toRgb(); var brightnessA = (a.r * 299 + a.g * 587 + a.b * 114) / 1000; var brightnessB = (b.r * 299 + b.g * 587 + b.b * 114) / 1000;
            var colorDiff = (Math.max(a.r, b.r) - Math.min(a.r, b.r) + Math.max(a.g, b.g) - Math.min(a.g, b.g) + Math.max(a.b, b.b) - Math.min(a.b, b.b));
            return { brightness: Math.abs(brightnessA - brightnessB), color: colorDiff };
        }; tinycolor.readable = function (color1, color2) {
            var readability = tinycolor.readability(color1, color2);
            return readability.brightness > 125 && readability.color > 500;
        }; tinycolor.mostReadable = function (baseColor, colorList) {
            var bestColor = null;
            var bestScore = 0; var bestIsReadable = false; for (var i = 0; i < colorList.length; i++) {
                var readability = tinycolor.readability(baseColor, colorList[i]);
                var readable = readability.brightness > 125 && readability.color > 500; var score = 3 * (readability.brightness / 125) + (readability.color / 500);
                if ((readable && !bestIsReadable) || (readable && bestIsReadable && score > bestScore) || ((!readable) && (!bestIsReadable) && score > bestScore)) {
                    bestIsReadable = readable;
                    bestScore = score; bestColor = tinycolor(colorList[i]);
                }
            } return bestColor;
        }; var names = tinycolor.names = { aliceblue: "f0f8ff", antiquewhite: "faebd7", aqua: "0ff", aquamarine: "7fffd4", azure: "f0ffff", beige: "f5f5dc", bisque: "ffe4c4", black: "000", blanchedalmond: "ffebcd", blue: "00f", blueviolet: "8a2be2", brown: "a52a2a", burlywood: "deb887", burntsienna: "ea7e5d", cadetblue: "5f9ea0", chartreuse: "7fff00", chocolate: "d2691e", coral: "ff7f50", cornflowerblue: "6495ed", cornsilk: "fff8dc", crimson: "dc143c", cyan: "0ff", darkblue: "00008b", darkcyan: "008b8b", darkgoldenrod: "b8860b", darkgray: "a9a9a9", darkgreen: "006400", darkgrey: "a9a9a9", darkkhaki: "bdb76b", darkmagenta: "8b008b", darkolivegreen: "556b2f", darkorange: "ff8c00", darkorchid: "9932cc", darkred: "8b0000", darksalmon: "e9967a", darkseagreen: "8fbc8f", darkslateblue: "483d8b", darkslategray: "2f4f4f", darkslategrey: "2f4f4f", darkturquoise: "00ced1", darkviolet: "9400d3", deeppink: "ff1493", deepskyblue: "00bfff", dimgray: "696969", dimgrey: "696969", dodgerblue: "1e90ff", firebrick: "b22222", floralwhite: "fffaf0", forestgreen: "228b22", fuchsia: "f0f", gainsboro: "dcdcdc", ghostwhite: "f8f8ff", gold: "ffd700", goldenrod: "daa520", gray: "808080", green: "008000", greenyellow: "adff2f", grey: "808080", honeydew: "f0fff0", hotpink: "ff69b4", indianred: "cd5c5c", indigo: "4b0082", ivory: "fffff0", khaki: "f0e68c", lavender: "e6e6fa", lavenderblush: "fff0f5", lawngreen: "7cfc00", lemonchiffon: "fffacd", lightblue: "add8e6", lightcoral: "f08080", lightcyan: "e0ffff", lightgoldenrodyellow: "fafad2", lightgray: "d3d3d3", lightgreen: "90ee90", lightgrey: "d3d3d3", lightpink: "ffb6c1", lightsalmon: "ffa07a", lightseagreen: "20b2aa", lightskyblue: "87cefa", lightslategray: "789", lightslategrey: "789", lightsteelblue: "b0c4de", lightyellow: "ffffe0", lime: "0f0", limegreen: "32cd32", linen: "faf0e6", magenta: "f0f", maroon: "800000", mediumaquamarine: "66cdaa", mediumblue: "0000cd", mediumorchid: "ba55d3", mediumpurple: "9370db", mediumseagreen: "3cb371", mediumslateblue: "7b68ee", mediumspringgreen: "00fa9a", mediumturquoise: "48d1cc", mediumvioletred: "c71585", midnightblue: "191970", mintcream: "f5fffa", mistyrose: "ffe4e1", moccasin: "ffe4b5", navajowhite: "ffdead", navy: "000080", oldlace: "fdf5e6", olive: "808000", olivedrab: "6b8e23", orange: "ffa500", orangered: "ff4500", orchid: "da70d6", palegoldenrod: "eee8aa", palegreen: "98fb98", paleturquoise: "afeeee", palevioletred: "db7093", papayawhip: "ffefd5", peachpuff: "ffdab9", peru: "cd853f", pink: "ffc0cb", plum: "dda0dd", powderblue: "b0e0e6", purple: "800080", red: "f00", rosybrown: "bc8f8f", royalblue: "4169e1", saddlebrown: "8b4513", salmon: "fa8072", sandybrown: "f4a460", seagreen: "2e8b57", seashell: "fff5ee", sienna: "a0522d", silver: "c0c0c0", skyblue: "87ceeb", slateblue: "6a5acd", slategray: "708090", slategrey: "708090", snow: "fffafa", springgreen: "00ff7f", steelblue: "4682b4", tan: "d2b48c", teal: "008080", thistle: "d8bfd8", tomato: "ff6347", turquoise: "40e0d0", violet: "ee82ee", wheat: "f5deb3", white: "fff", whitesmoke: "f5f5f5", yellow: "ff0", yellowgreen: "9acd32" };
        var hexNames = tinycolor.hexNames = flip(names); function flip(o) {
            var flipped = {}; for (var i in o) {
                if (o.hasOwnProperty(i)) {
                    flipped[o[i]] = i;
                }
            } return flipped;
        } function bound01(n, max) {
            if (isOnePointZero(n)) { n = "100%"; } var processPercent = isPercentage(n);
            n = mathMin(max, mathMax(0, parseFloat(n))); if (processPercent) { n = parseInt(n * max, 10) / 100; } if ((math.abs(n - max) < 0.000001)) {
                return 1;
            } return (n % max) / parseFloat(max);
        } function clamp01(val) { return mathMin(1, mathMax(0, val)); } function parseHex(val) {
            return parseInt(val, 16);
        } function isOnePointZero(n) { return typeof n == "string" && n.indexOf(".") != -1 && parseFloat(n) === 1; } function isPercentage(n) {
            return typeof n === "string" && n.indexOf("%") != -1;
        } function pad2(c) { return c.length == 1 ? "0" + c : "" + c; } function convertToPercentage(n) {
            if (n <= 1) {
                n = (n * 100) + "%";
            } return n;
        } var matchers = (function () {
            var CSS_INTEGER = "[-\\+]?\\d+%?"; var CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";
            var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")"; var PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
            var PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
            return { rgb: new RegExp("rgb" + PERMISSIVE_MATCH3), rgba: new RegExp("rgba" + PERMISSIVE_MATCH4), hsl: new RegExp("hsl" + PERMISSIVE_MATCH3), hsla: new RegExp("hsla" + PERMISSIVE_MATCH4), hsv: new RegExp("hsv" + PERMISSIVE_MATCH3), hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/, hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/ };
        })(); function stringInputToObject(colorinput) {
            var inputarray = colorinput.split("|"); color = inputarray[0];
            var id = ""; var image = ""; var text = ""; if (inputarray.length > 1) { id = inputarray[1]; } if (inputarray.length > 2) {
                image = inputarray[2];
            } if (inputarray.length > 3) { text = inputarray[3]; } color = color.replace(trimLeft, "").replace(trimRight, "").toLowerCase();
            var named = false; if (names[color]) { color = names[color]; named = true; } else {
                if (color == "transparent") {
                    return { r: 0, g: 0, b: 0, a: 0, id: id, image: image, text: text };
                }
            } var match; if ((match = matchers.rgb.exec(color))) {
                return { r: match[1], g: match[2], b: match[3], id: id, image: image, text: text };
            } if ((match = matchers.rgba.exec(color))) {
                return { r: match[1], g: match[2], b: match[3], a: match[4], id: id, image: image, text: text };
            } if ((match = matchers.hsl.exec(color))) {
                return { h: match[1], s: match[2], l: match[3], id: id, image: image, text: text };
            } if ((match = matchers.hsla.exec(color))) {
                return { h: match[1], s: match[2], l: match[3], a: match[4], id: id, image: image, text: text };
            } if ((match = matchers.hsv.exec(color))) {
                return { h: match[1], s: match[2], v: match[3], id: id, image: image, text: text };
            } if ((match = matchers.hex6.exec(color))) {
                return { r: parseHex(match[1]), g: parseHex(match[2]), b: parseHex(match[3]), id: id, image: image, text: text, format: named ? "name" : "hex" };
            } if ((match = matchers.hex3.exec(color))) {
                return { r: parseHex(match[1] + "" + match[1]), g: parseHex(match[2] + "" + match[2]), b: parseHex(match[3] + "" + match[3]), id: id, image: image, text: text, format: named ? "name" : "hex" };
            } return false;
        } root.tinycolor = tinycolor;
    })(this); $(function () {
        if ($.fn.spectrum.load) {
            $.fn.spectrum.processNativeColorInputs();
        }
    });
})
(window, jQuery); 
(function (modules) {
    var installedModules = {}; function __webpack_require__(moduleId) {
        if (installedModules[moduleId]) {
            return installedModules[moduleId].exports;
        } var module = installedModules[moduleId] = { exports: {}, id: moduleId, loaded: false }; modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
        module.loaded = true; return module.exports;
    } __webpack_require__.m = modules; __webpack_require__.c = installedModules;
    __webpack_require__.p = ""; return __webpack_require__(0);
})

([function (module, exports, __webpack_require__) {
    __webpack_require__(1);
    __webpack_require__(2); __webpack_require__(3); __webpack_require__(4); __webpack_require__(5); __webpack_require__(6);
    __webpack_require__(7); __webpack_require__(8); __webpack_require__(9); __webpack_require__(10); __webpack_require__(11);
    __webpack_require__(12); __webpack_require__(13); __webpack_require__(14); __webpack_require__(15); __webpack_require__(16);
    __webpack_require__(17); __webpack_require__(18); __webpack_require__(19); __webpack_require__(20); __webpack_require__(21);
    __webpack_require__(22); __webpack_require__(23); __webpack_require__(24); __webpack_require__(25); __webpack_require__(26);
    __webpack_require__(27); __webpack_require__(28); __webpack_require__(29); __webpack_require__(30); __webpack_require__(31);
    __webpack_require__(32); __webpack_require__(33); __webpack_require__(34); __webpack_require__(35); __webpack_require__(36);
    __webpack_require__(37); __webpack_require__(38); __webpack_require__(39); __webpack_require__(40); __webpack_require__(41);
    __webpack_require__(42); __webpack_require__(43); __webpack_require__(44); __webpack_require__(45); __webpack_require__(46);
    __webpack_require__(47); __webpack_require__(48); __webpack_require__(49); __webpack_require__(50); __webpack_require__(51);
    __webpack_require__(52); __webpack_require__(53); __webpack_require__(54); __webpack_require__(55); __webpack_require__(56);
    __webpack_require__(57); __webpack_require__(58); __webpack_require__(59); __webpack_require__(60); __webpack_require__(61);
    __webpack_require__(62); __webpack_require__(63); __webpack_require__(64); __webpack_require__(65); __webpack_require__(66);
    __webpack_require__(67); __webpack_require__(68); __webpack_require__(69); __webpack_require__(70); __webpack_require__(71);
    __webpack_require__(72); module.exports = __webpack_require__(73);
},
function (module, exports) {
    var T = window.T || {};
    T.settings = { geoWebServices: (window.location.protocol != "https:" ? "http://geowebservices.maporama.com/" : "https://geowebservices.maporama.com/") };
    window.T = T; if (!document.querySelectorAll) {
        document.querySelectorAll = function (r, c, i, j, a) {
            var s = document.createStyleSheet();
            a = document.all, c = [], r = r.replace(/\[for\b/gi, "[htmlFor").split(","); for (i = r.length; i--;) {
                s.addRule(r[i], "k:v");
                for (j = a.length; j--;) { a[j].currentStyle.k && c.push(a[j]); } s.removeRule(0);
            } return c;
        };
    } if (!Array.prototype.reduce) {
        Array.prototype.reduce = function (callback, opt_initialValue) {
            if (null === this || "undefined" === typeof this) {
                throw new TypeError("Array.prototype.reduce called on null or undefined");
            } if ("function" !== typeof callback) { throw new TypeError(callback + " is not a function"); } var index, value, length = this.length >>> 0, isValueSet = false;
            if (1 < arguments.length) { value = opt_initialValue; isValueSet = true; } for (index = 0; length > index; ++index) {
                if (this.hasOwnProperty(index)) {
                    if (isValueSet) {
                        value = callback(value, this[index], index, this);
                    } else { value = this[index]; isValueSet = true; }
                }
            } if (!isValueSet) {
                throw new TypeError("Reduce of empty array with no initial value");
            } return value;
        };
    } if (!Array.prototype.map) {
        Array.prototype.map = function (fun) {
            var len = this.length; if (typeof fun !== "function") {
                throw new TypeError("func is not a function!");
            } var res = [], i; var thisArg = arguments.length >= 2 ? arguments[1] : void 0; for (i = 0; i < len; i++) {
                if (i in this) {
                    res[i] = fun.call(thisArg, this[i], i, this);
                }
            } return res;
        };
    } if (!Array.prototype.filter) {
        Array.prototype.filter = function (fun) {
            var len = this.length;
            if (typeof fun !== "function") { throw new TypeError(); } var res = [], i; var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
            for (i = 0; i < len; i++) { if (i in this) { var val = this[i]; if (fun.call(thisArg, val, i, this)) { res.push(val); } } } return res;
        };
    } if (!Array.prototype.forEach) {
        Array.prototype.forEach = function (fun) {
            var t = this; var len = t.length; if (typeof fun !== "function") {
                throw new TypeError();
            } var thisArg = arguments.length >= 2 ? arguments[1] : void 0, i = 0; for (i = 0; i < len; i++) {
                if (i in t) {
                    fun.call(thisArg, t[i], i, t);
                }
            }
        };
    } if (!Array.isArray) {
        Array.isArray = function (vArg) {
            return Object.prototype.toString.call(vArg) === "[object Array]";
        };
    } if (!String.prototype.trim) {
        String.prototype.trim = function () { return this.replace(/^\s+|\s+$/g, ""); };
    }
},
function (module, exports) {
    (function (exports) {
        var EventDispatcher = function () {
            this.events = {}; this.eventsContext = {};
        }; EventDispatcher.prototype = {
            on: function (eventName, fn, context) {
                var f = context ? this.bind(fn, context) : fn, events = this.events[eventName] = this.events[eventName] || {}, eventsContext = this.eventsContext[eventName] = this.eventsContext[eventName] || {};
                fn.key = "fn" + this.now() + "_" + Math.floor((Math.random() * 100)); fn.proxy = f; events[fn.key] = f; eventsContext[fn.key] = context;
            }, fire: function (eventName, params) {
                var functions = this.events[eventName], key; for (key in functions) {
                    if (functions.hasOwnProperty(key)) {
                        if (typeof functions[key] === "function") {
                            var fn = functions[key];
                            var q = []; for (var i = 1; i < arguments.length; i++) { q.push(arguments[i]); } fn.apply(this, q);
                        }
                    }
                }
            }, detach: function (eventName, fn) {
                var events = this.events[eventName];
                if (events.hasOwnProperty(fn.key)) { delete events[fn.key]; } return;
            }, detachAll: function () {
                this.events = {};
            }, bind: function (fn, c) { return function () { return fn.apply(c || fn, arguments); }; }, now: function () {
                return (new Date()).getTime();
            }
        }; exports.EventDispatcher = EventDispatcher;
    }(window.T));
}, 
function (module, exports) {
    (function (exports) {
        var Point = function (x, y) {
            this.x = x;
            this.y = y;
        }; Point.prototype = {
            toString: function () { return "Point(" + this.x + "," + this.y + ")"; }, clone: function (point) {
                return new Point(this.x, this.y);
            }, add: function (point) { var result = this.clone(); result.x += point.x; result.y += point.y; return result; }, substract: function (point) {
                var result = this.clone();
                result.x -= point.x; result.y -= point.y; return result;
            }, multiplyBy: function (val) {
                var result = this.clone();
                if (val instanceof T.Point) { result.x *= val.x; result.y *= val.y; } else { result.x *= val; result.y *= val; } return result;
            }, divideBy: function (val) {
                var result = this.clone(); if (val instanceof T.Point) {
                    result.x /= val.x; result.y /= val.y;
                } else { result.x /= val; result.y /= val; } return result;
            }, round: function () {
                var result = this.clone(); result.x = Math.round(this.x);
                result.y = Math.round(this.y); return result;
            }, floor: function () {
                var result = this.clone(); result.x = Math.floor(result.x);
                result.y = Math.floor(result.y); return result;
            }, isEqual: function (other, tollerance) {
                if (tollerance) {
                    return (this.x <= other.x + tollerance && this.x >= other.x - tollerance && this.y <= other.y + tollerance && this.y >= other.y - tollerance);
                } return this.x === other.x && this.y === other.y;
            }, distanceTo: function (point) {
                var x = point.x - this.x, y = point.y - this.y;
                return Math.sqrt(x * x + y * y);
            }
        }; exports.Point = Point;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var Transform = function (a, b, c, d) {
            this.a = a;
            this.b = b; this.c = c; this.d = d;
        }; Transform.prototype = {
            transform: function (point, scale) {
                var result = point.clone();
                scale = scale || 1; result.x = scale * (this.a * result.x + this.b); result.y = scale * (this.c * result.y + this.d); return result;
            }, untransform: function (point, scale) {
                scale = scale || 1; return new T.Point((point.x / scale - this.b) / this.a, (point.y / scale - this.d) / this.c);
            }
        }; exports.Transform = Transform;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var LatLng = function (lat, lng) {
            this.lat = lat;
            this.lng = lng;
        }; LatLng.from = function (p1, p2) {
            if (p1 === undefined || p1 === null) { return null; } if (p1 instanceof T.LatLng) {
                return p1;
            } if (T.Util.isArray(p1)) { return new T.LatLng(p1[0], p1[1]); } return new T.LatLng(p1, p2);
        }; LatLng.prototype = {
            toString: function () {
                return "LatLng(" + this.lat + "," + this.lng + ")";
            }, clone: function () { return new LatLng(this.lat, this.lng); }, isEqual: function (other) {
                return this.lat === other.lat && this.lng === other.lng;
            }, round: function () {
                var result = this.clone(); result.lat = Math.round(this.lat); result.lng = Math.round(this.lng);
                return result;
            }
        }; exports.LatLng = LatLng;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var LatLngBounds = function (southWest, northEast) {
            if (!southWest) {
                return;
            } this.extend(southWest); this.extend(northEast);
        }; LatLngBounds.from = function (p1, p2) {
            if (p1 === undefined || p1 === null) {
                return null;
            } if (p1 instanceof T.LatLngBounds) { return p1; } if (T.Util.isArray(p1) && T.Util.isArray(p2)) {
                return new T.LatLngBounds(T.LatLng.from(p1), T.LatLng.from(p2));
            } if (T.Util.isArray(p1) && p1.length === 2) {
                return new T.LatLngBounds(T.LatLng.from(p1[0]), T.LatLng.from(p1[1]));
            }
        }; LatLngBounds.prototype = {
            extend: function (obj) {
                if (!obj) { return this; } if (obj instanceof T.LatLng) {
                    if (!this.southWest && !this.northEast) {
                        this.southWest = new T.LatLng(obj.lat, obj.lng);
                        this.northEast = new T.LatLng(obj.lat, obj.lng);
                    } else {
                        this.southWest.lat = Math.min(obj.lat, this.southWest.lat);
                        this.southWest.lng = Math.min(obj.lng, this.southWest.lng); this.northEast.lat = Math.max(obj.lat, this.northEast.lat);
                        this.northEast.lng = Math.max(obj.lng, this.northEast.lng);
                    }
                } else {
                    if (obj instanceof T.LatLngBounds) {
                        this.extend(obj.southWest);
                        this.extend(obj.northEast);
                    }
                } return this;
            }, getNorthEast: function () {
                return new T.LatLng(this.northEast.lat, this.northEast.lng);
            }, getNorthWest: function () { return new T.LatLng(this.northEast.lat, this.southWest.lng); }, getSouthEast: function () {
                return new T.LatLng(this.southWest.lat, this.northEast.lng);
            }, getSouthWest: function () { return new T.LatLng(this.southWest.lat, this.southWest.lng); }, center: function () {
                return new T.LatLng((this.southWest.lat + this.northEast.lat) / 2, (this.southWest.lng + this.northEast.lng) / 2);
            }, getWest: function () { return this.southWest.lng; }, getSouth: function () { return this.southWest.lat; }, getEast: function () {
                return this.northEast.lng;
            }, getNorth: function () { return this.northEast.lat; }
        }; exports.LatLngBounds = LatLngBounds;
    }(window.T));
}, 
function (module, exports) {
    (function (exports) {
        var Bounds = function (a, b) {
            if (!a) {
                a = new T.Point(0, 0);
            } if (!b) { b = new T.Point(0, 0); } this.extend(a); this.extend(b);
        }; Bounds.prototype = {
            extend: function (point) {
                if (!point) {
                    return;
                } if (!this.min && !this.max) { this.min = point.clone(); this.max = point.clone(); } else {
                    this.min.x = Math.min(point.x, this.min.x);
                    this.max.x = Math.max(point.x, this.max.x); this.min.y = Math.min(point.y, this.min.y); this.max.y = Math.max(point.y, this.max.y);
                } return this;
            }, intersect: function (bounds) {
                var b = new T.Bounds(); b.min.x = Math.max(this.min.x, bounds.min.x);
                b.min.y = Math.max(this.min.y, bounds.min.y); b.max.x = Math.min(this.max.x, bounds.max.x); b.max.y = Math.min(this.max.y, bounds.max.y);
                return b;
            }, center: function () {
                return new T.Point((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2);
            }, topLeft: function () { return new T.Point(this.min.x, this.max.y); }, topRight: function () {
                return new T.Point(this.max.x, this.max.y);
            }, bottomLeft: function () { return new T.Point(this.min.x, this.min.y); }, bottomRight: function () {
                return new T.Point(this.max.x, this.min.y);
            }, width: function () { return this.max.x - this.min.x; }, height: function () { return this.max.y - this.min.y; }
        }; exports.Bounds = Bounds;
    }(window.T));
},
function (module, exports) {
    if (typeof JSON !== "object") { JSON = {}; } (function () {
        function f(n) {
            return n < 10 ? "0" + n : n;
        } if (typeof Date.prototype.toJSON !== "function") {
            Date.prototype.toJSON = function () {
                return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null;
            }; String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () {
                return this.valueOf();
            };
        } var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep;
        function quote(string) {
            escapable.lastIndex = 0; return escapable.test(string) ? '"' + string.replace(escapable, function (a) {
                var c = meta[a];
                return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
            }) + '"' : '"' + string + '"';
        } function str(key, holder) {
            var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === "object" && typeof value.toJSON === "function") {
                value = value.toJSON(key);
            } if (typeof rep === "function") { value = rep.call(holder, key, value); } switch (typeof value) {
                case "string": return quote(value);
                case "number": return isFinite(value) ? String(value) : "null"; case "boolean": case "null": return String(value);
                case "object": if (!value) { return "null"; } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === "[object Array]") {
                    length = value.length;
                    for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || "null"; } v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]";
                    gap = mind; return v;
                } if (rep && typeof rep === "object") {
                    length = rep.length; for (i = 0; i < length; i += 1) {
                        if (typeof rep[i] === "string") {
                            k = rep[i];
                            v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v); }
                        }
                    }
                } else {
                    for (k in value) {
                        if (Object.prototype.hasOwnProperty.call(value, k)) {
                            v = str(k, value);
                            if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v); }
                        }
                    }
                } v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}";
                    gap = mind; return v;
            }
        } if (typeof JSON.stringify !== "function") {
            JSON.stringify = function (value, replacer, space) {
                var i;
                gap = ""; indent = ""; if (typeof space === "number") { for (i = 0; i < space; i += 1) { indent += " "; } } else {
                    if (typeof space === "string") {
                        indent = space;
                    }
                } rep = replacer; if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) {
                    throw new Error("JSON.stringify");
                } return str("", { "": value });
            };
        } if (typeof JSON.parse !== "function") {
            JSON.parse = function (text, reviver) {
                var j;
                function walk(holder, key) {
                    var k, v, value = holder[key]; if (value && typeof value === "object") {
                        for (k in value) {
                            if (Object.prototype.hasOwnProperty.call(value, k)) {
                                v = walk(value, k);
                                if (v !== undefined) { value[k] = v; } else { delete value[k]; }
                            }
                        }
                    } return reviver.call(holder, key, value);
                } text = String(text);
                cx.lastIndex = 0; if (cx.test(text)) {
                    text = text.replace(cx, function (a) {
                        return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4);
                    });
                } if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) {
                    j = eval("(" + text + ")");
                    return typeof reviver === "function" ? walk({ "": j }, "") : j;
                } throw new SyntaxError("JSON.parse");
            };
        }
    }());
}, 
function (module, exports) {
    (function (exports) {
        var Matrix2D = function (a, b, c, d, e, f) {
            var ln = 0;
            var cl = 0; for (var i = 0; i < 9; i++) { ln = (i / 3 | 0) + 1; cl = i % 3 + 1; this["m" + ln + cl] = ln === cl ? 1 : 0; } if (typeof a === "string") {
                var vals = a.match(/(-|\+)?\d*\.?\d+(?=,|\))/g);
                this.m11 = Number(vals[0]); this.m21 = Number(vals[1]); this.m12 = Number(vals[2]); this.m22 = Number(vals[3]); this.m13 = Number(vals[4]);
                this.m23 = Number(vals[5]);
            } else {
                this.m11 = a || this.m11; this.m21 = b || this.m21; this.m12 = c || this.m12; this.m22 = d || this.m22;
                this.m13 = e || this.m13; this.m23 = f || this.m23;
            }
        }; Matrix2D.prototype = {
            inverse: function () {
                var m = this.clone();
                var m2 = new Matrix2D(); var inv11 = m.m22 * m.m33 - m.m23 * m.m32; var inv12 = m.m13 * m.m32 - m.m12 * m.m33; var inv13 = m.m12 * m.m23 - m.m13 * m.m22;
                var inv21 = m.m23 * m.m31 - m.m21 * m.m33; var inv22 = m.m11 * m.m33 - m.m13 * m.m31; var inv23 = m.m13 * m.m21 - m.m11 * m.m23;
                var inv31 = m.m21 * m.m32 - m.m22 * m.m31; var inv32 = m.m12 * m.m31 - m.m11 * m.m32; var inv33 = m.m11 * m.m22 - m.m12 * m.m21;
                var det = m.m11 * inv11 + m.m12 * inv21 + m.m13 * inv31; m2.m11 = 1 / det * inv11; m2.m12 = 1 / det * inv12; m2.m13 = 1 / det * inv13;
                m2.m21 = 1 / det * inv21; m2.m22 = 1 / det * inv22; m2.m23 = 1 / det * inv23; m2.m31 = 1 / det * inv31; m2.m32 = 1 / det * inv32; m2.m33 = 1 / det * inv33;
                return m2;
            }, multiplyBy: function (b) {
                var a = this; var c = new Matrix2D(); c.m11 = a.m11 * b.m11 + a.m12 * b.m21 + a.m13 * b.m31;
                c.m12 = a.m11 * b.m12 + a.m12 * b.m22 + a.m13 * b.m32; c.m13 = a.m11 * b.m13 + a.m12 * b.m23 + a.m13 * b.m33; c.m21 = a.m21 * b.m11 + a.m22 * b.m21 + a.m23 * b.m31;
                c.m22 = a.m21 * b.m12 + a.m22 * b.m22 + a.m23 * b.m32; c.m23 = a.m21 * b.m13 + a.m22 * b.m23 + a.m23 * b.m33; c.m31 = a.m31 * b.m11 + a.m32 * b.m21 + a.m33 * b.m31;
                c.m32 = a.m31 * b.m12 + a.m32 * b.m22 + a.m33 * b.m32; c.m33 = a.m31 * b.m13 + a.m32 * b.m23 + a.m33 * b.m33; return c;
            }, clone: function () {
                var m = new Matrix2D();
                var l = 0; var c = 0; for (var i = 0; i < 9; i++) { l = (i / 3 | 0) + 1; c = i % 3 + 1; m["m" + l + c] = this["m" + l + c]; } return m;
            }, toString: function () {
                var str = this.m11.toFixed(6);
                str += ", " + this.m21.toFixed(6); str += ", " + this.m12.toFixed(6); str += ", " + this.m22.toFixed(6); str += ", " + this.m13.toFixed(6);
                str += ", " + this.m23.toFixed(6); return "matrix(" + str + ")";
            }
        }; exports.Matrix2D = Matrix2D;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        function Ajax() { } Ajax.prototype = {
            createXhr: function (options) {
                if (options) {
                    this.options = options;
                } var ajax = this; if (this.isIE() && !this.isSameWithOrigin(this.url)) {
                    this.xhr = new XDomainRequest(); this.xhr.onload = function () {
                        ajax.onComplete();
                    }; this.xhr.onerror = function () { ajax.onError(); }; this.xhr.onprogress = function () { }; this.xhr.ontimeout = function () { };
                } else {
                    if (!!window.XMLHttpRequest) { this.xhr = new window.XMLHttpRequest(); } else {
                        if (!!window.ActiveXObject) {
                            this.xhr = new window.ActiveXObject("Microsoft.XMLHTTP");
                        }
                    }
                } if (!this.xhr) { throw new Error("Unable to create XHR object!"); } this.xhr.onreadystatechange = function () {
                    if (this.readyState === 4) {
                        if (this.status === 501) {
                            ajax.onSessionTimeout();
                        } else { if (this.status >= 400 || this.status === 0) { ajax.onError(); } else { ajax.onComplete(); } }
                    }
                }; this.xhr.onprogress = function () { };
                this.xhr.ontimeout = function () { }; return;
            }, abort: function () { this.xhr.abort(); }, isIE: function () {
                if (navigator.appVersion.indexOf("MSIE") !== -1) {
                    return true;
                } return false;
            }, isSameWithOrigin: function (url) {
                var reg = new RegExp("^http(s)?://.*?(/|$)", "i"); var newHost = reg.exec(url)[0];
                var originHost = reg.exec(window.location.href)[0]; return (originHost === newHost);
            }, attachIsAjaxParameter: function (url) {
                var isQueryString = false, i = 0;
                for (i = 0; i < url.length; i++) { if (url.charAt(i) === "?") { url = url + "&isajax=true"; isQueryString = true; break; } } if (!isQueryString) {
                    url = url + "?isajax=true";
                } return url;
            }, send: function (url, options) {
                this.options = options; this.url = this.attachIsAjaxParameter(url);
                if (!this.xhr) { this.createXhr(); } this.xhr.open(options.method, this.url, true); this.xhr.timeout = 2000000;
                if (this.xhr.withCredentials !== undefined) {
                    if (options.withCredentials) {
                        this.xhr.withCredentials = options.withCredentials;
                    }
                } var i = 0; if (this.xhr.setRequestHeader && options.headers) {
                    for (i = 0; i < options.headers.length; i++) {
                        this.xhr.setRequestHeader(options.headers[i].name, options.headers[i].value);
                    }
                } if (options.data) { this.xhr.send(options.data); } else { this.xhr.send(null); } function timeoutHandler() {
                    throw new Error("Loading timeout: " + url);
                } return this;
            }, onComplete: function () {
                if (this.options.on.success) {
                    this.options.on.success(this.xhr.responseText);
                }
            }, onError: function () { if (this.options.on.error) { this.options.on.error(this.xhr.responseText); } }, onSessionTimeout: function () { }
        };
        exports.Ajax = Ajax;
    }(T));
}, 
function (module, exports) {
    (function (exports) {
        var Promise = function () {
            this.state = "pending";
            this.value = null; this.deferred = null; this.rejected = null;
        }; Promise.prototype = {
            then: function (deferred, rejected) {
                this._handle(deferred, rejected);
            }, resolve: function (value) {
                this.value = value; this.state = "resolved"; if (this.deferred) {
                    this._handle(this.deferred);
                }
            }, reject: function (value) { if (value) { value = JSON.parse(value); } this.rejected(value); }, _handle: function (deffered, rejected) {
                if (this.state === "pending") {
                    this.deferred = deffered;
                    this.rejected = rejected; return;
                } deffered(this.value);
            }
        }; exports.Promise = Promise;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var Util = {
            extend: function (dest) {
                var sources = Array.prototype.slice.call(arguments, 1), len = sources.length;
                var i, j, src; for (j = 0; j < len; j++) {
                    src = sources[j] || {}; for (i in src) {
                        if (src.hasOwnProperty(i)) {
                            dest[i] = src[i];
                        }
                    }
                } return dest;
            }, clone: function (dest) {
                var i, result = {}; for (i in dest) {
                    if (Object.prototype.hasOwnProperty.call(dest, i)) {
                        result[i] = dest[i];
                    }
                } return result;
            }, cloneFunctions: function (dest) {
                var i, result = {}; for (i in dest) {
                    if (typeof (dest[i]) === "function") {
                        result[i] = (function () {
                            var func = dest[i];
                            return function () { return func.apply(this, arguments); };
                        }());
                    } else { result[i] = dest[i]; }
                } return result;
            }, inherit: function (cls, superCls) {
                var Construct = function () { };
                Construct.prototype = this.cloneFunctions(superCls.prototype); var proto = new Construct(); cls.prototype = Util.extend(proto, cls.prototype);
                cls.prototype.constructor = cls; cls.base = superCls.prototype;
            }, bind: function (fn, c) {
                return function () {
                    return fn.apply(c || fn, arguments);
                };
            }, template: function (str, data) {
                return str.replace(/\{ *([\w_]+) *\}/g, function (str, key) {
                    var value = data[key];
                    if (value === undefined) { throw new Error("No value provided for variable " + str); } else {
                        if (typeof value === "function") {
                            value = value(data);
                        }
                    } return value;
                });
            }, trim: function (str) { return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, ""); }, defaults: function (obj, source) {
                if (!obj) {
                    return source;
                } if (source) {
                    var prop; for (prop in source) {
                        if (source.hasOwnProperty(prop)) {
                            if ((obj[prop] === null || obj[prop] === undefined)) {
                                obj[prop] = source[prop];
                            }
                        }
                    }
                } return obj;
            }, limitExecByInterval: function (fn, time, context) {
                var lock, execOnUnlock; return function wrapperFn() {
                    var args = arguments;
                    if (lock) { execOnUnlock = true; return; } lock = true; setTimeout(function () {
                        lock = false; if (execOnUnlock) {
                            wrapperFn.apply(context, args);
                            execOnUnlock = false;
                        }
                    }, time); fn.apply(context, args);
                };
            }, isArray: function (obj) {
                return (Object.prototype.toString.call(obj) === "[object Array]");
            }, isFunction: function (obj) { return !!(obj && obj.constructor && obj.call && obj.apply); }, minMax: function (v1, v2, v3) {
                return Math.max(v1, Math.min(v2, v3));
            }, maxMin: function (v1, v2, v3) { return Math.min(v1, Math.max(v2, v3)); }, floatEqual: function (v1, v2, epsilon) {
                epsilon = epsilon || 0.00001;
                return (Math.abs(v1 - v2) <= epsilon);
            }, stamp: (function () {
                var lastId = 0, key = "tibcoId"; return function (obj) {
                    obj[key] = obj[key] || ++lastId;
                    return obj[key];
                };
            }()), hexToRgba: function (hex, alpha) {
                var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                var rgba = result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16), a: alpha || 1 } : null;
                if (rgba) { return "rgba(" + rgba.r + "," + rgba.g + "," + rgba.b + "," + rgba.a + ")"; } return "";
            }, getObjectClass: function (obj) {
                if (obj && obj.constructor && obj.constructor.toString) {
                    var arr = obj.constructor.toString().match(/function\s*(\w+)/);
                    if (arr && arr.length === 2) { return arr[1]; }
                } return undefined;
            }, browserSupportsHistoryApi: function () {
                return !!(window.history && history.pushState);
            }, handleBrowserNavigation: function (callback) { window.onpopstate = callback; }, setBrowserHistory: function (content, noHistory) {
                var newUrl = window.location.href;
                if (!content || (history.state && content === history.state.content) || (window.location.href.indexOf(content) !== -1)) {
                    return;
                } if (window.location.href.indexOf(content.charAt(0)) !== -1) {
                    newUrl = window.location.href.substring(0, window.location.href.indexOf(content.charAt(0)));
                } if (noHistory) { history.replaceState({ content: content }, null, newUrl + content); } else {
                    history.pushState({ content: content }, null, newUrl + content);
                }
            }, setBrowserUrlHash: function (content) { if (!content) { return; } window.location.hash = content; }, getBrowserUrlHash: function (content) {
                return window.location.hash;
            }, geolocate: function (onSuccess, onError) {
                if (!navigator || !navigator.geolocation) {
                    onError.call(this, null);
                } navigator.geolocation.getCurrentPosition(T.Util.bind(function (position) {
                    onSuccess.call(this, position.coords.latitude, position.coords.longitude);
                }, this), T.Util.bind(function (error) { onError.call(this, error); }, this));
            }, browserSupportsGeolocation: function () {
                return (navigator && navigator.geolocation);
            }, touchSupport: function () {
                var msPointerEnabled = !!navigator.pointerEnabled || navigator.msPointerEnabled;
                return !!("ontouchstart" in window) || msPointerEnabled;
            }, browserVersion: (function () {
                var ua = navigator.userAgent.toLowerCase();
                return { ielt8: document.all && !document.querySelector, ielt9: !!window.ActiveXObject && !document.addEventListener, webkit: ua.indexOf("webkit") !== -1, chrome: ua.indexOf("chrome") !== -1, android: ua.indexOf("android") !== -1 };
            }()), initOldIE: (function () {
                if (!Array.prototype.indexOf) {
                    Array.prototype.indexOf = function (obj) {
                        var i = 0;
                        for (i = 0; i < this.length; i++) { if (this[i] === obj) { return i; } } return -1;
                    };
                } if (!window.getComputedStyle) {
                    window.getComputedStyle = function (el, pseudo) {
                        this.el = el;
                        this.getPropertyValue = function (prop) {
                            var re = /(\-([a-z]){1})/g; if (prop == "float") { prop = "styleFloat"; } if (re.test(prop)) {
                                prop = prop.replace(re, function () {
                                    return arguments[2].toUpperCase();
                                });
                            } return el.currentStyle[prop] ? el.currentStyle[prop] : null;
                        }; return this;
                    };
                }
            }()), numberToRad: (function () {
                if (typeof (Number.prototype.toRad) === "undefined") {
                    Number.prototype.toRad = function () {
                        return this * Math.PI / 180;
                    };
                }
            }())
        }; exports.Util = Util;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var DomUtil = {
            SVG_NS: "http://www.w3.org/2000/svg", get: function (id) {
                return document.getElementById(id);
            }, getNodesByClass: function (className) { return document.querySelectorAll("." + className); }, create: function (tagName, className, parent, id) {
                var element = document.createElement(tagName);
                element.className = className || ""; if (id) { element.id = id; } if (parent) { parent.appendChild(element); } return element;
            }, remove: function (el) { if (!el) { return; } el.parentNode.removeChild(el); }, hasClass: function (el, className) {
                return (el.className.length > 0) && new RegExp("(^|\\s)" + className + "(\\s|$)").test(el.className);
            }, addClass: function (el, className) {
                if (!DomUtil.hasClass(el, className)) {
                    el.className += (el.className ? " " : "") + className;
                }
            }, removeClass: function (el, className) {
                el.className = T.Util.trim((" " + el.className + " ").replace(" " + className + " ", " "));
            }, getStyle: function (el, style) {
                var value = el.style[style]; if (!value && el.currentStyle) {
                    value = el.currentStyle[style];
                } if ((!value || value === "auto") && document.defaultView) {
                    var css = document.defaultView.getComputedStyle(el, null);
                    value = css ? css[style] : null;
                } return value === "auto" ? null : value;
            }, setOpacity: function (el, value) {
                el.style.msFilter = "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + value * 100 + ")";
                if (!T.Util.browserVersion.ielt9) { el.style.filter = "alpha(opacity=" + value * 100 + ")"; } el.style.opacity = value;
                el.style.mozOpacity = value;
            }, position: function (el, point) {
                if (point) {
                    el.style.left = point.x + "px"; el.style.top = point.y + "px";
                    el.tibcoPosition = point;
                } return el.tibcoPosition;
            }, size: function (el, size) {
                if (size) {
                    el.style.width = size.x + "px";
                    el.style.height = size.y + "px";
                } return new T.Point(parseInt(el.style.width, 10), parseInt(el.style.height, 10));
            }, calculateElementClientOffset: function (element) {
                var offsetLeft = 0; var offsetTop = 0; var bounds = element.getBoundingClientRect();
                offsetLeft = bounds.left; offsetTop = bounds.top; return { left: offsetLeft, top: offsetTop };
            }, createSvgElement: function (name) {
                return document.createElementNS(DomUtil.SVG_NS, name);
            }, createVmlElement: function (name) {
                var x = document.createElement(name); x.setAttribute("xmlns", "urn:schemas-microsoft.com:vml");
                return x;
            }, getNodeIndex: function (node, parent) {
                var nodes = parent ? parent.childNodes : node.parentNode.childNodes, i;
                for (i = 0; i < nodes.length; i++) { if (node === nodes[i]) { return i; } } return -1;
            }, addStyleNode: function (css) {
                var head = document.getElementsByTagName("head")[0];
                var style = document.createElement("style"); style.type = "text/css"; if (style.styleSheet) {
                    style.styleSheet.cssText = css;
                } else { style.appendChild(document.createTextNode(css)); } head.appendChild(style);
            }, hide: function (el) {
                el.style.display = "none";
            }, show: function (el, display) { el.style.display = display || "block"; }, getElementInsideContainer: function (parentId, childId) {
                var elm = document.getElementById(childId);
                var parent = elm ? elm.parentNode : {}; return (parent.id && parent.id === parentId) ? elm : {};
            }, disableSelection: function (element) {
                element.style.mozUserSelect = "none";
                element.style.khtmlUserSelect = "none"; element.style.webkitUserSelect = "none"; element.style.msUserSelect = "none";
                element.style.userSelect = "none"; element.dtraggable = false; element.onmousedown = function (event) {
                    if (event) {
                        if (event.preventDefault) {
                            event.preventDefault();
                        } else { event.returnValue = false; }
                    } return false;
                };
            }, nodeCollectionToArray: function (collection) {
                var a = [], i = 0;
                try { a = Array.prototype.slice.call(collection); } catch (e) {
                    for (i = 0; i < collection.length; i++) {
                        a.push(collection[i]);
                    }
                } return a;
            }
        }; exports.DomUtil = DomUtil;
    }(window.T));
}, 
function (module, exports) {
    (function (exports) {
        var DomEventUtil = {
            on: function (obj, type, fn, context) {
                var id = T.Util.stamp(fn), key = "tibco_" + type + id, handler, originalHandler, newType;
                if (obj[key]) { return this; } handler = function (e) {
                    return fn.call(context || obj, e || DomEventUtil.getEvent());
                }; if (obj.addEventListener !== undefined) {
                    if (type === "mousewheel") {
                        obj.addEventListener("DOMMouseScroll", handler, false);
                        obj.addEventListener(type, handler, false);
                    } else {
                        if ((type === "mouseenter") || (type === "mouseleave")) {
                            originalHandler = handler;
                            newType = (type === "mouseenter" ? "mouseover" : "mouseout"); handler = function (e) {
                                if (!DomEventUtil.checkMouse(obj, e)) {
                                    return;
                                } return originalHandler(e);
                            }; obj.addEventListener(newType, handler, false);
                        } else {
                            obj.addEventListener(type, handler, false);
                        }
                    }
                } else { if (obj.attachEvent !== undefined) { obj.attachEvent("on" + type, handler); } } obj[key] = handler; return this;
            }, off: function (obj, type, fn) {
                var id = T.Util.stamp(fn), key = "tibco_" + type + id, handler = obj[key]; if (!handler) {
                    return this;
                } if (obj.removeEventListener !== undefined) {
                    if (type === "mousewheel") {
                        obj.removeEventListener("DOMMouseScroll", handler, false);
                        obj.removeEventListener(type, handler, false);
                    } else {
                        if ((type === "mouseenter") || (type === "mouseleave")) {
                            obj.removeEventListener((type === "mouseenter" ? "mouseover" : "mouseout"), handler, false);
                        } else { obj.removeEventListener(type, handler, false); }
                    }
                } else {
                    if (obj.detachEvent !== undefined) {
                        obj.detachEvent("on" + type, handler);
                    }
                } obj[key] = null; return this;
            }, stopPropagation: function (e) {
                if (e.stopPropagation) { e.stopPropagation(); } else {
                    e.cancelBubble = true;
                } return this;
            }, preventDefault: function (e) {
                if (e.preventDefault) { e.preventDefault(); } else {
                    e.returnValue = false;
                } return this;
            }, stop: function (e) { return DomEventUtil.preventDefault(e).stopPropagation(e); }, getWheelDelta: function (e) {
                var delta = 0;
                if (e.wheelDelta) { delta = e.wheelDelta / 120; } if (e.detail) { delta = -e.detail / 3; } return delta;
            }, checkMouse: function (el, e) {
                var related = e.relatedTarget;
                if (!related) { return true; } try { while (related && (related !== el)) { related = related.parentNode; } } catch (err) {
                    return false;
                } return (related !== el);
            }, getEvent: function () {
                var e = window.event; if (!e) {
                    var caller = arguments.callee.caller;
                    while (caller) {
                        e = caller["arguments"][0]; if (e && window.Event === e.constructor) { break; } caller = caller.caller;
                    }
                } return e;
            }
        }; exports.DomEventUtil = DomEventUtil;
    }(window.T));
},
function (module, exports) {
    (function (exports) {
        var MouseUtil = function (target, options) {
            this.events = new T.EventDispatcher();
            this.options = T.Util.defaults(options, this.options); this.target = target; this.nbOfClicks = 0; this.clickThreshold = this.options.clickThreshold || 170;
            this.longClickThreshold = this.options.longClickThreshold || 300; this.dblClickThreshold = this.options.dblClickThreshold || 150;
            this.clickPrecision = this.options.clickPrecision / 2 || 40 / 2;
        }; MouseUtil.prototype = {
            options: {}, enable: function () {
                if (this.isEnable) {
                    return;
                } T.DomEventUtil.on(document, "mouseover", this.onOver, this); T.DomEventUtil.on(document, "mouseout", this.onOut, this);
                T.DomEventUtil.on(document, "mousedown", this.onDown, this); T.DomEventUtil.on(document, "mousewheel", this.onMouseWheel, this);
                T.DomEventUtil.on(document, "contextmenu", this.onContextMenu, this); this.isEnable = true;
            }, disable: function () {
                if (!this.isEnable) {
                    return;
                } T.DomEventUtil.off(document, "mouseover", this.onOver, this); T.DomEventUtil.off(document, "mouseout", this.onOut, this);
                T.DomEventUtil.off(document, "mousedown", this.onDown, this); T.DomEventUtil.off(document, "mousewheel", this.onMouseWheel, this);
                T.DomEventUtil.off(document, "contextmenu", this.onContextMenu, this); this.isEnable = false;
            }, onContextMenu: function (evt) {
                T.DomEventUtil.stop(evt);
                return false;
            }, onMouseWheel: function (evt) { this.events.fire("mouse-wheel", evt); }, onOver: function (evt) {
                this.events.fire("mouse-over", evt);
            }, onOut: function (evt) { this.events.fire("mouse-out", evt); }, onDown: function (evt) {
                var targetElement = document.elementFromPoint(evt.clientX, evt.clientY);
                if (this.findParentForTarget(targetElement, this.target)) { T.DomEventUtil.stop(evt); } else { return; } this.nbOfClicks++;
                this.moved = false; this.startPoint = this.newPoint = new T.Point(evt.clientX, evt.clientY); this.startTimestamp = this.getTimestamp();
                this.f = function (evt) { this.onUp(evt); }; T.DomEventUtil.on(document, "mousemove", this.onMove, this); T.DomEventUtil.on(document, "mouseup", this.f, this);
                this.events.fire("before-drag", evt);
            }, onMove: function (evt) {
                var newPoint = new T.Point(evt.clientX, evt.clientY);
                T.DomEventUtil.preventDefault(evt); if (newPoint.isEqual(this.newPoint)) { return; } if (!this.moved) {
                    this.moved = true;
                    this.events.fire("drag-start", evt);
                } this.newPoint = newPoint; this.moving = true; this.events.fire("drag", evt);
            }, onUp: function (evt) {
                var newEvt; if ((evt.which && evt.which === 3) || (evt.button && evt.button === 2)) {
                    this.events.fire("right-click", evt);
                    this.nbOfClicks = 0; T.DomEventUtil.off(document, "mousemove", this.onMove, this); T.DomEventUtil.off(document, "mouseup", this.f, this);
                    return;
                } if (T.Util.browserVersion.ielt9) { newEvt = T.Util.clone(evt); } else { newEvt = evt; } if (this.clickTimer) {
                    clearTimeout(this.clickTimer);
                } if (this.withinTimeAndDistanceTolerance(this.clickThreshold)) {
                    if (this.nbOfClicks % 2 === 0) {
                        this.events.fire("double-click", evt);
                    }
                } this.clickTimer = setTimeout(T.Util.bind(function () {
                    if (this.nbOfClicks === 1 && this.withinDistanceTolerance() && !this.moving && !this.moved) {
                        if (this.getTimestamp() - this.startTimestamp < this.longClickThreshold) {
                            this.events.fire("click", newEvt);
                        } else { this.events.fire("long-click", newEvt); }
                    } this.moving = false; this.moved = false; this.nbOfClicks = 0;
                }, this), this.dblClickThreshold);
                T.DomEventUtil.off(document, "mousemove", this.onMove, this); T.DomEventUtil.off(document, "mouseup", this.f, this);
                this.events.fire("drag-end", evt);
            }, findParentForTarget: function (target, parent) {
                var match = false; while (target) {
                    if (target === parent) {
                        match = true;
                        break;
                    } target = target.parentNode;
                } return match;
            }, withinTimeAndDistanceTolerance: function (timeThreshold) {
                return (this.startTimestamp + timeThreshold) - this.getTimestamp() >= 0 && this.startPoint.x >= this.newPoint.x - this.clickPrecision && this.newPoint.x <= this.newPoint.x + this.clickPrecision && this.startPoint.y >= this.newPoint.y - this.clickPrecision && this.startPoint.y <= this.newPoint.y + this.clickPrecision;
            }, withinDistanceTolerance: function () {
                return this.startPoint.x >= this.newPoint.x - this.clickPrecision && this.newPoint.x <= this.newPoint.x + this.clickPrecision && this.startPoint.y >= this.newPoint.y - this.clickPrecision && this.startPoint.y <= this.newPoint.y + this.clickPrecision;
            }, getTimestamp: function () { return new Date().getTime(); }, getNewMouseEventWithUsefulProperties: function (evt, newTarget) {
                return { clientX: evt.clientX, clientY: evt.clientY, target: newTarget };
            }
        }; exports.MouseUtil = MouseUtil;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var TouchUtil = function (target, options) {
            options = options || {};
            this.events = new T.EventDispatcher(); this.options = T.Util.defaults(options, this.options); this.target = target;
            this.nbOfTaps = 0; this.currentTouches = []; this.tapThreshold = options.tapThreshold || 260; this.longTapThreshold = options.longTapThreshold || 360;
            this.dblTapThreshold = options.dblTapThreshold || 270; this.tapPrecision = options.tapPrecision / 2 || 14 / 2;
        }; TouchUtil.prototype = {
            options: {}, enable: function () {
                if (this.isEnable) {
                    return;
                } T.DomEventUtil.on(document, "touchstart", this.onTouchStart, this); T.DomEventUtil.on(document, "touchmove", this.onTouchMove, this);
                T.DomEventUtil.on(document, "touchend", this.onTouchEnd, this); T.DomEventUtil.on(document, "touchcancel", this.onTouchEnd, this);
                this.isEnable = true;
            }, disable: function () {
                if (!this.isEnable) { return; } T.DomEventUtil.off(document, "touchstart", this.onTouchStart, this);
                T.DomEventUtil.off(document, "touchmove", this.onTouchMove, this); T.DomEventUtil.off(document, "touchend", this.onTouchEnd, this);
                T.DomEventUtil.off(document, "touchcancel", this.onTouchEnd, this); this.isEnable = false;
            }, onTouchStart: function (evt) {
                var targetElement = document.elementFromPoint(this.getPointerEvent(evt).clientX, this.getPointerEvent(evt).clientY);
                if (this.findParentForTarget(targetElement, this.target)) { T.DomEventUtil.stop(evt); } else { return; } var touches = evt.changedTouches, newTouches = [], i;
                this.moved = false; this.startPoint = this.newPoint = new T.Point(this.getPointerEvent(evt).clientX, this.getPointerEvent(evt).clientY);
                for (i = 0; i < touches.length; i++) {
                    var touchObj = this.createTouchObject(touches[i]); var idx = this.getTouchIndexById(touches[i].identifier);
                    if (idx >= 0) { this.currentTouches.splice(idx, 1, touchObj); } else { this.currentTouches.push(touchObj); } newTouches.push(touchObj);
                } if (this.currentTouches.length === 1) {
                    if (this.nbOfTaps === 0) { this.startTimestamp = this.getTimestamp(); } this.nbOfTaps++;
                } else { this.nbOfTaps = 0; } if (this.currentTouches.length <= 2) {
                    this.startPositions = this.currentTouches.concat();
                } this.events.fire("touch-start", evt, newTouches);
            }, onTouchMove: function (evt) {
                var touches = evt.changedTouches, newTouches = [], originalTouches = [], i, newPoint = new T.Point(this.getPointerEvent(evt).clientX, this.getPointerEvent(evt).clientY);
                T.DomEventUtil.stop(evt); if (newPoint.isEqual(this.newPoint, 1)) { return; } for (i = 0; i < touches.length; i++) {
                    var idx = this.getTouchIndexById(touches[i].identifier);
                    if (idx >= 0) {
                        var touchObj = this.createTouchObject(touches[i]); newTouches.push(touchObj); originalTouches.push(this.currentTouches[idx]);
                        this.currentTouches.splice(idx, 1, touchObj);
                    }
                } if (this.currentTouches.length === 1 && !this._pinching) {
                    if (!this.moved) {
                        this.moved = true;
                        this.events.fire("touch-move-start", evt);
                    } this.newPoint = newPoint; this.moving = true; this.events.fire("touch-move", evt, originalTouches, newTouches);
                } this.handleGesture(evt, originalTouches, newTouches);
            }, onTouchEnd: function (evt) {
                var touches = evt.changedTouches, endTouches = [], center, delta, scale, touchChange = false, originalTouches = [], i;
                T.DomEventUtil.stop(evt); if (evt.touches.length === 0) { this.moving = false; } if (evt.changedTouches.length === 1 && this.withinTimeAndDistanceTolerance(this.tapThreshold)) {
                    if (this.nbOfTaps >= 2) {
                        this.nbOfTaps = 0;
                        this.events.fire("double-tap", evt);
                    }
                } if (!this.tapTimer) {
                    this.tapTimer = setTimeout(T.Util.bind(function () {
                        if (this.nbOfTaps === 1 && this.withinDistanceTolerance() && !this.moving) {
                            if (this.getTimestamp() - this.startTimestamp < this.longTapThreshold) {
                                this.events.fire("tap", evt);
                            } else { this.events.fire("long-tap", evt); }
                        } this.moving = false; this.moved = false; this.nbOfTaps = 0; this.tapTimer = null;
                    }, this), this.dblTapThreshold);
                } if (this.currentTouches.length === 2) {
                    this._center = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                    this._delta = this.getPinchCenter(); this._scale = this.getPinchScale(); touchChange = true;
                } for (i = 0; i < touches.length;
                i++) {
                    var idx = this.getTouchIndexById(touches[i].identifier); if (idx >= 0) {
                        var touchObj = this.createTouchObject(touches[i]);
                        endTouches.push(touchObj); originalTouches.push(this.currentTouches[idx]); this.currentTouches.splice(idx, 1);
                    }
                } if (touchChange) { this.events.fire("touch-pinch-change", evt, this._center, this._scale, this._delta); } if (evt.touches.length === 0 && this._pinching) {
                    this._pinching = false;
                    this.events.fire("touch-pinch-end", evt, this._center, this._scale, this._delta); this.currentTouches = [];
                } this.events.fire("touch-end", evt, originalTouches, endTouches);
            }, findParentForTarget: function (target, parent) {
                var match = false; while (target) {
                    if (target === parent) {
                        match = true;
                        break;
                    } target = target.parentNode;
                } return match;
            }, withinTimeAndDistanceTolerance: function (timeThreshold) {
                return (this.startTimestamp + timeThreshold) - this.getTimestamp() >= 0 && this.startPoint.x >= this.newPoint.x - this.tapPrecision && this.newPoint.x <= this.newPoint.x + this.tapPrecision && this.startPoint.y >= this.newPoint.y - this.tapPrecision && this.startPoint.y <= this.newPoint.y + this.tapPrecision;
            }, withinDistanceTolerance: function () {
                return this.startPoint.x >= this.newPoint.x - this.tapPrecision && this.newPoint.x <= this.newPoint.x + this.tapPrecision && this.startPoint.y >= this.newPoint.y - this.tapPrecision && this.startPoint.y <= this.newPoint.y + this.tapPrecision;
            }, getPointerEvent: function (event) { return event.targetTouches ? event.targetTouches[0] : event; }, getTimestamp: function () {
                return new Date().getTime();
            }, handleGesture: function (evt, originalTouches, newTouches) {
                if (this.currentTouches.length === 1) {
                    var dx = newTouches[0].pageX - originalTouches[0].pageX;
                    var dy = newTouches[0].pageY - originalTouches[0].pageY; this.events.fire("touch-slide", evt, dx, dy);
                } else {
                    if (this.currentTouches.length === 2) {
                        var scale, center, delta;
                        this._pinching = true; center = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                        delta = this.getPinchCenter(originalTouches, newTouches); scale = this.getPinchScale(originalTouches, newTouches);
                        this.events.fire("touch-pinch", evt, center, scale, delta);
                    }
                }
            }, getPinchCenter: function () {
                var i, idx, touch;
                var centerS = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                var centerE = { x: (this.currentTouches[0].pageX + this.currentTouches[1].pageX) / 2, y: (this.currentTouches[0].pageY + this.currentTouches[1].pageY) / 2 };
                var center = { x: centerE.x - centerS.x, y: centerE.y - centerS.y }; return center;
            }, getPinchScale: function (originalTouches, newTouches) {
                var idx, touchA, touchB, touchC, touchD, scale;
                touchA = this.startPositions[0]; touchB = this.startPositions[1]; touchC = this.currentTouches[0]; touchD = this.currentTouches[1];
                scale = this.distance(touchC, touchD) / this.distance(touchA, touchB); return scale;
            }, getTouchIndexById: function (idToFind) {
                var i;
                for (i = 0; i < this.currentTouches.length; i++) {
                    var id = this.currentTouches[i].identifier; if (id === idToFind) {
                        return i;
                    }
                } return -1;
            }, createTouchObject: function (touch) {
                return { identifier: touch.identifier, pageX: touch.pageX, pageY: touch.pageY };
            }, distance: function (touchA, touchB) {
                return Math.sqrt(Math.pow(touchA.pageX - touchB.pageX, 2) + Math.pow(touchA.pageY - touchB.pageY, 2));
            }, getNewMouseEventWithUsefulProperties: function (evt, newTarget) {
                if (!evt.changedTouches) {
                    return { clientX: evt.clientX, clientY: evt.clientY, target: newTarget };
                } else {
                    return { clientX: evt.changedTouches[0].clientX, clientY: evt.changedTouches[0].clientY, target: newTarget };
                }
            }
        }; exports.TouchUtil = TouchUtil;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var AnimUtil = {
            getTransform: function (element) {
                var style = getComputedStyle(element);
                var transform = style.msTransform || style.webkitTransform || style.transform || ""; if (transform.search("matrix") !== -1) {
                    return transform;
                } return null;
            }, setMatrix: function (element, matrixStr) {
                if (element.style.msTransform) {
                    element.style.msTransform = matrixStr;
                } else { element.style.webkitTransform = matrixStr; element.style.transform = matrixStr; }
            }, onTransitionEnd: function (element, callback) {
                element.removeEventListener("webkitTransitionEnd", element.lastCallback);
                element.addEventListener("webkitTransitionEnd", callback, false); element.removeEventListener("transitionend", element.lastCallback);
                element.addEventListener("transitionend", callback, false); element.removeEventListener("otransitionend", element.lastCallback);
                element.addEventListener("otransitionend", callback, false); element.removeEventListener("MSTransitionEnd", element.lastCallback);
                element.addEventListener("MSTransitionEnd", callback, false); element.lastCallback = callback;
            }, transition: function (element, time, pos, type) {
                if (type) {
                    element.style.webkitTransition = type + " " + time + "s";
                    element.style.transition = type + " " + time + "s"; return;
                } pos = pos || new T.Point(0, 0); element.style.webkitTransition = "-webkit-transform " + time + "s cubic-bezier(.17,.67,1,.84)";
                element.style.transition = "transform " + time + "s cubic-bezier(.17,.67,1,.84)"; element.style.webkitTransformOrigin = pos.x + "px " + pos.y + "px";
                element.style.transformOrigin = pos.x + "px " + pos.y + "px"; element.style.msTransformOrigin = pos.x + "px " + pos.y + "px";
            }, translate: function (element, x, y) {
                if (element.style.msTransform) {
                    element.style.msTransform = "translate(" + x + "px," + y + "px)" + element.style.msTransform;
                } else {
                    element.style.webkitTransform = "translate(" + x + "px," + y + "px)" + element.style.webkitTransform; element.style.transform = "translate(" + x + "px," + y + "px)" + element.style.transform;
                }
            }, scale: function (element, x, y) {
                if (element.style.msTransform) {
                    element.style.msTransform = "scale(" + x + "," + y + ")" + element.style.msTransform;
                } else {
                    element.style.webkitTransform = "scale(" + x + "," + y + ")" + element.style.webkitTransform; element.style.transform = "scale(" + x + "," + y + ")" + element.style.transform;
                }
            }, reset: function (element) {
                element.style.webkitTransition = "-webkit-transform 0s"; element.style.transition = "transform 0s";
                if (element.style.msTransform) { element.style.msTransform = "translate(0,0)"; } else {
                    element.style.webkitTransform = "translate(0,0)";
                    element.style.transform = "translate(0,0)";
                } if (element.style.msTransform) {
                    element.style.msTransform += "scale(1,1)";
                } else { element.style.webkitTransform += "scale(1,1)"; element.style.transform += "scale(1,1)"; }
            }, canAnim: function () {
                var s = document.createElement("p").style, supportsTransitions = "transition" in s || "WebkitTransition" in s || "MozTransition" in s || "msTransition" in s || "OTransition" in s;
                return supportsTransitions;
            }
        }; exports.AnimUtil = AnimUtil;
    }(window.T));
}, function (module, exports) {
    (function (T) {
        var SimpleTouch = function () {
            this.currentTouches = [];
            this.events = new T.EventDispatcher(); this.lastAnchor = {};
        }; SimpleTouch.prototype = {
            init: function (element) {
                element.addEventListener("touchstart", this.handleStart.bind(this));
                element.addEventListener("touchmove", this.handleMove.bind(this)); element.addEventListener("touchend", this.handleEnd.bind(this));
            }, createTouchObject: function (touch) {
                return { identifier: touch.identifier, pageX: touch.pageX, pageY: touch.pageY };
            }, getTouchIndexById: function (idToFind) {
                var i; for (i = 0; i < this.currentTouches.length; i++) {
                    var id = this.currentTouches[i].identifier;
                    if (id === idToFind) { return i; }
                } return -1;
            }, handleStart: function (e) {
                var touches = e.changedTouches, newTouches = [], i;
                e.preventDefault(); for (i = 0; i < touches.length; i++) {
                    var touchObj = this.createTouchObject(touches[i]); var idx = this.getTouchIndexById(touches[i].identifier);
                    if (idx >= 0) { this.currentTouches.splice(idx, 1, touchObj); } else { this.currentTouches.push(touchObj); } newTouches.push(touchObj);
                } if (this.currentTouches.length <= 2) { this.startPositions = this.currentTouches.concat(); } this.events.fire("touch-start", newTouches);
            }, handleMove: function (e) {
                var touches = e.changedTouches, newTouches = [], originalTouches = [], i; e.preventDefault();
                for (i = 0; i < touches.length; i++) {
                    var idx = this.getTouchIndexById(touches[i].identifier); if (idx >= 0) {
                        var touchObj = this.createTouchObject(touches[i]);
                        newTouches.push(touchObj); originalTouches.push(this.currentTouches[idx]); this.currentTouches.splice(idx, 1, touchObj);
                    } else { }
                } this.events.fire("touch-move", originalTouches, newTouches); this.handleGesture(originalTouches, newTouches);
            }, handleGesture: function (originalTouches, newTouches) {
                if (this.currentTouches.length === 1) {
                    var dx = newTouches[0].pageX - originalTouches[0].pageX;
                    var dy = newTouches[0].pageY - originalTouches[0].pageY; this.events.fire("touch-slide", dx, dy);
                } else {
                    if (this.currentTouches.length === 2) {
                        var scale, center, delta;
                        this._pinching = true; center = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                        delta = this.getPinchCenter(originalTouches, newTouches); scale = this.getPinchScale(originalTouches, newTouches);
                        this.events.fire("touch-pinch", center, scale, delta);
                    }
                }
            }, getPinchCenter: function () {
                var i, idx, touch; var centerS = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                var centerE = { x: (this.currentTouches[0].pageX + this.currentTouches[1].pageX) / 2, y: (this.currentTouches[0].pageY + this.currentTouches[1].pageY) / 2 };
                var center = { x: centerE.x - centerS.x, y: centerE.y - centerS.y }; return center;
            }, getPinchScale: function (originalTouches, newTouches) {
                var idx, touchA, touchB, touchC, touchD, scale;
                touchA = this.startPositions[0]; touchB = this.startPositions[1]; touchC = this.currentTouches[0]; touchD = this.currentTouches[1];
                scale = this.distance(touchC, touchD) / this.distance(touchA, touchB); return scale;
            }, distance: function (touchA, touchB) {
                return Math.sqrt(Math.pow(touchA.pageX - touchB.pageX, 2) + Math.pow(touchA.pageY - touchB.pageY, 2));
            }, handleEnd: function (e) {
                var touches = e.changedTouches, endTouches = [], center, delta, scale, touchChange = false, originalTouches = [], i;
                e.preventDefault(); if (this.currentTouches.length === 2) {
                    this._center = { x: (this.startPositions[0].pageX + this.startPositions[1].pageX) / 2, y: (this.startPositions[0].pageY + this.startPositions[1].pageY) / 2 };
                    this._delta = this.getPinchCenter(); this._scale = this.getPinchScale(); touchChange = true;
                } for (i = 0; i < touches.length;
                i++) {
                    var idx = this.getTouchIndexById(touches[i].identifier); if (idx >= 0) {
                        var touchObj = this.createTouchObject(touches[i]);
                        endTouches.push(touchObj); originalTouches.push(this.currentTouches[idx]); this.currentTouches.splice(idx, 1);
                    } else { console.log("can't figure out which touch to end"); }
                } if (touchChange) {
                    this.events.fire("touch-pinch-change", this._center, this._scale, this._delta);
                } if (e.touches.length === 0 && this._pinching) {
                    this._pinching = false; this.events.fire("touch-pinch-end", this._center, this._scale, this._delta);
                    this.currentTouches = [];
                } this.events.fire("touch-end", originalTouches, endTouches);
            }
        }; T.SimpleTouch = SimpleTouch;
    }(window.T));
}, function (module, exports, __webpack_require__) {
    var require; var require; (function (global) {
        !function (e) {
            var f;
            "undefined" != typeof window ? f = window : "undefined" != typeof global ? f = global : "undefined" != typeof self && (f = self), f.proj4 = e();
        }(function () {
            var define, module, exports; return (function e(t, n, r) {
                function s(o, u) {
                    if (!n[o]) {
                        if (!t[o]) {
                            var a = typeof require == "function" && require;
                            if (!u && a) { return require(o, !0); } if (i) { return i(o, !0); } throw new Error("Cannot find module '" + o + "'");
                        } var f = n[o] = { exports: {} };
                        t[o][0].call(f.exports, function (e) { var n = t[o][1][e]; return s(n ? n : e); }, f, f.exports, e, t, n, r);
                    } return n[o].exports;
                } var i = typeof require == "function" && require; for (var o = 0; o < r.length; o++) { s(r[o]); } return s;
            })({
                1: [function (_dereq_, module, exports) {
                    var mgrs = _dereq_("mgrs");
                    function Point(x, y, z) {
                        if (!(this instanceof Point)) { return new Point(x, y, z); } if (Array.isArray(x)) {
                            this.x = x[0];
                            this.y = x[1]; this.z = x[2] || 0;
                        } else {
                            if (typeof x === "object") { this.x = x.x; this.y = x.y; this.z = x.z || 0; } else {
                                if (typeof x === "string" && typeof y === "undefined") {
                                    var coords = x.split(",");
                                    this.x = parseFloat(coords[0], 10); this.y = parseFloat(coords[1], 10); this.z = parseFloat(coords[2], 10) || 0;
                                } else {
                                    this.x = x;
                                    this.y = y; this.z = z || 0;
                                }
                            }
                        } console.warn("proj4.Point will be removed in version 3, use proj4.toPoint");
                    } Point.fromMGRS = function (mgrsStr) {
                        return new Point(mgrs.toPoint(mgrsStr));
                    }; Point.prototype.toMGRS = function (accuracy) { return mgrs.forward([this.x, this.y], accuracy); }; module.exports = Point;
                }, { mgrs: 66 }], 2: [function (_dereq_, module, exports) {
                    var parseCode = _dereq_("./parseCode"); var extend = _dereq_("./extend");
                    var projections = _dereq_("./projections"); var deriveConstants = _dereq_("./deriveConstants"); function Projection(srsCode, callback) {
                        if (!(this instanceof Projection)) {
                            return new Projection(srsCode);
                        } callback = callback || function (error) { if (error) { throw error; } }; var json = parseCode(srsCode); if (typeof json !== "object") {
                            callback(srsCode);
                            return;
                        } var modifiedJSON = deriveConstants(json); var ourProj = Projection.projections.get(modifiedJSON.projName);
                        if (ourProj) { extend(this, modifiedJSON); extend(this, ourProj); this.init(); callback(null, this); } else {
                            callback(srsCode);
                        }
                    } Projection.projections = projections; Projection.projections.start(); module.exports = Projection;
                }, { "./deriveConstants": 32, "./extend": 33, "./parseCode": 36, "./projections": 38 }], 3: [function (_dereq_, module, exports) {
                    module.exports = function (crs, denorm, point) {
                        var xin = point.x, yin = point.y, zin = point.z || 0;
                        var v, t, i; for (i = 0; i < 3; i++) {
                            if (denorm && i === 2 && point.z === undefined) { continue; } if (i === 0) { v = xin; t = "x"; } else {
                                if (i === 1) {
                                    v = yin;
                                    t = "y";
                                } else { v = zin; t = "z"; }
                            } switch (crs.axis[i]) {
                                case "e": point[t] = v; break; case "w": point[t] = -v; break; case "n": point[t] = v;
                                    break; case "s": point[t] = -v; break; case "u": if (point[t] !== undefined) { point.z = v; } break; case "d": if (point[t] !== undefined) {
                                        point.z = -v;
                                    } break; default: return null;
                            }
                        } return point;
                    };
                }, {}], 4: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    var sign = _dereq_("./sign"); module.exports = function (x) {
                        return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));
                    };
                }, { "./sign": 21 }], 5: [function (_dereq_, module, exports) {
                    var TWO_PI = Math.PI * 2; var sign = _dereq_("./sign");
                    module.exports = function (x) { return (Math.abs(x) < Math.PI) ? x : (x - (sign(x) * TWO_PI)); };
                }, { "./sign": 21 }], 6: [function (_dereq_, module, exports) {
                    module.exports = function (x) {
                        if (Math.abs(x) > 1) {
                            x = (x > 1) ? 1 : -1;
                        } return Math.asin(x);
                    };
                }, {}], 7: [function (_dereq_, module, exports) {
                    module.exports = function (x) {
                        return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));
                    };
                }, {}], 8: [function (_dereq_, module, exports) {
                    module.exports = function (x) {
                        return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));
                    };
                }, {}], 9: [function (_dereq_, module, exports) {
                    module.exports = function (x) {
                        return (0.05859375 * x * x * (1 + 0.75 * x));
                    };
                }, {}], 10: [function (_dereq_, module, exports) { module.exports = function (x) { return (x * x * x * (35 / 3072)); }; }, {}], 11: [function (_dereq_, module, exports) {
                    module.exports = function (a, e, sinphi) {
                        var temp = e * sinphi;
                        return a / Math.sqrt(1 - temp * temp);
                    };
                }, {}], 12: [function (_dereq_, module, exports) {
                    module.exports = function (ml, e0, e1, e2, e3) {
                        var phi;
                        var dphi; phi = ml / e0; for (var i = 0; i < 15; i++) {
                            dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));
                            phi += dphi; if (Math.abs(dphi) <= 1e-10) { return phi; }
                        } return NaN;
                    };
                }, {}], 13: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    module.exports = function (eccent, q) {
                        var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));
                        if (Math.abs(Math.abs(q) - temp) < 0.000001) { if (q < 0) { return (-1 * HALF_PI); } else { return HALF_PI; } } var phi = Math.asin(0.5 * q);
                        var dphi; var sin_phi; var cos_phi; var con; for (var i = 0; i < 30; i++) {
                            sin_phi = Math.sin(phi); cos_phi = Math.cos(phi);
                            con = eccent * sin_phi; dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
                            phi += dphi; if (Math.abs(dphi) <= 1e-10) { return phi; }
                        } return NaN;
                    };
                }, {}], 14: [function (_dereq_, module, exports) {
                    module.exports = function (e0, e1, e2, e3, phi) {
                        return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));
                    };
                }, {}], 15: [function (_dereq_, module, exports) {
                    module.exports = function (eccent, sinphi, cosphi) {
                        var con = eccent * sinphi;
                        return cosphi / (Math.sqrt(1 - con * con));
                    };
                }, {}], 16: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    module.exports = function (eccent, ts) {
                        var eccnth = 0.5 * eccent; var con, dphi; var phi = HALF_PI - 2 * Math.atan(ts);
                        for (var i = 0; i <= 15; i++) {
                            con = eccent * Math.sin(phi); dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;
                            phi += dphi; if (Math.abs(dphi) <= 1e-10) { return phi; }
                        } return -9999;
                    };
                }, {}], 17: [function (_dereq_, module, exports) {
                    var C00 = 1;
                    var C02 = 0.25; var C04 = 0.046875; var C06 = 0.01953125; var C08 = 0.01068115234375; var C22 = 0.75; var C44 = 0.46875;
                    var C46 = 0.013020833333333334; var C48 = 0.007120768229166667; var C66 = 0.3645833333333333; var C68 = 0.005696614583333333;
                    var C88 = 0.3076171875; module.exports = function (es) {
                        var en = []; en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));
                        en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08))); var t = es * es; en[2] = t * (C44 - es * (C46 + es * C48)); t *= es; en[3] = t * (C66 - es * C68);
                        en[4] = t * es * C88; return en;
                    };
                }, {}], 18: [function (_dereq_, module, exports) {
                    var pj_mlfn = _dereq_("./pj_mlfn");
                    var EPSLN = 1e-10; var MAX_ITER = 20; module.exports = function (arg, es, en) {
                        var k = 1 / (1 - es); var phi = arg; for (var i = MAX_ITER;
                        i; --i) {
                            var s = Math.sin(phi); var t = 1 - es * s * s; t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;
                            phi -= t; if (Math.abs(t) < EPSLN) { return phi; }
                        } return phi;
                    };
                }, { "./pj_mlfn": 19 }], 19: [function (_dereq_, module, exports) {
                    module.exports = function (phi, sphi, cphi, en) {
                        cphi *= sphi;
                        sphi *= sphi; return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));
                    };
                }, {}], 20: [function (_dereq_, module, exports) {
                    module.exports = function (eccent, sinphi) {
                        var con;
                        if (eccent > 1e-7) {
                            con = eccent * sinphi; return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));
                        } else { return (2 * sinphi); }
                    };
                }, {}], 21: [function (_dereq_, module, exports) {
                    module.exports = function (x) {
                        return x < 0 ? -1 : 1;
                    };
                }, {}], 22: [function (_dereq_, module, exports) {
                    module.exports = function (esinp, exp) {
                        return (Math.pow((1 - esinp) / (1 + esinp), exp));
                    };
                }, {}], 23: [function (_dereq_, module, exports) {
                    module.exports = function (array) {
                        var out = { x: array[0], y: array[1] };
                        if (array.length > 2) { out.z = array[2]; } if (array.length > 3) { out.m = array[3]; } return out;
                    };
                }, {}], 24: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    module.exports = function (eccent, phi, sinphi) {
                        var con = eccent * sinphi; var com = 0.5 * eccent; con = Math.pow(((1 - con) / (1 + con)), com);
                        return (Math.tan(0.5 * (HALF_PI - phi)) / con);
                    };
                }, {}], 25: [function (_dereq_, module, exports) {
                    exports.wgs84 = { towgs84: "0,0,0", ellipse: "WGS84", datumName: "WGS84" };
                    exports.ch1903 = { towgs84: "674.374,15.056,405.346", ellipse: "bessel", datumName: "swiss" }; exports.ggrs87 = { towgs84: "-199.87,74.79,246.62", ellipse: "GRS80", datumName: "Greek_Geodetic_Reference_System_1987" };
                    exports.nad83 = { towgs84: "0,0,0", ellipse: "GRS80", datumName: "North_American_Datum_1983" }; exports.nad27 = { nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat", ellipse: "clrk66", datumName: "North_American_Datum_1927" };
                    exports.potsdam = { towgs84: "606.0,23.0,413.0", ellipse: "bessel", datumName: "Potsdam Rauenberg 1950 DHDN" };
                    exports.carthage = { towgs84: "-263.0,6.0,431.0", ellipse: "clark80", datumName: "Carthage 1934 Tunisia" }; exports.hermannskogel = { towgs84: "653.0,-212.0,449.0", ellipse: "bessel", datumName: "Hermannskogel" };
                    exports.ire65 = { towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15", ellipse: "mod_airy", datumName: "Ireland 1965" };
                    exports.rassadiran = { towgs84: "-133.63,-157.5,-158.62", ellipse: "intl", datumName: "Rassadiran" }; exports.nzgd49 = { towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993", ellipse: "intl", datumName: "New Zealand Geodetic Datum 1949" };
                    exports.osgb36 = { towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894", ellipse: "airy", datumName: "Airy 1830" };
                    exports.s_jtsk = { towgs84: "589,76,480", ellipse: "bessel", datumName: "S-JTSK (Ferro)" }; exports.beduaram = { towgs84: "-106,-87,188", ellipse: "clrk80", datumName: "Beduaram" };
                    exports.gunung_segara = { towgs84: "-403,684,41", ellipse: "bessel", datumName: "Gunung Segara Jakarta" }; exports.rnb72 = { towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1", ellipse: "intl", datumName: "Reseau National Belge 1972" };
                }, {}], 26: [function (_dereq_, module, exports) {
                    exports.MERIT = { a: 6378137, rf: 298.257, ellipseName: "MERIT 1983" };
                    exports.SGS85 = { a: 6378136, rf: 298.257, ellipseName: "Soviet Geodetic System 85" }; exports.GRS80 = { a: 6378137, rf: 298.257222101, ellipseName: "GRS 1980(IUGG, 1980)" };
                    exports.IAU76 = { a: 6378140, rf: 298.257, ellipseName: "IAU 1976" }; exports.airy = { a: 6377563.396, b: 6356256.91, ellipseName: "Airy 1830" };
                    exports.APL4 = { a: 6378137, rf: 298.25, ellipseName: "Appl. Physics. 1965" }; exports.NWL9D = { a: 6378145, rf: 298.25, ellipseName: "Naval Weapons Lab., 1965" };
                    exports.mod_airy = { a: 6377340.189, b: 6356034.446, ellipseName: "Modified Airy" }; exports.andrae = { a: 6377104.43, rf: 300, ellipseName: "Andrae 1876 (Den., Iclnd.)" };
                    exports.aust_SA = { a: 6378160, rf: 298.25, ellipseName: "Australian Natl & S. Amer. 1969" }; exports.GRS67 = { a: 6378160, rf: 298.247167427, ellipseName: "GRS 67(IUGG 1967)" };
                    exports.bessel = { a: 6377397.155, rf: 299.1528128, ellipseName: "Bessel 1841" }; exports.bess_nam = { a: 6377483.865, rf: 299.1528128, ellipseName: "Bessel 1841 (Namibia)" };
                    exports.clrk66 = { a: 6378206.4, b: 6356583.8, ellipseName: "Clarke 1866" }; exports.clrk80 = { a: 6378249.145, rf: 293.4663, ellipseName: "Clarke 1880 mod." };
                    exports.clrk58 = { a: 6378293.645208759, rf: 294.2606763692654, ellipseName: "Clarke 1858" }; exports.CPM = { a: 6375738.7, rf: 334.29, ellipseName: "Comm. des Poids et Mesures 1799" };
                    exports.delmbr = { a: 6376428, rf: 311.5, ellipseName: "Delambre 1810 (Belgium)" }; exports.engelis = { a: 6378136.05, rf: 298.2566, ellipseName: "Engelis 1985" };
                    exports.evrst30 = { a: 6377276.345, rf: 300.8017, ellipseName: "Everest 1830" }; exports.evrst48 = { a: 6377304.063, rf: 300.8017, ellipseName: "Everest 1948" };
                    exports.evrst56 = { a: 6377301.243, rf: 300.8017, ellipseName: "Everest 1956" }; exports.evrst69 = { a: 6377295.664, rf: 300.8017, ellipseName: "Everest 1969" };
                    exports.evrstSS = { a: 6377298.556, rf: 300.8017, ellipseName: "Everest (Sabah & Sarawak)" }; exports.fschr60 = { a: 6378166, rf: 298.3, ellipseName: "Fischer (Mercury Datum) 1960" };
                    exports.fschr60m = { a: 6378155, rf: 298.3, ellipseName: "Fischer 1960" }; exports.fschr68 = { a: 6378150, rf: 298.3, ellipseName: "Fischer 1968" };
                    exports.helmert = { a: 6378200, rf: 298.3, ellipseName: "Helmert 1906" }; exports.hough = { a: 6378270, rf: 297, ellipseName: "Hough" };
                    exports.intl = { a: 6378388, rf: 297, ellipseName: "International 1909 (Hayford)" }; exports.kaula = { a: 6378163, rf: 298.24, ellipseName: "Kaula 1961" };
                    exports.lerch = { a: 6378139, rf: 298.257, ellipseName: "Lerch 1979" }; exports.mprts = { a: 6397300, rf: 191, ellipseName: "Maupertius 1738" };
                    exports.new_intl = { a: 6378157.5, b: 6356772.2, ellipseName: "New International 1967" }; exports.plessis = { a: 6376523, rf: 6355863, ellipseName: "Plessis 1817 (France)" };
                    exports.krass = { a: 6378245, rf: 298.3, ellipseName: "Krassovsky, 1942" }; exports.SEasia = { a: 6378155, b: 6356773.3205, ellipseName: "Southeast Asia" };
                    exports.walbeck = { a: 6376896, b: 6355834.8467, ellipseName: "Walbeck" }; exports.WGS60 = { a: 6378165, rf: 298.3, ellipseName: "WGS 60" };
                    exports.WGS66 = { a: 6378145, rf: 298.25, ellipseName: "WGS 66" }; exports.WGS7 = { a: 6378135, rf: 298.26, ellipseName: "WGS 72" };
                    exports.WGS84 = { a: 6378137, rf: 298.257223563, ellipseName: "WGS 84" }; exports.sphere = { a: 6370997, b: 6370997, ellipseName: "Normal Sphere (r=6370997)" };
                }, {}], 27: [function (_dereq_, module, exports) {
                    exports.greenwich = 0; exports.lisbon = -9.131906111111; exports.paris = 2.337229166667;
                    exports.bogota = -74.080916666667; exports.madrid = -3.687938888889; exports.rome = 12.452333333333; exports.bern = 7.439583333333;
                    exports.jakarta = 106.807719444444; exports.ferro = -17.666666666667; exports.brussels = 4.367975; exports.stockholm = 18.058277777778;
                    exports.athens = 23.7163375; exports.oslo = 10.722916666667;
                }, {}], 28: [function (_dereq_, module, exports) {
                    var proj = _dereq_("./Proj");
                    var transform = _dereq_("./transform"); var wgs84 = proj("WGS84"); function transformer(from, to, coords) {
                        var transformedArray;
                        if (Array.isArray(coords)) {
                            transformedArray = transform(from, to, coords); if (coords.length === 3) {
                                return [transformedArray.x, transformedArray.y, transformedArray.z];
                            } else { return [transformedArray.x, transformedArray.y]; }
                        } else { return transform(from, to, coords); }
                    } function checkProj(item) {
                        if (item instanceof proj) {
                            return item;
                        } if (item.oProj) { return item.oProj; } return proj(item);
                    } function proj4(fromProj, toProj, coord) {
                        fromProj = checkProj(fromProj);
                        var single = false; var obj; if (typeof toProj === "undefined") { toProj = fromProj; fromProj = wgs84; single = true; } else {
                            if (typeof toProj.x !== "undefined" || Array.isArray(toProj)) {
                                coord = toProj;
                                toProj = fromProj; fromProj = wgs84; single = true;
                            }
                        } toProj = checkProj(toProj); if (coord) {
                            return transformer(fromProj, toProj, coord);
                        } else {
                            obj = {
                                forward: function (coords) { return transformer(fromProj, toProj, coords); }, inverse: function (coords) {
                                    return transformer(toProj, fromProj, coords);
                                }
                            }; if (single) { obj.oProj = toProj; } return obj;
                        }
                    } module.exports = proj4;
                }, { "./Proj": 2, "./transform": 64 }], 29: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    var PJD_3PARAM = 1; var PJD_7PARAM = 2; var PJD_GRIDSHIFT = 3; var PJD_WGS84 = 4; var PJD_NODATUM = 5; var SEC_TO_RAD = 0.00000484813681109536;
                    var AD_C = 1.0026; var COS_67P5 = 0.3826834323650898; var datum = function (proj) {
                        if (!(this instanceof datum)) {
                            return new datum(proj);
                        } this.datum_type = PJD_WGS84; if (!proj) { return; } if (proj.datumCode && proj.datumCode === "none") {
                            this.datum_type = PJD_NODATUM;
                        } if (proj.datum_params) {
                            for (var i = 0; i < proj.datum_params.length; i++) {
                                proj.datum_params[i] = parseFloat(proj.datum_params[i]);
                            } if (proj.datum_params[0] !== 0 || proj.datum_params[1] !== 0 || proj.datum_params[2] !== 0) {
                                this.datum_type = PJD_3PARAM;
                            } if (proj.datum_params.length > 3) {
                                if (proj.datum_params[3] !== 0 || proj.datum_params[4] !== 0 || proj.datum_params[5] !== 0 || proj.datum_params[6] !== 0) {
                                    this.datum_type = PJD_7PARAM;
                                    proj.datum_params[3] *= SEC_TO_RAD; proj.datum_params[4] *= SEC_TO_RAD; proj.datum_params[5] *= SEC_TO_RAD; proj.datum_params[6] = (proj.datum_params[6] / 1000000) + 1;
                                }
                            }
                        } this.datum_type = proj.grids ? PJD_GRIDSHIFT : this.datum_type; this.a = proj.a; this.b = proj.b; this.es = proj.es;
                        this.ep2 = proj.ep2; this.datum_params = proj.datum_params; if (this.datum_type === PJD_GRIDSHIFT) {
                            this.grids = proj.grids;
                        }
                    }; datum.prototype = {
                        compare_datums: function (dest) {
                            if (this.datum_type !== dest.datum_type) {
                                return false;
                            } else {
                                if (this.a !== dest.a || Math.abs(this.es - dest.es) > 5e-11) { return false; } else {
                                    if (this.datum_type === PJD_3PARAM) {
                                        return (this.datum_params[0] === dest.datum_params[0] && this.datum_params[1] === dest.datum_params[1] && this.datum_params[2] === dest.datum_params[2]);
                                    } else {
                                        if (this.datum_type === PJD_7PARAM) {
                                            return (this.datum_params[0] === dest.datum_params[0] && this.datum_params[1] === dest.datum_params[1] && this.datum_params[2] === dest.datum_params[2] && this.datum_params[3] === dest.datum_params[3] && this.datum_params[4] === dest.datum_params[4] && this.datum_params[5] === dest.datum_params[5] && this.datum_params[6] === dest.datum_params[6]);
                                        } else {
                                            if (this.datum_type === PJD_GRIDSHIFT || dest.datum_type === PJD_GRIDSHIFT) {
                                                return this.nadgrids === dest.nadgrids;
                                            } else { return true; }
                                        }
                                    }
                                }
                            }
                        }, geodetic_to_geocentric: function (p) {
                            var Longitude = p.x; var Latitude = p.y; var Height = p.z ? p.z : 0;
                            var X; var Y; var Z; var Error_Code = 0; var Rn; var Sin_Lat; var Sin2_Lat; var Cos_Lat; if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {
                                Latitude = -HALF_PI;
                            } else {
                                if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) { Latitude = HALF_PI; } else {
                                    if ((Latitude < -HALF_PI) || (Latitude > HALF_PI)) {
                                        return null;
                                    }
                                }
                            } if (Longitude > Math.PI) { Longitude -= (2 * Math.PI); } Sin_Lat = Math.sin(Latitude); Cos_Lat = Math.cos(Latitude);
                            Sin2_Lat = Sin_Lat * Sin_Lat; Rn = this.a / (Math.sqrt(1 - this.es * Sin2_Lat)); X = (Rn + Height) * Cos_Lat * Math.cos(Longitude);
                            Y = (Rn + Height) * Cos_Lat * Math.sin(Longitude); Z = ((Rn * (1 - this.es)) + Height) * Sin_Lat; p.x = X; p.y = Y; p.z = Z; return Error_Code;
                        }, geocentric_to_geodetic: function (p) {
                            var genau = 1e-12; var genau2 = (genau * genau); var maxiter = 30; var P; var RR;
                            var CT; var ST; var RX; var RK; var RN; var CPHI0; var SPHI0; var CPHI; var SPHI; var SDPHI; var At_Pole; var iter;
                            var X = p.x; var Y = p.y; var Z = p.z ? p.z : 0; var Longitude; var Latitude; var Height; At_Pole = false; P = Math.sqrt(X * X + Y * Y);
                            RR = Math.sqrt(X * X + Y * Y + Z * Z); if (P / this.a < genau) {
                                At_Pole = true; Longitude = 0; if (RR / this.a < genau) {
                                    Latitude = HALF_PI;
                                    Height = -this.b; return;
                                }
                            } else { Longitude = Math.atan2(Y, X); } CT = Z / RR; ST = P / RR; RX = 1 / Math.sqrt(1 - this.es * (2 - this.es) * ST * ST);
                            CPHI0 = ST * (1 - this.es) * RX; SPHI0 = CT * RX; iter = 0; do {
                                iter++; RN = this.a / Math.sqrt(1 - this.es * SPHI0 * SPHI0); Height = P * CPHI0 + Z * SPHI0 - RN * (1 - this.es * SPHI0 * SPHI0);
                                RK = this.es * RN / (RN + Height); RX = 1 / Math.sqrt(1 - RK * (2 - RK) * ST * ST); CPHI = ST * (1 - RK) * RX; SPHI = CT * RX; SDPHI = SPHI * CPHI0 - CPHI * SPHI0;
                                CPHI0 = CPHI; SPHI0 = SPHI;
                            } while (SDPHI * SDPHI > genau2 && iter < maxiter); Latitude = Math.atan(SPHI / Math.abs(CPHI));
                            p.x = Longitude; p.y = Latitude; p.z = Height; return p;
                        }, geocentric_to_geodetic_noniter: function (p) {
                            var X = p.x;
                            var Y = p.y; var Z = p.z ? p.z : 0; var Longitude; var Latitude; var Height; var W; var W2; var T0; var T1; var S0; var S1;
                            var Sin_B0; var Sin3_B0; var Cos_B0; var Sin_p1; var Cos_p1; var Rn; var Sum; var At_Pole; X = parseFloat(X); Y = parseFloat(Y);
                            Z = parseFloat(Z); At_Pole = false; if (X !== 0) { Longitude = Math.atan2(Y, X); } else {
                                if (Y > 0) { Longitude = HALF_PI; } else {
                                    if (Y < 0) {
                                        Longitude = -HALF_PI;
                                    } else {
                                        At_Pole = true; Longitude = 0; if (Z > 0) { Latitude = HALF_PI; } else {
                                            if (Z < 0) { Latitude = -HALF_PI; } else {
                                                Latitude = HALF_PI;
                                                Height = -this.b; return;
                                            }
                                        }
                                    }
                                }
                            } W2 = X * X + Y * Y; W = Math.sqrt(W2); T0 = Z * AD_C; S0 = Math.sqrt(T0 * T0 + W2); Sin_B0 = T0 / S0; Cos_B0 = W / S0;
                            Sin3_B0 = Sin_B0 * Sin_B0 * Sin_B0; T1 = Z + this.b * this.ep2 * Sin3_B0; Sum = W - this.a * this.es * Cos_B0 * Cos_B0 * Cos_B0; S1 = Math.sqrt(T1 * T1 + Sum * Sum);
                            Sin_p1 = T1 / S1; Cos_p1 = Sum / S1; Rn = this.a / Math.sqrt(1 - this.es * Sin_p1 * Sin_p1); if (Cos_p1 >= COS_67P5) {
                                Height = W / Cos_p1 - Rn;
                            } else { if (Cos_p1 <= -COS_67P5) { Height = W / -Cos_p1 - Rn; } else { Height = Z / Sin_p1 + Rn * (this.es - 1); } } if (At_Pole === false) {
                                Latitude = Math.atan(Sin_p1 / Cos_p1);
                            } p.x = Longitude; p.y = Latitude; p.z = Height; return p;
                        }, geocentric_to_wgs84: function (p) {
                            if (this.datum_type === PJD_3PARAM) {
                                p.x += this.datum_params[0];
                                p.y += this.datum_params[1]; p.z += this.datum_params[2];
                            } else {
                                if (this.datum_type === PJD_7PARAM) {
                                    var Dx_BF = this.datum_params[0];
                                    var Dy_BF = this.datum_params[1]; var Dz_BF = this.datum_params[2]; var Rx_BF = this.datum_params[3]; var Ry_BF = this.datum_params[4];
                                    var Rz_BF = this.datum_params[5]; var M_BF = this.datum_params[6]; var x_out = M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF;
                                    var y_out = M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF; var z_out = M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF; p.x = x_out;
                                    p.y = y_out; p.z = z_out;
                                }
                            }
                        }, geocentric_from_wgs84: function (p) {
                            if (this.datum_type === PJD_3PARAM) {
                                p.x -= this.datum_params[0];
                                p.y -= this.datum_params[1]; p.z -= this.datum_params[2];
                            } else {
                                if (this.datum_type === PJD_7PARAM) {
                                    var Dx_BF = this.datum_params[0];
                                    var Dy_BF = this.datum_params[1]; var Dz_BF = this.datum_params[2]; var Rx_BF = this.datum_params[3]; var Ry_BF = this.datum_params[4];
                                    var Rz_BF = this.datum_params[5]; var M_BF = this.datum_params[6]; var x_tmp = (p.x - Dx_BF) / M_BF; var y_tmp = (p.y - Dy_BF) / M_BF;
                                    var z_tmp = (p.z - Dz_BF) / M_BF; p.x = x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp; p.y = -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp; p.z = Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp;
                                }
                            }
                        }
                    }; module.exports = datum;
                }, {}], 30: [function (_dereq_, module, exports) {
                    var PJD_3PARAM = 1; var PJD_7PARAM = 2;
                    var PJD_GRIDSHIFT = 3; var PJD_NODATUM = 5; var SRS_WGS84_SEMIMAJOR = 6378137; var SRS_WGS84_ESQUARED = 0.006694379990141316;
                    module.exports = function (source, dest, point) {
                        var wp, i, l; function checkParams(fallback) {
                            return (fallback === PJD_3PARAM || fallback === PJD_7PARAM);
                        } if (source.compare_datums(dest)) { return point; } if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {
                            return point;
                        } var src_a = source.a; var src_es = source.es; var dst_a = dest.a; var dst_es = dest.es; var fallback = source.datum_type;
                        if (fallback === PJD_GRIDSHIFT) {
                            if (this.apply_gridshift(source, 0, point) === 0) {
                                source.a = SRS_WGS84_SEMIMAJOR;
                                source.es = SRS_WGS84_ESQUARED;
                            } else {
                                if (!source.datum_params) {
                                    source.a = src_a; source.es = source.es; return point;
                                } wp = 1; for (i = 0, l = source.datum_params.length; i < l; i++) { wp *= source.datum_params[i]; } if (wp === 0) {
                                    source.a = src_a;
                                    source.es = source.es; return point;
                                } if (source.datum_params.length > 3) { fallback = PJD_7PARAM; } else {
                                    fallback = PJD_3PARAM;
                                }
                            }
                        } if (dest.datum_type === PJD_GRIDSHIFT) { dest.a = SRS_WGS84_SEMIMAJOR; dest.es = SRS_WGS84_ESQUARED; } if (source.es !== dest.es || source.a !== dest.a || checkParams(fallback) || checkParams(dest.datum_type)) {
                            source.geodetic_to_geocentric(point);
                            if (checkParams(source.datum_type)) { source.geocentric_to_wgs84(point); } if (checkParams(dest.datum_type)) {
                                dest.geocentric_from_wgs84(point);
                            } dest.geocentric_to_geodetic(point);
                        } if (dest.datum_type === PJD_GRIDSHIFT) {
                            this.apply_gridshift(dest, 1, point);
                        } source.a = src_a; source.es = src_es; dest.a = dst_a; dest.es = dst_es; return point;
                    };
                }, {}], 31: [function (_dereq_, module, exports) {
                    var globals = _dereq_("./global");
                    var parseProj = _dereq_("./projString"); var wkt = _dereq_("./wkt"); function defs(name) {
                        var that = this; if (arguments.length === 2) {
                            var def = arguments[1];
                            if (typeof def === "string") {
                                if (def[0] === "+") { defs[name] = parseProj(arguments[1]); } else {
                                    defs[name] = wkt(arguments[1]);
                                }
                            } else { defs[name] = def; }
                        } else {
                            if (arguments.length === 1) {
                                if (Array.isArray(name)) {
                                    return name.map(function (v) {
                                        if (Array.isArray(v)) {
                                            defs.apply(that, v);
                                        } else { defs(v); }
                                    });
                                } else {
                                    if (typeof name === "string") { if (name in defs) { return defs[name]; } } else {
                                        if ("EPSG" in name) {
                                            defs["EPSG:" + name.EPSG] = name;
                                        } else {
                                            if ("ESRI" in name) { defs["ESRI:" + name.ESRI] = name; } else {
                                                if ("IAU2000" in name) {
                                                    defs["IAU2000:" + name.IAU2000] = name;
                                                } else { console.log(name); }
                                            }
                                        }
                                    }
                                } return;
                            }
                        }
                    } globals(defs); module.exports = defs;
                }, { "./global": 34, "./projString": 37, "./wkt": 65 }], 32: [function (_dereq_, module, exports) {
                    var Datum = _dereq_("./constants/Datum");
                    var Ellipsoid = _dereq_("./constants/Ellipsoid"); var extend = _dereq_("./extend"); var datum = _dereq_("./datum");
                    var EPSLN = 1e-10; var SIXTH = 0.16666666666666666; var RA4 = 0.04722222222222222; var RA6 = 0.022156084656084655;
                    module.exports = function (json) {
                        if (json.datumCode && json.datumCode !== "none") {
                            var datumDef = Datum[json.datumCode];
                            if (datumDef) {
                                json.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(",") : null; json.ellps = datumDef.ellipse;
                                json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;
                            }
                        } if (!json.a) {
                            var ellipse = Ellipsoid[json.ellps] ? Ellipsoid[json.ellps] : Ellipsoid.WGS84;
                            extend(json, ellipse);
                        } if (json.rf && !json.b) { json.b = (1 - 1 / json.rf) * json.a; } if (json.rf === 0 || Math.abs(json.a - json.b) < EPSLN) {
                            json.sphere = true;
                            json.b = json.a;
                        } json.a2 = json.a * json.a; json.b2 = json.b * json.b; json.es = (json.a2 - json.b2) / json.a2; json.e = Math.sqrt(json.es);
                        if (json.R_A) {
                            json.a *= 1 - json.es * (SIXTH + json.es * (RA4 + json.es * RA6)); json.a2 = json.a * json.a; json.b2 = json.b * json.b;
                            json.es = 0;
                        } json.ep2 = (json.a2 - json.b2) / json.b2; if (!json.k0) { json.k0 = 1; } if (!json.axis) {
                            json.axis = "enu";
                        } json.datum = datum(json); return json;
                    };
                }, { "./constants/Datum": 25, "./constants/Ellipsoid": 26, "./datum": 29, "./extend": 33 }], 33: [function (_dereq_, module, exports) {
                    module.exports = function (destination, source) {
                        destination = destination || {};
                        var value, property; if (!source) { return destination; } for (property in source) {
                            value = source[property]; if (value !== undefined) {
                                destination[property] = value;
                            }
                        } return destination;
                    };
                }, {}], 34: [function (_dereq_, module, exports) {
                    module.exports = function (defs) {
                        defs("EPSG:4326", "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");
                        defs("EPSG:4269", "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");
                        defs("EPSG:3857", "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");
                        defs.WGS84 = defs["EPSG:4326"]; defs["EPSG:3785"] = defs["EPSG:3857"]; defs.GOOGLE = defs["EPSG:3857"]; defs["EPSG:900913"] = defs["EPSG:3857"];
                        defs["EPSG:102113"] = defs["EPSG:3857"];
                    };
                }, {}], 35: [function (_dereq_, module, exports) {
                    var proj4 = _dereq_("./core");
                    proj4.defaultDatum = "WGS84"; proj4.Proj = _dereq_("./Proj"); proj4.WGS84 = new proj4.Proj("WGS84"); proj4.Point = _dereq_("./Point");
                    proj4.toPoint = _dereq_("./common/toPoint"); proj4.defs = _dereq_("./defs"); proj4.transform = _dereq_("./transform");
                    proj4.mgrs = _dereq_("mgrs"); proj4.version = _dereq_("../package.json").version; _dereq_("./includedProjections")(proj4);
                    module.exports = proj4;
                }, { "../package.json": 67, "./Point": 1, "./Proj": 2, "./common/toPoint": 23, "./core": 28, "./defs": 31, "./includedProjections": "Jf/0WF", "./transform": 64, mgrs: 66 }], 36: [function (_dereq_, module, exports) {
                    var defs = _dereq_("./defs");
                    var wkt = _dereq_("./wkt"); var projStr = _dereq_("./projString"); function testObj(code) {
                        return typeof code === "string";
                    } function testDef(code) { return code in defs; } function testWKT(code) {
                        var codeWords = ["GEOGCS", "GEOCCS", "PROJCS", "LOCAL_CS"];
                        return codeWords.reduce(function (a, b) { return a + 1 + code.indexOf(b); }, 0);
                    } function testProj(code) {
                        return code[0] === "+";
                    } function parse(code) {
                        if (testObj(code)) {
                            if (testDef(code)) { return defs[code]; } else {
                                if (testWKT(code)) {
                                    return wkt(code);
                                } else { if (testProj(code)) { return projStr(code); } }
                            }
                        } else { return code; }
                    } module.exports = parse;
                }, { "./defs": 31, "./projString": 37, "./wkt": 65 }], 37: [function (_dereq_, module, exports) {
                    var D2R = 0.017453292519943295;
                    var PrimeMeridian = _dereq_("./constants/PrimeMeridian"); module.exports = function (defData) {
                        var self = {}; var paramObj = {};
                        defData.split("+").map(function (v) { return v.trim(); }).filter(function (a) { return a; }).forEach(function (a) {
                            var split = a.split("=");
                            split.push(true); paramObj[split[0].toLowerCase()] = split[1];
                        }); var paramName, paramVal, paramOutname; var params = {
                            proj: "projName", datum: "datumCode", rf: function (v) {
                                self.rf = parseFloat(v, 10);
                            }, lat_0: function (v) { self.lat0 = v * D2R; }, lat_1: function (v) { self.lat1 = v * D2R; }, lat_2: function (v) {
                                self.lat2 = v * D2R;
                            }, lat_ts: function (v) { self.lat_ts = v * D2R; }, lon_0: function (v) { self.long0 = v * D2R; }, lon_1: function (v) {
                                self.long1 = v * D2R;
                            }, lon_2: function (v) { self.long2 = v * D2R; }, alpha: function (v) { self.alpha = parseFloat(v) * D2R; }, lonc: function (v) {
                                self.longc = v * D2R;
                            }, x_0: function (v) { self.x0 = parseFloat(v, 10); }, y_0: function (v) { self.y0 = parseFloat(v, 10); }, k_0: function (v) {
                                self.k0 = parseFloat(v, 10);
                            }, k: function (v) { self.k0 = parseFloat(v, 10); }, r_a: function () { self.R_A = true; }, zone: function (v) {
                                self.zone = parseInt(v, 10);
                            }, south: function () { self.utmSouth = true; }, towgs84: function (v) {
                                self.datum_params = v.split(",").map(function (a) {
                                    return parseFloat(a, 10);
                                });
                            }, to_meter: function (v) { self.to_meter = parseFloat(v, 10); }, from_greenwich: function (v) {
                                self.from_greenwich = v * D2R;
                            }, pm: function (v) { self.from_greenwich = (PrimeMeridian[v] ? PrimeMeridian[v] : parseFloat(v, 10)) * D2R; }, nadgrids: function (v) {
                                if (v === "@null") {
                                    self.datumCode = "none";
                                } else { self.nadgrids = v; }
                            }, axis: function (v) {
                                var legalAxis = "ewnsud"; if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {
                                    self.axis = v;
                                }
                            }
                        }; for (paramName in paramObj) {
                            paramVal = paramObj[paramName]; if (paramName in params) {
                                paramOutname = params[paramName];
                                if (typeof paramOutname === "function") { paramOutname(paramVal); } else { self[paramOutname] = paramVal; }
                            } else {
                                self[paramName] = paramVal;
                            }
                        } if (typeof self.datumCode === "string" && self.datumCode !== "WGS84") {
                            self.datumCode = self.datumCode.toLowerCase();
                        } return self;
                    };
                }, { "./constants/PrimeMeridian": 27 }], 38: [function (_dereq_, module, exports) {
                    var projs = [_dereq_("./projections/merc"), _dereq_("./projections/longlat")];
                    var names = {}; var projStore = []; function add(proj, i) {
                        var len = projStore.length; if (!proj.names) {
                            console.log(i);
                            return true;
                        } projStore[len] = proj; proj.names.forEach(function (n) { names[n.toLowerCase()] = len; }); return this;
                    } exports.add = add; exports.get = function (name) {
                        if (!name) { return false; } var n = name.toLowerCase(); if (typeof names[n] !== "undefined" && projStore[names[n]]) {
                            return projStore[names[n]];
                        }
                    }; exports.start = function () { projs.forEach(add); };
                }, { "./projections/longlat": 50, "./projections/merc": 51 }], 39: [function (_dereq_, module, exports) {
                    var EPSLN = 1e-10;
                    var msfnz = _dereq_("../common/msfnz"); var qsfnz = _dereq_("../common/qsfnz"); var adjust_lon = _dereq_("../common/adjust_lon");
                    var asinz = _dereq_("../common/asinz"); exports.init = function () {
                        if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                            return;
                        } this.temp = this.b / this.a; this.es = 1 - Math.pow(this.temp, 2); this.e3 = Math.sqrt(this.es); this.sin_po = Math.sin(this.lat1);
                        this.cos_po = Math.cos(this.lat1); this.t1 = this.sin_po; this.con = this.sin_po; this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);
                        this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po); this.sin_po = Math.sin(this.lat2); this.cos_po = Math.cos(this.lat2);
                        this.t2 = this.sin_po; this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po); this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);
                        this.sin_po = Math.sin(this.lat0); this.cos_po = Math.cos(this.lat0); this.t3 = this.sin_po; this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);
                        if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
                            this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);
                        } else { this.ns0 = this.con; } this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1; this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; this.sin_phi = Math.sin(lat); this.cos_phi = Math.cos(lat);
                        var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi); var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;
                        var theta = this.ns0 * adjust_lon(lon - this.long0); var x = rh1 * Math.sin(theta) + this.x0; var y = this.rh - rh1 * Math.cos(theta) + this.y0;
                        p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        var rh1, qs, con, theta, lon, lat; p.x -= this.x0; p.y = this.rh - p.y + this.y0;
                        if (this.ns0 >= 0) { rh1 = Math.sqrt(p.x * p.x + p.y * p.y); con = 1; } else { rh1 = -Math.sqrt(p.x * p.x + p.y * p.y); con = -1; } theta = 0;
                        if (rh1 !== 0) { theta = Math.atan2(con * p.x, con * p.y); } con = rh1 * this.ns0 / this.a; if (this.sphere) {
                            lat = Math.asin((this.c - con * con) / (2 * this.ns0));
                        } else { qs = (this.c - con * con) / this.ns0; lat = this.phi1z(this.e3, qs); } lon = adjust_lon(theta / this.ns0 + this.long0);
                        p.x = lon; p.y = lat; return p;
                    }; exports.phi1z = function (eccent, qs) {
                        var sinphi, cosphi, con, com, dphi; var phi = asinz(0.5 * qs);
                        if (eccent < EPSLN) { return phi; } var eccnts = eccent * eccent; for (var i = 1; i <= 25; i++) {
                            sinphi = Math.sin(phi); cosphi = Math.cos(phi);
                            con = eccent * sinphi; com = 1 - con * con; dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
                            phi = phi + dphi; if (Math.abs(dphi) <= 1e-7) { return phi; }
                        } return null;
                    }; exports.names = ["Albers_Conic_Equal_Area", "Albers", "aea"];
                }, { "../common/adjust_lon": 5, "../common/asinz": 6, "../common/msfnz": 15, "../common/qsfnz": 20 }], 40: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var HALF_PI = Math.PI / 2; var EPSLN = 1e-10; var mlfn = _dereq_("../common/mlfn"); var e0fn = _dereq_("../common/e0fn");
                    var e1fn = _dereq_("../common/e1fn"); var e2fn = _dereq_("../common/e2fn"); var e3fn = _dereq_("../common/e3fn");
                    var gN = _dereq_("../common/gN"); var asinz = _dereq_("../common/asinz"); var imlfn = _dereq_("../common/imlfn");
                    exports.init = function () { this.sin_p12 = Math.sin(this.lat0); this.cos_p12 = Math.cos(this.lat0); }; exports.forward = function (p) {
                        var lon = p.x;
                        var lat = p.y; var sinphi = Math.sin(p.y); var cosphi = Math.cos(p.y); var dlon = adjust_lon(lon - this.long0); var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;
                        if (this.sphere) {
                            if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                                p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon); p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);
                                return p;
                            } else {
                                if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                                    p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon); p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);
                                    return p;
                                } else {
                                    cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon); c = Math.acos(cos_c); kp = c / Math.sin(c);
                                    p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon); p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));
                                    return p;
                                }
                            }
                        } else {
                            e0 = e0fn(this.es); e1 = e1fn(this.es); e2 = e2fn(this.es); e3 = e3fn(this.es); if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                                Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
                                Ml = this.a * mlfn(e0, e1, e2, e3, lat); p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon); p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);
                                return p;
                            } else {
                                if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                                    Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI); Ml = this.a * mlfn(e0, e1, e2, e3, lat);
                                    p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon); p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon); return p;
                                } else {
                                    tanphi = sinphi / cosphi;
                                    Nl1 = gN(this.a, this.e, this.sin_p12); Nl = gN(this.a, this.e, sinphi); psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));
                                    Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon)); if (Az === 0) {
                                        s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
                                    } else {
                                        if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {
                                            s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
                                        } else { s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az)); }
                                    } G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);
                                    H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es); GH = G * H; Hs = H * H; s2 = s * s; s3 = s2 * s; s4 = s3 * s; s5 = s4 * s;
                                    c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH); p.x = this.x0 + c * Math.sin(Az);
                                    p.y = this.y0 + c * Math.cos(Az); return p;
                                }
                            }
                        }
                    }; exports.inverse = function (p) {
                        p.x -= this.x0; p.y -= this.y0; var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F;
                        if (this.sphere) {
                            rh = Math.sqrt(p.x * p.x + p.y * p.y); if (rh > (2 * HALF_PI * this.a)) { return; } z = rh / this.a; sinz = Math.sin(z);
                            cosz = Math.cos(z); lon = this.long0; if (Math.abs(rh) <= EPSLN) { lat = this.lat0; } else {
                                lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);
                                con = Math.abs(this.lat0) - HALF_PI; if (Math.abs(con) <= EPSLN) {
                                    if (this.lat0 >= 0) {
                                        lon = adjust_lon(this.long0 + Math.atan2(p.x, -p.y));
                                    } else { lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y)); }
                                } else {
                                    lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));
                                }
                            } p.x = lon; p.y = lat; return p;
                        } else {
                            e0 = e0fn(this.es); e1 = e1fn(this.es); e2 = e2fn(this.es); e3 = e3fn(this.es);
                            if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                                Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI); rh = Math.sqrt(p.x * p.x + p.y * p.y);
                                M = Mlp - rh; lat = imlfn(M / this.a, e0, e1, e2, e3); lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y)); p.x = lon; p.y = lat;
                                return p;
                            } else {
                                if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                                    Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI); rh = Math.sqrt(p.x * p.x + p.y * p.y);
                                    M = rh - Mlp; lat = imlfn(M / this.a, e0, e1, e2, e3); lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y)); p.x = lon; p.y = lat;
                                    return p;
                                } else {
                                    rh = Math.sqrt(p.x * p.x + p.y * p.y); Az = Math.atan2(p.x, p.y); N1 = gN(this.a, this.e, this.sin_p12);
                                    cosAz = Math.cos(Az); tmp = this.e * this.cos_p12 * cosAz; A = -tmp * tmp / (1 - this.es); B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);
                                    D = rh / N1; Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24; F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6; psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);
                                    lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi))); lat = Math.atan((1 - this.es * F * this.sin_p12 / Math.sin(psi)) * Math.tan(psi) / (1 - this.es));
                                    p.x = lon; p.y = lat; return p;
                                }
                            }
                        }
                    }; exports.names = ["Azimuthal_Equidistant", "aeqd"];
                }, { "../common/adjust_lon": 5, "../common/asinz": 6, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/imlfn": 12, "../common/mlfn": 14 }], 41: [function (_dereq_, module, exports) {
                    var mlfn = _dereq_("../common/mlfn");
                    var e0fn = _dereq_("../common/e0fn"); var e1fn = _dereq_("../common/e1fn"); var e2fn = _dereq_("../common/e2fn");
                    var e3fn = _dereq_("../common/e3fn"); var gN = _dereq_("../common/gN"); var adjust_lon = _dereq_("../common/adjust_lon");
                    var adjust_lat = _dereq_("../common/adjust_lat"); var imlfn = _dereq_("../common/imlfn"); var HALF_PI = Math.PI / 2;
                    var EPSLN = 1e-10; exports.init = function () {
                        if (!this.sphere) {
                            this.e0 = e0fn(this.es); this.e1 = e1fn(this.es);
                            this.e2 = e2fn(this.es); this.e3 = e3fn(this.es); this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                        }
                    }; exports.forward = function (p) {
                        var x, y; var lam = p.x; var phi = p.y; lam = adjust_lon(lam - this.long0); if (this.sphere) {
                            x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));
                            y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);
                        } else {
                            var sinphi = Math.sin(phi); var cosphi = Math.cos(phi);
                            var nl = gN(this.a, this.e, sinphi); var tl = Math.tan(phi) * Math.tan(phi); var al = lam * Math.cos(phi); var asq = al * al;
                            var cl = this.es * cosphi * cosphi / (1 - this.es); var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi); x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));
                            y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);
                        } p.x = x + this.x0; p.y = y + this.y0; return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0;
                        p.y -= this.y0; var x = p.x / this.a; var y = p.y / this.a; var phi, lam; if (this.sphere) {
                            var dd = y + this.lat0; phi = Math.asin(Math.sin(dd) * Math.cos(x));
                            lam = Math.atan2(Math.tan(x), Math.cos(dd));
                        } else {
                            var ml1 = this.ml0 / this.a + y; var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);
                            if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) { p.x = this.long0; p.y = HALF_PI; if (y < 0) { p.y *= -1; } return p; } var nl1 = gN(this.a, this.e, Math.sin(phi1));
                            var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es); var tl1 = Math.pow(Math.tan(phi1), 2); var dl = x * this.a / nl1;
                            var dsq = dl * dl; phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24); lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);
                        } p.x = adjust_lon(lam + this.long0); p.y = adjust_lat(phi); return p;
                    }; exports.names = ["Cassini", "Cassini_Soldner", "cass"];
                }, { "../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/imlfn": 12, "../common/mlfn": 14 }], 42: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var qsfnz = _dereq_("../common/qsfnz"); var msfnz = _dereq_("../common/msfnz"); var iqsfnz = _dereq_("../common/iqsfnz");
                    exports.init = function () {
                        if (!this.sphere) {
                            this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
                        }
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var x, y; var dlon = adjust_lon(lon - this.long0); if (this.sphere) {
                            x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);
                            y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);
                        } else {
                            var qs = qsfnz(this.e, Math.sin(lat)); x = this.x0 + this.a * this.k0 * dlon;
                            y = this.y0 + this.a * qs * 0.5 / this.k0;
                        } p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0; p.y -= this.y0;
                        var lon, lat; if (this.sphere) {
                            lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts)); lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));
                        } else { lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a); lon = adjust_lon(this.long0 + p.x / (this.a * this.k0)); } p.x = lon;
                        p.y = lat; return p;
                    }; exports.names = ["cea"];
                }, { "../common/adjust_lon": 5, "../common/iqsfnz": 13, "../common/msfnz": 15, "../common/qsfnz": 20 }], 43: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var adjust_lat = _dereq_("../common/adjust_lat"); exports.init = function () {
                        this.x0 = this.x0 || 0; this.y0 = this.y0 || 0;
                        this.lat0 = this.lat0 || 0; this.long0 = this.long0 || 0; this.lat_ts = this.lat_ts || 0; this.title = this.title || "Equidistant Cylindrical (Plate Carre)";
                        this.rc = Math.cos(this.lat_ts);
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var dlon = adjust_lon(lon - this.long0);
                        var dlat = adjust_lat(lat - this.lat0); p.x = this.x0 + (this.a * dlon * this.rc); p.y = this.y0 + (this.a * dlat); return p;
                    }; exports.inverse = function (p) {
                        var x = p.x; var y = p.y; p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));
                        p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a))); return p;
                    }; exports.names = ["Equirectangular", "Equidistant_Cylindrical", "eqc"];
                }, { "../common/adjust_lat": 4, "../common/adjust_lon": 5 }], 44: [function (_dereq_, module, exports) {
                    var e0fn = _dereq_("../common/e0fn");
                    var e1fn = _dereq_("../common/e1fn"); var e2fn = _dereq_("../common/e2fn"); var e3fn = _dereq_("../common/e3fn");
                    var msfnz = _dereq_("../common/msfnz"); var mlfn = _dereq_("../common/mlfn"); var adjust_lon = _dereq_("../common/adjust_lon");
                    var adjust_lat = _dereq_("../common/adjust_lat"); var imlfn = _dereq_("../common/imlfn"); var EPSLN = 1e-10; exports.init = function () {
                        if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                            return;
                        } this.lat2 = this.lat2 || this.lat1; this.temp = this.b / this.a; this.es = 1 - Math.pow(this.temp, 2); this.e = Math.sqrt(this.es);
                        this.e0 = e0fn(this.es); this.e1 = e1fn(this.es); this.e2 = e2fn(this.es); this.e3 = e3fn(this.es); this.sinphi = Math.sin(this.lat1);
                        this.cosphi = Math.cos(this.lat1); this.ms1 = msfnz(this.e, this.sinphi, this.cosphi); this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);
                        if (Math.abs(this.lat1 - this.lat2) < EPSLN) { this.ns = this.sinphi; } else {
                            this.sinphi = Math.sin(this.lat2); this.cosphi = Math.cos(this.lat2);
                            this.ms2 = msfnz(this.e, this.sinphi, this.cosphi); this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);
                            this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);
                        } this.g = this.ml1 + this.ms1 / this.ns; this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                        this.rh = this.a * (this.g - this.ml0);
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var rh1; if (this.sphere) {
                            rh1 = this.a * (this.g - lat);
                        } else { var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat); rh1 = this.a * (this.g - ml); } var theta = this.ns * adjust_lon(lon - this.long0);
                        var x = this.x0 + rh1 * Math.sin(theta); var y = this.y0 + this.rh - rh1 * Math.cos(theta); p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0;
                        p.y = this.rh - p.y + this.y0; var con, rh1, lat, lon; if (this.ns >= 0) { rh1 = Math.sqrt(p.x * p.x + p.y * p.y); con = 1; } else {
                            rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);
                            con = -1;
                        } var theta = 0; if (rh1 !== 0) { theta = Math.atan2(con * p.x, con * p.y); } if (this.sphere) {
                            lon = adjust_lon(this.long0 + theta / this.ns);
                            lat = adjust_lat(this.g - rh1 / this.a); p.x = lon; p.y = lat; return p;
                        } else {
                            var ml = this.g - rh1 / this.a; lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);
                            lon = adjust_lon(this.long0 + theta / this.ns); p.x = lon; p.y = lat; return p;
                        }
                    }; exports.names = ["Equidistant_Conic", "eqdc"];
                }, { "../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/imlfn": 12, "../common/mlfn": 14, "../common/msfnz": 15 }], 45: [function (_dereq_, module, exports) {
                    var FORTPI = Math.PI / 4;
                    var srat = _dereq_("../common/srat"); var HALF_PI = Math.PI / 2; var MAX_ITER = 20; exports.init = function () {
                        var sphi = Math.sin(this.lat0);
                        var cphi = Math.cos(this.lat0); cphi *= cphi; this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi); this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));
                        this.phic0 = Math.asin(sphi / this.C); this.ratexp = 0.5 * this.C * this.e; this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;
                        p.x = this.C * lon; return p;
                    }; exports.inverse = function (p) {
                        var DEL_TOL = 1e-14; var lon = p.x / this.C; var lat = p.y;
                        var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C); for (var i = MAX_ITER; i > 0; --i) {
                            lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), -0.5 * this.e)) - HALF_PI;
                            if (Math.abs(lat - p.y) < DEL_TOL) { break; } p.y = lat;
                        } if (!i) { return null; } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["gauss"];
                }, { "../common/srat": 22 }], 46: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var EPSLN = 1e-10; var asinz = _dereq_("../common/asinz"); exports.init = function () {
                        this.sin_p14 = Math.sin(this.lat0);
                        this.cos_p14 = Math.cos(this.lat0); this.infinity_dist = 1000 * this.a; this.rc = 1;
                    }; exports.forward = function (p) {
                        var sinphi, cosphi;
                        var dlon; var coslon; var ksp; var g; var x, y; var lon = p.x; var lat = p.y; dlon = adjust_lon(lon - this.long0); sinphi = Math.sin(lat);
                        cosphi = Math.cos(lat); coslon = Math.cos(dlon); g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon; ksp = 1; if ((g > 0) || (Math.abs(g) <= EPSLN)) {
                            x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;
                            y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;
                        } else {
                            x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);
                            y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
                        } p.x = x; p.y = y; return p;
                    };
                    exports.inverse = function (p) {
                        var rh; var sinc, cosc; var c; var lon, lat; p.x = (p.x - this.x0) / this.a; p.y = (p.y - this.y0) / this.a;
                        p.x /= this.k0; p.y /= this.k0; if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {
                            c = Math.atan2(rh, this.rc); sinc = Math.sin(c);
                            cosc = Math.cos(c); lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh); lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);
                            lon = adjust_lon(this.long0 + lon);
                        } else { lat = this.phic0; lon = 0; } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["gnom"];
                }, { "../common/adjust_lon": 5, "../common/asinz": 6 }], 47: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    exports.init = function () {
                        this.a = 6377397.155; this.es = 0.006674372230614; this.e = Math.sqrt(this.es); if (!this.lat0) {
                            this.lat0 = 0.863937979737193;
                        } if (!this.long0) { this.long0 = 0.7417649320975901 - 0.308341501185665; } if (!this.k0) { this.k0 = 0.9999; } this.s45 = 0.785398163397448;
                        this.s90 = 2 * this.s45; this.fi0 = this.lat0; this.e2 = this.es; this.e = Math.sqrt(this.e2); this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));
                        this.uq = 1.04216856380474; this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa); this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);
                        this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g; this.k1 = this.k0;
                        this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2)); this.s0 = 1.37008346281555;
                        this.n = Math.sin(this.s0); this.ro0 = this.k1 * this.n0 / Math.tan(this.s0); this.ad = this.s90 - this.uq;
                    }; exports.forward = function (p) {
                        var gfi, u, deltav, s, d, eps, ro;
                        var lon = p.x; var lat = p.y; var delta_lon = adjust_lon(lon - this.long0); gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));
                        u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45); deltav = -delta_lon * this.alfa;
                        s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav)); d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));
                        eps = this.n * d; ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);
                        p.y = ro * Math.cos(eps) / 1; p.x = ro * Math.sin(eps) / 1; if (!this.czech) { p.y *= -1; p.x *= -1; } return (p);
                    }; exports.inverse = function (p) {
                        var u, deltav, s, d, eps, ro, fi1;
                        var ok; var tmp = p.x; p.x = p.y; p.y = tmp; if (!this.czech) { p.y *= -1; p.x *= -1; } ro = Math.sqrt(p.x * p.x + p.y * p.y); eps = Math.atan2(p.y, p.x);
                        d = eps / Math.sin(this.s0); s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);
                        u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d)); deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));
                        p.x = this.long0 - deltav / this.alfa; fi1 = u; ok = 0; var iter = 0; do {
                            p.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);
                            if (Math.abs(fi1 - p.y) < 1e-10) { ok = 1; } fi1 = p.y; iter += 1;
                        } while (ok === 0 && iter < 15); if (iter >= 15) { return null; } return (p);
                    }; exports.names = ["Krovak", "krovak"];
                }, { "../common/adjust_lon": 5 }], 48: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2;
                    var FORTPI = Math.PI / 4; var EPSLN = 1e-10; var qsfnz = _dereq_("../common/qsfnz"); var adjust_lon = _dereq_("../common/adjust_lon");
                    exports.S_POLE = 1; exports.N_POLE = 2; exports.EQUIT = 3; exports.OBLIQ = 4; exports.init = function () {
                        var t = Math.abs(this.lat0);
                        if (Math.abs(t - HALF_PI) < EPSLN) { this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE; } else {
                            if (Math.abs(t) < EPSLN) {
                                this.mode = this.EQUIT;
                            } else { this.mode = this.OBLIQ; }
                        } if (this.es > 0) {
                            var sinphi; this.qp = qsfnz(this.e, 1); this.mmf = 0.5 / (1 - this.es);
                            this.apa = this.authset(this.es); switch (this.mode) {
                                case this.N_POLE: this.dd = 1; break; case this.S_POLE: this.dd = 1;
                                    break; case this.EQUIT: this.rq = Math.sqrt(0.5 * this.qp); this.dd = 1 / this.rq; this.xmf = 1; this.ymf = 0.5 * this.qp;
                                        break; case this.OBLIQ: this.rq = Math.sqrt(0.5 * this.qp); sinphi = Math.sin(this.lat0); this.sinb1 = qsfnz(this.e, sinphi) / this.qp;
                                            this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1); this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);
                                            this.ymf = (this.xmf = this.rq) / this.dd; this.xmf *= this.dd; break;
                            }
                        } else {
                            if (this.mode === this.OBLIQ) {
                                this.sinph0 = Math.sin(this.lat0);
                                this.cosph0 = Math.cos(this.lat0);
                            }
                        }
                    }; exports.forward = function (p) {
                        var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;
                        var lam = p.x; var phi = p.y; lam = adjust_lon(lam - this.long0); if (this.sphere) {
                            sinphi = Math.sin(phi); cosphi = Math.cos(phi);
                            coslam = Math.cos(lam); if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                                y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
                                if (y <= EPSLN) { return null; } y = Math.sqrt(2 / y); x = y * cosphi * Math.sin(lam); y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
                            } else {
                                if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                                    if (this.mode === this.N_POLE) {
                                        coslam = -coslam;
                                    } if (Math.abs(phi + this.phi0) < EPSLN) { return null; } y = FORTPI - phi * 0.5; y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));
                                    x = y * Math.sin(lam); y *= coslam;
                                }
                            }
                        } else {
                            sinb = 0; cosb = 0; b = 0; coslam = Math.cos(lam); sinlam = Math.sin(lam); sinphi = Math.sin(phi);
                            q = qsfnz(this.e, sinphi); if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                                sinb = q / this.qp; cosb = Math.sqrt(1 - sinb * sinb);
                            } switch (this.mode) {
                                case this.OBLIQ: b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam; break; case this.EQUIT: b = 1 + cosb * coslam;
                                    break; case this.N_POLE: b = HALF_PI + phi; q = this.qp - q; break; case this.S_POLE: b = phi - HALF_PI; q = this.qp + q; break;
                            } if (Math.abs(b) < EPSLN) { return null; } switch (this.mode) {
                                case this.OBLIQ: case this.EQUIT: b = Math.sqrt(2 / b);
                                    if (this.mode === this.OBLIQ) { y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam); } else {
                                        y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;
                                    } x = this.xmf * b * cosb * sinlam; break; case this.N_POLE: case this.S_POLE: if (q >= 0) {
                                        x = (b = Math.sqrt(q)) * sinlam;
                                        y = coslam * ((this.mode === this.S_POLE) ? b : -b);
                                    } else { x = y = 0; } break;
                            }
                        } p.x = this.a * x + this.x0; p.y = this.a * y + this.y0;
                        return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0; p.y -= this.y0; var x = p.x / this.a; var y = p.y / this.a; var lam, phi, cCe, sCe, q, rho, ab;
                        if (this.sphere) {
                            var cosz = 0, rh, sinz = 0; rh = Math.sqrt(x * x + y * y); phi = rh * 0.5; if (phi > 1) { return null; } phi = 2 * Math.asin(phi);
                            if (this.mode === this.OBLIQ || this.mode === this.EQUIT) { sinz = Math.sin(phi); cosz = Math.cos(phi); } switch (this.mode) {
                                case this.EQUIT: phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);
                                    x *= sinz; y = cosz * rh; break; case this.OBLIQ: phi = (Math.abs(rh) <= EPSLN) ? this.phi0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);
                                        x *= sinz * this.cosph0; y = (cosz - Math.sin(phi) * this.sinph0) * rh; break; case this.N_POLE: y = -y; phi = HALF_PI - phi;
                                            break; case this.S_POLE: phi -= HALF_PI; break;
                            } lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);
                        } else {
                            ab = 0; if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                                x /= this.dd; y *= this.dd; rho = Math.sqrt(x * x + y * y);
                                if (rho < EPSLN) { p.x = 0; p.y = this.phi0; return p; } sCe = 2 * Math.asin(0.5 * rho / this.rq); cCe = Math.cos(sCe); x *= (sCe = Math.sin(sCe));
                                if (this.mode === this.OBLIQ) {
                                    ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho; q = this.qp * ab; y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;
                                } else { ab = y * sCe / rho; q = this.qp * ab; y = rho * cCe; }
                            } else {
                                if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                                    if (this.mode === this.N_POLE) {
                                        y = -y;
                                    } q = (x * x + y * y); if (!q) { p.x = 0; p.y = this.phi0; return p; } ab = 1 - q / this.qp; if (this.mode === this.S_POLE) { ab = -ab; }
                                }
                            } lam = Math.atan2(x, y);
                            phi = this.authlat(Math.asin(ab), this.apa);
                        } p.x = adjust_lon(this.long0 + lam); p.y = phi; return p;
                    }; exports.P00 = 0.3333333333333333;
                    exports.P01 = 0.17222222222222222; exports.P02 = 0.10257936507936508; exports.P10 = 0.06388888888888888; exports.P11 = 0.0664021164021164;
                    exports.P20 = 0.016415012942191543; exports.authset = function (es) {
                        var t; var APA = []; APA[0] = es * this.P00; t = es * es;
                        APA[0] += t * this.P01; APA[1] = t * this.P10; t *= es; APA[0] += t * this.P02; APA[1] += t * this.P11; APA[2] = t * this.P20; return APA;
                    }; exports.authlat = function (beta, APA) {
                        var t = beta + beta; return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));
                    }; exports.names = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"];
                }, { "../common/adjust_lon": 5, "../common/qsfnz": 20 }], 49: [function (_dereq_, module, exports) {
                    var EPSLN = 1e-10;
                    var msfnz = _dereq_("../common/msfnz"); var tsfnz = _dereq_("../common/tsfnz"); var HALF_PI = Math.PI / 2; var sign = _dereq_("../common/sign");
                    var adjust_lon = _dereq_("../common/adjust_lon"); var phi2z = _dereq_("../common/phi2z"); exports.init = function () {
                        if (!this.lat2) {
                            this.lat2 = this.lat1;
                        } if (!this.k0) { this.k0 = 1; } this.x0 = this.x0 || 0; this.y0 = this.y0 || 0; if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                            return;
                        } var temp = this.b / this.a; this.e = Math.sqrt(1 - temp * temp); var sin1 = Math.sin(this.lat1); var cos1 = Math.cos(this.lat1);
                        var ms1 = msfnz(this.e, sin1, cos1); var ts1 = tsfnz(this.e, this.lat1, sin1); var sin2 = Math.sin(this.lat2); var cos2 = Math.cos(this.lat2);
                        var ms2 = msfnz(this.e, sin2, cos2); var ts2 = tsfnz(this.e, this.lat2, sin2); var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));
                        if (Math.abs(this.lat1 - this.lat2) > EPSLN) { this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2); } else {
                            this.ns = sin1;
                        } if (isNaN(this.ns)) { this.ns = sin1; } this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns)); this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);
                        if (!this.title) { this.title = "Lambert Conformal Conic"; }
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y;
                        if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) { lat = sign(lat) * (HALF_PI - 2 * EPSLN); } var con = Math.abs(Math.abs(lat) - HALF_PI);
                        var ts, rh1; if (con > EPSLN) { ts = tsfnz(this.e, lat, Math.sin(lat)); rh1 = this.a * this.f0 * Math.pow(ts, this.ns); } else {
                            con = lat * this.ns;
                            if (con <= 0) { return null; } rh1 = 0;
                        } var theta = this.ns * adjust_lon(lon - this.long0); p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;
                        p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0; return p;
                    }; exports.inverse = function (p) {
                        var rh1, con, ts;
                        var lat, lon; var x = (p.x - this.x0) / this.k0; var y = (this.rh - (p.y - this.y0) / this.k0); if (this.ns > 0) {
                            rh1 = Math.sqrt(x * x + y * y);
                            con = 1;
                        } else { rh1 = -Math.sqrt(x * x + y * y); con = -1; } var theta = 0; if (rh1 !== 0) {
                            theta = Math.atan2((con * x), (con * y));
                        } if ((rh1 !== 0) || (this.ns > 0)) {
                            con = 1 / this.ns; ts = Math.pow((rh1 / (this.a * this.f0)), con); lat = phi2z(this.e, ts);
                            if (lat === -9999) { return null; }
                        } else { lat = -HALF_PI; } lon = adjust_lon(theta / this.ns + this.long0); p.x = lon; p.y = lat;
                        return p;
                    }; exports.names = ["Lambert Tangential Conformal Conic Projection", "Lambert_Conformal_Conic", "Lambert_Conformal_Conic_2SP", "lcc"];
                }, { "../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/sign": 21, "../common/tsfnz": 24 }], 50: [function (_dereq_, module, exports) {
                    exports.init = function () { };
                    function identity(pt) { return pt; } exports.forward = identity; exports.inverse = identity; exports.names = ["longlat", "identity"];
                }, {}], 51: [function (_dereq_, module, exports) {
                    var msfnz = _dereq_("../common/msfnz"); var HALF_PI = Math.PI / 2;
                    var EPSLN = 1e-10; var R2D = 57.29577951308232; var adjust_lon = _dereq_("../common/adjust_lon"); var FORTPI = Math.PI / 4;
                    var tsfnz = _dereq_("../common/tsfnz"); var phi2z = _dereq_("../common/phi2z"); exports.init = function () {
                        var con = this.b / this.a;
                        this.es = 1 - con * con; if (!("x0" in this)) { this.x0 = 0; } if (!("y0" in this)) { this.y0 = 0; } this.e = Math.sqrt(this.es);
                        if (this.lat_ts) {
                            if (this.sphere) { this.k0 = Math.cos(this.lat_ts); } else {
                                this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
                            }
                        } else { if (!this.k0) { if (this.k) { this.k0 = this.k; } else { this.k0 = 1; } } }
                    }; exports.forward = function (p) {
                        var lon = p.x;
                        var lat = p.y; if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) { return null; } var x, y; if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
                            return null;
                        } else {
                            if (this.sphere) {
                                x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0); y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));
                            } else {
                                var sinphi = Math.sin(lat); var ts = tsfnz(this.e, lat, sinphi); x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
                                y = this.y0 - this.a * this.k0 * Math.log(ts);
                            } p.x = x; p.y = y; return p;
                        }
                    }; exports.inverse = function (p) {
                        var x = p.x - this.x0;
                        var y = p.y - this.y0; var lon, lat; if (this.sphere) {
                            lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));
                        } else { var ts = Math.exp(-y / (this.a * this.k0)); lat = phi2z(this.e, ts); if (lat === -9999) { return null; } } lon = adjust_lon(this.long0 + x / (this.a * this.k0));
                        p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"];
                }, { "../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/tsfnz": 24 }], 52: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    exports.init = function () { }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var dlon = adjust_lon(lon - this.long0);
                        var x = this.x0 + this.a * dlon; var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25; p.x = x; p.y = y;
                        return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0; p.y -= this.y0; var lon = adjust_lon(this.long0 + p.x / this.a);
                        var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4); p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Miller_Cylindrical", "mill"];
                }, { "../common/adjust_lon": 5 }], 53: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var EPSLN = 1e-10; exports.init = function () { }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var delta_lon = adjust_lon(lon - this.long0);
                        var theta = lat; var con = Math.PI * Math.sin(lat); for (var i = 0; true; i++) {
                            var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));
                            theta += delta_theta; if (Math.abs(delta_theta) < EPSLN) { break; }
                        } theta /= 2; if (Math.PI / 2 - Math.abs(lat) < EPSLN) {
                            delta_lon = 0;
                        } var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0; var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;
                        p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        var theta; var arg; p.x -= this.x0; p.y -= this.y0; arg = p.y / (1.4142135623731 * this.a);
                        if (Math.abs(arg) > 0.999999999999) { arg = 0.999999999999; } theta = Math.asin(arg); var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));
                        if (lon < (-Math.PI)) { lon = -Math.PI; } if (lon > Math.PI) { lon = Math.PI; } arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;
                        if (Math.abs(arg) > 1) { arg = 1; } var lat = Math.asin(arg); p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Mollweide", "moll"];
                }, { "../common/adjust_lon": 5 }], 54: [function (_dereq_, module, exports) {
                    var SEC_TO_RAD = 0.00000484813681109536;
                    exports.iterations = 1; exports.init = function () {
                        this.A = []; this.A[1] = 0.6399175073; this.A[2] = -0.1358797613;
                        this.A[3] = 0.063294409; this.A[4] = -0.02526853; this.A[5] = 0.0117879; this.A[6] = -0.0055161; this.A[7] = 0.0026906;
                        this.A[8] = -0.001333; this.A[9] = 0.00067; this.A[10] = -0.00034; this.B_re = []; this.B_im = []; this.B_re[1] = 0.7557853228;
                        this.B_im[1] = 0; this.B_re[2] = 0.249204646; this.B_im[2] = 0.003371507; this.B_re[3] = -0.001541739; this.B_im[3] = 0.04105856;
                        this.B_re[4] = -0.10162907; this.B_im[4] = 0.01727609; this.B_re[5] = -0.26623489; this.B_im[5] = -0.36249218; this.B_re[6] = -0.6870983;
                        this.B_im[6] = -1.1651967; this.C_re = []; this.C_im = []; this.C_re[1] = 1.3231270439; this.C_im[1] = 0; this.C_re[2] = -0.577245789;
                        this.C_im[2] = -0.007809598; this.C_re[3] = 0.508307513; this.C_im[3] = -0.112208952; this.C_re[4] = -0.15094762;
                        this.C_im[4] = 0.18200602; this.C_re[5] = 1.01418179; this.C_im[5] = 1.64497696; this.C_re[6] = 1.9660549; this.C_im[6] = 2.5127645;
                        this.D = []; this.D[1] = 1.5627014243; this.D[2] = 0.5185406398; this.D[3] = -0.03333098; this.D[4] = -0.1052906; this.D[5] = -0.0368594;
                        this.D[6] = 0.007317; this.D[7] = 0.0122; this.D[8] = 0.00394; this.D[9] = -0.0013;
                    }; exports.forward = function (p) {
                        var n;
                        var lon = p.x; var lat = p.y; var delta_lat = lat - this.lat0; var delta_lon = lon - this.long0; var d_phi = delta_lat / SEC_TO_RAD * 0.00001;
                        var d_lambda = delta_lon; var d_phi_n = 1; var d_psi = 0; for (n = 1; n <= 10; n++) {
                            d_phi_n = d_phi_n * d_phi; d_psi = d_psi + this.A[n] * d_phi_n;
                        } var th_re = d_psi; var th_im = d_lambda; var th_n_re = 1; var th_n_im = 0; var th_n_re1; var th_n_im1; var z_re = 0;
                        var z_im = 0; for (n = 1; n <= 6; n++) {
                            th_n_re1 = th_n_re * th_re - th_n_im * th_im; th_n_im1 = th_n_im * th_re + th_n_re * th_im;
                            th_n_re = th_n_re1; th_n_im = th_n_im1; z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im; z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;
                        } p.x = (z_im * this.a) + this.x0; p.y = (z_re * this.a) + this.y0; return p;
                    }; exports.inverse = function (p) {
                        var n; var x = p.x;
                        var y = p.y; var delta_x = x - this.x0; var delta_y = y - this.y0; var z_re = delta_y / this.a; var z_im = delta_x / this.a;
                        var z_n_re = 1; var z_n_im = 0; var z_n_re1; var z_n_im1; var th_re = 0; var th_im = 0; for (n = 1; n <= 6; n++) {
                            z_n_re1 = z_n_re * z_re - z_n_im * z_im;
                            z_n_im1 = z_n_im * z_re + z_n_re * z_im; z_n_re = z_n_re1; z_n_im = z_n_im1; th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;
                            th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;
                        } for (var i = 0; i < this.iterations; i++) {
                            var th_n_re = th_re;
                            var th_n_im = th_im; var th_n_re1; var th_n_im1; var num_re = z_re; var num_im = z_im; for (n = 2; n <= 6; n++) {
                                th_n_re1 = th_n_re * th_re - th_n_im * th_im;
                                th_n_im1 = th_n_im * th_re + th_n_re * th_im; th_n_re = th_n_re1; th_n_im = th_n_im1; num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
                                num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
                            } th_n_re = 1; th_n_im = 0; var den_re = this.B_re[1];
                            var den_im = this.B_im[1]; for (n = 2; n <= 6; n++) {
                                th_n_re1 = th_n_re * th_re - th_n_im * th_im; th_n_im1 = th_n_im * th_re + th_n_re * th_im;
                                th_n_re = th_n_re1; th_n_im = th_n_im1; den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im); den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
                            } var den2 = den_re * den_re + den_im * den_im; th_re = (num_re * den_re + num_im * den_im) / den2; th_im = (num_im * den_re - num_re * den_im) / den2;
                        } var d_psi = th_re; var d_lambda = th_im; var d_psi_n = 1; var d_phi = 0; for (n = 1; n <= 9; n++) {
                            d_psi_n = d_psi_n * d_psi;
                            d_phi = d_phi + this.D[n] * d_psi_n;
                        } var lat = this.lat0 + (d_phi * SEC_TO_RAD * 100000); var lon = this.long0 + d_lambda;
                        p.x = lon; p.y = lat; return p;
                    }; exports.names = ["New_Zealand_Map_Grid", "nzmg"];
                }, {}], 55: [function (_dereq_, module, exports) {
                    var tsfnz = _dereq_("../common/tsfnz");
                    var adjust_lon = _dereq_("../common/adjust_lon"); var phi2z = _dereq_("../common/phi2z"); var HALF_PI = Math.PI / 2;
                    var FORTPI = Math.PI / 4; var EPSLN = 1e-10; exports.init = function () {
                        this.no_off = this.no_off || false; this.no_rot = this.no_rot || false;
                        if (isNaN(this.k0)) { this.k0 = 1; } var sinlat = Math.sin(this.lat0); var coslat = Math.cos(this.lat0); var con = this.e * sinlat;
                        this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(coslat, 4)); this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - con * con);
                        var t0 = tsfnz(this.e, this.lat0, sinlat); var dl = this.bl / coslat * Math.sqrt((1 - this.es) / (1 - con * con)); if (dl * dl < 1) {
                            dl = 1;
                        } var fl; var gl; if (!isNaN(this.longc)) {
                            if (this.lat0 >= 0) { fl = dl + Math.sqrt(dl * dl - 1); } else {
                                fl = dl - Math.sqrt(dl * dl - 1);
                            } this.el = fl * Math.pow(t0, this.bl); gl = 0.5 * (fl - 1 / fl); this.gamma0 = Math.asin(Math.sin(this.alpha) / dl); this.long0 = this.longc - Math.asin(gl * Math.tan(this.gamma0)) / this.bl;
                        } else {
                            var t1 = tsfnz(this.e, this.lat1, Math.sin(this.lat1)); var t2 = tsfnz(this.e, this.lat2, Math.sin(this.lat2));
                            if (this.lat0 >= 0) { this.el = (dl + Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl); } else {
                                this.el = (dl - Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);
                            } var hl = Math.pow(t1, this.bl); var ll = Math.pow(t2, this.bl); fl = this.el / hl; gl = 0.5 * (fl - 1 / fl); var jl = (this.el * this.el - ll * hl) / (this.el * this.el + ll * hl);
                            var pl = (ll - hl) / (ll + hl); var dlon12 = adjust_lon(this.long1 - this.long2); this.long0 = 0.5 * (this.long1 + this.long2) - Math.atan(jl * Math.tan(0.5 * this.bl * (dlon12)) / pl) / this.bl;
                            this.long0 = adjust_lon(this.long0); var dlon10 = adjust_lon(this.long1 - this.long0); this.gamma0 = Math.atan(Math.sin(this.bl * (dlon10)) / gl);
                            this.alpha = Math.asin(dl * Math.sin(this.gamma0));
                        } if (this.no_off) { this.uc = 0; } else {
                            if (this.lat0 >= 0) {
                                this.uc = this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));
                            } else { this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha)); }
                        }
                    }; exports.forward = function (p) {
                        var lon = p.x;
                        var lat = p.y; var dlon = adjust_lon(lon - this.long0); var us, vs; var con; if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
                            if (lat > 0) {
                                con = -1;
                            } else { con = 1; } vs = this.al / this.bl * Math.log(Math.tan(FORTPI + con * this.gamma0 * 0.5)); us = -1 * con * HALF_PI * this.al / this.bl;
                        } else {
                            var t = tsfnz(this.e, lat, Math.sin(lat)); var ql = this.el / Math.pow(t, this.bl); var sl = 0.5 * (ql - 1 / ql); var tl = 0.5 * (ql + 1 / ql);
                            var vl = Math.sin(this.bl * (dlon)); var ul = (sl * Math.sin(this.gamma0) - vl * Math.cos(this.gamma0)) / tl; if (Math.abs(Math.abs(ul) - 1) <= EPSLN) {
                                vs = Number.POSITIVE_INFINITY;
                            } else { vs = 0.5 * this.al * Math.log((1 - ul) / (1 + ul)) / this.bl; } if (Math.abs(Math.cos(this.bl * (dlon))) <= EPSLN) {
                                us = this.al * this.bl * (dlon);
                            } else {
                                us = this.al * Math.atan2(sl * Math.cos(this.gamma0) + vl * Math.sin(this.gamma0), Math.cos(this.bl * dlon)) / this.bl;
                            }
                        } if (this.no_rot) { p.x = this.x0 + us; p.y = this.y0 + vs; } else {
                            us -= this.uc; p.x = this.x0 + vs * Math.cos(this.alpha) + us * Math.sin(this.alpha);
                            p.y = this.y0 + us * Math.cos(this.alpha) - vs * Math.sin(this.alpha);
                        } return p;
                    }; exports.inverse = function (p) {
                        var us, vs;
                        if (this.no_rot) { vs = p.y - this.y0; us = p.x - this.x0; } else {
                            vs = (p.x - this.x0) * Math.cos(this.alpha) - (p.y - this.y0) * Math.sin(this.alpha);
                            us = (p.y - this.y0) * Math.cos(this.alpha) + (p.x - this.x0) * Math.sin(this.alpha); us += this.uc;
                        } var qp = Math.exp(-1 * this.bl * vs / this.al);
                        var sp = 0.5 * (qp - 1 / qp); var tp = 0.5 * (qp + 1 / qp); var vp = Math.sin(this.bl * us / this.al); var up = (vp * Math.cos(this.gamma0) + sp * Math.sin(this.gamma0)) / tp;
                        var ts = Math.pow(this.el / Math.sqrt((1 + up) / (1 - up)), 1 / this.bl); if (Math.abs(up - 1) < EPSLN) {
                            p.x = this.long0; p.y = HALF_PI;
                        } else {
                            if (Math.abs(up + 1) < EPSLN) { p.x = this.long0; p.y = -1 * HALF_PI; } else {
                                p.y = phi2z(this.e, ts); p.x = adjust_lon(this.long0 - Math.atan2(sp * Math.cos(this.gamma0) - vp * Math.sin(this.gamma0), Math.cos(this.bl * us / this.al)) / this.bl);
                            }
                        } return p;
                    }; exports.names = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "omerc"];
                }, { "../common/adjust_lon": 5, "../common/phi2z": 16, "../common/tsfnz": 24 }], 56: [function (_dereq_, module, exports) {
                    var e0fn = _dereq_("../common/e0fn");
                    var e1fn = _dereq_("../common/e1fn"); var e2fn = _dereq_("../common/e2fn"); var e3fn = _dereq_("../common/e3fn");
                    var adjust_lon = _dereq_("../common/adjust_lon"); var adjust_lat = _dereq_("../common/adjust_lat"); var mlfn = _dereq_("../common/mlfn");
                    var EPSLN = 1e-10; var gN = _dereq_("../common/gN"); var MAX_ITER = 20; exports.init = function () {
                        this.temp = this.b / this.a;
                        this.es = 1 - Math.pow(this.temp, 2); this.e = Math.sqrt(this.es); this.e0 = e0fn(this.es); this.e1 = e1fn(this.es);
                        this.e2 = e2fn(this.es); this.e3 = e3fn(this.es); this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var x, y, el; var dlon = adjust_lon(lon - this.long0);
                        el = dlon * Math.sin(lat); if (this.sphere) {
                            if (Math.abs(lat) <= EPSLN) { x = this.a * dlon; y = -1 * this.a * this.lat0; } else {
                                x = this.a * Math.sin(el) / Math.tan(lat);
                                y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));
                            }
                        } else {
                            if (Math.abs(lat) <= EPSLN) {
                                x = this.a * dlon;
                                y = -1 * this.ml0;
                            } else {
                                var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat); x = nl * Math.sin(el); y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));
                            }
                        } p.x = x + this.x0; p.y = y + this.y0; return p;
                    }; exports.inverse = function (p) {
                        var lon, lat, x, y, i; var al, bl; var phi, dphi;
                        x = p.x - this.x0; y = p.y - this.y0; if (this.sphere) {
                            if (Math.abs(y + this.a * this.lat0) <= EPSLN) {
                                lon = adjust_lon(x / this.a + this.long0);
                                lat = 0;
                            } else {
                                al = this.lat0 + y / this.a; bl = x * x / this.a / this.a + al * al; phi = al; var tanphi; for (i = MAX_ITER; i; --i) {
                                    tanphi = Math.tan(phi);
                                    dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1); phi += dphi; if (Math.abs(dphi) <= EPSLN) {
                                        lat = phi;
                                        break;
                                    }
                                } lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));
                            }
                        } else {
                            if (Math.abs(y + this.ml0) <= EPSLN) {
                                lat = 0;
                                lon = adjust_lon(this.long0 + x / this.a);
                            } else {
                                al = (this.ml0 + y) / this.a; bl = x * x / this.a / this.a + al * al; phi = al; var cl, mln, mlnp, ma;
                                var con; for (i = MAX_ITER; i; --i) {
                                    con = this.e * Math.sin(phi); cl = Math.sqrt(1 - con * con) * Math.tan(phi); mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
                                    mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi); ma = mln / this.a;
                                    dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);
                                    phi -= dphi; if (Math.abs(dphi) <= EPSLN) { lat = phi; break; }
                                } cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);
                                lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));
                            }
                        } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Polyconic", "poly"];
                }, { "../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/gN": 11, "../common/mlfn": 14 }], 57: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var adjust_lat = _dereq_("../common/adjust_lat"); var pj_enfn = _dereq_("../common/pj_enfn"); var MAX_ITER = 20;
                    var pj_mlfn = _dereq_("../common/pj_mlfn"); var pj_inv_mlfn = _dereq_("../common/pj_inv_mlfn"); var HALF_PI = Math.PI / 2;
                    var EPSLN = 1e-10; var asinz = _dereq_("../common/asinz"); exports.init = function () {
                        if (!this.sphere) {
                            this.en = pj_enfn(this.es);
                        } else {
                            this.n = 1; this.m = 0; this.es = 0; this.C_y = Math.sqrt((this.m + 1) / this.n); this.C_x = this.C_y / (this.m + 1);
                        }
                    }; exports.forward = function (p) {
                        var x, y; var lon = p.x; var lat = p.y; lon = adjust_lon(lon - this.long0); if (this.sphere) {
                            if (!this.m) {
                                lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;
                            } else {
                                var k = this.n * Math.sin(lat); for (var i = MAX_ITER; i; --i) {
                                    var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));
                                    lat -= V; if (Math.abs(V) < EPSLN) { break; }
                                }
                            } x = this.a * this.C_x * lon * (this.m + Math.cos(lat)); y = this.a * this.C_y * lat;
                        } else {
                            var s = Math.sin(lat); var c = Math.cos(lat); y = this.a * pj_mlfn(lat, s, c, this.en); x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);
                        } p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        var lat, temp, lon, s; p.x -= this.x0; lon = p.x / this.a; p.y -= this.y0;
                        lat = p.y / this.a; if (this.sphere) {
                            lat /= this.C_y; lon = lon / (this.C_x * (this.m + Math.cos(lat))); if (this.m) {
                                lat = asinz((this.m * lat + Math.sin(lat)) / this.n);
                            } else { if (this.n !== 1) { lat = asinz(Math.sin(lat) / this.n); } } lon = adjust_lon(lon + this.long0); lat = adjust_lat(lat);
                        } else {
                            lat = pj_inv_mlfn(p.y / this.a, this.es, this.en); s = Math.abs(lat); if (s < HALF_PI) {
                                s = Math.sin(lat); temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));
                                lon = adjust_lon(temp);
                            } else { if ((s - EPSLN) < HALF_PI) { lon = this.long0; } }
                        } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Sinusoidal", "sinu"];
                }, { "../common/adjust_lat": 4, "../common/adjust_lon": 5, "../common/asinz": 6, "../common/pj_enfn": 17, "../common/pj_inv_mlfn": 18, "../common/pj_mlfn": 19 }], 58: [function (_dereq_, module, exports) {
                    exports.init = function () {
                        var phy0 = this.lat0;
                        this.lambda0 = this.long0; var sinPhy0 = Math.sin(phy0); var semiMajorAxis = this.a; var invF = this.rf; var flattening = 1 / invF;
                        var e2 = 2 * flattening - Math.pow(flattening, 2); var e = this.e = Math.sqrt(e2); this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));
                        this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4)); this.b0 = Math.asin(sinPhy0 / this.alpha); var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));
                        var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2)); var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0)); this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;
                    }; exports.forward = function (p) {
                        var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2)); var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));
                        var S = -this.alpha * (Sa1 + Sa2) + this.K; var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4); var I = this.alpha * (p.x - this.lambda0);
                        var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I))); var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));
                        p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0; p.x = this.R * rotI + this.x0; return p;
                    }; exports.inverse = function (p) {
                        var Y = p.x - this.x0; var X = p.y - this.y0; var rotI = Y / this.R; var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);
                        var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI)); var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));
                        var lambda = this.lambda0 + I / this.alpha; var S = 0; var phy = b; var prevPhy = -1000; var iteration = 0; while (Math.abs(phy - prevPhy) > 1e-7) {
                            if (++iteration > 20) {
                                return;
                            } S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));
                            prevPhy = phy; phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;
                        } p.x = lambda; p.y = phy; return p;
                    }; exports.names = ["somerc"];
                }, {}], 59: [function (_dereq_, module, exports) {
                    var HALF_PI = Math.PI / 2; var EPSLN = 1e-10; var sign = _dereq_("../common/sign");
                    var msfnz = _dereq_("../common/msfnz"); var tsfnz = _dereq_("../common/tsfnz"); var phi2z = _dereq_("../common/phi2z");
                    var adjust_lon = _dereq_("../common/adjust_lon"); exports.ssfn_ = function (phit, sinphi, eccen) {
                        sinphi *= eccen;
                        return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));
                    }; exports.init = function () {
                        this.coslat0 = Math.cos(this.lat0);
                        this.sinlat0 = Math.sin(this.lat0); if (this.sphere) {
                            if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
                                this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));
                            }
                        } else {
                            if (Math.abs(this.coslat0) <= EPSLN) { if (this.lat0 > 0) { this.con = 1; } else { this.con = -1; } } this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));
                            if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
                                this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));
                            } this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0); this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;
                            this.cosX0 = Math.cos(this.X0); this.sinX0 = Math.sin(this.X0);
                        }
                    }; exports.forward = function (p) {
                        var lon = p.x;
                        var lat = p.y; var sinlat = Math.sin(lat); var coslat = Math.cos(lat); var A, X, sinX, cosX, ts, rh; var dlon = adjust_lon(lon - this.long0);
                        if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {
                            p.x = NaN; p.y = NaN;
                            return p;
                        } if (this.sphere) {
                            A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon)); p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;
                            p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0; return p;
                        } else {
                            X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;
                            cosX = Math.cos(X); sinX = Math.sin(X); if (Math.abs(this.coslat0) <= EPSLN) {
                                ts = tsfnz(this.e, lat * this.con, this.con * sinlat);
                                rh = 2 * this.a * this.k0 * ts / this.cons; p.x = this.x0 + rh * Math.sin(lon - this.long0); p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);
                                return p;
                            } else {
                                if (Math.abs(this.sinlat0) < EPSLN) {
                                    A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon)); p.y = A * sinX;
                                } else {
                                    A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon))); p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;
                                }
                            } p.x = A * cosX * Math.sin(dlon) + this.x0;
                        } return p;
                    }; exports.inverse = function (p) {
                        p.x -= this.x0; p.y -= this.y0;
                        var lon, lat, ts, ce, Chi; var rh = Math.sqrt(p.x * p.x + p.y * p.y); if (this.sphere) {
                            var c = 2 * Math.atan(rh / (0.5 * this.a * this.k0));
                            lon = this.long0; lat = this.lat0; if (rh <= EPSLN) { p.x = lon; p.y = lat; return p; } lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);
                            if (Math.abs(this.coslat0) < EPSLN) {
                                if (this.lat0 > 0) { lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y)); } else {
                                    lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));
                                }
                            } else {
                                lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));
                            } p.x = lon; p.y = lat; return p;
                        } else {
                            if (Math.abs(this.coslat0) <= EPSLN) {
                                if (rh <= EPSLN) {
                                    lat = this.lat0; lon = this.long0;
                                    p.x = lon; p.y = lat; return p;
                                } p.x *= this.con; p.y *= this.con; ts = rh * this.cons / (2 * this.a * this.k0); lat = this.con * phi2z(this.e, ts);
                                lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, -1 * p.y));
                            } else {
                                ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));
                                lon = this.long0; if (rh <= EPSLN) { Chi = this.X0; } else {
                                    Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);
                                    lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));
                                } lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));
                            }
                        } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["stere"];
                }, { "../common/adjust_lon": 5, "../common/msfnz": 15, "../common/phi2z": 16, "../common/sign": 21, "../common/tsfnz": 24 }], 60: [function (_dereq_, module, exports) {
                    var gauss = _dereq_("./gauss");
                    var adjust_lon = _dereq_("../common/adjust_lon"); exports.init = function () {
                        gauss.init.apply(this); if (!this.rc) {
                            return;
                        } this.sinc0 = Math.sin(this.phic0); this.cosc0 = Math.cos(this.phic0); this.R2 = 2 * this.rc; if (!this.title) {
                            this.title = "Oblique Stereographic Alternative";
                        }
                    }; exports.forward = function (p) {
                        var sinc, cosc, cosl, k; p.x = adjust_lon(p.x - this.long0); gauss.forward.apply(this, [p]);
                        sinc = Math.sin(p.y); cosc = Math.cos(p.y); cosl = Math.cos(p.x); k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);
                        p.x = k * cosc * Math.sin(p.x); p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl); p.x = this.a * p.x + this.x0; p.y = this.a * p.y + this.y0;
                        return p;
                    }; exports.inverse = function (p) {
                        var sinc, cosc, lon, lat, rho; p.x = (p.x - this.x0) / this.a; p.y = (p.y - this.y0) / this.a;
                        p.x /= this.k0; p.y /= this.k0; if ((rho = Math.sqrt(p.x * p.x + p.y * p.y))) {
                            var c = 2 * Math.atan2(rho, this.R2); sinc = Math.sin(c);
                            cosc = Math.cos(c); lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho); lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);
                        } else { lat = this.phic0; lon = 0; } p.x = lon; p.y = lat; gauss.inverse.apply(this, [p]); p.x = adjust_lon(p.x + this.long0);
                        return p;
                    }; exports.names = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea", "Oblique Stereographic Alternative"];
                }, { "../common/adjust_lon": 5, "./gauss": 45 }], 61: [function (_dereq_, module, exports) {
                    var e0fn = _dereq_("../common/e0fn");
                    var e1fn = _dereq_("../common/e1fn"); var e2fn = _dereq_("../common/e2fn"); var e3fn = _dereq_("../common/e3fn");
                    var mlfn = _dereq_("../common/mlfn"); var adjust_lon = _dereq_("../common/adjust_lon"); var HALF_PI = Math.PI / 2;
                    var EPSLN = 1e-10; var sign = _dereq_("../common/sign"); var asinz = _dereq_("../common/asinz"); exports.init = function () {
                        this.e0 = e0fn(this.es);
                        this.e1 = e1fn(this.es); this.e2 = e2fn(this.es); this.e3 = e3fn(this.es); this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var delta_lon = adjust_lon(lon - this.long0); var con;
                        var x, y; var sin_phi = Math.sin(lat); var cos_phi = Math.cos(lat); if (this.sphere) {
                            var b = cos_phi * Math.sin(delta_lon);
                            if ((Math.abs(Math.abs(b) - 1)) < 1e-10) { return (93); } else {
                                x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)); con = Math.acos(cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - b * b));
                                if (lat < 0) { con = -con; } y = this.a * this.k0 * (con - this.lat0);
                            }
                        } else {
                            var al = cos_phi * delta_lon; var als = Math.pow(al, 2);
                            var c = this.ep2 * Math.pow(cos_phi, 2); var tq = Math.tan(lat); var t = Math.pow(tq, 2); con = 1 - this.es * Math.pow(sin_phi, 2);
                            var n = this.a / Math.sqrt(con); var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat); x = this.k0 * n * al * (1 + als / 6 * (1 - t + c + als / 20 * (5 - 18 * t + Math.pow(t, 2) + 72 * c - 58 * this.ep2))) + this.x0;
                            y = this.k0 * (ml - this.ml0 + n * tq * (als * (0.5 + als / 24 * (5 - t + 9 * c + 4 * Math.pow(c, 2) + als / 30 * (61 - 58 * t + Math.pow(t, 2) + 600 * c - 330 * this.ep2))))) + this.y0;
                        } p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        var con, phi; var delta_phi; var i; var max_iter = 6; var lat, lon;
                        if (this.sphere) {
                            var f = Math.exp(p.x / (this.a * this.k0)); var g = 0.5 * (f - 1 / f); var temp = this.lat0 + p.y / (this.a * this.k0);
                            var h = Math.cos(temp); con = Math.sqrt((1 - h * h) / (1 + g * g)); lat = asinz(con); if (temp < 0) { lat = -lat; } if ((g === 0) && (h === 0)) {
                                lon = this.long0;
                            } else { lon = adjust_lon(Math.atan2(g, h) + this.long0); }
                        } else {
                            var x = p.x - this.x0; var y = p.y - this.y0; con = (this.ml0 + y / this.k0) / this.a;
                            phi = con; for (i = 0; true; i++) {
                                delta_phi = ((con + this.e1 * Math.sin(2 * phi) - this.e2 * Math.sin(4 * phi) + this.e3 * Math.sin(6 * phi)) / this.e0) - phi;
                                phi += delta_phi; if (Math.abs(delta_phi) <= EPSLN) { break; } if (i >= max_iter) { return (95); }
                            } if (Math.abs(phi) < HALF_PI) {
                                var sin_phi = Math.sin(phi);
                                var cos_phi = Math.cos(phi); var tan_phi = Math.tan(phi); var c = this.ep2 * Math.pow(cos_phi, 2); var cs = Math.pow(c, 2);
                                var t = Math.pow(tan_phi, 2); var ts = Math.pow(t, 2); con = 1 - this.es * Math.pow(sin_phi, 2); var n = this.a / Math.sqrt(con);
                                var r = n * (1 - this.es) / con; var d = x / (n * this.k0); var ds = Math.pow(d, 2); lat = phi - (n * tan_phi * ds / r) * (0.5 - ds / 24 * (5 + 3 * t + 10 * c - 4 * cs - 9 * this.ep2 - ds / 30 * (61 + 90 * t + 298 * c + 45 * ts - 252 * this.ep2 - 3 * cs)));
                                lon = adjust_lon(this.long0 + (d * (1 - ds / 6 * (1 + 2 * t + c - ds / 20 * (5 - 2 * c + 28 * t - 3 * cs + 8 * this.ep2 + 24 * ts))) / cos_phi));
                            } else {
                                lat = HALF_PI * sign(y);
                                lon = this.long0;
                            }
                        } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Transverse_Mercator", "Transverse Mercator", "tmerc"];
                }, { "../common/adjust_lon": 5, "../common/asinz": 6, "../common/e0fn": 7, "../common/e1fn": 8, "../common/e2fn": 9, "../common/e3fn": 10, "../common/mlfn": 14, "../common/sign": 21 }], 62: [function (_dereq_, module, exports) {
                    var D2R = 0.017453292519943295;
                    var tmerc = _dereq_("./tmerc"); exports.dependsOn = "tmerc"; exports.init = function () {
                        if (!this.zone) {
                            return;
                        } this.lat0 = 0; this.long0 = ((6 * Math.abs(this.zone)) - 183) * D2R; this.x0 = 500000; this.y0 = this.utmSouth ? 10000000 : 0;
                        this.k0 = 0.9996; tmerc.init.apply(this); this.forward = tmerc.forward; this.inverse = tmerc.inverse;
                    }; exports.names = ["Universal Transverse Mercator System", "utm"];
                }, { "./tmerc": 61 }], 63: [function (_dereq_, module, exports) {
                    var adjust_lon = _dereq_("../common/adjust_lon");
                    var HALF_PI = Math.PI / 2; var EPSLN = 1e-10; var asinz = _dereq_("../common/asinz"); exports.init = function () {
                        this.R = this.a;
                    }; exports.forward = function (p) {
                        var lon = p.x; var lat = p.y; var dlon = adjust_lon(lon - this.long0); var x, y; if (Math.abs(lat) <= EPSLN) {
                            x = this.x0 + this.R * dlon;
                            y = this.y0;
                        } var theta = asinz(2 * Math.abs(lat / Math.PI)); if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {
                            x = this.x0;
                            if (lat >= 0) { y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta); } else {
                                y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);
                            }
                        } var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI)); var asq = al * al; var sinth = Math.sin(theta); var costh = Math.cos(theta);
                        var g = costh / (sinth + costh - 1); var gsq = g * g; var m = g * (2 / sinth - 1); var msq = m * m; var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);
                        if (dlon < 0) { con = -con; } x = this.x0 + con; var q = asq + g; con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);
                        if (lat >= 0) { y = this.y0 + con; } else { y = this.y0 - con; } p.x = x; p.y = y; return p;
                    }; exports.inverse = function (p) {
                        var lon, lat;
                        var xx, yy, xys, c1, c2, c3; var a1; var m1; var con; var th1; var d; p.x -= this.x0; p.y -= this.y0; con = Math.PI * this.R;
                        xx = p.x / con; yy = p.y / con; xys = xx * xx + yy * yy; c1 = -Math.abs(yy) * (1 + xys); c2 = c1 - 2 * yy * yy + xx * xx; c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;
                        d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27; a1 = (c1 - c2 * c2 / 3 / c3) / c3; m1 = 2 * Math.sqrt(-a1 / 3); con = ((3 * d) / a1) / m1;
                        if (Math.abs(con) > 1) { if (con >= 0) { con = 1; } else { con = -1; } } th1 = Math.acos(con) / 3; if (p.y >= 0) {
                            lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
                        } else { lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI; } if (Math.abs(xx) < EPSLN) { lon = this.long0; } else {
                            lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);
                        } p.x = lon; p.y = lat; return p;
                    }; exports.names = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"];
                }, { "../common/adjust_lon": 5, "../common/asinz": 6 }], 64: [function (_dereq_, module, exports) {
                    var D2R = 0.017453292519943295;
                    var R2D = 57.29577951308232; var PJD_3PARAM = 1; var PJD_7PARAM = 2; var datum_transform = _dereq_("./datum_transform");
                    var adjust_axis = _dereq_("./adjust_axis"); var proj = _dereq_("./Proj"); var toPoint = _dereq_("./common/toPoint");
                    module.exports = function transform(source, dest, point) {
                        var wgs84; if (Array.isArray(point)) {
                            point = toPoint(point);
                        } function checkNotWGS(source, dest) {
                            return ((source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== "WGS84");
                        } if (source.datum && dest.datum && (checkNotWGS(source, dest) || checkNotWGS(dest, source))) {
                            wgs84 = new proj("WGS84");
                            transform(source, wgs84, point); source = wgs84;
                        } if (source.axis !== "enu") { adjust_axis(source, false, point); } if (source.projName === "longlat") {
                            point.x *= D2R;
                            point.y *= D2R;
                        } else {
                            if (source.to_meter) { point.x *= source.to_meter; point.y *= source.to_meter; } source.inverse(point);
                        } if (source.from_greenwich) { point.x += source.from_greenwich; } point = datum_transform(source.datum, dest.datum, point);
                        if (dest.from_greenwich) { point.x -= dest.from_greenwich; } if (dest.projName === "longlat") {
                            point.x *= R2D; point.y *= R2D;
                        } else { dest.forward(point); if (dest.to_meter) { point.x /= dest.to_meter; point.y /= dest.to_meter; } } if (dest.axis !== "enu") {
                            adjust_axis(dest, true, point);
                        } return point;
                    };
                }, { "./Proj": 2, "./adjust_axis": 3, "./common/toPoint": 23, "./datum_transform": 30 }], 65: [function (_dereq_, module, exports) {
                    var D2R = 0.017453292519943295;
                    var extend = _dereq_("./extend"); function mapit(obj, key, v) {
                        obj[key] = v.map(function (aa) {
                            var o = {}; sExpr(aa, o);
                            return o;
                        }).reduce(function (a, b) { return extend(a, b); }, {});
                    } function sExpr(v, obj) {
                        var key; if (!Array.isArray(v)) {
                            obj[v] = true;
                            return;
                        } else {
                            key = v.shift(); if (key === "PARAMETER") { key = v.shift(); } if (v.length === 1) {
                                if (Array.isArray(v[0])) {
                                    obj[key] = {};
                                    sExpr(v[0], obj[key]);
                                } else { obj[key] = v[0]; }
                            } else {
                                if (!v.length) { obj[key] = true; } else {
                                    if (key === "TOWGS84") {
                                        obj[key] = v;
                                    } else {
                                        obj[key] = {}; if (["UNIT", "PRIMEM", "VERT_DATUM"].indexOf(key) > -1) {
                                            obj[key] = { name: v[0].toLowerCase(), convert: v[1] };
                                            if (v.length === 3) { obj[key].auth = v[2]; }
                                        } else {
                                            if (key === "SPHEROID") {
                                                obj[key] = { name: v[0], a: v[1], rf: v[2] }; if (v.length === 4) {
                                                    obj[key].auth = v[3];
                                                }
                                            } else {
                                                if (["GEOGCS", "GEOCCS", "DATUM", "VERT_CS", "COMPD_CS", "LOCAL_CS", "FITTED_CS", "LOCAL_DATUM"].indexOf(key) > -1) {
                                                    v[0] = ["name", v[0]];
                                                    mapit(obj, key, v);
                                                } else {
                                                    if (v.every(function (aa) { return Array.isArray(aa); })) { mapit(obj, key, v); } else {
                                                        sExpr(v, obj[key]);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    } function rename(obj, params) {
                        var outName = params[0]; var inName = params[1]; if (!(outName in obj) && (inName in obj)) {
                            obj[outName] = obj[inName];
                            if (params.length === 3) { obj[outName] = params[2](obj[outName]); }
                        }
                    } function d2r(input) { return input * D2R; } function cleanWKT(wkt) {
                        if (wkt.type === "GEOGCS") {
                            wkt.projName = "longlat";
                        } else {
                            if (wkt.type === "LOCAL_CS") { wkt.projName = "identity"; wkt.local = true; } else {
                                if (typeof wkt.PROJECTION === "object") {
                                    wkt.projName = Object.keys(wkt.PROJECTION)[0];
                                } else { wkt.projName = wkt.PROJECTION; }
                            }
                        } if (wkt.UNIT) {
                            wkt.units = wkt.UNIT.name.toLowerCase(); if (wkt.units === "metre") {
                                wkt.units = "meter";
                            } if (wkt.UNIT.convert) { wkt.to_meter = parseFloat(wkt.UNIT.convert, 10); }
                        } if (wkt.GEOGCS) {
                            if (wkt.GEOGCS.DATUM) {
                                wkt.datumCode = wkt.GEOGCS.DATUM.name.toLowerCase();
                            } else { wkt.datumCode = wkt.GEOGCS.name.toLowerCase(); } if (wkt.datumCode.slice(0, 2) === "d_") {
                                wkt.datumCode = wkt.datumCode.slice(2);
                            } if (wkt.datumCode === "new_zealand_geodetic_datum_1949" || wkt.datumCode === "new_zealand_1949") {
                                wkt.datumCode = "nzgd49";
                            } if (wkt.datumCode === "wgs_1984") {
                                if (wkt.PROJECTION === "Mercator_Auxiliary_Sphere") { wkt.sphere = true; } wkt.datumCode = "wgs84";
                            } if (wkt.datumCode.slice(-6) === "_ferro") { wkt.datumCode = wkt.datumCode.slice(0, -6); } if (wkt.datumCode.slice(-8) === "_jakarta") {
                                wkt.datumCode = wkt.datumCode.slice(0, -8);
                            } if (~wkt.datumCode.indexOf("belge")) { wkt.datumCode = "rnb72"; } if (wkt.GEOGCS.DATUM && wkt.GEOGCS.DATUM.SPHEROID) {
                                wkt.ellps = wkt.GEOGCS.DATUM.SPHEROID.name.replace("_19", "").replace(/[Cc]larke\_18/, "clrk");
                                if (wkt.ellps.toLowerCase().slice(0, 13) === "international") { wkt.ellps = "intl"; } wkt.a = wkt.GEOGCS.DATUM.SPHEROID.a;
                                wkt.rf = parseFloat(wkt.GEOGCS.DATUM.SPHEROID.rf, 10);
                            } if (~wkt.datumCode.indexOf("osgb_1936")) {
                                wkt.datumCode = "osgb36";
                            }
                        } if (wkt.b && !isFinite(wkt.b)) { wkt.b = wkt.a; } function toMeter(input) {
                            var ratio = wkt.to_meter || 1; return parseFloat(input, 10) * ratio;
                        } var renamer = function (a) { return rename(wkt, a); }; var list = [["standard_parallel_1", "Standard_Parallel_1"], ["standard_parallel_2", "Standard_Parallel_2"], ["false_easting", "False_Easting"], ["false_northing", "False_Northing"], ["central_meridian", "Central_Meridian"], ["latitude_of_origin", "Latitude_Of_Origin"], ["scale_factor", "Scale_Factor"], ["k0", "scale_factor"], ["latitude_of_center", "Latitude_of_center"], ["lat0", "latitude_of_center", d2r], ["longitude_of_center", "Longitude_Of_Center"], ["longc", "longitude_of_center", d2r], ["x0", "false_easting", toMeter], ["y0", "false_northing", toMeter], ["long0", "central_meridian", d2r], ["lat0", "latitude_of_origin", d2r], ["lat0", "standard_parallel_1", d2r], ["lat1", "standard_parallel_1", d2r], ["lat2", "standard_parallel_2", d2r], ["alpha", "azimuth", d2r], ["srsCode", "name"]];
                        list.forEach(renamer); if (!wkt.long0 && wkt.longc && (wkt.PROJECTION === "Albers_Conic_Equal_Area" || wkt.PROJECTION === "Lambert_Azimuthal_Equal_Area")) {
                            wkt.long0 = wkt.longc;
                        }
                    } module.exports = function (wkt, self) {
                        var lisp = JSON.parse(("," + wkt).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g, ',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g, ',"$1"]'));
                        var type = lisp.shift(); var name = lisp.shift(); lisp.unshift(["name", name]); lisp.unshift(["type", type]); lisp.unshift("output");
                        var obj = {}; sExpr(lisp, obj); cleanWKT(obj.output); return extend(self, obj.output);
                    };
                }, { "./extend": 33 }], 66: [function (_dereq_, module, exports) {
                    var NUM_100K_SETS = 6;
                    var SET_ORIGIN_COLUMN_LETTERS = "AJSAJS"; var SET_ORIGIN_ROW_LETTERS = "AFAFAF"; var A = 65; var I = 73; var O = 79;
                    var V = 86; var Z = 90; exports.forward = function (ll, accuracy) {
                        accuracy = accuracy || 5; return encode(LLtoUTM({ lat: ll[1], lon: ll[0] }), accuracy);
                    }; exports.inverse = function (mgrs) {
                        var bbox = UTMtoLL(decode(mgrs.toUpperCase())); return [bbox.left, bbox.bottom, bbox.right, bbox.top];
                    }; exports.toPoint = function (mgrsStr) {
                        var llbbox = exports.inverse(mgrsStr); return [(llbbox[2] + llbbox[0]) / 2, (llbbox[3] + llbbox[1]) / 2];
                    }; function degToRad(deg) { return (deg * (Math.PI / 180)); } function radToDeg(rad) {
                        return (180 * (rad / Math.PI));
                    } function LLtoUTM(ll) {
                        var Lat = ll.lat; var Long = ll.lon; var a = 6378137; var eccSquared = 0.00669438; var k0 = 0.9996;
                        var LongOrigin; var eccPrimeSquared; var N, T, C, A, M; var LatRad = degToRad(Lat); var LongRad = degToRad(Long);
                        var LongOriginRad; var ZoneNumber; ZoneNumber = Math.floor((Long + 180) / 6) + 1; if (Long === 180) { ZoneNumber = 60; } if (Lat >= 56 && Lat < 64 && Long >= 3 && Long < 12) {
                            ZoneNumber = 32;
                        } if (Lat >= 72 && Lat < 84) {
                            if (Long >= 0 && Long < 9) { ZoneNumber = 31; } else {
                                if (Long >= 9 && Long < 21) { ZoneNumber = 33; } else {
                                    if (Long >= 21 && Long < 33) {
                                        ZoneNumber = 35;
                                    } else { if (Long >= 33 && Long < 42) { ZoneNumber = 37; } }
                                }
                            }
                        } LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; LongOriginRad = degToRad(LongOrigin);
                        eccPrimeSquared = (eccSquared) / (1 - eccSquared); N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));
                        T = Math.tan(LatRad) * Math.tan(LatRad); C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad); A = Math.cos(LatRad) * (LongRad - LongOriginRad);
                        M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));
                        var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120) + 500000); var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720)));
                        if (Lat < 0) { UTMNorthing += 10000000; } return { northing: Math.round(UTMNorthing), easting: Math.round(UTMEasting), zoneNumber: ZoneNumber, zoneLetter: getLetterDesignator(Lat) };
                    } function UTMtoLL(utm) {
                        var UTMNorthing = utm.northing; var UTMEasting = utm.easting; var zoneLetter = utm.zoneLetter;
                        var zoneNumber = utm.zoneNumber; if (zoneNumber < 0 || zoneNumber > 60) { return null; } var k0 = 0.9996; var a = 6378137;
                        var eccSquared = 0.00669438; var eccPrimeSquared; var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));
                        var N1, T1, C1, R1, D, M; var LongOrigin; var mu, phi1Rad; var x = UTMEasting - 500000; var y = UTMNorthing; if (zoneLetter < "N") {
                            y -= 10000000;
                        } LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; eccPrimeSquared = (eccSquared) / (1 - eccSquared); M = y / k0; mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));
                        phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);
                        N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad)); T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);
                        C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad); R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);
                        D = x / (N1 * k0); var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);
                        lat = radToDeg(lat); var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);
                        lon = LongOrigin + radToDeg(lon); var result; if (utm.accuracy) {
                            var topRight = UTMtoLL({ northing: utm.northing + utm.accuracy, easting: utm.easting + utm.accuracy, zoneLetter: utm.zoneLetter, zoneNumber: utm.zoneNumber });
                            result = { top: topRight.lat, right: topRight.lon, bottom: lat, left: lon };
                        } else { result = { lat: lat, lon: lon }; } return result;
                    } function getLetterDesignator(lat) {
                        var LetterDesignator = "Z"; if ((84 >= lat) && (lat >= 72)) {
                            LetterDesignator = "X";
                        } else {
                            if ((72 > lat) && (lat >= 64)) { LetterDesignator = "W"; } else {
                                if ((64 > lat) && (lat >= 56)) {
                                    LetterDesignator = "V";
                                } else {
                                    if ((56 > lat) && (lat >= 48)) { LetterDesignator = "U"; } else {
                                        if ((48 > lat) && (lat >= 40)) {
                                            LetterDesignator = "T";
                                        } else {
                                            if ((40 > lat) && (lat >= 32)) { LetterDesignator = "S"; } else {
                                                if ((32 > lat) && (lat >= 24)) {
                                                    LetterDesignator = "R";
                                                } else {
                                                    if ((24 > lat) && (lat >= 16)) { LetterDesignator = "Q"; } else {
                                                        if ((16 > lat) && (lat >= 8)) {
                                                            LetterDesignator = "P";
                                                        } else {
                                                            if ((8 > lat) && (lat >= 0)) { LetterDesignator = "N"; } else {
                                                                if ((0 > lat) && (lat >= -8)) { LetterDesignator = "M"; } else {
                                                                    if ((-8 > lat) && (lat >= -16)) {
                                                                        LetterDesignator = "L";
                                                                    } else {
                                                                        if ((-16 > lat) && (lat >= -24)) { LetterDesignator = "K"; } else {
                                                                            if ((-24 > lat) && (lat >= -32)) {
                                                                                LetterDesignator = "J";
                                                                            } else {
                                                                                if ((-32 > lat) && (lat >= -40)) { LetterDesignator = "H"; } else {
                                                                                    if ((-40 > lat) && (lat >= -48)) {
                                                                                        LetterDesignator = "G";
                                                                                    } else {
                                                                                        if ((-48 > lat) && (lat >= -56)) { LetterDesignator = "F"; } else {
                                                                                            if ((-56 > lat) && (lat >= -64)) {
                                                                                                LetterDesignator = "E";
                                                                                            } else {
                                                                                                if ((-64 > lat) && (lat >= -72)) { LetterDesignator = "D"; } else {
                                                                                                    if ((-72 > lat) && (lat >= -80)) {
                                                                                                        LetterDesignator = "C";
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        } return LetterDesignator;
                    } function encode(utm, accuracy) {
                        var seasting = "" + utm.easting, snorthing = "" + utm.northing;
                        return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);
                    } function get100kID(easting, northing, zoneNumber) {
                        var setParm = get100kSetForZone(zoneNumber); var setColumn = Math.floor(easting / 100000);
                        var setRow = Math.floor(northing / 100000) % 20; return getLetter100kID(setColumn, setRow, setParm);
                    } function get100kSetForZone(i) {
                        var setParm = i % NUM_100K_SETS;
                        if (setParm === 0) { setParm = NUM_100K_SETS; } return setParm;
                    } function getLetter100kID(column, row, parm) {
                        var index = parm - 1;
                        var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index); var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);
                        var colInt = colOrigin + column - 1; var rowInt = rowOrigin + row; var rollover = false; if (colInt > Z) {
                            colInt = colInt - Z + A - 1;
                            rollover = true;
                        } if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {
                            colInt++;
                        } if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {
                            colInt++; if (colInt === I) {
                                colInt++;
                            }
                        } if (colInt > Z) { colInt = colInt - Z + A - 1; } if (rowInt > V) { rowInt = rowInt - V + A - 1; rollover = true; } else {
                            rollover = false;
                        } if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) { rowInt++; } if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {
                            rowInt++;
                            if (rowInt === I) { rowInt++; }
                        } if (rowInt > V) { rowInt = rowInt - V + A - 1; } var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);
                        return twoLetter;
                    } function decode(mgrsString) {
                        if (mgrsString && mgrsString.length === 0) {
                            throw ("MGRSPoint coverting from nothing");
                        } var length = mgrsString.length; var hunK = null; var sb = ""; var testChar; var i = 0; while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {
                            if (i >= 2) {
                                throw ("MGRSPoint bad conversion from: " + mgrsString);
                            } sb += testChar; i++;
                        } var zoneNumber = parseInt(sb, 10); if (i === 0 || i + 3 > length) {
                            throw ("MGRSPoint bad conversion from: " + mgrsString);
                        } var zoneLetter = mgrsString.charAt(i++); if (zoneLetter <= "A" || zoneLetter === "B" || zoneLetter === "Y" || zoneLetter >= "Z" || zoneLetter === "I" || zoneLetter === "O") {
                            throw ("MGRSPoint zone letter " + zoneLetter + " not handled: " + mgrsString);
                        } hunK = mgrsString.substring(i, i += 2); var set = get100kSetForZone(zoneNumber); var east100k = getEastingFromChar(hunK.charAt(0), set);
                        var north100k = getNorthingFromChar(hunK.charAt(1), set); while (north100k < getMinNorthing(zoneLetter)) {
                            north100k += 2000000;
                        } var remainder = length - i; if (remainder % 2 !== 0) {
                            throw ("MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + mgrsString);
                        } var sep = remainder / 2; var sepEasting = 0; var sepNorthing = 0; var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;
                        if (sep > 0) {
                            accuracyBonus = 100000 / Math.pow(10, sep); sepEastingString = mgrsString.substring(i, i + sep); sepEasting = parseFloat(sepEastingString) * accuracyBonus;
                            sepNorthingString = mgrsString.substring(i + sep); sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;
                        } easting = sepEasting + east100k; northing = sepNorthing + north100k; return { easting: easting, northing: northing, zoneLetter: zoneLetter, zoneNumber: zoneNumber, accuracy: accuracyBonus };
                    } function getEastingFromChar(e, set) {
                        var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1); var eastingValue = 100000;
                        var rewindMarker = false; while (curCol !== e.charCodeAt(0)) {
                            curCol++; if (curCol === I) { curCol++; } if (curCol === O) {
                                curCol++;
                            } if (curCol > Z) { if (rewindMarker) { throw ("Bad character: " + e); } curCol = A; rewindMarker = true; } eastingValue += 100000;
                        } return eastingValue;
                    } function getNorthingFromChar(n, set) {
                        if (n > "V") {
                            throw ("MGRSPoint given invalid Northing " + n);
                        } var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1); var northingValue = 0; var rewindMarker = false; while (curRow !== n.charCodeAt(0)) {
                            curRow++;
                            if (curRow === I) { curRow++; } if (curRow === O) { curRow++; } if (curRow > V) {
                                if (rewindMarker) {
                                    throw ("Bad character: " + n);
                                } curRow = A; rewindMarker = true;
                            } northingValue += 100000;
                        } return northingValue;
                    } function getMinNorthing(zoneLetter) {
                        var northing;
                        switch (zoneLetter) {
                            case "C": northing = 1100000; break; case "D": northing = 2000000; break; case "E": northing = 2800000;
                                break; case "F": northing = 3700000; break; case "G": northing = 4600000; break; case "H": northing = 5500000; break; case "J": northing = 6400000;
                                    break; case "K": northing = 7300000; break; case "L": northing = 8200000; break; case "M": northing = 9100000; break; case "N": northing = 0;
                                        break; case "P": northing = 800000; break; case "Q": northing = 1700000; break; case "R": northing = 2600000; break; case "S": northing = 3500000;
                                            break; case "T": northing = 4400000; break; case "U": northing = 5300000; break; case "V": northing = 6200000; break; case "W": northing = 7000000;
                                                break; case "X": northing = 7900000; break; default: northing = -1;
                        } if (northing >= 0) { return northing; } else {
                            throw ("Invalid zone letter: " + zoneLetter);
                        }
                    }
                }, {}], 67: [function (_dereq_, module, exports) {
                    module.exports = { name: "proj4", version: "2.2.2-alpha", description: "Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.", main: "lib/index.js", directories: { test: "test", doc: "docs" }, scripts: { test: "./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js" }, repository: { type: "git", url: "git://github.com/proj4js/proj4js.git" }, author: "", license: "MIT", jam: { main: "dist/proj4.js", include: ["dist/proj4.js", "README.md", "AUTHORS", "LICENSE.md"] }, devDependencies: { "grunt-cli": "~0.1.13", grunt: "~0.4.2", "grunt-contrib-connect": "~0.6.0", "grunt-contrib-jshint": "~0.8.0", chai: "~1.8.1", mocha: "~1.17.1", "grunt-mocha-phantomjs": "~0.4.0", browserify: "~3.24.5", "grunt-browserify": "~1.3.0", "grunt-contrib-uglify": "~0.3.2", curl: "git://github.com/cujojs/curl.git", istanbul: "~0.2.4", tin: "~0.4.0" }, dependencies: { mgrs: "0.0.0" } };
                }, {}], "./includedProjections": [function (_dereq_, module, exports) { module.exports = _dereq_("Jf/0WF"); }, {}], "Jf/0WF": [function (_dereq_, module, exports) {
                    var projs = [_dereq_("./lib/projections/tmerc"), _dereq_("./lib/projections/utm"), _dereq_("./lib/projections/sterea"), _dereq_("./lib/projections/stere"), _dereq_("./lib/projections/somerc"), _dereq_("./lib/projections/omerc"), _dereq_("./lib/projections/lcc"), _dereq_("./lib/projections/krovak"), _dereq_("./lib/projections/cass"), _dereq_("./lib/projections/laea"), _dereq_("./lib/projections/aea"), _dereq_("./lib/projections/gnom"), _dereq_("./lib/projections/cea"), _dereq_("./lib/projections/eqc"), _dereq_("./lib/projections/poly"), _dereq_("./lib/projections/nzmg"), _dereq_("./lib/projections/mill"), _dereq_("./lib/projections/sinu"), _dereq_("./lib/projections/moll"), _dereq_("./lib/projections/eqdc"), _dereq_("./lib/projections/vandg"), _dereq_("./lib/projections/aeqd")];
                    module.exports = function (proj4) { projs.forEach(function (proj) { proj4.Proj.projections.add(proj); }); };
                }, { "./lib/projections/aea": 39, "./lib/projections/aeqd": 40, "./lib/projections/cass": 41, "./lib/projections/cea": 42, "./lib/projections/eqc": 43, "./lib/projections/eqdc": 44, "./lib/projections/gnom": 46, "./lib/projections/krovak": 47, "./lib/projections/laea": 48, "./lib/projections/lcc": 49, "./lib/projections/mill": 52, "./lib/projections/moll": 53, "./lib/projections/nzmg": 54, "./lib/projections/omerc": 55, "./lib/projections/poly": 56, "./lib/projections/sinu": 57, "./lib/projections/somerc": 58, "./lib/projections/stere": 59, "./lib/projections/sterea": 60, "./lib/projections/tmerc": 61, "./lib/projections/utm": 62, "./lib/projections/vandg": 63 }]
            }, {}, [35])(35);
        });
    }.call(exports, (function () { return this; }())));
}, function (module, exports) {
    (function (exports) {
        var Projection = function (proj) {
            this.proj = new proj4.Proj(proj);
        }; Projection.prototype = {
            project: function (latlng) {
                var projectedPoint = proj4(this.proj).forward([latlng.lng, latlng.lat]);
                return new T.Point(projectedPoint[0], projectedPoint[1]);
            }, unproject: function (point) {
                var unprojectedPoint = proj4(this.proj).inverse([point.x, point.y]);
                return new T.LatLng(unprojectedPoint[1], unprojectedPoint[0]);
            }
        }; exports.Projection = Projection;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var SphericalMercator = function () {
            this.MAX_LATITUDE = 85.0511287798 * 200;
        }; SphericalMercator.prototype = {
            project: function (latlng) {
                var d = Math.PI / 180, max = this.MAX_LATITUDE, lat = Math.max(Math.min(max, latlng.lat), -max), x = latlng.lng * d, y = lat * d;
                y = Math.log(Math.tan((Math.PI / 4) + (y / 2))); return new T.Point(x, y);
            }, unproject: function (point) {
                var d = 180 / Math.PI, lng = point.x * d, lat = (2 * Math.atan(Math.exp(point.y)) - (Math.PI / 2)) * d;
                return new T.LatLng(lat, lng);
            }
        }; exports.SphericalMercator = SphericalMercator;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Crs = function (options) {
            var i;
            this.code = options.code || "EPSG:3857"; this.transformation = options.transform || new T.Transform(1, 0, -1, 0);
            this.resolutions = options.resolutions; this.maxResolution = options.maxResolution; this.projText = options.proj;
            this.projection = new T.Projection(options.proj || options.code); this.maxProjected = this.projection.project(new T.LatLng(0, 179.9999));
            if (!this.resolutions) {
                this.resolutions = []; if (!this.maxResolution) {
                    this.maxResolution = 2 * Math.PI * this.projection.proj.a / 256;
                } for (i = 0; i < 19; i++) { this.resolutions.push(this.maxResolution / (1 << i)); }
            } this.scales = []; for (i = 0; i < this.resolutions.length;
            i++) { this.scales.push(1 / this.resolutions[i]); }
        }; Crs.prototype = {
            project: function (latlng) {
                var point, MAX, factor, latlngClone;
                if (this.code === "EPSG:3857") {
                    MAX = 20037508.342789233; latlngClone = latlng.clone(); this.transformation = new T.Transform(1, MAX, -1, MAX);
                    factor = this.prepareLatLng(latlngClone); point = this.projection.project(latlngClone); point.x += this.maxProjected.x * factor;
                } else { point = this.projection.project(latlng); } return point;
            }, unproject: function (point) {
                var latlng, factor, MAX, pointClone;
                if (this.code === "EPSG:3857") {
                    MAX = 20037508.342789233; pointClone = point.clone(); this.transformation = new T.Transform(1, MAX, -1, MAX);
                    factor = this.preparePoint(pointClone); latlng = this.projection.unproject(pointClone); latlng.lng += 180 * factor;
                } else { latlng = this.projection.unproject(point); } return latlng;
            }, latLngToPoint: function (latlng, zoom) {
                var projectedPoint = this.project(latlng), point = this.transform(projectedPoint, zoom);
                return point;
            }, pointToLatLng: function (point, zoom) {
                var untransformedPoint = this.untransform(point, zoom), latlng = this.unproject(untransformedPoint);
                return latlng;
            }, transform: function (point, zoom) {
                var scale = this.scale(zoom), transformedPoint = this.transformation.transform(point, scale);
                return transformedPoint;
            }, untransform: function (point, zoom) {
                var scale = this.scale(zoom), untransformedPoint = this.transformation.untransform(point, scale);
                return untransformedPoint;
            }, scale: function (zoom) { return this.scales[zoom]; }, resolution: function (zoom) {
                return this.resolutions[zoom];
            }, preparePoint: function (point) {
                if (!point.x || point.x === 0) { return 0; } var max = this.maxProjected; var sgn = Math.abs(point.x) / point.x;
                var factor = Math.floor(Math.abs(point.x / max.x)); if (factor > 0) { point.x = point.x % max.x; } return factor * sgn;
            }, prepareLatLng: function (latlng) {
                if (!latlng.lng || latlng.lng === 0) { return 0; } var max = 180; var sgn = Math.abs(latlng.lng) / latlng.lng;
                var factor = Math.floor(Math.abs(latlng.lng / max)); if (factor > 0) { latlng.lng = latlng.lng % max; } return factor * sgn;
            }
        }; exports.Crs = Crs;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var MouseHandler = function (options) {
            this.dragTargetPrecision = (options && options.dragTargetPrecision) ? options.dragTargetPrecision : 500;
        }; MouseHandler.CLICKS = "clicks"; MouseHandler.DRAG = "drag"; MouseHandler.MOUSE_WHEEL = "mouse-wheel"; MouseHandler.prototype = {
            init: function (map) {
                this.map = map;
                this.mouseWheelDelta = 0; this.mouseUtil = new T.MouseUtil(this.map.$container); this.enable();
            }, uninit: function () {
                this.disable();
                this.map = null; this.mouseUtil = null;
            }, onClick: function (evt, supressMapEvents) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), mousePosition = this.map.computeMousePosition(evt), canvasGeometryHit;
                if (!target) { return; } evt.latLng = this.map.containerPointToLatLng(mousePosition); if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, evt, "press", this.onClick);
                } else {
                    if (target.isClickableLayer) { this.map.events.fire("press", evt); } else {
                        if (target && target.events) {
                            target.events.fire("press", evt);
                            this.customizedEventHandling(target, "press", evt);
                        }
                    }
                } if (!supressMapEvents) {
                    this.map.events.fire("map-press", evt);
                }
            }, onDoubleClick: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement);
                if (!target) { return; } this.doubleClickZoom(evt);
            }, onLongClick: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), mousePosition = this.map.computeMousePosition(evt);
                if (!target) { return; } evt.latLng = this.map.containerPointToLatLng(mousePosition); if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, evt, "long-press", this.onLongClick);
                } else {
                    if (target.isClickableLayer) { this.map.events.fire("long-press", evt); } else {
                        if (target && target.events) {
                            target.events.fire("long-press", evt);
                            this.customizedEventHandling(target, "long-press", evt);
                        }
                    }
                }
            }, onRightClick: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), mousePosition = this.map.computeMousePosition(evt);
                evt.latLng = this.map.containerPointToLatLng(mousePosition); if (target && target.isClickableLayer) {
                    this.map.events.fire("right-click", evt);
                }
            }, onMouseOver: function (evt) {
                var mousePosition = this.map.computeMousePosition(evt), target = this.findEventInteractiveTarget(evt.target || evt.srcElement);
                if (target) {
                    evt.latLng = this.map.containerPointToLatLng(mousePosition); target.events.fire("over", evt); this.customizedEventHandling(target, "over", evt);
                }
            }, onMouseOut: function (evt) {
                var mousePosition = this.map.computeMousePosition(evt), target = this.findEventInteractiveTarget(evt.target || evt.srcElement);
                if (target) {
                    evt.latLng = this.map.containerPointToLatLng(mousePosition); target.events.fire("out", evt); this.customizedEventHandling(target, "out", evt);
                }
            }, onBeforeDragStart: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement);
                if (!target) { return; } if (target instanceof T.CanvasLayer) {
                    var x = this.handleCanvasLayerEvents(target, evt, null, this.onBeforeDragStart);
                    if (!x) { return; }
                } if (!target.isDraggable || !target.options.draggable) { target = this.map.getTileLayer(); } this.currentDragTarget = target;
                target.events.fire("before-drag-start", evt); this.customizedEventHandling(target, "before-drag-start", evt);
            }, onDragStart: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement); if (!target) {
                    return;
                } if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, evt, null, this.onDragStart); return;
                } if (!target.isDraggable || !target.options.draggable) { target = this.map.getTileLayer(); } target.events.fire("drag-start", evt);
                this.customizedEventHandling(target, "drag-start", evt);
            }, onDrag: function (evt) {
                var target = this.currentDragTarget;
                if (!target) { return; } target.events.fire("drag", evt); this.customizedEventHandling(target, "drag", evt);
            }, onDragEnd: function (evt) {
                var target = this.currentDragTarget;
                if (!target) { return; } target.events.fire("drag-end", evt); this.customizedEventHandling(target, "drag-end", evt);
                this.currentDragTarget = null;
            }, onMouseWheel: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement);
                if (!target) { return; } var util = T.DomEventUtil, delta = util.getWheelDelta(evt), mousePosition = this.map.computeMousePosition(evt), centerInPixels = this.calculateCenterInPixels(mousePosition), center = this.map.unproject(centerInPixels), zoom, self;
                this.mouseWheelDelta += delta; util.stop(evt); clearTimeout(this.tm); self = this; this.tm = setTimeout(function () {
                    zoom = (self.map.getZoom()) + Math.floor(self.mouseWheelDelta);
                    self.map.zoomAround(center, zoom, true); self.mouseWheelDelta = 0;
                }, 30);
            }, handleCanvasLayerEvents: function (targetObject, evt, eventToFire, callback) {
                var geometryFound = targetObject.getTargetedGeometry(evt);
                if (!geometryFound) {
                    targetObject.$canvas.style.display = "none"; var newTarget = document.elementFromPoint(evt.clientX, evt.clientY);
                    var newEvt = this.mouseUtil.getNewMouseEventWithUsefulProperties(evt, newTarget); callback.call(this, newEvt, true);
                    targetObject.$canvas.style.display = "block";
                } else {
                    if (eventToFire) {
                        geometryFound.events.fire(eventToFire, evt);
                        this.customizedEventHandling(targetObject, eventToFire, geometryFound, evt);
                    }
                } return geometryFound;
            }, customizedEventHandling: function (target, eventName, object, evt) {
                if (target.handleEvents) {
                    target.handleEvents(eventName, object, evt);
                }
            }, findEventInteractiveTarget: function (src) {
                while (src) {
                    var target = src.interactiveObject; if (target) {
                        return target;
                    } if (src === this.map.$container.layers) { break; } src = src.parentNode;
                } return null;
            }, doubleClickZoom: function (evt) {
                var util = T.DomEventUtil, mousePosition = this.map.computeMousePosition(evt), centerInPixels = this.calculateCenterInPixels(mousePosition), center = this.map.unproject(centerInPixels);
                util.stop(evt); this.map.zoomAround(center, this.map.getZoom() + 1, true);
            }, calculateCenterInPixels: function (mousePosition) {
                var pos = mousePosition.substract(this.map.getLayersPos()).add(this.map.getTopLeftInPixels());
                return pos;
            }, disable: function (handlerRegion) {
                switch (handlerRegion) {
                    case T.MouseHandler.DRAG: this.mouseUtil.events.detach("before-drag", this.onBeforeDragStart);
                        this.mouseUtil.events.detach("drag-start", this.onDragStart); this.mouseUtil.events.detach("drag", this.onDrag);
                        this.mouseUtil.events.detach("drag-end", this.onDragEnd); break; case T.MouseHandler.MOUSE_WHEEL: this.mouseUtil.events.detach("mouse-wheel", this.onMouseWheel);
                            break; case T.MouseHandler.CLICKS: this.mouseUtil.events.detach("click", this.onClick); this.mouseUtil.events.detach("double-click", this.onDoubleClick);
                                this.mouseUtil.events.detach("long-click", this.onLongClick); this.mouseUtil.events.detach("right-click", this.onRightClick);
                                this.mouseUtil.events.detach("mouse-over", this.onMouseOver); this.mouseUtil.events.detach("mouse-out", this.onMouseOut);
                                break; default: this.mouseUtil.events.detach("before-drag", this.onBeforeDragStart); this.mouseUtil.events.detach("drag-start", this.onDragStart);
                                    this.mouseUtil.events.detach("drag", this.onDrag); this.mouseUtil.events.detach("drag-end", this.onDragEnd);
                                    this.mouseUtil.events.detach("mouse-wheel", this.onMouseWheel); this.mouseUtil.events.detach("mouse-over", this.onMouseOver);
                                    this.mouseUtil.events.detach("mouse-out", this.onMouseOut); this.mouseUtil.events.detach("click", this.onClick, this);
                                    this.mouseUtil.events.detach("double-click", this.onDoubleClick); this.mouseUtil.events.detach("long-click", this.onLongClick);
                                    this.mouseUtil.events.detach("right-click", this.onRightClick); this.mouseUtil.disable(); break;
                }
            }, enable: function (handlerRegion) {
                switch (handlerRegion) {
                    case T.MouseHandler.DRAG: this.mouseUtil.events.on("before-drag", this.onBeforeDragStart, this);
                        this.mouseUtil.events.on("drag-start", this.onDragStart, this); this.mouseUtil.events.on("drag", this.onDrag, this);
                        this.mouseUtil.events.on("drag-end", this.onDragEnd, this); break; case T.MouseHandler.MOUSE_WHEEL: this.mouseUtil.events.on("mouse-wheel", this.onMouseWheel, this);
                            break; case T.MouseHandler.CLICKS: this.mouseUtil.events.on("click", this.onClick, this); this.mouseUtil.events.on("double-click", this.onDoubleClick, this);
                                this.mouseUtil.events.on("long-click", this.onLongClick, this); this.mouseUtil.events.on("right-click", this.onRightClick, this);
                                this.mouseUtil.events.on("mouse-over", this.onMouseOver, this); this.mouseUtil.events.on("mouse-out", this.onMouseOut, this);
                                break; default: this.mouseUtil.events.on("before-drag", this.onBeforeDragStart, this); this.mouseUtil.events.on("drag-start", this.onDragStart, this);
                                    this.mouseUtil.events.on("drag", this.onDrag, this); this.mouseUtil.events.on("drag-end", this.onDragEnd, this);
                                    this.mouseUtil.events.on("mouse-wheel", this.onMouseWheel, this); this.mouseUtil.events.on("mouse-over", this.onMouseOver, this);
                                    this.mouseUtil.events.on("mouse-out", this.onMouseOut, this); this.mouseUtil.events.on("click", this.onClick, this);
                                    this.mouseUtil.events.on("double-click", this.onDoubleClick, this); this.mouseUtil.events.on("long-click", this.onLongClick, this);
                                    this.mouseUtil.events.on("right-click", this.onRightClick, this); this.mouseUtil.enable(); break;
                }
            }, remove: function () {
                this.mouseUtil.disable();
                this.mouseUtil.events.detachAll(); this.map = null; this.mouseUtil = null;
            }
        }; exports.MouseHandler = MouseHandler;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var TouchHandler = function (options) {
            this.animMatrix = new T.Matrix2D();
        }; TouchHandler.TAPS = "taps"; TouchHandler.MOVE = "move"; TouchHandler.prototype = {
            init: function (map) {
                this.map = map;
                this.touchUtil = new T.TouchUtil(this.map.$container); this.enable();
            }, uninit: function () {
                this.disable();
                this.map = null; this.touchUtil = null;
            }, onTap: function (evt, supressMapEvents) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), newEvtData = this.touchUtil.getNewMouseEventWithUsefulProperties(evt, target), mousePosition = this.map.computeMousePosition(newEvtData), canvasGeometryHit;
                if (!target) { return; } newEvtData.latLng = this.map.containerPointToLatLng(mousePosition); if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, newEvtData, "press", this.onTap);
                } else {
                    if (target.isClickableLayer) { this.map.events.fire("press", newEvtData); } else {
                        if (target && target.events) {
                            target.events.fire("press", newEvtData);
                            this.customizedEventHandling(target, "press", evt);
                        }
                    }
                } if (!supressMapEvents) {
                    this.map.events.fire("map-press", newEvtData);
                }
            }, onDoubleTap: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement); if (!target) {
                    return;
                } this.doubleTouchZoom(evt);
            }, onLongTap: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), newEvtData = this.touchUtil.getNewMouseEventWithUsefulProperties(evt, target), mousePosition = this.map.computeMousePosition(newEvtData);
                if (!target) { return; } newEvtData.latLng = this.map.containerPointToLatLng(mousePosition); if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, newEvtData, "long-press", this.onLongTap);
                } else {
                    if (target.isClickableLayer) { this.map.events.fire("long-press", newEvtData); } else {
                        if (target && target.events) {
                            target.events.fire("long-press", newEvtData);
                            this.customizedEventHandling(target, "long-press", evt);
                        }
                    }
                }
            }, onTouchStart: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), newEvtData = this.touchUtil.getNewMouseEventWithUsefulProperties(evt, target);
                if (!target) { return; } if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, newEvtData, null, this.onTouchStart);
                    return;
                } if (!target.isDraggable || !target.options.draggable) { target = this.map.getTileLayer(); } this.currentDragTarget = target;
                target.events.fire("before-drag-start", newEvtData); this.customizedEventHandling(target, "before-drag-start", evt);
            }, onTouchMove: function (evt) {
                var target = this.currentDragTarget || this.findEventInteractiveTarget(evt.target || evt.srcElement), newEvtData = this.touchUtil.getNewMouseEventWithUsefulProperties(evt, target), dragContainer = null;
                if (!target) { return; } target.events.fire("drag", newEvtData); this.customizedEventHandling(target, "drag", evt);
            }, onTouchEnd: function (evt) {
                var target = this.findEventInteractiveTarget(evt.target || evt.srcElement), newEvtData = this.touchUtil.getNewMouseEventWithUsefulProperties(evt, target);
                if (!target) { return; } if (target instanceof T.CanvasLayer) {
                    this.handleCanvasLayerEvents(target, newEvtData, null, this.onTouchEnd);
                } if (!target.isDraggable || !target.options.draggable) { target = this.map.getTileLayer(); } this.currentDragTarget = null;
                target.events.fire("drag-end", newEvtData); this.customizedEventHandling(target, "drag-end", evt);
            }, onPinchZoom: function (evt, center, scale, delta) {
                var newContinuousZoom = scale, mapPoint = this.map.computeMousePosition(new T.Point(center.x, center.y)).substract(this.map.getLayersPos()), matrixA = new T.Matrix2D(1, 0, 0, 1, -mapPoint.x, -mapPoint.y), matrixB = new T.Matrix2D(scale, 0, 0, scale, delta.x, delta.y), matrixC = new T.Matrix2D(1, 0, 0, 1, mapPoint.x, mapPoint.y), m = matrixC.multiplyBy(matrixB).multiplyBy(matrixA);
                if (T.AnimUtil.canAnim()) {
                    m = m.multiplyBy(this.animMatrix); T.AnimUtil.setMatrix(this.map.$layers, m.toString());
                }
            }, onPinchZoomChanged: function (evt, center, scale, delta) {
                var mapPoint = this.map.computeMousePosition(new T.Point(center.x, center.y)).substract(this.map.getLayersPos()), matrixA = new T.Matrix2D(1, 0, 0, 1, -mapPoint.x, -mapPoint.y), matrixB = new T.Matrix2D(scale, 0, 0, scale, delta.x, delta.y), matrixC = new T.Matrix2D(1, 0, 0, 1, mapPoint.x, mapPoint.y), m = matrixC.multiplyBy(matrixB).multiplyBy(matrixA);
                this.animMatrix = m.multiplyBy(this.animMatrix);
            }, onPinchZoomEnd: function (evt, center, scale, delta) {
                var zoomDiff = Math.log(this.animMatrix.m11) / Math.LN2;
                var zoom = (this.map.getZoom() + (this.animMatrix.m11 < 1 ? Math.floor(zoomDiff) : Math.ceil(zoomDiff))) || 1; var newScale = (this.animMatrix.m11 < 1 ? Math.floor(zoomDiff) : Math.ceil(zoomDiff));
                var mapPoint = this.map.computeMousePosition(new T.Point(center.x + delta.x, center.y + delta.y)).substract(this.map.getLayersPos());
                var topleft = this.map.getTopLeftInPixels(); var inverse = this.animMatrix.inverse(); var newMapPoint = new T.Point(mapPoint.x * (inverse.m11) + inverse.m13, mapPoint.y * (inverse.m22) + inverse.m23);
                var point = topleft.add(newMapPoint); var latLng = this.map.unproject(point); var newPoint = this.map.project(latLng, zoom);
                var center = newPoint.substract(new T.Point(center.x + delta.x, center.y + delta.y)).add(this.map.getSize().divideBy(2));
                var centerLatLng = this.map.unproject(center, zoom); this.map.resetView(centerLatLng, zoom, true); this.animMatrix = new T.Matrix2D();
            }, disable: function (handlerRegion) {
                switch (handlerRegion) {
                    case T.TouchHandler.TAPS: this.touchUtil.events.detach("tap", this.onTap);
                        this.touchUtil.events.detach("double-tap", this.onDoubleTap); this.touchUtil.events.detach("long-tap", this.onLongTap);
                        break; case T.TouchHandler.MOVE: this.touchUtil.events.detach("touch-start", this.onTouchStart); this.touchUtil.events.detach("touch-move-start", this.onTouchStart);
                            this.touchUtil.events.detach("touch-move", this.onTouchMove); this.touchUtil.events.detach("touch-end", this.onTouchEnd);
                            this.touchUtil.events.detach("touch-pinch", this.onPinchZoom); this.touchUtil.events.detach("touch-pinch-change", this.onPinchZoomChanged);
                            this.touchUtil.events.detach("touch-pinch-end", this.onPinchZoomEnd); break; default: this.touchUtil.events.detach("tap", this.onTap, this);
                                this.touchUtil.events.detach("double-tap", this.onDoubleTap, this); this.touchUtil.events.detach("long-tap", this.onLongTap, this);
                                this.touchUtil.events.detach("touch-start", this.onTouchStart, this); this.touchUtil.events.detach("touch-move-start", this.onTouchStart, this);
                                this.touchUtil.events.detach("touch-move", this.onTouchMove, this); this.touchUtil.events.detach("touch-end", this.onTouchEnd, this);
                                this.touchUtil.events.detach("touch-pinch", this.onPinchZoom, this); this.touchUtil.events.detach("touch-pinch-change", this.onPinchZoomChanged, this);
                                this.touchUtil.events.detach("touch-pinch-end", this.onPinchZoomEnd, this); this.touchUtil.disable(); break;
                }
            }, enable: function (handlerRegion) {
                switch (handlerRegion) {
                    case T.TouchHandler.TAPS: this.touchUtil.events.on("tap", this.onTap, this);
                        this.touchUtil.events.on("double-tap", this.onDoubleTap, this); this.touchUtil.events.on("long-tap", this.onLongTap, this);
                        break; case T.TouchHandler.MOVE: this.touchUtil.events.on("touch-start", this.onTouchStart, this); this.touchUtil.events.on("touch-move-start", this.onTouchStart, this);
                            this.touchUtil.events.on("touch-move", this.onTouchMove, this); this.touchUtil.events.on("touch-end", this.onTouchEnd, this);
                            this.touchUtil.events.on("touch-pinch", this.onPinchZoom, this); this.touchUtil.events.on("touch-pinch-change", this.onPinchZoomChanged, this);
                            this.touchUtil.events.on("touch-pinch-end", this.onPinchZoomEnd, this); break; default: this.touchUtil.events.on("tap", this.onTap, this);
                                this.touchUtil.events.on("double-tap", this.onDoubleTap, this); this.touchUtil.events.on("long-tap", this.onLongTap, this);
                                this.touchUtil.events.on("touch-start", this.onTouchStart, this); this.touchUtil.events.on("touch-move-start", this.onTouchStart, this);
                                this.touchUtil.events.on("touch-move", this.onTouchMove, this); this.touchUtil.events.on("touch-end", this.onTouchEnd, this);
                                this.touchUtil.events.on("touch-pinch", this.onPinchZoom, this); this.touchUtil.events.on("touch-pinch-change", this.onPinchZoomChanged, this);
                                this.touchUtil.events.on("touch-pinch-end", this.onPinchZoomEnd, this); this.touchUtil.enable(); break;
                }
            }, remove: function () {
                this.touchUtil.disable();
                this.touchUtil.events.detachAll(); this.map = null; this.touchUtil = null;
            }, doubleTouchZoom: function (evt) {
                var util = T.DomEventUtil, touchEvent = this.getPointerEvent(evt), mousePosition = this.map.computeMousePosition(touchEvent), centerInPixels = this.calculateCenterInPixels(mousePosition), center = this.map.unproject(centerInPixels);
                util.stop(evt); this.map.zoomAround(center, this.map.getZoom() + 1, true);
            }, calculateCenterInPixels: function (mousePosition) {
                var pos = mousePosition.substract(this.map.getLayersPos()).add(this.map.getTopLeftInPixels());
                return pos;
            }, getPointerEvent: function (event) {
                return event.changedTouches ? event.changedTouches[0] : event;
            }, handleCanvasLayerEvents: function (targetObject, evt, eventToFire, callback) {
                var geometryFound = targetObject.getTargetedGeometry(evt);
                if (!geometryFound) {
                    targetObject.$canvas.style.display = "none"; var newTarget = document.elementFromPoint(evt.clientX, evt.clientY);
                    evt.target = newTarget; callback.call(this, evt, true); targetObject.$canvas.style.display = "block";
                } else {
                    if (eventToFire) {
                        geometryFound.events.fire(eventToFire, evt);
                        this.customizedEventHandling(targetObject, eventToFire, geometryFound, evt);
                    }
                }
            }, customizedEventHandling: function (target, eventName, object, evt) {
                if (target.handleEvents) {
                    target.handleEvents(eventName, object, evt);
                }
            }, findEventInteractiveTarget: function (src) {
                while (src) {
                    var target = src.interactiveObject; if (target) {
                        return target;
                    } if (src === this.map.$container.layers) { break; } src = src.parentNode;
                } return null;
            }
        }; exports.TouchHandler = TouchHandler;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Map = function (container, options) {
            if (!container) {
                throw new Error("Map container not found.");
            } this._targets = {}; this.layersArray = []; this.options = T.Util.defaults(options, this.options); this.zoom = this.options.zoom;
            this.center = this.options.center; this.events = new T.EventDispatcher(); this.lastTransform = { matrix: new T.Matrix2D() };
            this.initContainer(container); if (!this.options.skipDefaultHandlers) { this.initHandlers(); } this.initControls();
            this.initPosition(); this.resetView(this.center, this.zoom);
        }; Map.prototype = {
            options: { zoom: 5, minZoom: 1, maxZoom: 18, maxExtent: null, center: new T.LatLng(46, 2), crs: new T.Crs({ code: "EPSG:3857" }), repeatX: true, repeatY: false, urlLocation: false, noHistory: true, geolocate: false, controls: { attribution: { prefix: "<a target='_blank' href='http://www.tibco.com/assets/blt59b361e6644c8d3a/tibco-end-user-license-agreement_tcm8-9378.pdf'>TIBCO GeoAnalytics</a>" } } }, initContainer: function (container) {
                this.$container = container;
                this.$container.map = this; this.$container.style.overflow = "hidden"; this.$container.style.position = "relative";
                T.DomUtil.addClass(this.$container, "tibco-map"); var layers = this.$container.layers = T.DomUtil.create("div", "layers-container", this.$container, "layers-container");
                var controls = this.$container.controls = T.DomUtil.create("div", "controls-container", this.$container); layers.style.position = "absolute";
                T.DomUtil.position(layers, new T.Point(0, 0)); T.DomEventUtil.on(window, "resize", this.reset, this); this.$layers = layers;
            }, destroy: function () {
                var i = 0; T.DomEventUtil.off(window, "resize", this.reset, this); for (i = 0; i < this.layersArray.length;
                i++) { this.removeLayer(this.layersArray[i]); } this.$layers = null; this.layersArray = null; this.uninitHandlers();
                this.$container.map = null; this.$container.innerHTML = "";
            }, initHandlers: function () {
                this.mouseHandler = new T.MouseHandler();
                this.addHandler(this.mouseHandler); if (T.Util.touchSupport()) {
                    this.touchHandler = new T.TouchHandler(); this.addHandler(this.touchHandler);
                }
            }, uninitHandlers: function () {
                if (this.mouseHandler) { this.removeHandler(this.mouseHandler); } if (this.touchHandler) {
                    this.removeHandler(this.touchHandler);
                }
            }, initControls: function () {
                if (!(this.options.controls.contextMenu && this.options.controls.contextMenu.addToMap === false)) {
                    this.addControl(new T.ContextMenuControl(this.options.controls.contextMenu));
                } if (!(this.options.controls.attribution && this.options.controls.attribution.addToMap === false)) {
                    this.addControl(new T.AttributionControl(this.options.controls.attribution));
                } if (!(this.options.controls.scale && this.options.controls.scale.addToMap === false)) {
                    this.addControl(new T.ScaleControl(this.options.controls.scale));
                }
            }, initPosition: function () {
                if (this.options.geolocate && T.Util.browserSupportsGeolocation()) {
                    this.setPositionFromGeolocation();
                } else { this.setPositionFromUrl(); }
            }, addHandler: function (handler) { handler.init(this); }, removeHandler: function (handler) {
                handler.uninit();
            }, addControl: function (control) { control.onAdd(this); return this; }, reset: function () {
                this.resetView(this.getCenter(), this.zoom);
            }, resetView: function (center, zoom, hard) {
                this.sizeChanged = true; if (this.lastTransform.matrix) {
                    var matrix = this.lastTransform.matrix;
                    if (matrix.m11 === 1 && matrix.m22 === 1) {
                        matrix = this.computeTransformMatrix(this.calculateCenterInPixel(), zoom);
                    } matrix.m13 += this.getLayersPos().x; matrix.m23 += this.getLayersPos().y;
                } this.zoom = this.limitZoom(zoom);
                this.center = center; T.DomUtil.position(this.$container.layers, new T.Point(0, 0)); T.AnimUtil.reset(this.$layers);
                if (hard) { this.events.fire("hard-reset"); } this.events.fire("view-reset");
            }, addLayer: function (layer) {
                this.layersArray.push(layer);
                layer.onAdd(this); this.events.fire("layer-add", layer); return this;
            }, removeLayer: function (layer) {
                var layerIndex = this.getLayerIndex(layer);
                if (layerIndex === -1) { return; } this.layersArray.splice(layerIndex, 1); layer.onRemove(); this.events.fire("layer-remove", layer);
                return this;
            }, getSize: function () {
                if (!this.size || this.sizeChanged) {
                    this.size = new T.Point(this.$container.clientWidth, this.$container.clientHeight);
                    this.sizeChanged = false;
                } return this.size.clone();
            }, setDefaults: function (defaults) {
                this.options = T.Util.defaults(defaults, this.options);
            }, setCrs: function (crs) {
                this.options.crs = crs; this.options.minZoom = 0; this.options.maxZoom = crs.resolutions.length - 1;
                this.events.fire("zoom-interval-change");
            }, setCenter: function (center) {
                this.resetView(center, this.getZoom());
            }, setZoom: function (zoom) { this.zoomAround(this.calculateCenter(), zoom); }, setUrlLocation: function () {
                var urlLocationString = null;
                if (this.options.urlLocation) {
                    urlLocationString = "@" + this.getCenter().lat.toFixed(7) + "," + this.getCenter().lng.toFixed(7) + "," + this.getZoom() + "z";
                    if (T.Util.browserSupportsHistoryApi()) {
                        T.Util.setBrowserHistory("#" + urlLocationString, this.options.noHistory);
                        T.Util.handleBrowserNavigation(T.Util.bind(function () { }, this));
                    } else {
                        T.Util.setBrowserUrlHash(urlLocationString);
                    }
                }
            }, setPositionFromUrl: function () {
                var urlPosition = T.Util.getBrowserUrlHash(), urlContent = null, urlItems = [], latitude = null, longitude = null, zoom = null;
                if (!this.options.urlLocation) { return; } if (urlPosition && urlPosition.length > 1) {
                    urlContent = urlPosition.substring(1, urlPosition.length);
                    urlItems = urlContent.split(","); if (urlItems.length === 3) {
                        latitude = parseFloat(urlItems[0].substring(1, urlItems[0].length));
                        longitude = parseFloat(urlItems[1]); zoom = parseInt(urlItems[2], 10); this.center = new T.LatLng(latitude, longitude);
                        this.zoom = zoom; this.resetView(this.center, this.zoom);
                    } else {
                        this.zoom = this.options.zoom; this.center = this.options.center;
                        this.resetView(this.center, this.zoom);
                    }
                }
            }, setPositionFromGeolocation: function () {
                T.Util.geolocate(T.Util.bind(function (latitude, longitude) {
                    if (latitude && longitude) {
                        this.center = new T.LatLng(latitude, longitude);
                        this.zoom = 14; this.resetView(this.center, this.zoom);
                    } else { this.setPositionFromUrl(); }
                }, this), T.Util.bind(function (error) {
                    this.setPositionFromUrl();
                }, this));
            }, getZoom: function () { return this.zoom; }, getCenter: function () { return this.calculateCenter(); }, getViewportCenter: function () {
                return this.center.clone();
            }, getCenterInPixels: function () { return this.project(this.getViewportCenter(), this.getZoom()); }, getTopLeftInPixels: function () {
                return this.getCenterInPixels().substract(this.getSize().divideBy(2));
            }, getResolution: function () { return this.options.crs.resolution(this.zoom); }, latLngToPoint: function (latlng) {
                latlng = T.LatLng.from(latlng);
                var projectedPoint = this.project(latlng).round(); return projectedPoint.substract(this.getTopLeftInPixels());
            }, pointToLatLng: function (point) {
                var projectedPoint = point.add(this.getTopLeftInPixels()); return this.unproject(projectedPoint);
            }, getLayersCenter: function () {
                var layerPoint = this.getSize().divideBy(2).substract(this.getLayersPos());
                return layerPoint;
            }, getPixelBounds: function () {
                var topLeft = this.calculateTopLeft(); return new T.Bounds(topLeft, topLeft.add(this.getSize()));
            }, getLayersPos: function () { return T.DomUtil.position(this.$container.layers); }, getLayers: function () {
                return this.layersArray;
            }, calculateCenter: function () { return this.unproject(this.calculateCenterInPixel()); }, calculateCenterInPixel: function () {
                var projectedCenter = this.getLayersCenter().add(this.getTopLeftInPixels());
                return projectedCenter;
            }, calculateTopLeft: function () {
                var half = this.getSize().divideBy(2); var topLeft = this.getCenterInPixels().substract(half).substract(this.getLayersPos());
                return topLeft;
            }, latLngToContainerPoint: function (latlng) {
                latlng = T.LatLng.from(latlng); var projectedPoint = this.project(latlng).round();
                return projectedPoint.substract(this.calculateTopLeft());
            }, containerPointToLatLng: function (point) {
                return this.unproject(this.calculateTopLeft().add(point));
            }, getMapResolution: function () {
                var point = this.getCenter(); var zoom = this.getZoom(); var tileSize = 256; var earthRadius = 6378137;
                var res = (Math.cos(point.lat * Math.PI / 180) * 2 * Math.PI * earthRadius) / (tileSize * Math.pow(2, zoom)); return res;
            }, metersToArcAngle: function (meters, latlng) {
                var equatorialArc = meters * 360 / 40075016; return equatorialArc / Math.cos(latlng.lat * Math.PI / 180);
            }, panBy: function (offset, skipRefresh) {
                if (this.animatingZoom) { return; } this.events.fire("move-start"); T.DomUtil.position(this.$container.layers, this.getLayersPos().add(offset));
                this.events.fire("move"); if (!skipRefresh) { this.events.fire("move-end"); } return this;
            }, zoomAround: function (latlng, zoom, withAnim, force) {
                zoom = this.limitZoom(zoom);
                withAnim = withAnim || false; if (zoom === this.zoom && !force) { return; } var point = this.project(latlng); var newPoint = this.project(latlng, zoom);
                var diff = newPoint.substract(point); var pixelCenter = this.calculateCenterInPixel().add(diff); var latLngCenter = this.unproject(pixelCenter, zoom);
                var matrix = this.computeTransformMatrix(point, zoom); if (T.AnimUtil.canAnim() && withAnim) {
                    if (this.animatingZoom) {
                        return;
                    } this.animatingZoom = true; if (this.mouseHandler) { this.mouseHandler.disable(T.MouseHandler.DRAG); } if (this.touchHandler) {
                        this.touchHandler.disable(T.TouchHandler.MOVE);
                    } var self = this; T.AnimUtil.onTransitionEnd(this.$layers, function () {
                        if (self.mouseHandler) {
                            self.mouseHandler.enable(T.MouseHandler.DRAG);
                        } if (self.touchHandler) { self.touchHandler.enable(T.TouchHandler.MOVE); } self.animatingZoom = null; self.lastTransform.matrix = new T.Matrix2D(T.AnimUtil.getTransform(self.$layers));
                        self.resetView(latLngCenter, zoom);
                    }); T.AnimUtil.transition(this.$layers, 0.1); T.AnimUtil.setMatrix(this.$layers, matrix.toString());
                } else { this.lastTransform.matrix = matrix; this.resetView(latLngCenter, zoom); }
            }, limitBounds: function () {
                if (!this.options.maxExtent) {
                    return;
                } var currentBounds = this.getBounds(), maxBounds = this.options.maxExtent, newBounds = new T.LatLngBounds(currentBounds.getSouthWest(), currentBounds.getNorthEast()), boundsChanged = false;
                if (!T.Util.floatEqual(currentBounds.northEast.lat, maxBounds.northEast.lat) && currentBounds.northEast.lat > maxBounds.northEast.lat) {
                    boundsChanged = true;
                    newBounds.northEast.lat = maxBounds.northEast.lat; newBounds.southWest.lat -= currentBounds.northEast.lat - maxBounds.northEast.lat;
                } else {
                    if (!T.Util.floatEqual(currentBounds.southWest.lat, maxBounds.southWest.lat) && currentBounds.southWest.lat < maxBounds.southWest.lat) {
                        boundsChanged = true;
                        newBounds.southWest.lat = maxBounds.southWest.lat; newBounds.northEast.lat -= currentBounds.southWest.lat - maxBounds.southWest.lat;
                    }
                } if (!T.Util.floatEqual(currentBounds.northEast.lng, maxBounds.northEast.lng) && currentBounds.northEast.lng > maxBounds.northEast.lng) {
                    boundsChanged = true;
                    newBounds.northEast.lng = maxBounds.northEast.lng; newBounds.southWest.lng -= currentBounds.northEast.lng - maxBounds.northEast.lng;
                } else {
                    if (!T.Util.floatEqual(currentBounds.southWest.lng, maxBounds.southWest.lng) && currentBounds.southWest.lng < maxBounds.southWest.lng) {
                        boundsChanged = true;
                        newBounds.southWest.lng = maxBounds.southWest.lng; newBounds.northEast.lng -= currentBounds.southWest.lng - maxBounds.southWest.lng;
                    }
                } if (boundsChanged) { this.fitToBounds(newBounds, 20); }
            }, limitZoom: function (zoom) {
                var maxExtentZoom = (this.options.maxExtent) ? this.getZoomForBounds(this.options.maxExtent) + 1 : zoom;
                return T.Util.maxMin(this.options.maxZoom, maxExtentZoom, T.Util.minMax(this.options.minZoom, this.options.maxZoom, zoom));
            }, project: function (latlng, zoom) {
                zoom = zoom === undefined ? this.zoom : zoom; return this.options.crs.latLngToPoint(latlng, zoom);
            }, unproject: function (point, zoom) {
                zoom = zoom === undefined ? this.zoom : zoom; return this.options.crs.pointToLatLng(point, zoom);
            }, transform: function (point, zoom) {
                zoom = zoom === undefined ? this.zoom : zoom; return this.options.crs.transform(point, zoom);
            }, untransform: function (point, zoom) {
                zoom = zoom === undefined ? this.zoom : zoom; return this.options.crs.untransform(point, zoom);
            }, fitToBounds: function (bounds, tolerance, hard) {
                var zoom = this.getZoomForBounds(bounds, tolerance); var ne = this.project(bounds.getNorthEast(), zoom);
                var sw = this.project(bounds.getSouthWest(), zoom); var center = this.unproject(sw.add(ne).divideBy(2), zoom);
                this.resetView(center, zoom, hard);
            }, getBounds: function () {
                var pixelBounds = this.getPixelBounds(); var bottomLeft = this.unproject(pixelBounds.bottomLeft());
                var topRight = this.unproject(pixelBounds.topRight()); var bounds = new T.LatLngBounds(bottomLeft, topRight);
                return bounds;
            }, getProjectedBounds: function () {
                var key, queryParams = this.options.queryParams, image = this.image, crs = this.options.crs, size = this.getSize(), bottomLeft = new T.Point(0, 0), topRight = new T.Point(0, 0), projCenter = this.untransform(this.calculateCenterInPixel()), half = size.divideBy(2).multiplyBy(crs.resolutions[this.getZoom()]);
                bottomLeft.x = projCenter.x - half.x; bottomLeft.y = projCenter.y - half.y; topRight.x = projCenter.x + half.x; topRight.y = projCenter.y + half.y;
                var bounds = new T.Bounds(bottomLeft, topRight); return bounds;
            }, getZoomForBounds: function (bounds, tolerance) {
                var zoom = this.options.minZoom, viewportSize = this.getSize(), i = 0;
                tolerance = tolerance || 0; for (i = this.options.minZoom; i <= this.options.maxZoom; i++) {
                    var topRight = this.project(bounds.getNorthEast(), i);
                    var bottomLeft = this.project(bounds.getSouthWest(), i); var bWidth = topRight.x - bottomLeft.x; var bHeight = bottomLeft.y - topRight.y;
                    if (bWidth - tolerance <= viewportSize.x && bHeight - tolerance <= viewportSize.y) { zoom = i; }
                } return zoom;
            }, getLayerIndex: function (layer) {
                return this.layersArray.indexOf(layer);
            }, getTileLayer: function () {
                var i = 0; for (i = 0; i < this.layersArray.length; i++) {
                    if (this.layersArray[i] instanceof T.TibcoLayer || this.layersArray[i] instanceof T.TileLayer || this.layersArray[i] instanceof T.GoogleLayer) {
                        return this.layersArray[i];
                    }
                } return null;
            }, computeMousePosition: function (evt) {
                var point; if (evt instanceof T.Point) { point = evt; } else {
                    if (arguments.length === 2) {
                        point = new T.Point(arguments[0], arguments[1]);
                    } else { point = new T.Point(evt.clientX, evt.clientY); }
                } var offset = T.DomUtil.calculateElementClientOffset(this.$container);
                var containerOffset = new T.Point(offset.left, offset.top); var mousePosition = new T.Point(point.x, point.y).substract(containerOffset);
                return mousePosition;
            }, moveLayer: function (layer, newLayerIndex) {
                if (!layer || layer.getIndex() === newLayerIndex || newLayerIndex < 0 || newLayerIndex >= this.layersArray.length) {
                    return;
                } var referenceLayerElement = this.$layers.children.item(newLayerIndex); layer.getContainer().parentNode.removeChild(layer.getContainer());
                if (layer.getIndex() > newLayerIndex) {
                    this.$layers.insertBefore(layer.getContainer(), referenceLayerElement);
                } else {
                    referenceLayerElement.parentNode.insertBefore(layer.getContainer(), referenceLayerElement.nextSibling);
                } this.layersArray.splice(layer.getIndex(), 1); this.layersArray.splice(newLayerIndex, 0, layer); this.events.fire("layer-moved", layer);
            }, moveLayerUp: function (layer) {
                if (layer.getIndex() !== -1 && layer.getIndex() !== this.layersArray.length - 1) {
                    this.moveLayer(layer, layer.getIndex() + 1);
                }
            }, moveLayerDown: function (layer) {
                if (layer.getIndex() !== -1 && layer.getIndex() !== 0) {
                    this.moveLayer(layer, layer.getIndex() - 1);
                }
            }, computeTransformMatrix: function (point, zoom) {
                var zoomDiff = zoom - this.getZoom(); var ratio = Math.pow(2, zoomDiff);
                var posDiff = this.getLayersPos().substract(point.substract(this.calculateTopLeft())); var newPosition = posDiff.multiplyBy(ratio).substract(posDiff);
                var matrix = new T.Matrix2D(ratio, 0, 0, ratio, newPosition.x, newPosition.y); return matrix;
            }, onBeforeDragStart: function (evt) {
                this.startPoint = new T.Point(evt.clientX, evt.clientY);
                this.startPos = T.DomUtil.position(this.$container.layers);
            }, onDragStart: function (evt) {
                var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint);
                this.moved = true; this.startPos = T.DomUtil.position(this.$container.layers).substract(offset);
            }, onDrag: function (evt) {
                var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint), newPosition = this.startPos.add(offset);
                T.DomUtil.position(this.$container.layers, newPosition); this.events.fire("move", evt);
            }, onDragEnd: function (evt) {
                this.events.fire("move-end", evt);
            }
        }; exports.Map = Map;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var MapTypes = { STANDARD: "Standard map", STANDARD_LIGHT: "Standard map - light", BASIC: "Basic map", BASIC_LIGHT: "Basic map - light", BORDERS: "Borders", LABELS: "Labels", ROADS: "Roads", };
        exports.MapTypes = MapTypes;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var MapStyles = { LIGHT: "Light", DARK: "Dark" };
        exports.MapStyles = MapStyles;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Path = function (options) {
            this.type = "path";
            this.options = T.Util.defaults(options, this.options); this.style = T.Util.defaults({}, this.options.style);
            this.events = new T.EventDispatcher();
        }; Path.prototype = {
            options: { path: "", clickable: true, reverseCoordinates: false }, style: null, initContainer: function () {
                if (this.context) {
                    this.context.initContainer(this);
                }
            }, setStyle: function (style) { T.Util.extend(this.style, style); this.draw(); }, handleEvents: function (eventName, evt) {
                this.layer.events.fire(eventName, this, evt);
            }, getStyle: function () { return this.context.options.style; }, projectCoords: function () { }, reset: function () {
                if (this.context) {
                    this.projectCoords();
                    this.draw();
                }
            }, draw: function () {
                if (this.context) {
                    this.context.applyStyle(this); this.context.draw(this);
                }
            }, extendBounds: function (coords, bounds) {
                if (!T.Util.isArray(coords[0])) {
                    var latLng = this.options.reverseCoordinates ? new T.LatLng(coords[1], coords[0]) : new T.LatLng(coords[0], coords[1]);
                    bounds.extend(latLng); return;
                } var i; for (i = 0; i < coords.length; i++) {
                    this.extendBounds(coords[i], bounds);
                }
            }, getBounds: function () {
                if (!this.coords) { return; } var bounds = new T.LatLngBounds(); this.extendBounds(this.coords, bounds);
                return bounds;
            }, onAdd: function (layer) {
                var defaultStyle = T.Util.clone(layer.options.defaultStyle); this.layer = layer;
                this.context = layer.context; this.initContainer(); this.setStyle(T.Util.extend(defaultStyle, this.style));
                this.reset();
            }, onRemove: function (layer) {
                this.context.dispose(this); this.context = null; this.layer = null;
            }
        }; exports.Path = Path;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Polyline = function (coords, options) {
            T.Path.call(this, options);
            this.type = "polyline"; this.coords = coords; this.projectedCoords = []; this.noneFillGeometry = true;
        }; Polyline.prototype = {
            projectCoords: function () {
                var i, j;
                this.projectedCoords = []; for (i = 0; i < this.coords.length; i++) {
                    this.projectedCoords.push(this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? this.coords[i].concat().reverse() : this.coords[i]).floor());
                }
            }
        }; T.Util.inherit(Polyline, T.Path); exports.Polyline = Polyline;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Polygon = function (coords, options) {
            T.Path.call(this, options);
            this.type = "polygon"; this.coords = coords; this.projectedCoords = [];
        }; Polygon.prototype = {
            projectCoords: function () {
                var i, j, k, line;
                this.projectedCoords = []; for (i = 0; i < this.coords.length; i++) {
                    line = []; for (j = 0; j < this.coords[i].length; j++) {
                        line.push(this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? this.coords[i][j].concat().reverse() : this.coords[i][j]).floor());
                    } this.projectedCoords.push(line);
                }
            }
        }; T.Util.inherit(Polygon, T.Path); exports.Polygon = Polygon;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var MultiPolyline = function (coords, options) {
            T.Path.call(this, options);
            this.type = "multipolyline"; this.coords = coords; this.projectedCoords = []; this.noneFillGeometry = true;
        }; MultiPolyline.prototype = {
            projectCoords: function () {
                var i, j, k, line = [];
                this.projectedCoords = []; for (i = 0; i < this.coords.length; i++) {
                    line = []; for (j = 0; j < this.coords[i].length; j++) {
                        line.push(this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? this.coords[i][j].concat().reverse() : this.coords[i][j]).floor());
                    } this.projectedCoords.push(line);
                }
            }
        }; T.Util.inherit(MultiPolyline, T.Path); exports.MultiPolyline = MultiPolyline;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var MultiPolygon = function (coords, options) {
            T.Path.call(this, options);
            this.type = "multipolygon"; this.coords = coords; this.projectedCoords = [];
        }; MultiPolygon.prototype = {
            projectCoords: function () {
                var i, j, k, line = [], poly = [];
                this.projectedCoords = []; for (k = 0; k < this.coords.length; k++) {
                    poly = []; for (i = 0; i < this.coords[k].length; i++) {
                        line = [];
                        for (j = 0; j < this.coords[k][i].length; j++) {
                            line.push(this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? this.coords[k][i][j].concat().reverse() : this.coords[k][i][j]).floor());
                        } poly.push(line);
                    } this.projectedCoords.push(poly);
                }
            }
        }; T.Util.inherit(MultiPolygon, T.Path); exports.MultiPolygon = MultiPolygon;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Rectangle = function (bounds, options) {
            T.Polygon.call(this, this.boundsToCoordinates(bounds), options);
            this.type = "rectangle"; this.projectedCoords = [];
        }; Rectangle.prototype = {
            setBounds: function (bounds) {
                this.coords = this.boundsToCoordinates(bounds);
                this.reset();
            }, boundsToCoordinates: function (bounds) {
                bounds = T.LatLngBounds.from(bounds); return [[bounds.getSouthWest(), bounds.getSouthEast(), bounds.getNorthEast(), bounds.getNorthWest()]];
            }
        }; T.Util.inherit(Rectangle, T.Polygon); exports.Rectangle = Rectangle;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Circle = function (center, radius, options) {
            T.Path.call(this, options);
            this.type = "circle"; this.radius = radius || 100; this.center = T.LatLng.from(center); this.radiusMeasure = options.radiusMeasure === "meter" ? options.radiusMeasure : "pixel";
            this.isDraggable = true;
        }; Circle.prototype = {
            setRadius: function (radius) {
                this.radius = radius; this.reset();
            }, setCenter: function (center) { this.center = T.LatLng.from(center); this.reset(); }, projectCoords: function () {
                this.projectedCenter = this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? [this.center.lng, this.center.lat] : [this.center.lat, this.center.lng]).floor();
                if (this.radiusMeasure === "meter") {
                    var diff = this.layer.map.metersToArcAngle(this.radius, this.center); this.porjectedStartPoint = this.layer.map.latLngToContainerPoint(this.options.reverseCoordinates ? [this.center.lng, this.center.lat - diff] : [this.center.lat, this.center.lng - diff]).floor();
                } else { this.porjectedStartPoint = this.projectedCenter.clone().substract(new T.Point(this.radius, 0)); }
            }
        };
        T.Util.inherit(Circle, T.Path); exports.Circle = Circle;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var SvgContext = function (svg, options) {
            this.options = T.Util.defaults(options, this.options);
            this.$svg = svg;
        }; SvgContext.prototype = {
            initContainer: function (geometry) {
                if (!geometry.$container) {
                    geometry.$container = T.DomUtil.createSvgElement("g");
                    geometry.$path = T.DomUtil.createSvgElement("path"); geometry.$path.setAttributeNS(null, "fill-rule", "evenodd");
                    geometry.$path.style.pointerEvents = "visiblepainted"; geometry.$container.appendChild(geometry.$path);
                } this.$svg.$g.appendChild(geometry.$container);
            }, applyStyle: function (geometry) {
                var style = geometry.style; if (style.stroke) {
                    geometry.$path.setAttributeNS(null, "stroke", style.color);
                    geometry.$path.setAttributeNS(null, "stroke-opacity", style.opacity); geometry.$path.setAttributeNS(null, "stroke-width", style.weight);
                    geometry.$path.setAttributeNS(null, "stroke-linecap", style.lineCap); geometry.$path.setAttributeNS(null, "stroke-linejoin", style.lineJoin);
                    geometry.$path.setAttributeNS(null, "stroke-miterlimit", style.miterLimit); geometry.$path.setAttributeNS(null, "stroke-dasharray", style.dashArray);
                } else { geometry.$path.setAttribute("stroke", "none"); } if (style.fill && !geometry.noneFillGeometry) {
                    geometry.$path.setAttributeNS(null, "fill", style.fillColor || style.color);
                    geometry.$path.setAttributeNS(null, "fill-opacity", style.fillOpacity);
                } else {
                    geometry.$path.setAttributeNS(null, "fill", "none");
                }
            }, getPathString: function (geometry) {
                var coords = geometry.projectedCoords; var i, j, k, path = ""; if (geometry.type !== "circle" && coords.length === 0) {
                    return;
                } switch (geometry.type) {
                    case "polyline": path = "M " + coords[0].x + " " + coords[0].y; for (i = 1; i < coords.length; i++) {
                        path += "L " + coords[i].x + " " + coords[i].y;
                    } return path; case "polygon": case "rectangle": for (i = 0; i < coords.length; i++) {
                        for (j = 0; j < coords[i].length; j++) {
                            if (j === 0) {
                                path += "M " + coords[i][0].x + " " + coords[i][0].y;
                                continue;
                            } path += "L " + coords[i][j].x + " " + coords[i][j].y;
                        } path += " Z ";
                    } return path; case "multipolyline": for (i = 0;
                    i < coords.length; i++) {
                        for (j = 0; j < coords[i].length; j++) {
                            if (j === 0) {
                                path += "M " + coords[i][0].x + " " + coords[i][0].y;
                                continue;
                            } path += "L " + coords[i][j].x + " " + coords[i][j].y;
                        }
                    } return path; case "multipolygon": for (k = 0; k < coords.length;
                    k++) {
                        for (i = 0; i < coords[k].length; i++) {
                            for (j = 0; j < coords[k][i].length; j++) {
                                if (j === 0) {
                                    path += "M " + coords[k][i][0].x + " " + coords[k][i][0].y;
                                    continue;
                                } path += "L " + coords[k][i][j].x + " " + coords[k][i][j].y;
                            } path += " Z ";
                        }
                    } return path; case "circle": if (!geometry.projectedCenter) {
                        return;
                    } var radius = geometry.projectedCenter.x - geometry.porjectedStartPoint.x; path = "M " + geometry.porjectedStartPoint.x + " " + geometry.porjectedStartPoint.y;
                        path += " A " + radius + " " + radius; path += ",0,1,1, " + geometry.porjectedStartPoint.x + " " + (geometry.porjectedStartPoint.y + 0.01) + " Z";
                        return path;
                }
            }, draw: function (geometry) {
                var path = this.getPathString(geometry); if (path) {
                    geometry.$path.setAttributeNS(null, "d", path);
                } else { geometry.$path.setAttributeNS(null, "d", "M 0 0"); }
            }, dispose: function (geometry) {
                this.$svg.$g.removeChild(geometry.$container);
            }
        }; exports.SvgContext = SvgContext;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var CanvasContext = function (canvas, options) {
            this.options = T.Util.defaults(options, this.options);
            this.$canvas = canvas; this.ctx = this.$canvas.getContext("2d");
        }; CanvasContext.prototype = {
            initContainer: function (geometry) { }, applyStyle: function (geometry) {
                var style = geometry.style;
                if (style.stroke) {
                    this.ctx.strokeStyle = T.Util.hexToRgba(style.color, style.opacity); this.ctx.lineWidth = style.weight;
                    this.ctx.lineCap = style.lineCap; this.ctx.lineJoin = style.lineJoin; this.ctx.miterLimit = style.miterLimit;
                } if (style.fill) { this.ctx.fillStyle = T.Util.hexToRgba(style.fillColor || style.color, style.fillOpacity); }
            }, draw: function (geometry) {
                var coords = geometry.projectedCoords, style = geometry.style;
                var i, j, k, polygonPoints; this.ctx.beginPath(); switch (geometry.type) {
                    case "polyline": if (coords.length > 0) {
                        this.ctx.moveTo(coords[0].x, coords[0].y);
                        for (i = 1; i < coords.length; i++) { this.ctx.lineTo(coords[i].x, coords[i].y); }
                    } break; case "polygon": case "rectangle": if (coords.length > 0) {
                        for (i = 0;
                        i < coords.length; i++) {
                            polygonPoints = coords[i].concat(); if (i > 0) { polygonPoints.reverse(); } this.ctx.moveTo(polygonPoints[0].x, polygonPoints[0].y);
                            for (j = 1; j < polygonPoints.length; j++) { this.ctx.lineTo(polygonPoints[j].x, polygonPoints[j].y); } this.ctx.closePath();
                        }
                    } break; case "multipolyline": if (coords.length > 0) {
                        for (i = 0; i < coords.length; i++) {
                            polygonPoints = coords[i].concat();
                            this.ctx.moveTo(polygonPoints[0].x, polygonPoints[0].y); for (j = 1; j < polygonPoints.length; j++) {
                                this.ctx.lineTo(polygonPoints[j].x, polygonPoints[j].y);
                            }
                        }
                    } break; case "multipolygon": if (coords.length > 0) {
                        for (k = 0; k < coords.length; k++) {
                            for (i = 0; i < coords[k].length;
                            i++) {
                                polygonPoints = coords[k][i].concat(); if (i > 0) { polygonPoints.reverse(); } this.ctx.moveTo(polygonPoints[0].x, polygonPoints[0].y);
                                for (j = 1; j < polygonPoints.length; j++) { this.ctx.lineTo(polygonPoints[j].x, polygonPoints[j].y); } this.ctx.closePath();
                            }
                        }
                    } break; case "circle": if (!geometry.projectedCenter) { return; } var radius = geometry.projectedCenter.x - geometry.porjectedStartPoint.x;
                        this.ctx.arc(geometry.projectedCenter.x, geometry.projectedCenter.y, radius, 0, 2 * Math.PI); this.ctx.stroke();
                        break;
                } if (style.fill && !geometry.noneFillGeometry) { this.ctx.fill(); } if (style.stroke) {
                    this.ctx.stroke();
                }
            }, dispose: function (geometry) { this.draw(geometry); }
        }; exports.CanvasContext = CanvasContext;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var VmlContext = function (vml, options) {
            this.options = T.Util.defaults(options, this.options);
            this.$vml = vml;
        }; VmlContext.prototype = {
            initContainer: function (geometry) {
                if (!geometry.$container) {
                    geometry.$container = T.DomUtil.createVmlElement("shape");
                    var path = T.DomUtil.createVmlElement("path"); geometry.$container.appendChild(path); geometry.$container.$path = path;
                    geometry.$container.style.width = "1px"; geometry.$container.style.height = "1px"; geometry.$container.className = "tibco-vml";
                    geometry.$container.$path.className = "tibco-vml";
                } geometry.$container.coordsize = "1 1"; this.$vml.appendChild(geometry.$container);
            }, applyStyle: function (geometry) {
                var style = geometry.style; if (style.stroke) {
                    if (!geometry.$stroke) {
                        geometry.$stroke = T.DomUtil.createVmlElement("stroke");
                        geometry.$stroke.className = "tibco-vml"; geometry.$container.appendChild(geometry.$stroke);
                    } geometry.$stroke.color = style.color;
                    geometry.$stroke.weight = style.weight; geometry.$stroke.opacity = style.opacity; geometry.$container.stroked = "t";
                } else {
                    if (geometry.$stroke) { geometry.$container.removeChild(geometry.$stroke); } geometry.$container.stroked = "f";
                } if (style.fill && !geometry.noneFillGeometry) {
                    if (!geometry.$fill) {
                        geometry.$fill = T.DomUtil.createVmlElement("fill");
                        geometry.$fill.className = "tibco-vml"; geometry.$container.appendChild(geometry.$fill);
                    } geometry.$fill.color = style.fillColor || style.color;
                    geometry.$fill.opacity = style.fillOpacity; geometry.$container.filled = "t";
                } else {
                    if (geometry.$fill) {
                        geometry.$container.removeChild(geometry.$fill);
                    } geometry.$container.filled = "f";
                }
            }, getPathString: function (geometry) {
                var coords = geometry.projectedCoords;
                var i, j, k, path; if (geometry.type !== "circle" && coords.length === 0) { return; } switch (geometry.type) {
                    case "polyline": path = "M " + Math.round(coords[0].x) + " " + Math.round(coords[0].y);
                        for (i = 1; i < coords.length; i++) { path += "L " + Math.round(coords[i].x) + " " + Math.round(coords[i].y); } return path;
                    case "polygon": case "rectangle": for (i = 0; i < coords.length; i++) {
                        for (j = 0; j < coords[i].length; j++) {
                            if (j === 0) {
                                path += "M " + coords[i][0].x + " " + coords[i][0].y;
                                continue;
                            } path += "L " + coords[i][j].x + " " + coords[i][j].y;
                        } path += " X ";
                    } return path; case "multipolyline": for (i = 0;
                    i < coords.length; i++) {
                        for (j = 0; j < coords[i].length; j++) {
                            if (j === 0) {
                                path += "M " + coords[i][0].x + " " + coords[i][0].y;
                                continue;
                            } path += "L " + coords[i][j].x + " " + coords[i][j].y;
                        }
                    } return path; case "multipolygon": for (k = 0; k < coords.length;
                    k++) {
                        for (i = 0; i < coords[k].length; i++) {
                            for (j = 0; j < coords[k][i].length; j++) {
                                if (j === 0) {
                                    path += "M " + coords[k][i][0].x + " " + coords[k][i][0].y;
                                    continue;
                                } path += "L " + coords[k][i][j].x + " " + coords[k][i][j].y;
                            } path += " X ";
                        }
                    } return path; case "circle": if (!geometry.projectedCenter) {
                        return;
                    } var radius = geometry.projectedCenter.x - geometry.porjectedStartPoint.x; path = "AL " + Math.round(geometry.projectedCenter.x) + "," + Math.round(geometry.projectedCenter.y) + " " + Math.round(radius) + "," + Math.round(radius) + " 0," + (65535 * 360);
                        return path;
                }
            }, draw: function (geometry) {
                geometry.$container.style.display = "none"; geometry.$container.$path.v = this.getPathString(geometry) + " ";
                geometry.$container.style.display = "";
            }, dispose: function (geometry) {
                this.$vml.removeChild(geometry.$container);
            }
        }; exports.VmlContext = VmlContext;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var BaseLayer = function (options) {
            this.options = T.Util.defaults(options, this.options);
            this.name = this.options.name || ""; this.events = new T.EventDispatcher(); this.isClickableLayer = true;
        }; BaseLayer.prototype = {
            onRemove: function () {
                T.DomUtil.remove(this.getContainer());
                this.events.detachAll(); this.$container = null;
            }, reset: function () { }, getIndex: function () {
                if (!this.map) {
                    return -1;
                } return this.map.getLayerIndex(this);
            }, getContainer: function () { return this.$container; }, setVisible: function (visible) {
                if (visible === true) {
                    this.getContainer().style.display = "block";
                    this.map.events.fire("layer-show");
                } else {
                    if (visible === false) {
                        this.getContainer().style.display = "none";
                        this.map.events.fire("layer-hide");
                    }
                }
            }, isVisible: function () {
                return T.DomUtil.getStyle(this.getContainer(), "display") !== "none" ? true : false;
            }, setAsInteractiveTarget: function (targetElement, targetObject) {
                targetElement.interactiveObject = targetObject;
                return targetElement;
            }
        }; exports.BaseLayer = BaseLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.BaseLayer;
        var TileLayer = function (url, options) {
            if (!url) { } base.call(this, options); this.url = url; this.tilesToLoad = 0;
            this.delayedUpdate = T.Util.limitExecByInterval(this.move, 200, this); this.isDraggable = true;
        }; TileLayer.prototype = {
            options: { tileSize: 256, errorTileAttemptsThreshold: 1, reuseTiles: true, opacity: 1, autoLoadTiles: true, tile404: "https://geoanalytics.tibco.com/404.png", attribution: null }, initContainer: function () {
                if (!this.$container) {
                    this.$layerContainer = T.DomUtil.create("div", "tibco-layer tile-layer", this.map.$container.layers);
                    this.$container = T.DomUtil.create("div", "tibco-layer tile-layer-1", this.$layerContainer); this.$bufferContainer = T.DomUtil.create("div", "tibco-layer tile-layer-2", this.$layerContainer);
                    this.$layerContainer.style.position = "relative"; this.$container.style.position = "absolute"; this.$bufferContainer.style.position = "absolute";
                    this.$container.style.visibility = "visible"; this.$bufferContainer.style.visibility = "visible"; this.$container.layer = this;
                    this.$bufferContainer.layer = this;
                }
            }, reset: function () {
                this.tiles = {}; this.tilesToLoad = 0; this.unusedTiles = [];
                this.handleBackBuffer(); this.update(); this.map.setUrlLocation();
            }, move: function () {
                if (this.$container.style.visibility === "hidden") {
                    this.$container.style.visibility = "visible";
                    this.$container.style.zIndex = 0; this.$bufferContainer.style.zIndex = -1;
                } this.update();
            }, moveEnd: function () {
                this.move();
                this.map.setUrlLocation();
            }, addTile: function (point, $container) {
                var position = this.getTilePosition(point);
                var tile = this.getTile(); T.DomUtil.position(tile, position); this.storeTile(tile, point); this.loadTile(tile, point);
                $container.appendChild(tile);
            }, update: function () {
                if (!this.map) { return; } if (this.options.autoLoadTiles === true) {
                    this.reloadTiles();
                }
            }, reloadTiles: function () {
                var zoom = this.map.getZoom(), bounds = this.map.getPixelBounds(), tileSize = this.options.tileSize;
                var tileBounds = new T.Bounds(bounds.min.divideBy(tileSize).floor(), bounds.max.divideBy(tileSize).floor());
                this.tilesLoaded = 0; this.addTileFromBounds(tileBounds); this.removeInvisibleTiles(tileBounds);
            }, handleBackBuffer: function () {
                if (!this.IsBackbufferEnabled()) {
                    this.$container.innerHTML = "";
                    return;
                } var frontPercent = this.getLoadedTilesPercent(this.$container); var backPercent = this.getLoadedTilesPercent(this.$bufferContainer);
                if (frontPercent > 0.5 && backPercent < 0.5) {
                    var temp = this.$bufferContainer; this.$bufferContainer = this.$container;
                    this.$container = temp; this.$container.style.visibility = "hidden";
                } this.stopLoadingTiles(this.$container);
                this.$container.innerHTML = ""; this.$bufferContainer.style.visibility = "visible"; var matrix = this.map.lastTransform.matrix;
                if (!this.$bufferContainer.matrix) { this.$bufferContainer.matrix = new T.Matrix2D(); } this.$bufferContainer.matrix = matrix.multiplyBy(this.$bufferContainer.matrix);
                T.DomUtil.position(this.$bufferContainer, new T.Point(0, 0)); T.AnimUtil.setMatrix(this.$bufferContainer, this.$bufferContainer.matrix.toString());
                T.AnimUtil.setMatrix(this.$container, new T.Matrix2D());
            }, setOpacity: function (opacity) {
                this.options.opacity = opacity;
                var key, tiles = this.tiles; for (key in tiles) {
                    if (tiles.hasOwnProperty(key)) {
                        T.DomUtil.setOpacity(tiles[key], this.options.opacity);
                    }
                }
            }, addTileFromBounds: function (tileBounds) {
                var queue = []; var j, i, point; var center = tileBounds.center();
                for (j = tileBounds.min.y; j <= tileBounds.max.y; j++) {
                    for (i = tileBounds.min.x; i <= tileBounds.max.x; i++) {
                        point = new T.Point(i, j);
                        if (this.shouldTileBeLoaded(point)) { queue.push(point); }
                    }
                } if (queue.length === 0) { return; } queue.sort(function (a, b) {
                    return a.distanceTo(center) - b.distanceTo(center);
                }); this.tilesToLoad = queue.length; var fragment = document.createDocumentFragment(); for (i = 0; i < queue.length;
                i++) { this.addTile(queue[i], fragment); } this.$container.appendChild(fragment);
            }, removeInvisibleTiles: function (tileBounds) {
                var x, y, key;
                for (key in this.tiles) {
                    if (this.tiles.hasOwnProperty(key)) {
                        var tmp = key.split(":"); x = parseInt(tmp[0], 10);
                        y = parseInt(tmp[1], 10); if (x < tileBounds.min.x || x > tileBounds.max.x || y < tileBounds.min.y || y > tileBounds.max.y) {
                            this.removeTile(key);
                        }
                    }
                }
            }, removeTile: function (key) {
                var tile = this.tiles[key]; if (this.options.reuseTiles) {
                    T.DomUtil.removeClass(tile, "tibco-tile-loaded");
                    this.unusedTiles.push(tile);
                } if (!this.options.reuseTiles) { tile.parentNode.removeChild(tile); } else {
                    if (!T.Util.browserVersion.ielt9) {
                        tile.onerror = null;
                        tile.onload = null; tile.removeAttribute("src");
                    }
                } delete this.tiles[key];
            }, getTile: function () {
                if (this.options.reuseTiles && this.unusedTiles.length > 0) {
                    var tile = this.unusedTiles.pop();
                    return tile;
                } return this.createTile();
            }, getTileUrl: function (point) {
                var tileCount = Math.pow(2, this.map.getZoom());
                var x = point.x; var y = point.y; if (this.map.options.repeatX) {
                    x = x >= 0 ? x % tileCount : (tileCount + x % tileCount) % tileCount;
                } if (x >= 0 && x < tileCount && y >= 0 && y < tileCount) { return T.Util.template(this.url, { x: x, y: y, z: point.z }); } return "";
            }, getTilePosition: function (point) {
                var tileSize = this.options.tileSize, topLeft = this.map.getCenterInPixels().substract(this.map.getSize().divideBy(2)).floor();
                return point.multiplyBy(tileSize).substract(topLeft);
            }, createTile: function () {
                var tile = T.DomUtil.create("img", "tibco-tile");
                tile.style.width = tile.style.height = this.options.tileSize + "px"; tile.style.position = "absolute"; tile.errorAttempts = 0;
                T.DomUtil.setOpacity(tile, this.options.opacity); T.DomUtil.disableSelection(tile); T.DomUtil.show(tile);
                return tile;
            }, storeTile: function (tile, point) { this.tiles[point.x + ":" + point.y + ":" + point.z] = tile; }, loadTile: function (tile, point) {
                point.z = this.map.getZoom();
                tile.layer = this; tile.point = point; var src = this.getTileUrl(point); if (src && src !== "") {
                    if (!tile.onload) {
                        tile.onload = this.onTileLoad;
                    } if (!tile.onerror) { tile.onerror = this.onTileError; } tile.src = src; if (T.Util.browserVersion.ielt9) {
                        T.DomUtil.show(tile);
                    }
                } else { if (T.Util.browserVersion.ielt9) { T.DomUtil.hide(tile); } this.tilesToLoad--; } if (!T.Util.browserVersion.ielt9) {
                    T.DomUtil.hide(tile);
                }
            }, shouldTileBeLoaded: function (point) {
                var tileKey = point.x + ":" + point.y + ":" + point.z; if (typeof this.tiles[tileKey] !== "undefined") {
                    return false;
                } return true;
            }, getIndex: function () { return this.map.getLayerIndex(this); }, getContainer: function () {
                return this.$layerContainer;
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("hard-reset", function () { this.hardReset = true; }, this);
                this.map.events.on("view-reset", this.reset, this); this.map.events.on("move-end", this.moveEnd, this); this.map.events.on("move", this.delayedUpdate, this);
                this.events.on("before-drag-start", this.onBeforeDragStart, this); this.events.on("drag-start", this.onDragStart, this);
                this.events.on("drag", this.onDrag, this); this.events.on("drag-end", this.onDragEnd, this); this.initContainer();
                this.reset(); this.$layerContainer = base.prototype.setAsInteractiveTarget.call(this, this.$layerContainer, this);
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset); this.map.events.detach("move-end", this.moveEnd, this);
                this.map.events.detach("move", this.delayedUpdate, this); this.events.detach("before-drag-start", this.onBeforeDragStart, this);
                this.events.detach("drag-start", this.onDragStart, this); this.events.detach("drag", this.onDrag, this); this.events.detach("drag-end", this.onDragEnd, this);
                base.prototype.onRemove.call(this);
            }, onTileLoad: function () {
                var layer = this.layer; layer.events.fire("tile-load", { tile: this });
                T.DomUtil.addClass(this, "tibco-tile-loaded"); layer.tilesLoaded++; if (this.src && this.src !== "") {
                    T.DomUtil.show(this);
                } if (layer.tilesToLoad === layer.tilesLoaded) {
                    layer.onAllTilesLoaded(); layer.events.fire("tiles-loaded", { nrTiles: layer.tilesLoaded });
                }
            }, onTileError: function (e) {
                var layer = this.layer; if (this.errorAttempts < this.layer.options.errorTileAttemptsThreshold) {
                    this.errorAttempts++;
                    this.layer.loadTile(this, this.point);
                } else {
                    this.layer.tilesLoaded++; this.layer.events.fire("tile-error", { tile: this });
                    this.onerror = null; this.src = this.layer.options.tile404;
                } if (layer.tilesToLoad === layer.tilesLoaded) {
                    layer.onAllTilesLoaded();
                    layer.events.fire("tiles-loaded", { nrTiles: layer.tilesLoaded });
                }
            }, IsBackbufferEnabled: function () {
                if (T.AnimUtil.canAnim()) {
                    if (this.hardReset) {
                        this.hardReset = false;
                        return false;
                    }
                } else { return false; } return true;
            }, onAllTilesLoaded: function () {
                if (!this.IsBackbufferEnabled()) {
                    return;
                } var self = this; self.$container.style.zIndex = 0; self.$bufferContainer.style.zIndex = -1; self.$container.style.visibility = "visible";
                self.$bufferContainer.style.visibility = "hidden"; self.$bufferContainer.innerHTML = ""; self.$bufferContainer.matrix = new T.Matrix2D();
            }, stopLoadingTiles: function (container) {
                var tiles = T.DomUtil.nodeCollectionToArray(container.getElementsByTagName("img")), i, len, tile;
                for (i = 0, len = tiles.length; i < len; i++) {
                    tile = tiles[i]; if (!tile.complete) {
                        tile.onload = null; tile.onerror = null;
                        tile.removeAttribute("src"); tile.parentNode.removeChild(tile);
                    }
                }
            }, getLoadedTilesPercent: function (container) {
                var tiles = container.getElementsByTagName("img"), i, j = 0, len = tiles.length, tile;
                if (len === 0) { return 0; } for (i = 0; i < len; i++) { if (tiles[i].complete) { j++; } } return j / len;
            }, onBeforeDragStart: function (evt) {
                this.map.onBeforeDragStart(evt);
            }, onDragStart: function (evt) { this.map.onDragStart(evt); }, onDrag: function (evt) { this.map.onDrag(evt); }, onDragEnd: function (evt) {
                this.map.onDragEnd(evt);
            }
        }; T.Util.inherit(TileLayer, base); exports.TileLayer = TileLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ImageLayer = function (url, bounds, options) {
            this.options = T.Util.defaults(options, this.options);
            this.url = url; this.bounds = bounds; T.BaseLayer.call(this, options);
        }; ImageLayer.prototype = {
            options: { opacity: 1 }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer", this.map.$container.layers);
                    this.$container.layer = this;
                }
            }, initImage: function () {
                var image = this.image = T.DomUtil.create("img", "tibco-image-1");
                var backImage = this.backImage = T.DomUtil.create("img", "tibco-image-2"); image.onload = this.onImageLoad; image.onerror = this.onImageError;
                if (this.url) { image.src = this.url; } image.layer = this; image.style.position = "absolute"; image.style.opacity = this.options.opacity;
                image.matrix = new T.Matrix2D(); backImage.layer = this; backImage.style.position = "absolute"; backImage.style.opacity = this.options.opacity;
                backImage.matrix = new T.Matrix2D(); backImage.style.visibility = "hidden"; T.DomUtil.disableSelection(image);
                T.DomUtil.disableSelection(backImage);
            }, reset: function () {
                var image = this.image, topLeft, size; if (this.bounds instanceof T.LatLngBounds) {
                    topLeft = this.map.latLngToPoint(this.bounds.getNorthWest()).floor();
                    size = this.map.latLngToPoint(this.bounds.getSouthEast()).substract(topLeft).floor();
                } else {
                    topLeft = this.map.transform(this.bounds.topLeft()).substract(this.map.getTopLeftInPixels()).round();
                    size = this.map.transform(this.bounds.bottomRight()).substract(this.map.getTopLeftInPixels()).substract(topLeft).round();
                } T.DomUtil.position(image, topLeft); image.style.width = size.x + "px"; image.style.height = size.y + "px";
            }, reload: function (url, bounds) {
                this.url = url;
                this.bounds = bounds; if (!this.image) { this.initImage(); } this.events.fire("image-loading", { tile: this.image });
                this.image.src = this.url; this.reset();
            }, setOpacity: function (opacity) {
                if (!this.image) {
                    this.initImage();
                } this.options.opacity = opacity; this.image.style.opacity = this.options.opacity;
            }, onAdd: function (map) {
                this.map = map;
                this.map.events.on("view-reset", this.reset, this); this.initContainer(); if (!this.image) {
                    this.initImage();
                } this.$container.appendChild(this.image); this.$container.appendChild(this.backImage); this.reset();
            }, onRemove: function (map) {
                T.ImageLayer.base.onRemove.call(this);
                this.map.events.detach("view-reset", this.reset);
            }, onImageLoad: function () {
                var layer = this.layer; layer.events.fire("image-load", { tile: this });
            }, onImageError: function (e) { var layer = this.layer; layer.events.fire("image-error", { tile: this }); }
        }; T.Util.inherit(ImageLayer, T.BaseLayer);
        exports.ImageLayer = ImageLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.BaseLayer;
        var MarkersLayer = function (options) { base.call(this, options); this.markers = []; }; MarkersLayer.prototype = {
            options: { opacity: 1 }, initContainer: function () {
                var i;
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer markers-layer", this.map.$container.layers);
                    this.$container.layer = this; for (i = 0; i < this.markers.length; i++) {
                        this.$container.appendChild(this.markers[i].$container);
                    }
                }
            }, reset: function () { var i = 0; for (i = 0; i < this.markers.length; i++) { this.markers[i].reset(); } }, addMarker: function (marker) {
                marker.layer = this;
                marker.onAdd(this); marker.reset(); if (this.$container) {
                    this.$container.appendChild(marker.$container);
                } this.markers.push(marker); marker.$container = base.prototype.setAsInteractiveTarget.call(this, marker.$container, marker);
            }, removeMarker: function (marker) {
                var index = this.markers.indexOf(marker); if (index > -1) {
                    this.markers.splice(index, 1);
                    marker.layer = null; marker.onRemove(this); if (this.$container) {
                        this.$container.removeChild(marker.$container);
                    }
                }
            }, removeAllMarkers: function () {
                var i = 0; for (i = 0; i < this.markers.length; i++) {
                    this.markers[i].layer = null;
                    this.markers[i].onRemove(this);
                } this.markers = []; this.$container.innerHTML = "";
            }, findByLabel: function (label) {
                var i = 0;
                for (i = 0; i < this.markers.length; i++) { if (this.markers[i].options.label === label) { return this.markers[i]; } } return null;
            }, setOpacity: function (opacity) {
                this.options.opacity = opacity; this.$container.style.opacity = this.options.opacity;
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.reset, this); this.initContainer();
                this.reset();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset); base.prototype.onRemove.call(this);
            }
        }; T.Util.inherit(MarkersLayer, base); exports.MarkersLayer = MarkersLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.BaseLayer;
        var SvgLayer = function (options) { base.call(this, options); this.geometries = []; this.type = "svg"; }; SvgLayer.prototype = {
            initContainer: function () {
                var i;
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer svg-layer", this.map.$container.layers);
                    this.$svg = T.DomUtil.createSvgElement("svg"); this.$svg.style.pointerEvents = "none"; this.$svg.$g = T.DomUtil.createSvgElement("g");
                    this.$svg.style.position = "absolute"; this.$container.appendChild(this.$svg); this.$svg.appendChild(this.$svg.$g);
                    this.context = new T.SvgContext(this.$svg); for (i = 0; i < this.geometries.length; i++) {
                        this.geometries[i].context = this.context;
                        this.geometries[i].initContainer();
                    }
                }
            }, reset: function () {
                var i; for (i = 0; i < this.geometries.length; i++) {
                    this.geometries[i].reset();
                }
            }, addGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (index > -1) { return; } geometry.onAdd(this);
                this.geometries.push(geometry); geometry.$container = base.prototype.setAsInteractiveTarget.call(this, geometry.$container, geometry);
                return this;
            }, removeGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (index > -1) {
                    this.geometries.splice(index, 1);
                    geometry.onRemove(this);
                }
            }, removeAllGeometries: function () {
                for (var i = 0; i < this.geometries.length; i++) {
                    this.geometries[i].onRemove(this);
                } this.geometries = [];
            }, updateViewPort: function () {
                var padding = new T.Point(this.options.clipOffset, this.options.clipOffset);
                var delta = this.map.getLayersPos(); var pos = delta.add(padding); var size = this.map.getSize().add(padding.multiplyBy(2));
                T.DomUtil.position(this.$svg, pos.multiplyBy(-1)); this.$svg.setAttributeNS(null, "width", size.x); this.$svg.setAttributeNS(null, "height", size.y);
                this.$svg.setAttributeNS(null, "viewBox", [-padding.x, -padding.y, size.x, size.y].join(" ")); this.$svg.$g.setAttributeNS(null, "transform", "matrix(" + [1, 0, 0, 1, 0, 0].join(" ") + ")");
                this.reset();
            }, bringForward: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$svg.$g);
                if (index < 0) { return; } var nextNode = this.$svg.$g.childNodes[index + 2]; if (nextNode) {
                    this.$svg.$g.insertBefore(geometry.$container, nextNode);
                } else { this.$svg.$g.appendChild(geometry.$container); }
            }, sendBackward: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$svg.$g);
                if (index < 0) { return; } var nextNode = this.$svg.$g.childNodes[index - 1]; if (nextNode) {
                    this.$svg.$g.insertBefore(geometry.$container, nextNode);
                }
            }, bringToFront: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$svg.$g);
                if (index < 0) { return; } this.$svg.$g.appendChild(geometry.$container);
            }, sendToBack: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$svg.$g);
                if (index < 0 || this.$svg.$g.firstChild === geometry.$container) { return; } this.$svg.$g.insertBefore(geometry.$container, this.$svg.$g.firstChild);
            }, getContainer: function () { return this.$container; }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.updateViewPort, this);
                this.map.events.on("move-end", this.updateViewPort, this); this.initContainer(); this.reset(); this.updateViewPort();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset); this.map.events.detach("move-end", this.updateViewPort);
                this.map = null;
            }, onGeometryClick: function (e, geometry) { this.events.fire("geometry-click", geometry); }
        }; T.Util.inherit(SvgLayer, base);
        exports.SvgLayer = SvgLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var CanvasLayer = function (options) {
            T.BaseLayer.call(this, options);
            this.type = "canvas"; this.geometries = [];
        }; CanvasLayer.prototype = {
            initContainer: function () {
                var i; if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer canvas-layer", this.map.$container.layers);
                    this.$canvas = T.DomUtil.create("canvas", "canvas"); this.$canvas.style.position = "absolute"; this.$container.appendChild(this.$canvas);
                    this.canvasContext = this.$canvas.getContext("2d"); this.context = new T.CanvasContext(this.$canvas); for (i = 0;
                    i < this.geometries.length; i++) {
                        this.geometries[i].context = this.context; this.geometries[i].initContainer();
                    }
                }
            }, handleEvents: function (eventName, geometry, evt) { this.events.fire(eventName, geometry, evt); }, getTargetedGeometry: function (evt) {
                var i, geometry;
                var point = this.map.computeMousePosition(evt); var geoms = this.geometries.concat().reverse(); var padding = new T.Point(this.options.clipOffset, this.options.clipOffset);
                point = point.add(padding); for (i = 0; i < geoms.length; i++) {
                    this.clear(); geoms[i].reset(); var img = this.canvasContext.getImageData(point.x, point.y, 1, 1).data;
                    if (img[0] !== 0 || img[1] !== 0 || img[2] !== 0) { geometry = geoms[i]; break; }
                } this.updateViewPort(); evt.latLng = this.map.containerPointToLatLng(point.substract(padding));
                if (geometry) { return geometry; } else { return null; }
            }, reset: function () {
                var i; for (i = 0; i < this.geometries.length;
                i++) { this.geometries[i].reset(); }
            }, addGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry);
                if (index > -1) { return; } geometry.onAdd(this); this.geometries.push(geometry); return this;
            }, removeGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry), i = 0;
                if (index > -1) {
                    this.geometries.splice(index, 1); this.clear(); for (i = 0; i < this.geometries.length; i++) {
                        this.geometries[i].draw(this.geometries[i]);
                    }
                }
            }, removeAllGeometries: function () { this.clear(); this.geometries = []; }, clear: function () {
                this.canvasContext.clearRect(0, 0, this.$canvas.width, this.$canvas.height);
            }, bringForward: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (this.geometries.length < 2 || index === this.geometries.length - 1) {
                    return;
                } var temp = this.geometries[index + 1]; this.geometries[index + 1] = geometry; this.geometries[index] = temp; this.updateViewPort();
            }, sendBackward: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (this.geometries.length < 2 || index === 0) {
                    return;
                } var temp = this.geometries[index - 1]; this.geometries[index - 1] = geometry; this.geometries[index] = temp; this.updateViewPort();
            }, bringToFront: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (this.geometries.length < 2 || index === this.geometries.length - 1) {
                    return;
                } this.geometries.splice(index, 1); this.geometries.push(geometry); this.updateViewPort();
            }, sendToBack: function (geometry) {
                var index = this.geometries.indexOf(geometry);
                if (this.geometries.length < 2 || index === 0) { return; } this.geometries.splice(index, 1); this.geometries.splice(0, 0, geometry);
                this.updateViewPort();
            }, updateViewPort: function () {
                var padding = new T.Point(this.options.clipOffset, this.options.clipOffset);
                var pos = this.map.getLayersPos().add(padding); var size = this.map.getSize().add(padding.multiplyBy(2)); T.DomUtil.position(this.$canvas, pos.multiplyBy(-1));
                this.$canvas.width = size.x; this.$canvas.height = size.y; this.canvasContext.setTransform(1, 0, 0, 1, padding.x, padding.y);
                this.reset();
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.updateViewPort, this);
                this.map.events.on("move-end", this.updateViewPort, this); this.initContainer(); this.updateViewPort(); this.$canvas = T.BaseLayer.prototype.setAsInteractiveTarget.call(this, this.$canvas, this);
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.updateViewPort); this.map.events.detach("move-end", this.updateViewPort);
                this.map = null;
            }
        }; T.Util.inherit(CanvasLayer, T.BaseLayer); exports.CanvasLayer = CanvasLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var VmlLayer = function (options) {
            T.BaseLayer.call(this, options);
            this.type = "vml"; this.geometries = [];
        }; VmlLayer.prototype = {
            initContainer: function () {
                var i; if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer vml-layer", this.map.$container.layers);
                    this.$container.style.position = "absolute"; document.namespaces.add("v", "urn:schemas-microsoft-com:vml");
                    T.DomUtil.addStyleNode(".tibco-vml	 {	display:inline-block; behavior:url(#default#VML); position: absolute; }");
                    this.$vml = this.$container; this.context = new T.VmlContext(this.$vml); for (i = 0; i < this.geometries.length; i++) {
                        this.geometries[i].context = this.context;
                        this.geometries[i].initContainer();
                    }
                }
            }, reset: function () {
                var i; for (i = 0; i < this.geometries.length; i++) {
                    this.geometries[i].reset();
                }
            }, addGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (index > -1) { return; } geometry.onAdd(this);
                this.geometries.push(geometry); geometry.$container = T.BaseLayer.prototype.setAsInteractiveTarget.call(this, geometry.$container, geometry);
                return this;
            }, removeGeometry: function (geometry) {
                var index = this.geometries.indexOf(geometry); if (index > -1) {
                    this.geometries.splice(index, 1);
                    geometry.onRemove(this);
                }
            }, removeAllGeometries: function () {
                for (var i = 0; i < this.geometries.length; i++) {
                    this.geometries[i].onRemove(this);
                } this.geometries = [];
            }, updateViewPort: function () {
                var pos = this.map.getLayersPos(); T.DomUtil.position(this.$vml, pos.multiplyBy(-1));
                this.reset();
            }, bringForward: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$vml);
                if (index < 0) { return; } var nextNode = this.$vml.childNodes[index + 2]; if (nextNode) {
                    this.$vml.insertBefore(geometry.$container, nextNode);
                } else { this.$vml.appendChild(geometry.$container); }
            }, sendBackward: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$vml);
                if (index < 0) { return; } var nextNode = this.$vml.childNodes[index - 1]; if (nextNode) {
                    this.$vml.insertBefore(geometry.$container, nextNode);
                }
            }, bringToFront: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$vml); if (index < 0) {
                    return;
                } this.$vml.appendChild(geometry.$container);
            }, sendToBack: function (geometry) {
                var index = T.DomUtil.getNodeIndex(geometry.$container, this.$vml);
                if (index < 0 || this.$vml.firstChild === geometry.$container) { return; } this.$vml.insertBefore(geometry.$container, this.$vml.firstChild);
            }, getContainer: function () { return this.$container; }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.reset, this);
                this.map.events.on("move-end", this.updateViewPort, this); if (T.Util.browserVersion.ielt9) {
                    this.map.events.on("layer-moved", this.updateViewPort, this);
                } this.initContainer(); this.updateViewPort();
            }, onRemove: function () {
                T.VmlLayer.base.onRemove.call(this);
                this.map.events.detach("view-reset", this.reset); this.map.events.detach("move-end", this.updateViewPort);
                if (T.Util.browserVersion.ielt9) { this.map.events.detach("layer-moved", this.updateViewPort); }
            }
        }; T.Util.inherit(VmlLayer, T.BaseLayer);
        exports.VmlLayer = VmlLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.BaseLayer;
        var VectorLayer = function (options) {
            var i; base.call(this, options); if (T.Util.browserVersion.ielt9) {
                this.vectorDrawer = new T.VmlLayer(this.options);
            } else {
                if (options && options.useCanvas === true) { this.vectorDrawer = new T.CanvasLayer(this.options); } else {
                    this.vectorDrawer = new T.SvgLayer(this.options);
                }
            } this.vectorDrawer.events = this.events;
        }; VectorLayer.prototype = {
            options: { defaultStyle: { stroke: true, color: "#0033ff", dashArray: null, lineCap: null, lineJoin: null, weight: 2, opacity: 0.5, fill: true, fillColor: null, fillOpacity: 0.2 }, clipOffset: 100 }, reset: function () {
                this.vectorDrawer.reset();
            }, addGeometry: function (geometry) { return this.vectorDrawer.addGeometry(geometry); }, removeGeometry: function (geometry) {
                return this.vectorDrawer.removeGeometry(geometry);
            }, removeAllGeometries: function () { return this.vectorDrawer.removeAllGeometries(); }, bringForward: function (geometry) {
                this.vectorDrawer.bringForward(geometry);
            }, sendBackward: function (geometry) { this.vectorDrawer.sendBackward(geometry); }, bringToFront: function (geometry) {
                this.vectorDrawer.bringToFront(geometry);
            }, sendToBack: function (geometry) { this.vectorDrawer.sendToBack(geometry); }, updateViewPort: function () {
                this.vectorDrawer.updateViewPort();
            }, getIndex: function () { return this.vectorDrawer.map.getLayerIndex(this); }, getContainer: function () {
                return this.vectorDrawer.$container;
            }, setVisible: function (visible) {
                var container = this.getContainer(); if (visible === true) {
                    container.style.display = "block";
                } else { if (visible === false) { container.style.display = "none"; } }
            }, isVisible: function () {
                var container = this.getContainer();
                return container.style.display === "none" ? false : true;
            }, onAdd: function (map) {
                this.vectorDrawer.onAdd(map);
            }, onRemove: function (map) { this.vectorDrawer.onRemove(map); base.prototype.onRemove.call(this); }
        }; T.Util.inherit(VectorLayer, base);
        exports.VectorLayer = VectorLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var GoogleLayer = function (options) {
            T.BaseLayer.call(this, options);
            this.isDraggable = true;
        }; GoogleLayer.prototype = {
            options: { opacity: 1, attribution: null }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer google-layer", this.map.$container.layers);
                    this.$container.layer = this; T.DomUtil.size(this.$container, this.map.getSize()); this.mapObject = new google.maps.Map(this.$container, { center: this.toGoogle(this.map.getCenter()), zoom: this.map.getZoom(), type: google.maps.MapTypeId.ROADMAP, disableDefaultUI: true, keyboardShortcuts: false, draggable: false, disableDoubleClickZoom: false, scrollwheel: false, streetViewControl: false });
                }
            }, reset: function () {
                var container = this.map.$layers; google.maps.event.addListenerOnce(this.mapObject, "idle", function () {
                    container.style.visibility = "";
                }); container.style.visibility = "hidden"; this.mapObject.setOptions({ animatedZoom: false, center: this.toGoogle(this.map.getCenter()), zoom: this.map.getZoom() });
                this.map.setUrlLocation();
            }, update: function () { if (!this.map) { return; } this.map.setUrlLocation(); }, updatePosition: function () {
                if (!this.map) {
                    return;
                } var layerPosition = this.map.getLayersPos().multiplyBy(-1); T.DomUtil.position(this.$container, layerPosition);
                this.mapObject.setCenter(this.toGoogle(this.map.getCenter())); this.resizeMap();
            }, resizeMap: function () {
                google.maps.event.trigger(this.mapObject, "resize");
            }, toGoogle: function (latLng) { return new google.maps.LatLng(latLng.lat, latLng.lng); }, setOpacity: function (opacity) {
                this.options.opacity = opacity;
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("move-end", this.update, this); this.map.events.on("move", this.updatePosition, this);
                this.map.events.on("view-reset", this.reset, this); this.events.on("before-drag-start", this.onBeforeDragStart, this);
                this.events.on("drag-start", this.onDragStart, this); this.events.on("drag", this.onDrag, this); this.events.on("drag-end", this.onDragEnd, this);
                this.initContainer(); this.reset(); this.update(); this.$container = T.BaseLayer.prototype.setAsInteractiveTarget.call(this, this.$container, this);
            }, onRemove: function () {
                T.GoogleLayer.base.onRemove.call(this); this.map.events.detach("move-end", this.update);
                this.map.events.detach("move", this.updatePosition); this.map.events.detach("view-reset", this.reset); this.events.detach("before-drag-start", this.onBeforeDragStart, this);
                this.events.detach("drag-start", this.onDragStart, this); this.events.detach("drag", this.onDrag, this); this.events.detach("drag-end", this.onDragEnd, this);
            }, onBeforeDragStart: function (evt) { this.map.onBeforeDragStart(evt); }, onDragStart: function (evt) {
                this.map.onDragStart(evt);
            }, onDrag: function (evt) { this.map.onDrag(evt); }, onDragEnd: function (evt) { this.map.onDragEnd(evt); }
        }; T.Util.inherit(GoogleLayer, T.BaseLayer);
        exports.GoogleLayer = GoogleLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.TileLayer;
        var TibcoLayer = function (options) {
            if (window.location.protocol !== "https:") {
                this.mapServicesUrl = "http://geoanalytics.tibco.com/service/services-list.json";
            } else { this.mapServicesUrl = "https://geoanalytics.tibco.com/service/ssl/services-list.json"; } this.mapServices = null;
            this.mapTypeService = null; this.mapTypeServiceData = null; this.options = T.Util.defaults(this.options, base.prototype.options);
            T.TileLayer.call(this, "", options); this.init(options);
        }; TibcoLayer.prototype = {
            options: { draggable: true, mapType: T.MapTypes.STANDARD, mapStyle: T.MapStyles.LIGHT, attribution: { prefix: "<a target='_blank' href='http://www.tibco.com/assets/blt59b361e6644c8d3a/tibco-end-user-license-agreement_tcm8-9378.pdf'>TIBCO GeoAnalytics</a>", text: "" } }, init: function () {
                var self = this;
                this.makeRequest(this.mapServicesUrl).then(function (data) {
                    self.mapServices = self.getMapServices(data);
                    self.setMapType(self.options.mapType);
                }, function () { throw new Error("Map services error!"); });
            }, makeRequest: function (url) {
                var promise = new T.Promise();
                var cfg = {
                    method: "GET", withCredentials: false, on: {
                        success: function (data) {
                            var json = JSON.parse(data); promise.resolve(json);
                        }, error: function (error) { promise.reject(error); }
                    }
                }; new T.Ajax().send(url, cfg); return promise;
            }, setMapType: function (mapType) {
                var self = this, promise = new T.Promise();
                if (!mapType) { throw new Error("Please specify a map type!"); } this.options.mapType = mapType; this.mapTypeService = this.getMapServiceByMapType(this.options.mapType);
                if (!this.mapTypeService) { throw new Error("Map services error!"); } this.makeRequest(this.mapTypeService.href).then(function (data) {
                    if (!data || !data["tile url"]) {
                        throw new Error("Map tiles error!");
                    } self.options.attribution.text = '<a target="_blank" href=' + data["copyright href"] + ">" + data.copyright + "</a>";
                    if (self.map) {
                        self.map.events.fire("attribution-update", self.options.attribution); self.map.events.fire("layer-attribution-reset", self);
                    } self.mapTypeServiceData = data; self.setMapStyle(self.options.mapStyle); promise.resolve();
                }, function () {
                    promise.reject();
                    throw new Error("Map tiles error!");
                }); return promise;
            }, setMapStyle: function (mapStyle) {
                var availableMapStyles = this.mapTypeServiceData["tile styles"], styleFound = false, i = 0;
                if (!availableMapStyles) { this.setTilesUrl(this.mapTypeServiceData["tile url"]); } else {
                    for (i = 0; i < availableMapStyles.length;
                    i++) {
                        if (availableMapStyles[i].id === mapStyle) {
                            styleFound = true; this.options.mapStyle = availableMapStyles[i].id;
                            this.setTilesUrl(availableMapStyles[i].url); break;
                        }
                    } if (!styleFound) {
                        throw new Error("Style '" + mapStyle + "' is not a supported map style!");
                    }
                }
            }, setTilesUrl: function (tilesUrl) {
                if (!tilesUrl) { throw new Error("Map services error!"); } this.url = tilesUrl + "{z}/{x}/{y}.png";
                if (this.map) { base.prototype.reset.call(this); }
            }, getAvailableMapTypes: function () {
                var availableMapTypes = [], i = 0;
                if (!this.mapServices || this.mapServices.length === 0) { throw new Error("Map services error!"); } for (i = 0; i < this.mapServices.length;
                i++) { availableMapTypes.push(this.mapServices[i].name); } return availableMapTypes;
            }, getAvailableMapStyles: function () {
                var availableMapStyles = [], i = 0;
                if (!this.mapTypeServiceData) { throw new Error("Map services error!"); } if (!this.mapTypeServiceData["tile styles"]) {
                    return availableMapStyles;
                } for (i = 0; i < this.mapTypeServiceData["tile styles"].length; i++) {
                    availableMapStyles.push(this.mapTypeServiceData["tile styles"][i].id);
                } return availableMapStyles;
            }, getMapServices: function (data) {
                var latestMapData = null; if (!data || !data.maps) {
                    throw new Error("Map services error!");
                } latestMapData = this.getLastVersionOfMapData(data.maps); if (!latestMapData || !latestMapData.services || latestMapData.services.length === 0) {
                    throw new Error("Map services error!");
                } return latestMapData.services;
            }, getMapServiceByMapType: function (mapType) {
                var i = 0; if (!mapType || !this.mapServices || this.mapServices.length === 0) {
                    throw new Error("Map services error!");
                } for (i = 0; i < this.mapServices.length; i++) {
                    if (this.mapServices[i].name === mapType) {
                        return this.mapServices[i];
                    }
                } return null;
            }, getLastVersionOfMapData: function (mapData) {
                var i = 0, latestMapData = null; if (!mapData || mapData.length === 0) {
                    throw new Error("Map services error!");
                } latestMapData = mapData[0]; for (i = 1; i < mapData.length; i++) {
                    if (mapData[i].version > latestMapData.version) {
                        latestMapData = mapData[i];
                    }
                } return latestMapData;
            }
        }; T.Util.inherit(TibcoLayer, T.TileLayer); exports.TibcoLayer = TibcoLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var WmsLayer = function (url, options) {
            options.transparent = options.transparent || "true";
            options.version = options.version || "1.1.1"; options.format = options.format || "image/png"; options.styles = options.styles || [];
            options.queryParams = options.queryParams || []; T.ImageLayer.call(this, null, null, options); this.wmsUrl = url;
        }; WmsLayer.prototype = {
            computeParameters: function (bounds) {
                var param = {}; if (this.options.maxBounds) {
                    param.bounds = bounds.intersect(this.options.maxBounds);
                    var topLeftPx = this.map.transform(param.bounds.topLeft()); var bottomRightPx = this.map.transform(param.bounds.bottomRight());
                    param.topLeftPixel = topLeftPx.substract(this.map.calculateTopLeft()).substract(this.map.getLayersPos());
                    param.size = bottomRightPx.substract(topLeftPx);
                } else {
                    param.topLeftPixel = new T.Point(0, 0).substract(this.map.getLayersPos());
                    param.size = this.map.getSize(); param.bounds = bounds;
                } param.size.x = param.size.x | 0; param.size.y = param.size.y | 0;
                return param;
            }, handleBackbuffer: function (noTransform) {
                if (this.image.completed) {
                    var temp = this.backImage;
                    this.backImage = this.image; this.image = temp; this.image.style.visibility = "hidden"; this.image.completed = false;
                    if (T.AnimUtil.canAnim()) { T.AnimUtil.setMatrix(this.image, new T.Matrix2D()); } else {
                        this.image.style.width = "";
                        this.image.style.height = ""; this.image.style.left = ""; this.image.style.top = "";
                    }
                } else {
                    this.image.onload = null;
                    this.image.onerror = null; this.image.removeAttribute("src");
                } if (!noTransform) {
                    var matrix = this.map.lastTransform.matrix;
                    this.backImage.matrix = matrix.multiplyBy(this.backImage.matrix); T.DomUtil.position(this.backImage, new T.Point(0, 0));
                    if (T.AnimUtil.canAnim()) {
                        T.AnimUtil.transition(this.backImage, 0); T.AnimUtil.setMatrix(this.backImage, this.backImage.matrix.toString());
                    } else {
                        this.backImage.style.width = (this.backImage.originalWidth || 0) * this.backImage.matrix.m11 + "px"; this.backImage.style.height = (this.backImage.originalHeight || 0) * this.backImage.matrix.m11 + "px";
                        this.backImage.style.left = this.backImage.matrix.m13 + "px"; this.backImage.style.top = this.backImage.matrix.m23 + "px";
                    }
                }
            }, reset: function (noTransform) {
                this.handleBackbuffer(noTransform); var key, queryParams = this.options.queryParams, image = this.image, crs = this.map.options.crs, url = this.wmsUrl, map = this.map, bounds = map.getProjectedBounds(), param = this.computeParameters(bounds), size = param.size, topLeftPixel = param.topLeftPixel, bottomLeft = param.bounds.bottomLeft(), topRight = param.bounds.topRight();
                if (size.x <= 0 || size.y <= 0) { this.events.fire("image-load", { tile: null }); return; } url += "?"; url += "service=WMS";
                url += "&version=" + this.options.version; url += "&request=GetMap"; url += "&layers=" + this.options.layers.join(",");
                url += "&styles=" + this.options.styles.join(","); url += "&bbox=" + bottomLeft.x + "," + bottomLeft.y + "," + topRight.x + "," + topRight.y;
                url += "&format=" + this.options.format; url += "&SRS=" + crs.code; url += "&width=" + size.x; url += "&height=" + size.y;
                url += "&transparent=" + this.options.transparent; for (key in queryParams) {
                    if (queryParams.hasOwnProperty(key)) {
                        url += "&" + key + "=" + queryParams[key];
                    }
                } this.events.fire("image-loading", { tile: this.image }); T.DomUtil.position(image, topLeftPixel); image.onload = this.onImageLoad;
                image.onerror = this.onImageError; image.style.width = size.x + "px"; image.style.height = size.y + "px"; image.src = url;
            }, onMoveEnd: function () { this.reset(true); }, reload: function (url, bounds) { }, onAdd: function (map) {
                WmsLayer.base.onAdd.call(this, map);
                map.events.on("move-end", this.onMoveEnd, this);
            }, onRemove: function () {
                this.map.events.detach("move-end", this.reset);
                WmsLayer.base.onRemove.call(this);
            }, onImageLoad: function () {
                var self = this.layer; var img; this.completed = true;
                self.image.style.zIndex = 0; self.backImage.style.zIndex = -1; self.image.style.visibility = "visible"; self.backImage.style.visibility = "hidden";
                self.image.matrix = new T.Matrix2D(); self.image.matrix.m13 += T.DomUtil.position(this).x; self.image.matrix.m23 += T.DomUtil.position(this).y;
                if (!T.AnimUtil.canAnim()) {
                    self.image.originalWidth = parseInt(this.style.width, 10); self.image.originalHeight = parseInt(this.style.height, 10);
                } WmsLayer.base.onImageLoad.call(this);
            }, onImageError: function (e) {
                this.layer.events.fire("wms-error", "Error loading WMS image");
            }
        }; T.Util.inherit(WmsLayer, T.ImageLayer); exports.WmsLayer = WmsLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var WmsTileLayer = function (url, options) {
            if (!url) {
                throw new Error("TileLayer must have an URL");
            } T.TileLayer.call(this, url, options); this.url = url; options.transparent = options.transparent || "true"; options.version = options.version || "1.1.1";
            options.format = options.format || "image/png"; options.styles = options.styles || []; options.queryParams = options.queryParams || [];
            options.errorTileAttemptsThreshold = 0;
        }; WmsTileLayer.prototype = {
            getTileUrl: function (point) {
                var size, tilePos, crs = this.map.options.crs, url = this.url, tileSize = this.options.tileSize, queryParams = this.options.queryParams, tileSizePoint = new T.Point(tileSize, tileSize), topLeft, topRight, bottomLeft, bottomRight, topLeftLatLng, bottomRightLatLng, key;
                tilePos = point.multiplyBy(tileSize); topLeft = crs.untransform(tilePos, this.map.getZoom()); size = tileSizePoint.multiplyBy(this.map.getResolution()).multiplyBy(new T.Point(1, -1));
                bottomRight = topLeft.add(size); url += "?"; url += "service=WMS"; url += "&version=" + this.options.version; url += "&request=GetMap";
                url += "&layers=" + this.options.layers.join(","); url += "&styles=" + this.options.styles.join(","); url += "&bbox=" + topLeft.x + "," + bottomRight.y + "," + bottomRight.x + "," + topLeft.y;
                url += "&format=" + this.options.format; url += "&SRS=" + crs.code; url += "&width=" + tileSize; url += "&height=" + tileSize;
                url += "&transparent=" + this.options.transparent; for (key in queryParams) {
                    if (queryParams.hasOwnProperty(key)) {
                        url += "&" + key + "=" + queryParams[key];
                    }
                } return url;
            }, getTilePosition: function (point) {
                var tileSize = this.options.tileSize, topLeft = this.map.getCenterInPixels().substract(this.map.getSize().divideBy(2)).floor();
                return point.multiplyBy(tileSize).substract(topLeft);
            }, onRemove: function () {
                WmsTileLayer.base.onRemove.call(this);
            }
        }; T.Util.inherit(WmsTileLayer, T.TileLayer); exports.WmsTileLayer = WmsTileLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var PopupsLayer = function (options) {
            T.BaseLayer.call(this, options);
            this.popups = [];
        }; PopupsLayer.prototype = {
            options: { opacity: 1 }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-layer popup-layer", this.map.$container.layers);
                    this.$container.layer = this;
                }
            }, reset: function () {
                var i = 0; for (i = 0; i < this.popups.length; i++) {
                    this.popups[i].reset();
                }
            }, addPopup: function (popup) {
                this.$container.appendChild(popup.$container); popup.layer = this; popup.onAdd(this);
                this.popups.push(popup); if (popup.$closeButton) {
                    T.DomEventUtil.on(popup.$closeButton, "mousedown", this.onPopupCloseButtonClick, this);
                    if (T.Util.touchSupport()) {
                        T.DomEventUtil.on(popup.$closeButton, "touchstart", this.onPopupCloseButtonClick, this);
                    }
                }
            }, removePopup: function (popup) {
                var index = this.popups.indexOf(popup); if (index > -1) {
                    this.popups.splice(index, 1);
                    popup.layer = null; popup.onRemove(this); this.$container.removeChild(popup.$container); if (popup.$closeButton) {
                        T.DomEventUtil.off(popup.$closeButton, "mousedown", this.onPopupCloseButtonClick, this);
                        if (T.Util.touchSupport()) {
                            T.DomEventUtil.off(popup.$closeButton, "touchstart", this.onPopupCloseButtonClick, this);
                        }
                    }
                }
            }, removeAllPopups: function () {
                var i = 0; for (i = 0; i < this.popups.length; i++) {
                    this.popups[i].layer = null; this.popups[i].onRemove(this);
                } this.popups = []; this.$container.innerHTML = "";
            }, setOpacity: function (opacity) {
                this.options.opacity = opacity;
                this.$container.style.opacity = this.options.opacity;
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.reset, this);
                this.initContainer(); this.reset();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset);
                T.PopupsLayer.base.onRemove.call(this);
            }, onPopupCloseButtonClick: function (event) {
                var target = event.target || event.srcElement;
                target.popup.close(); event.stopPropagation();
            }
        }; T.Util.inherit(PopupsLayer, T.BaseLayer); exports.PopupsLayer = PopupsLayer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Popup = function (html, options) {
            this.html = html;
            this.options = T.Util.defaults(options, this.options); this.initContainer();
        }; Popup.prototype = {
            options: { closeButtonUrl: "", offset: { x: 0, y: 0 }, panMap: false, panMapExtraOffset: { x: 0, y: 0 } }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-popup");
                    if (this.options.closeButtonUrl) {
                        this.$closeButton = T.DomUtil.create("img", "tibco-popup-close", this.$container);
                        this.$closeButton.src = this.options.closeButtonUrl; this.$closeButton.popup = this;
                    } this.$htmlContent = T.DomUtil.create("div", "tibco-popup-content", this.$container);
                    this.$tail = T.DomUtil.create("div", "tibco-popup-tail", this.$container); this.$container.style.position = "absolute";
                    if (this.html) { this.$htmlContent.innerHTML = this.html; } this.close();
                }
            }, addHandler: function (handler) {
                handler.init(this);
            }, setHtml: function (template, templateData) {
                var key = null, keyInTemplate = null, regExp = null; if (!template) {
                    return;
                } if (templateData) {
                    for (key in templateData) {
                        keyInTemplate = "{{" + key + "}}"; if (template.indexOf(keyInTemplate) === -1) {
                            throw "Invalid object for popup template!";
                        } else { regExp = new RegExp(keyInTemplate, "g"); template = template.replace(regExp, templateData[key]); }
                    }
                } this.html = template;
                this.$htmlContent.innerHTML = this.html;
            }, getPosition: function (latlng, offset) {
                var position = this.layer.map.latLngToPoint(latlng).floor();
                position = position.substract(new T.Point(this.$container.clientWidth / 2, this.$container.offsetHeight + this.$tail.offsetHeight / 2)).add(new T.Point(this.options.offset.x, this.options.offset.y));
                return position;
            }, getLayersContainerPanOffset: function () {
                return { top: parseInt(T.DomUtil.getStyle(this.layer.map.$container.layers, "top"), 10), left: parseInt(T.DomUtil.getStyle(this.layer.map.$container.layers, "left"), 10) };
            }, getPanOffset: function () {
                var offsetX = 0, offsetY = 0, popupPanPosition = this.getPositionWithPan(); if (popupPanPosition.left < 0) {
                    offsetX = Math.abs(popupPanPosition.left) + this.options.panMapExtraOffset.x;
                } else {
                    if (!this.isHorizontallyVisible()) {
                        offsetX = this.layer.map.$container.offsetWidth - this.options.panMapExtraOffset.x - (popupPanPosition.left + this.$container.offsetWidth);
                    } else { offsetX = -this.options.panMapExtraOffset.x; }
                } if (popupPanPosition.top < 0) {
                    offsetY = Math.abs(popupPanPosition.top) + this.options.panMapExtraOffset.y;
                } else {
                    if (!this.isVerticallyVisible()) {
                        offsetY = this.layer.map.$container.offsetHeight - this.options.panMapExtraOffset.y - (popupPanPosition.top + this.$container.offsetHeight + this.$tail.offsetHeight);
                    } else { offsetY = -this.options.panMapExtraOffset.y; }
                } return { x: offsetX, y: offsetY };
            }, getPositionWithPan: function () {
                var layersContainerPanOffset = this.getLayersContainerPanOffset();
                if (!this.$container.tibcoPosition) { return null; } return { top: this.$container.tibcoPosition.y + layersContainerPanOffset.top, left: this.$container.tibcoPosition.x + layersContainerPanOffset.left };
            }, isInViewport: function () { return this.isHorizontallyVisible() && this.isVerticallyVisible(); }, isHorizontallyVisible: function () {
                var popupPanPosition = this.getPositionWithPan();
                return (popupPanPosition.left > 0) && ((popupPanPosition.left + this.$container.offsetWidth) <= this.layer.map.$container.offsetWidth);
            }, isVerticallyVisible: function () {
                var popupPanPosition = this.getPositionWithPan(); return (popupPanPosition.top > 0) && ((popupPanPosition.top + this.$container.offsetHeight) <= this.layer.map.$container.offsetHeight);
            }, panMapIfNecessary: function () {
                var panOffset; if (this.options.panMap === true && !this.isInViewport()) {
                    panOffset = this.getPanOffset();
                    this.layer.map.panBy(new T.Point(panOffset.x, panOffset.y));
                }
            }, reset: function () {
                var position; if (!this.reference) {
                    return;
                } position = this.getPosition(this.reference, this.options.offset); T.DomUtil.position(this.$container, position);
            }, open: function (reference) {
                if (!reference) { return; } if (this.marker) {
                    this.marker.popup = null; this.marker = null;
                } if (reference.className && reference.className === "marker") {
                    this.marker = reference; this.marker.popup = this;
                    this.reference = this.marker.latlng;
                } else { this.reference = reference; } T.DomUtil.show(this.$container); this.reset();
                this.panMapIfNecessary();
            }, close: function () { T.DomUtil.hide(this.$container); }, isOpen: function () {
                if (!this.$container) {
                    return false;
                } return !(this.$container.style.display === "none");
            }, onAdd: function (layer) { }, onRemove: function (layer) { }
        };
        exports.Popup = Popup;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ImageMarker = function ImageMarker(latlng, url, options) {
            this.latlng = latlng;
            this.url = url; this.options = T.Util.defaults(options, this.options); this.imageSize = new T.Point(0, 0); this.className = "marker";
            this.events = new T.EventDispatcher(); this.isDraggable = true; this.initContainer();
        }; ImageMarker.prototype = {
            options: { draggable: false, draggableUsingOffset: false, popOnClick: true, offset: new T.Point(0, 0), anchor: "bottom-center" }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-marker");
                    this.$container.marker = this; this.$container.style.position = "absolute";
                }
            }, addHandler: function (handler) {
                handler.init(this);
            }, handleEvents: function (eventName, evt) { this.layer.events.fire(eventName, this, evt); }, reset: function () {
                if (!this.layer || !this.layer.map) {
                    return;
                } var pxPosition = this.layer.map.latLngToPoint(this.latlng); switch (this.options.anchor) {
                    case "bottom-left": pxPosition.y = pxPosition.y - this.imageSize.y;
                        break; case "bottom-center": pxPosition.x = pxPosition.x - (this.imageSize.x / 2); pxPosition.y = pxPosition.y - this.imageSize.y;
                            break; case "bottom-right": pxPosition.x = pxPosition.x - this.imageSize.x; pxPosition.y = pxPosition.y - this.imageSize.y;
                                break;
                } pxPosition = pxPosition.substract(this.options.offset).floor(); T.DomUtil.position(this.$container, pxPosition);
            }, resetFromPx: function () {
                var p = T.DomUtil.position(this.$container).add(new T.Point(this.imageSize.x / 2, this.imageSize.y));
                if (this.layer) { this.latlng = this.layer.map.pointToLatLng(p); }
            }, resetOffset: function () {
                var viewportPos = this.layer.map.latLngToPoint(this.latlng);
                var currentPos = T.DomUtil.position(this.$container); this.dragOffset = currentPos.substract(viewportPos);
            }, initImage: function () {
                var image = this.image = T.DomUtil.create("img", "tibco-marker-image"); image.marker = this;
                image.onload = this.onImageLoad; image.onerror = this.onImageError; image.src = this.url; this.$container.appendChild(image);
            }, onAdd: function (layer) {
                if (!this.image) { this.initImage(); } this.events.on("before-drag-start", this.onBeforeDragStart, this);
                this.events.on("drag-start", this.onDragStart, this); this.events.on("drag", this.onDrag, this); this.events.on("drag-end", this.onDragEnd, this);
            }, onRemove: function (layer) { this.events.detachAll(); }, move: function (latlng) {
                this.latlng = latlng; this.reset();
                if (this.popup) { if (this.popup.isOpen()) { this.popup.open(this); } }
            }, onImageLoad: function () {
                this.marker.imageSize = new T.Point(this.width, this.height);
                this.marker.reset();
            }, onImageError: function () { }, onBeforeDragStart: function (evt) {
                if (!this.options.draggable) {
                    return;
                } this.startPoint = new T.Point(evt.clientX, evt.clientY); this.startPos = T.DomUtil.position(this.$container);
                if (this.options.popOnClick) {
                    var p = T.DomUtil.position(this.$container); p.y -= 2; T.DomUtil.position(this.$container, p);
                }
            }, onDragStart: function (evt) {
                if (!this.options.draggable) { return; } var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint);
                this.moved = true; this.startPos = T.DomUtil.position(this.$container).substract(offset); if (this.layer) {
                    if (this.popup) {
                        this.popup.close();
                    }
                }
            }, onDrag: function (evt) {
                if (!this.options.draggable) { return; } var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint), newPosition = this.startPos.add(offset);
                T.DomUtil.position(this.$container, newPosition);
            }, onDragEnd: function (evt) {
                if (!this.options.draggable) {
                    return;
                } if (this.options.popOnClick) {
                    var p = T.DomUtil.position(this.$container); p.y += 2; T.DomUtil.position(this.$container, p);
                } if (this.options.draggableUsingOffset) { this.resetOffset(); this.resetFromPx(); } else {
                    this.resetFromPx();
                }
            }
        }; exports.ImageMarker = ImageMarker;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var HtmlMarker = function (latlng, html, options) {
            this.latlng = latlng;
            this.html = html; this.options = T.Util.defaults(options, this.options); this.dragOffset = new T.Point(0, 0); this.className = "marker";
            this.events = new T.EventDispatcher(); this.isDraggable = true; this.initContainer();
        }; HtmlMarker.prototype = {
            options: { draggable: false, draggableUsingOffset: false, popOnClick: false, offset: new T.Point(0, 0) }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-marker");
                    this.$container.marker = this; this.$container.style.position = "absolute"; if (this.html) {
                        this.$container.innerHTML = this.html;
                    }
                }
            }, addHandler: function (handler) { handler.init(this); }, handleEvents: function (eventName, evt) {
                this.layer.events.fire(eventName, this, evt);
            }, reset: function () {
                if (!this.layer || !this.layer.map) { return; } var pxPosition = this.layer.map.latLngToPoint(this.latlng).floor();
                pxPosition = pxPosition.substract(this.options.offset).add(this.dragOffset); T.DomUtil.position(this.$container, pxPosition);
            }, resetFromPx: function () {
                var p = T.DomUtil.position(this.$container).add(this.options.offset); if (this.layer) {
                    this.latlng = this.layer.map.pointToLatLng(p);
                }
            }, resetOffset: function () {
                var viewportPos = this.layer.map.latLngToPoint(this.latlng); var currentPos = T.DomUtil.position(this.$container);
                this.dragOffset = currentPos.substract(viewportPos);
            }, onAdd: function (layer) {
                this.events.on("before-drag-start", this.onBeforeDragStart, this);
                this.events.on("drag-start", this.onDragStart, this); this.events.on("drag", this.onDrag, this); this.events.on("drag-end", this.onDragEnd, this);
            }, onRemove: function (layer) { this.events.detachAll(); }, onBeforeDragStart: function (evt) {
                if (!this.options.draggable) {
                    return;
                } this.startPoint = new T.Point(evt.clientX, evt.clientY); this.startPos = T.DomUtil.position(this.$container);
                if (this.options.popOnClick) {
                    var p = T.DomUtil.position(this.$container); p.y -= 2; T.DomUtil.position(this.$container, p);
                }
            }, onDragStart: function (evt) {
                if (!this.options.draggable) { return; } var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint);
                this.moved = true; this.startPos = T.DomUtil.position(this.$container).substract(offset); if (this.layer) {
                    if (this.popup) {
                        this.popup.close();
                    }
                }
            }, onDrag: function (evt) {
                if (!this.options.draggable) { return; } var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint), newPosition = this.startPos.add(offset);
                T.DomUtil.position(this.$container, newPosition);
            }, onDragEnd: function (evt) {
                if (!this.options.draggable) {
                    return;
                } if (this.options.popOnClick) {
                    var p = T.DomUtil.position(this.$container); p.y += 2; T.DomUtil.position(this.$container, p);
                } if (this.options.draggableUsingOffset) { this.resetOffset(); } else { this.resetFromPx(); }
            }
        }; exports.HtmlMarker = HtmlMarker;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ScaleControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
        }; ScaleControl.prototype = {
            options: { offset: [0, 0], fontSize: 10, fontStyle: "normal", fontFamily: "Tahoma", kmLabel: "km", mLabel: "m", miLabel: "mi", ftLabel: "ft", unitSystem: "metric" }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "scale-control", this.map.$container.controls);
                    this.$container.style.position = "absolute"; this.$container.style.left = (this.options.offset[0] + 5) + "px";
                    this.$container.style.bottom = (this.options.offset[1] + 5) + "px"; this.$container.style.fontSize = this.options.fontSize + "pt";
                    this.$container.style.fontFamily = this.options.fontFamily; this.$container.style.fontStyle = this.options.fontStyle;
                }
            }, getPresetDistance: function (resolution) {
                var resStr = parseInt(resolution, 10).toString(); var multiplier = Math.pow(10, resStr.length);
                var res = resolution / multiplier; if (res < 0.03) { return multiplier; } else {
                    if (res < 0.1) { return 5 * multiplier; } else {
                        if (res < 0.2) {
                            return 10 * multiplier;
                        } else { if (res < 0.4) { return 20 * multiplier; } else { return 50 * multiplier; } }
                    }
                }
            }, getPresetMileDistance: function (resolution) {
                var resStr = parseInt(resolution, 10).toString();
                var multiplier = Math.pow(10, resStr.length); var res = resolution / multiplier; if (res < 0.015) { return 5; } else {
                    if (res < 0.02) {
                        return 10;
                    } else {
                        if (res < 0.03) { return multiplier; } else {
                            if (res < 0.1) { return 5 * multiplier; } else {
                                if (res < 0.2) {
                                    return 10 * multiplier;
                                } else { if (res < 0.4) { return 20 * multiplier; } else { return 50 * multiplier; } }
                            }
                        }
                    }
                }
            }, getPresetFeetDistance: function (resolution) {
                var resStr = parseInt(resolution, 10).toString();
                var multiplier = Math.pow(10, resStr.length); var res = resolution / multiplier; if (res < 0.03) {
                    return multiplier;
                } else {
                    if (res < 0.15) { return 5 * multiplier; } else {
                        if (res < 0.25) { return 10 * multiplier; } else {
                            if (res < 0.45) {
                                return 20 * multiplier;
                            } else { return 50 * multiplier; }
                        }
                    }
                }
            }, reset: function () {
                var resolution = this.map.getMapResolution(); var distance, label, width, mileResolution, feetResolution, useMiles;
                if (this.options.unitSystem === "metric") {
                    distance = this.getPresetDistance(resolution); width = distance / resolution;
                    label = this.options.mLabel; if (distance / 1000 >= 1) { distance = distance / 1000; label = this.options.kmLabel; }
                } else {
                    feetResolution = resolution * 3.28084;
                    distance = this.getPresetFeetDistance(feetResolution); label = this.options.ftLabel; useMiles = false; if (distance / 5280 >= 1) {
                        mileResolution = resolution * 0.000621371;
                        distance = this.getPresetMileDistance(mileResolution); useMiles = true; label = this.options.miLabel;
                    } width = useMiles === false ? distance * 0.3048 / resolution : distance * 1609.34 / resolution;
                } var html = ""; html += '<div style="padding-left: 5px;"><span>' + distance + " " + label + "</span></div>"; html += '<div style="width: ' + width + 'px; height: 0px; border: 1px solid;"></div>';
                html += '<div style="position: absolute; border: 1px solid;height: 5px;bottom: 0;"></div>'; html += '<div style="position: absolute; border: 1px solid;height: 5px;bottom: 0;left:' + width + 'px;"></div>';
                this.$container.innerHTML = html;
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.reset, this);
                this.map.events.on("move", this.reset, this); this.initContainer(); this.reset();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset);
                this.map.events.detach("move", this.reset); T.DomUtil.remove(this.$container); this.map = null;
            }
        }; exports.ScaleControl = ScaleControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var AttributionControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
            this.attributions = [];
        }; AttributionControl.prototype = {
            options: { separator: " | ", prefix: "", offset: [0, 0], fontSize: 9, fontFamily: "Tahoma", opacity: 0.5 }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-control tibco-attribution", this.map.$container.controls);
                    this.$container.style.background = "#FFFFFF"; this.$container.style.position = "absolute"; this.$container.style.margin = 0;
                    this.$container.style.right = (this.options.offset[0]) + "px"; this.$container.style.bottom = (this.options.offset[1]) + "px";
                    this.$container.style.padding = "5px"; this.$container.style.fontSize = this.options.fontSize + "pt"; this.$container.style.fontFamily = this.options.fontFamily;
                    this.$container.style.filter = "progid:DXImageTransform.Microsoft.Alpha(Opacity=" + this.options.opacity * 100 + ")";
                    T.DomUtil.setOpacity(this.$container, this.options.opacity);
                }
            }, reset: function () {
                var attribution = ""; var separator = this.options.separator;
                if (this.options.prefix === "" || this.attributions.length === 0) { separator = ""; } attribution = this.options.prefix + separator + this.attributions.join(this.options.separator);
                if (!attribution) { this.$container.style.display = "none"; } else {
                    this.$container.style.display = "block"; this.$container.innerHTML = attribution;
                }
            }, addAttribution: function (text) {
                if (!text || this.getAttributionIndex(text) > -1) { return; } this.attributions.push(text);
                this.reset(); return this;
            }, removeAttribution: function (text) {
                if (!text) { return; } var index = this.getAttributionIndex(text);
                if (index > -1) { this.attributions = this.attributions.slice(index, 1); } return this;
            }, getAttributionIndex: function (text) {
                var i = 0;
                for (i = 0; i < this.attributions.length; i++) { if (text === this.attributions[i]) { return i; } } return -1;
            }, onAdd: function (map) {
                this.map = map;
                this.map.events.on("layer-add", this.onLayerAdd, this); this.map.events.on("layer-remove", this.onLayerRemove, this);
                this.map.events.on("layer-attribution-reset", this.onLayerAttributionReset, this); this.map.events.on("attribution-update", this.onAttributionUpdate, this);
                this.initContainer(); this.reset();
            }, onRemove: function () {
                this.map.events.detach("layer-add", this.onLayerAdd);
                this.map.events.detach("layer-remove", this.onLayerRemove); T.DomUtil.remove(this.$container); this.map = null;
            }, onLayerAdd: function (layer) {
                if (layer.options.attribution) {
                    if (typeof (layer.options.attribution) === "object") {
                        this.addAttribution(layer.options.attribution.text);
                    } else { this.addAttribution(layer.options.attribution); }
                }
            }, onLayerRemove: function (layer) {
                if (layer.options.attribution) {
                    if (typeof (layer.options.attribution) === "object") {
                        this.removeAttribution(layer.options.attribution.text);
                    } else { this.removeAttribution(layer.options.attribution); }
                }
            }, onAttributionUpdate: function (options) {
                if (options) {
                    T.Util.defaults(this.options, options);
                }
            }, onLayerAttributionReset: function (layer) {
                if (layer.options.attribution) {
                    if (typeof (layer.options.attribution) === "object") {
                        this.addAttribution(layer.options.attribution.text);
                    } else { this.addAttribution(layer.options.attribution); }
                }
            }
        }; exports.AttributionControl = AttributionControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var RulerControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
            this.disbaled = false; this.vectorLayer = null; this.markerLayer = null; this.coordinates = []; this.distance = 0; this.polyline = new T.Polyline(this.coordinates);
            this.polyline.setStyle({ color: "#FF0000", stroke: true }); this.events = new T.EventDispatcher();
        }; RulerControl.prototype = {
            options: { disableMouse: false, useCanvas: false, startFlag: "", endFlag: "" }, initContainer: function () {
                if (!this.vectorLayer) {
                    this.vectorLayer = new T.VectorLayer({ useCanvas: this.options.useCanvas });
                    this.map.addLayer(this.vectorLayer); this.vectorLayer.addGeometry(this.polyline);
                } if (!this.markersLayer) {
                    this.markerLayer = new T.MarkersLayer();
                    this.map.addLayer(this.markerLayer);
                }
            }, calculateDisance: function () {
                var i; this.distance = 0; if (this.coordinates.length > 1) {
                    for (i = 1;
                    i < this.coordinates.length; i++) {
                        this.distance += this.computeDistanceBetween(T.LatLng.from(this.coordinates[i - 1]), T.LatLng.from(this.coordinates[i]));
                    }
                } this.events.fire("distance-changed", this);
            }, computeDistanceBetween: function (a, b) {
                var R = 6371; var dLat = (b.lat - a.lat).toRad();
                var dLon = (b.lng - a.lng).toRad(); var lat1 = a.lat.toRad(); var lat2 = b.lat.toRad(); var x = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);
                var y = 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x)); var d = R * y; return d;
            }, enable: function () {
                if (!this.options.disableMouse) {
                    T.DomEventUtil.on(this.map.$container, "click", this.onMapClick, this);
                    if (T.Util.touchSupport()) { T.DomEventUtil.on(this.map.$container, "touchstart", this.onMapClick, this); }
                } this.disabled = false;
            }, disable: function () {
                T.DomEventUtil.off(this.map.$container, "click", this.onMapClick); if (T.Util.touchSupport()) {
                    T.DomEventUtil.off(this.map.$container, "touchstart", this.onMapClick, this);
                } this.disabled = true;
            }, addCoordinate: function (coord) {
                this.coordinates.push([coord.lat, coord.lng]); this.reset();
            }, addCoordinateAt: function (coord, index) {
                this.coordinates.splice(index, 0, [coord.lat, coord.lng]); this.reset();
            }, reset: function () {
                this.vectorLayer.updateViewPort(); var startMarker = null; if (this.coordinates.length === 1) {
                    startMarker = new T.ImageMarker(T.LatLng.from(this.coordinates[0]), this.options.startFlag, { anchor: "bottom-center", offset: new T.Point(0, -5) });
                    this.markerLayer.removeAllMarkers(); this.markerLayer.addMarker(startMarker);
                } else {
                    if (this.coordinates.length > 1) {
                        startMarker = new T.ImageMarker(T.LatLng.from(this.coordinates[0]), this.options.startFlag, { anchor: "bottom-center", offset: new T.Point(0, -5) });
                        var stopMarker = new T.ImageMarker(T.LatLng.from(this.coordinates[this.coordinates.length - 1]), this.options.endFlag, { anchor: "bottom-center", offset: new T.Point(0, -5) });
                        this.markerLayer.removeAllMarkers(); this.markerLayer.addMarker(startMarker); this.markerLayer.addMarker(stopMarker);
                    }
                } this.calculateDisance();
            }, clear: function () {
                this.coordinates = []; this.polyline.coords = this.coordinates;
                this.markerLayer.removeAllMarkers(); this.reset();
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.reset, this);
                this.initContainer(); this.reset();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.reset);
                T.DomUtil.remove(this.$container); this.map = null;
            }, onMapClick: function (e) {
                var mousePosition = this.map.computeMousePosition(e);
                var coord = this.map.containerPointToLatLng(mousePosition); this.coordinates.push([coord.lat, coord.lng]);
                this.reset();
            }
        }; exports.RulerControl = RulerControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var LayersControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
            this.attributions = [];
        }; LayersControl.prototype = {
            CONTROL_LAYERS_CLASS: "tibco-control-layers", CONTROL_LAYERS_HEADER_CLASS: "header", CONTROL_LAYERS_CONTAINER_CLASS: "layers", HEADER_LABEL_CLASS: "label", HEADER_COLLAPSE_CLASS: "collapse", HEADER_COLLAPSE_TRUE_CLASS: "is-collapsed", HEADER_COLLAPSE_FALSE_CLASS: "is-not-collapsed", LAYER_CONTAINER_CLASS: "layer", LAYER_RADIO_CLASS: "radio", LAYER_VISIBLE_CLASS: "visibility", LAYER_LABEL_CLASS: "label", LAYER_SELECTED_CLASS: "selected", options: { offset: [0, 0], fontSize: 10, fontFamily: "Tahoma" }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", this.CONTROL_LAYERS_CLASS, this.map.$container.controls);
                    this.$container.style.top = (this.options.offset[0]) + "px"; this.$container.style.left = (this.options.offset[1]) + "px";
                    this.$container.style.fontSize = this.options.fontSize + "pt"; this.$container.style.fontFamily = this.options.fontFamily;
                    this.createHeader(); this.createLayersContainer(); this.selectedLayerData = this.map.getLayers()[this.map.getLayers().length - 1];
                }
            }, reset: function () {
                var layers = this.map.getLayers(), i = 0; this.clearLayers(); for (i = 0; i < layers.length; i++) {
                    this.createLayer(layers[i]);
                } this.bindKeyEvents();
            }, createHeader: function () {
                var label = null, collapse = null; this.$headerContainer = T.DomUtil.create("div", this.CONTROL_LAYERS_HEADER_CLASS, this.$container);
                this.$headerContainer.style.fontSize = this.options.fontSize + "pt"; this.$headerContainer.style.fontFamily = this.options.fontFamily;
                label = T.DomUtil.create("div", this.HEADER_LABEL_CLASS, this.$headerContainer); label.innerHTML = "Layers";
                collapse = T.DomUtil.create("div", this.HEADER_COLLAPSE_CLASS, this.$headerContainer); T.DomEventUtil.on(this.$headerContainer, "click", this.toggleLayers, this);
                if (T.Util.touchSupport()) {
                    T.DomEventUtil.on(this.$headerContainer, "touchstart", this.toggleLayers, this);
                }
            }, createLayersContainer: function () {
                this.$layersContainer = T.DomUtil.create("div", this.CONTROL_LAYERS_CONTAINER_CLASS, this.$container);
                this.$layersContainer.tabIndex = "1"; this.$layersContainer.style.display = "none";
            }, createLayer: function (layer) {
                var layerContainer = null, radio = null, checkbox = null, label = null;
                layerContainer = T.DomUtil.create("div", this.LAYER_CONTAINER_CLASS, this.$layersContainer); radio = T.DomUtil.create("input", this.LAYER_RADIO_CLASS);
                radio.type = "radio"; radio.name = "active-layer"; layerContainer.appendChild(radio); radio.checked = (layer === this.selectedLayerData) ? "checked" : "";
                checkbox = T.DomUtil.create("input", this.LAYER_VISIBLE_CLASS); checkbox.type = "checkbox"; layerContainer.appendChild(checkbox);
                checkbox.checked = (layer.isVisible() === true) ? "checked" : ""; label = T.DomUtil.create("div", this.LAYER_LABEL_CLASS);
                label.innerHTML = layer.name; layerContainer.appendChild(label); T.DomEventUtil.on(radio, "click", this.onSelectLayer, this);
                T.DomEventUtil.on(checkbox, "click", this.onSetLayerVisibility, this); if (T.Util.touchSupport()) {
                    T.DomEventUtil.on(radio, "touchstart", this.onSelectLayer, this);
                    T.DomEventUtil.on(checkbox, "touchstart", this.onSetLayerVisibility, this);
                }
            }, toggleLayers: function () {
                var collapse = T.DomUtil.getNodesByClass(this.HEADER_COLLAPSE_CLASS)[0];
                if (!collapse) { return; } if (this.areLayersVisible()) {
                    collapse.className = this.HEADER_COLLAPSE_CLASS + " " + this.HEADER_COLLAPSE_TRUE_CLASS;
                    T.DomEventUtil.off(this.$layersContainer, "keydown", this.onKeydownHandler, this); this.hideLayers();
                } else {
                    collapse.className = this.HEADER_COLLAPSE_CLASS + " " + this.HEADER_COLLAPSE_FALSE_CLASS;
                    T.DomEventUtil.on(this.$layersContainer, "keydown", this.onKeydownHandler, this); this.showLayers(); this.$layersContainer.focus();
                }
            }, showLayers: function () { this.$layersContainer.style.display = "block"; }, hideLayers: function () {
                this.$layersContainer.style.display = "none";
            }, areLayersVisible: function () { return (this.$layersContainer.style.display !== "none" ? true : false); }, clearLayers: function () {
                while (this.$layersContainer.hasChildNodes()) {
                    if (T.DomUtil.hasClass(this.$layersContainer.lastChild, this.LAYER_CONTAINER_CLASS)) {
                        this.$layersContainer.removeChild(this.$layersContainer.lastChild);
                    }
                }
            }, bindKeyEvents: function () {
                T.DomEventUtil.off(document, "keydown", this.onKeydownHandler, this); T.DomEventUtil.on(document, "keydown", this.onKeydownHandler, this);
            }, onKeydownHandler: function (evt) {
                if (evt.stopPropagation !== undefined) { evt.stopPropagation(); } else {
                    evt.cancelBubble = true;
                } if (!this.selectedLayerData) { return; } if (evt.keyCode === 38) {
                    this.map.moveLayerDown(this.selectedLayerData);
                } else { if (evt.keyCode === 40) { this.map.moveLayerUp(this.selectedLayerData); } }
            }, onSelectLayer: function (evt) {
                var targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement;
                this.selectedLayerIndex = T.DomUtil.getNodeIndex(targetEelement.parentNode, this.$layersContainer); this.selectedLayerData = this.map.getLayers()[this.selectedLayerIndex];
                this.$layersContainer.focus();
            }, onSetLayerVisibility: function (evt) {
                var layer = null, layerIndex = -1, targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement, layerVisible = targetEelement.checked;
                layerIndex = T.DomUtil.getNodeIndex(targetEelement.parentNode, this.$layersContainer); layer = this.map.getLayers()[layerIndex];
                layer.setVisible(layerVisible);
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("layer-add", this.reset, this);
                this.map.events.on("layer-remove", this.reset, this); this.map.events.on("layer-moved", this.reset, this);
                this.map.events.on("layer-hide", this.reset, this); this.map.events.on("layer-show", this.reset, this); this.initContainer();
                this.reset();
            }, onRemove: function () {
                this.map.events.detach("layer-add", this.reset); this.map.events.detach("layer-remove", this.reset);
                this.map.events.detach("layer-moved", this.reset); T.DomEventUtil.off(this.$headerContainer, "click", this.toggleLayers, this);
                if (T.Util.touchSupport()) {
                    T.DomEventUtil.off(this.$headerContainer, "touchstart", this.toggleLayers, this);
                } T.DomUtil.remove(this.$container); this.map = null;
            }
        }; exports.LayersControl = LayersControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var TibcoMapControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
            this.attributions = [];
        }; TibcoMapControl.prototype = {
            CONTROL_LAYERS_CLASS: "tibco-control-tibco-map", CONTROL_LAYERS_HEADER_CLASS: "header", CONTROL_LAYERS_CONTAINER_CLASS: "layers", HEADER_LABEL_CLASS: "label", HEADER_COLLAPSE_CLASS: "collapse", HEADER_COLLAPSE_TRUE_CLASS: "is-collapsed", HEADER_COLLAPSE_FALSE_CLASS: "is-not-collapsed", LAYER_CONTAINER_CLASS: "layer", LAYER_RADIO_CLASS: "radio", LAYER_VISIBLE_CLASS: "visibility", LAYER_LABEL_CLASS: "label", LAYER_SELECTED_CLASS: "selected", LAYER_OPTIONS_CONTAINER_CLASS: "layer-options", LAYER_OPTIONS_GROUP_CLASS: "layer-options-group", LAYER_OPTIONS_SELECT_CLASS: "layer-options-select", LAYER_OPTION_CLASS: "layer-option", options: { offset: [0, 0], fontSize: 10, fontFamily: "Tahoma" }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", this.CONTROL_LAYERS_CLASS, this.map.$container.controls);
                    this.$container.style.top = (this.options.offset[0]) + "px"; this.$container.style.right = (this.options.offset[1]) + "px";
                    this.$container.style.fontSize = this.options.fontSize + "pt"; this.$container.style.fontFamily = this.options.fontFamily;
                    this.createHeader(); this.createLayersContainer(); this.createOptionsContainer();
                }
            }, reset: function () {
                var layers = this.getMapTibcoLayers(), i = 0;
                this.clearContainer(this.$layersContainer, this.LAYER_CONTAINER_CLASS); for (i = 0; i < layers.length; i++) {
                    this.createLayer(layers[i]);
                }
            }, createHeader: function () {
                var label = null, collapse = null; this.$headerContainer = T.DomUtil.create("div", this.CONTROL_LAYERS_HEADER_CLASS, this.$container);
                this.$headerContainer.style.fontSize = this.options.fontSize + "pt"; this.$headerContainer.style.fontFamily = this.options.fontFamily;
                label = T.DomUtil.create("div", this.HEADER_LABEL_CLASS, this.$headerContainer); label.innerHTML = "Tibco Layers";
                collapse = T.DomUtil.create("div", this.HEADER_COLLAPSE_CLASS, this.$headerContainer); T.DomEventUtil.on(this.$headerContainer, "click", this.toggleContent, this);
                if (T.Util.touchSupport()) {
                    T.DomEventUtil.on(this.$headerContainer, "touchstart", this.toggleContent, this);
                }
            }, createLayersContainer: function () {
                this.$layersContainer = T.DomUtil.create("div", this.CONTROL_LAYERS_CONTAINER_CLASS, this.$container);
                this.$layersContainer.tabIndex = "1"; this.$layersContainer.style.display = "none";
            }, createOptionsContainer: function () {
                this.$layerOptionsContainer = T.DomUtil.create("div", this.LAYER_OPTIONS_CONTAINER_CLASS, this.$container);
                this.$layerOptionsContainer.tabIndex = "1"; this.$layerOptionsContainer.style.display = "none";
            }, createLayer: function (layer) {
                var layerContainer = null, radio = null, label = null;
                layerContainer = T.DomUtil.create("div", this.LAYER_CONTAINER_CLASS, this.$layersContainer); radio = T.DomUtil.create("input", this.LAYER_RADIO_CLASS);
                radio.type = "radio"; radio.name = "active-layer"; layerContainer.appendChild(radio); radio.checked = ""; label = T.DomUtil.create("div", this.LAYER_LABEL_CLASS);
                label.innerHTML = layer.options.name; layerContainer.appendChild(label); T.DomEventUtil.on(radio, "click", this.onSelectLayer, this);
                if (T.Util.touchSupport()) { T.DomEventUtil.on(radio, "touchstart", this.onSelectLayer, this); }
            }, createLayerOptions: function () {
                var i = 0, mapTypesContainer = null, mapStylesContainer = null, mapTypesOptionContainer = null, mapStylesOptionContainer = null, availableMapTypes = null, availableMapStyles = null, mapTypeLabelContainer = null, mapStyleLabelContainer = null, groupContainer = null;
                if (!this.selectedLayerData) { throw new Error("No layer selected!"); } this.clearContainer(this.$layerOptionsContainer, this.LAYER_OPTIONS_GROUP_CLASS);
                this.$layerOptionsContainer.style.display = "block"; availableMapTypes = this.selectedLayerData.getAvailableMapTypes();
                groupContainer = T.DomUtil.create("div", this.LAYER_OPTIONS_GROUP_CLASS, this.$layerOptionsContainer); mapTypeLabelContainer = T.DomUtil.create("span", this.LAYER_OPTIONS_SELECT_CLASS, groupContainer);
                mapTypeLabelContainer.innerHTML = "Map type:"; mapTypesContainer = T.DomUtil.create("select", this.LAYER_OPTIONS_SELECT_CLASS, groupContainer);
                for (i = 0; i < availableMapTypes.length; i++) {
                    mapTypesOptionContainer = T.DomUtil.create("option", this.LAYER_OPTION_CLASS);
                    mapTypesOptionContainer.innerHTML = availableMapTypes[i]; mapTypesContainer.appendChild(mapTypesOptionContainer);
                    T.DomEventUtil.on(mapTypesContainer, "change", this.onMapTypeChanged, this);
                } mapTypesContainer.value = this.selectedLayerData.options.mapType;
                availableMapStyles = this.selectedLayerData.getAvailableMapStyles(); if (!availableMapStyles || availableMapStyles.length === 0) {
                    return;
                } groupContainer = T.DomUtil.create("div", this.LAYER_OPTIONS_GROUP_CLASS, this.$layerOptionsContainer); mapStyleLabelContainer = T.DomUtil.create("span", this.LAYER_OPTIONS_SELECT_CLASS, groupContainer);
                mapStyleLabelContainer.innerHTML = "Map style:"; mapStylesContainer = T.DomUtil.create("select", this.LAYER_OPTIONS_SELECT_CLASS, groupContainer);
                for (i = 0; i < availableMapStyles.length; i++) {
                    mapStylesOptionContainer = T.DomUtil.create("option", this.LAYER_OPTION_CLASS);
                    mapStylesOptionContainer.innerHTML = availableMapStyles[i]; mapStylesContainer.appendChild(mapStylesOptionContainer);
                    T.DomEventUtil.on(mapStylesContainer, "change", this.onMapStyleChanged, this);
                } mapStylesContainer.value = this.selectedLayerData.options.mapStyle;
            }, getMapTibcoLayers: function () {
                var layers = this.map.getLayers(), tibcoLayers = [], i = 0; for (i = 0; i < layers.length;
                i++) { if (layers[i] instanceof T.TibcoLayer) { tibcoLayers.push(layers[i]); } } return tibcoLayers;
            }, toggleContent: function () {
                var collapse = T.DomUtil.getNodesByClass(this.HEADER_COLLAPSE_CLASS)[0];
                if (!collapse) { return; } if (this.areLayersVisible()) {
                    collapse.className = this.HEADER_COLLAPSE_CLASS + " " + this.HEADER_COLLAPSE_TRUE_CLASS;
                    this.hideContent();
                } else {
                    collapse.className = this.HEADER_COLLAPSE_CLASS + " " + this.HEADER_COLLAPSE_FALSE_CLASS;
                    this.showContent(); this.$layersContainer.focus();
                }
            }, showContent: function () {
                this.$layersContainer.style.display = "block";
                if (this.selectedLayerData) { this.$layerOptionsContainer.style.display = "block"; }
            }, hideContent: function () {
                this.$layersContainer.style.display = "none";
                this.$layerOptionsContainer.style.display = "none";
            }, areLayersVisible: function () {
                return (this.$layersContainer.style.display !== "none" ? true : false);
            }, clearContainer: function ($container, containerClass) {
                while ($container.hasChildNodes()) {
                    if (T.DomUtil.hasClass($container.lastChild, containerClass)) {
                        $container.removeChild($container.lastChild);
                    }
                }
            }, onAdd: function (map) {
                this.map = map; this.tibcoLayers = this.getMapTibcoLayers(); if (this.tibcoLayers.length === 0) {
                    throw new Error("Map does not contain TibcoLayers. Cannot initialize this control!");
                } this.map.events.on("layer-add", this.reset, this); this.map.events.on("layer-remove", this.reset, this); this.map.events.on("layer-moved", this.reset, this);
                this.map.events.on("layer-hide", this.reset, this); this.map.events.on("layer-show", this.reset, this); this.initContainer();
                this.reset();
            }, onRemove: function () {
                this.map.events.detach("layer-add", this.reset); this.map.events.detach("layer-remove", this.reset);
                this.map.events.detach("layer-moved", this.reset); T.DomEventUtil.off(this.$headerContainer, "click", this.toggleContent, this);
                if (T.Util.touchSupport()) {
                    T.DomEventUtil.off(this.$headerContainer, "touchstart", this.toggleContent, this);
                } T.DomUtil.remove(this.$container); this.map = null;
            }, onSelectLayer: function (evt) {
                var targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement;
                this.selectedLayerIndex = T.DomUtil.getNodeIndex(targetEelement.parentNode, this.$layersContainer); this.selectedLayerData = this.tibcoLayers[this.selectedLayerIndex];
                this.createLayerOptions(); this.$layersContainer.focus();
            }, onMapTypeChanged: function (evt) {
                var targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement, self = this;
                this.selectedLayerData.setMapType(targetEelement.value).then(function () { self.createLayerOptions(); }, function () { });
            }, onMapStyleChanged: function (evt) {
                var targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement;
                this.selectedLayerData.setMapStyle(targetEelement.value); this.createLayerOptions();
            }
        }; exports.TibcoMapControl = TibcoMapControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var NavigationControl = function (options) {
            this.minHeight = 100;
            this.options = T.Util.defaults(options, this.options); this.height = (!this.options.zoomRailHeight || this.options.zoomRailHeight < this.minHeight) ? this.minHeight : this.options.zoomRailHeight;
        }; NavigationControl.prototype = {
            CONTROL_NAVIGATION_CLASS: "tibco-control-navigation", PAN_CONTROL_CLASS: "pan-control", RESET_CLASS: "reset", PAN_UP_CLASS: "pan-up", PAN_DOWN_CLASS: "pan-down", PAN_LEFT_CLASS: "pan-left", PAN_RIGHT_CLASS: "pan-right", ZOOM_CONTROL_CLASS: "zoom-control", ZOOM_IN_CLASS: "zoom-in", ZOOM_OUT_CLASS: "zoom-out", ZOOM_SLIDER_CLASS: "zoom-slider", ZOOM_RAIL_CLASS: "zoom-rail", ZOOM_THUMB_CLASS: "zoom-thumb", options: { offset: [0, 0], panOffset: 100, panControl: true, zoomControl: true }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", this.CONTROL_NAVIGATION_CLASS, this.map.$container.controls);
                    this.$container.style.top = (this.options.offset[0]) + "px"; this.$container.style.left = (this.options.offset[1]) + "px";
                    this.initPanControl(); this.initZoomControl();
                }
            }, initPanControl: function () {
                if (!this.options.panControl) {
                    return;
                } this.createPanControl();
            }, initZoomControl: function () {
                if (!this.options.zoomControl) { return; } this.createZoomControl();
                this.setPositionForZoom(this.map.zoom); this.drag = new T.MouseUtil(this.$zoomThumbContainer, this.$zoomThumbContainer, { limit: { minX: 0, maxX: 0, minY: this.minY, maxY: this.maxY } });
                this.drag.events.on("drag-end", this.onZoomThumbDragEnd, this); this.drag.enable();
            }, createPanControl: function () {
                this.$panContainer = T.DomUtil.create("div", this.PAN_CONTROL_CLASS, this.$container);
                this.$panUpContainer = T.DomUtil.create("div", this.PAN_UP_CLASS, this.$panContainer); this.$panUpContainer.title = (this.options.titles && this.options.titles.panUp) ? this.options.titles.panUp : "";
                this.$panDownContainer = T.DomUtil.create("div", this.PAN_DOWN_CLASS, this.$panContainer); this.$panDownContainer.title = (this.options.titles && this.options.titles.panDown) ? this.options.titles.panDown : "";
                this.$panLeftContainer = T.DomUtil.create("div", this.PAN_LEFT_CLASS, this.$panContainer); this.$panLeftContainer.title = (this.options.titles && this.options.titles.panLeft) ? this.options.titles.panLeft : "";
                this.$panRightContainer = T.DomUtil.create("div", this.PAN_RIGHT_CLASS, this.$panContainer); this.$panRightContainer.title = (this.options.titles && this.options.titles.panRight) ? this.options.titles.panRight : "";
                if (!this.options.disableMapReset) {
                    this.$resetContainer = T.DomUtil.create("div", this.RESET_CLASS, this.$panContainer);
                    this.$resetContainer.title = (this.options.titles && this.options.titles.reset) ? this.options.titles.reset : "";
                    T.DomEventUtil.on(this.$resetContainer, "click", this.onReset, this); if (T.Util.touchSupport()) {
                        T.DomEventUtil.on(this.$resetContainer, "touchstart", this.onReset, this);
                    }
                } T.DomEventUtil.on(this.$panUpContainer, "click", this.onPanUp, this); T.DomEventUtil.on(this.$panDownContainer, "click", this.onPanDown, this);
                T.DomEventUtil.on(this.$panLeftContainer, "click", this.onPanLeft, this); T.DomEventUtil.on(this.$panRightContainer, "click", this.onPanRight, this);
                if (T.Util.touchSupport()) {
                    T.DomEventUtil.on(this.$panUpContainer, "touchstart", this.onPanUp, this); T.DomEventUtil.on(this.$panDownContainer, "touchstart", this.onPanDown, this);
                    T.DomEventUtil.on(this.$panLeftContainer, "touchstart", this.onPanLeft, this); T.DomEventUtil.on(this.$panRightContainer, "touchstart", this.onPanRight, this);
                }
            }, createZoomControl: function () {
                this.$zoomContainer = T.DomUtil.create("div", this.ZOOM_CONTROL_CLASS, this.$container);
                this.$zoomInContainer = T.DomUtil.create("div", this.ZOOM_IN_CLASS, this.$zoomContainer); this.$zoomInContainer.title = (this.options.titles && this.options.titles.zoomIn) ? this.options.titles.zoomIn : "";
                this.$zoomOutContainer = T.DomUtil.create("div", this.ZOOM_OUT_CLASS, this.$zoomContainer); this.$zoomOutContainer.title = (this.options.titles && this.options.titles.zoomOut) ? this.options.titles.zoomOut : "";
                this.$zoomSliderContainer = T.DomUtil.create("div", this.ZOOM_SLIDER_CLASS, this.$zoomContainer); this.$zoomRailContainer = T.DomUtil.create("div", this.ZOOM_RAIL_CLASS, this.$zoomSliderContainer);
                this.$zoomThumbContainer = T.DomUtil.create("div", this.ZOOM_THUMB_CLASS, this.$zoomRailContainer); this.$zoomSliderContainer.style.height = this.height + "px";
                if (this.minZoom === 0) {
                    this.$zoomSliderContainer.style.height = this.height + this.$zoomThumbContainer.clientHeight + "px";
                } else {
                    this.$zoomSliderContainer.style.height = this.height + this.$zoomThumbContainer.clientHeight - this.zoomSkipInterval + "px";
                } this.$zoomContainer.style.height = this.$zoomSliderContainer.clientHeight + this.$zoomInContainer.clientHeight + this.$zoomOutContainer.clientHeight + "px";
                this.minY = 0; if (this.minZoom === 0) { this.maxY = this.height; } else {
                    this.maxY = this.height - this.zoomSkipInterval;
                } T.DomEventUtil.on(this.$zoomInContainer, "click", this.onZoomIn, this); T.DomEventUtil.on(this.$zoomOutContainer, "click", this.onZoomOut, this);
                T.DomEventUtil.on(this.$zoomRailContainer, "click", this.onRailClick, this); if (T.Util.touchSupport()) {
                    T.DomEventUtil.on(this.$zoomInContainer, "touchstart", this.onZoomIn, this);
                    T.DomEventUtil.on(this.$zoomOutContainer, "touchstart", this.onZoomOut, this);
                }
            }, getBottomPosition: function (topPosition) {
                return this.height - topPosition;
            }, setPositionForZoom: function (zoom) {
                var position = null, snapPosition = null; zoom = (zoom !== undefined) ? zoom : this.map.zoom;
                position = this.getBottomPosition(zoom * this.zoomSkipInterval); T.DomUtil.position(this.$zoomThumbContainer, new T.Point(0, position));
            }, setZoomForPosition: function (position) {
                var newZoom = null; position = this.getBottomPosition(position); if (position === this.minY) {
                    newZoom = this.minZoom;
                } else { newZoom = Math.round(position / this.zoomSkipInterval); } this.map.setZoom(newZoom);
            }, reset: function () {
                if (this.$container) {
                    T.DomUtil.remove(this.$container);
                    this.$container = null;
                } this.minZoom = this.map.options.minZoom; this.maxZoom = this.map.options.maxZoom; if (this.minZoom === 0) {
                    this.zoomSkipInterval = this.height / this.maxZoom;
                } else { this.zoomSkipInterval = this.height / (this.maxZoom - this.minZoom + 1); } this.initContainer();
            }, onPanUp: function () {
                var p = new T.Point(0, this.options.panOffset);
                this.map.panBy(p);
            }, onPanDown: function () {
                var p = new T.Point(0, -this.options.panOffset); this.map.panBy(p);
            }, onPanLeft: function () { var p = new T.Point(this.options.panOffset, 0); this.map.panBy(p); }, onPanRight: function () {
                var p = new T.Point(-this.options.panOffset, 0);
                this.map.panBy(p);
            }, onReset: function () {
                this.map.resetView(this.map.options.center, this.map.options.zoom);
            }, onZoomIn: function () { this.map.setZoom(this.map.zoom + 1); }, onZoomOut: function () {
                this.map.setZoom(this.map.zoom - 1);
            }, onZoomThumbDragEnd: function () {
                var thumbPosition = T.DomUtil.position(this.$zoomThumbContainer).y; this.setZoomForPosition(thumbPosition);
            }, onRailClick: function (evt) {
                var position = null, targetEelement = null; targetEelement = evt.srcElement === undefined ? evt.target : evt.srcElement;
                if (targetEelement.className === this.ZOOM_RAIL_CLASS) {
                    position = evt.offsetY === undefined ? evt.layerY : evt.offsetY;
                    this.setZoomForPosition(position);
                }
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("view-reset", this.setPositionForZoom, this);
                this.map.events.on("zoom-interval-change", this.reset, this); this.reset();
            }, onRemove: function () {
                this.map.events.detach("view-reset", this.setPositionForZoom);
                this.map.events.detach("zoom-interval-change", this.reset); T.DomEventUtil.off(this.$zoomInContainer, "click", this.onZoomIn, this);
                T.DomEventUtil.off(this.$zoomOutContainer, "click", this.onZoomOut, this); T.DomEventUtil.off(this.$zoomRailContainer, "click", this.onRailClick, this);
                T.DomEventUtil.off(this.$resetContainer, "click", this.onReset, this); T.DomEventUtil.off(this.$panUpContainer, "click", this.onPanUp, this);
                T.DomEventUtil.off(this.$panDownContainer, "click", this.onPanDown, this); T.DomEventUtil.off(this.$panLeftContainer, "click", this.onPanLeft, this);
                T.DomEventUtil.off(this.$panRightContainer, "click", this.onPanRight, this); if (T.Util.touchSupport()) {
                    T.DomEventUtil.off(this.$panUpContainer, "touchstart", this.onPanUp, this);
                    T.DomEventUtil.off(this.$panDownContainer, "touchstart", this.onPanDown, this); T.DomEventUtil.off(this.$panLeftContainer, "touchstart", this.onPanLeft, this);
                    T.DomEventUtil.off(this.$panRightContainer, "touchstart", this.onPanRight, this); T.DomEventUtil.off(this.$resetContainer, "touchstart", this.onReset, this);
                    T.DomEventUtil.off(this.$zoomInContainer, "touchstart", this.onZoomIn, this); T.DomEventUtil.off(this.$zoomOutContainer, "touchstart", this.onZoomOut, this);
                } T.DomUtil.remove(this.$container); this.map = null;
            }
        }; exports.NavigationControl = NavigationControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ContextMenuControl = function (options) {
            this.options = T.Util.defaults(options, this.options);
        }; ContextMenuControl.prototype = {
            CONTEXT_MENU_CLASS: "tibco-control-context-menu", CONTEXT_MENU_ITEM_CLASS: "item", options: { offset: [0, 0] }, reset: function () {
                this.removeContextMenu();
            }, addContextMenu: function (evt) {
                this.evt = evt; this.removeContextMenu(); if (!this.$container) {
                    this.$container = T.DomUtil.create("div", this.CONTEXT_MENU_CLASS, this.map.$container.controls);
                    this.$container.style.top = (evt.clientY - this.map.$container.offsetTop + this.options.offset[0]) + "px"; this.$container.style.left = (evt.clientX - this.map.$container.offsetLeft + this.options.offset[1]) + "px";
                } this.addContextMenuItem("What's here?", this.onLocationClick);
            }, addContextMenuItem: function (text, callback) {
                var $menuItemContainer = T.DomUtil.create("div", this.CONTEXT_MENU_ITEM_CLASS, this.$container);
                $menuItemContainer.innerHTML = text; T.DomEventUtil.on($menuItemContainer, "click", callback, this);
            }, removeContextMenu: function () {
                if (this.$container) {
                    T.DomUtil.remove(this.$container);
                    this.$container = null;
                } this.removeContextMenuItems();
            }, removeContextMenuItems: function () {
                if (this.markerLayer) {
                    this.markerLayer.removeAllMarkers();
                } if (this.popupLayer) { this.popupLayer.removeAllPopups(); }
            }, onLocationClick: function () {
                var popup = null, marker = null;
                this.removeContextMenu(); if (!this.markerLayer) {
                    this.markerLayer = new T.MarkersLayer({ name: "Internal Context Menu Marker Layer" });
                    this.map.addLayer(this.markerLayer);
                } this.markerLayer.removeAllMarkers(); marker = new T.ImageMarker(this.evt.latLng, "http://geoanalytics.tibco.com/documentation/assets/img/marker.png", { offset: new T.Point(-2, -10) });
                this.markerLayer.addMarker(marker); if (!this.popupLayer) {
                    this.popupLayer = new T.PopupsLayer({ name: "Internal Context Menu Popup Layer" });
                    this.map.addLayer(this.popupLayer);
                } this.popupLayer.removeAllPopups(); popup = new T.Popup("<div class='tibco-control-context-menu-popup'>" + this.evt.latLng.lat.toFixed(6) + ", " + this.evt.latLng.lng.toFixed(6) + "</div>", { offset: { x: 0, y: -35 }, panMap: true, panMapExtraOffset: { x: 10, y: 10 } });
                this.popupLayer.addPopup(popup); popup.open(marker.latlng);
            }, onAdd: function (map) {
                this.map = map; this.map.events.on("right-click", this.addContextMenu, this);
                this.map.events.on("press", this.removeContextMenu, this); this.map.events.on("long-press", this.removeContextMenu, this);
                this.map.events.on("move", this.removeContextMenu, this); this.map.events.on("view-reset", this.removeContextMenu, this);
                this.reset();
            }, onRemove: function () {
                this.map.events.detach("right-click", this.addContextMenu); this.map.events.detach("press", this.removeContextMenu);
                this.map.events.detach("long-press", this.removeContextMenu); this.map.events.detach("move", this.removeContextMenu);
                this.map.events.detach("view-reset", this.removeContextMenu); T.DomUtil.remove(this.$container); this.map = null;
            }
        }; exports.ContextMenuControl = ContextMenuControl;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var GeoJsonImporter = function (geoJson, options) {
            this.options = options || {};
            this.geometries = []; if (typeof geoJson === "string") { this.initGeoJsonFromUrl(geoJson); } else {
                this.initGeoJson(geoJson);
            }
        }; GeoJsonImporter.prototype = {
            initGeoJson: function (geoJson) {
                this.geoJson = geoJson; this.readPart(geoJson);
                if (this.options.success) { this.options.success(this); }
            }, initGeoJsonFromUrl: function (url) {
                var ajax = new T.Ajax();
                ajax.send(url, {
                    method: "GET", on: {
                        success: T.Util.bind(function (content) {
                            var json; try {
                                json = JSON.parse(content);
                            } catch (err) { throw "The URL content is not a valid JSON! " + err.message; } this.initGeoJson(json);
                        }, this)
                    }
                });
            }, getStyle: function (properties) {
                return T.Util.isFunction(this.options.style) ? this.options.style(properties) : this.options.style;
            }, readPart: function (obj, properties) {
                var i, point, style; switch (obj.type) {
                    case "Point": style = this.getStyle(properties) || { color: "#ff0000", weight: 1 };
                        point = new T.Circle(obj.coordinates, style.radius || 3, { radiusMeasure: "pixel", style: style, reverseCoordinates: true, geojsonProperties: properties });
                        this.geometries.push(point); break; case "MultiPoint": style = this.getStyle(properties) || { color: "#ff0000", weight: 1 };
                            for (i = 0; i < obj.coordinates.length; i++) {
                                point = new T.Circle(obj.coordinates[i], style.radius || 3, { radiusMeasure: "pixel", style: style, reverseCoordinates: true, geojsonProperties: properties });
                                this.geometries.push(point);
                            } break; case "LineString": var lineString = new T.Polyline(obj.coordinates, { reverseCoordinates: true, style: this.getStyle(properties), geojsonProperties: properties });
                                this.geometries.push(lineString); break; case "MultiLineString": var multiLineString = new T.MultiPolyline(obj.coordinates, { reverseCoordinates: true, style: this.getStyle(properties), geojsonProperties: properties });
                                    this.geometries.push(multiLineString); break; case "Polygon": var polygon = new T.Polygon(obj.coordinates, { reverseCoordinates: true, style: this.getStyle(properties), geojsonProperties: properties });
                                        this.geometries.push(polygon); break; case "MultiPolygon": var multiPolygon = new T.MultiPolygon(obj.coordinates, { reverseCoordinates: true, style: this.getStyle(properties), geojsonProperties: properties });
                                            this.geometries.push(multiPolygon); break; case "GeometryCollection": for (i = 0; i < obj.geometries.length; i++) {
                                                this.readPart(obj.geometries[i]);
                                            } break; case "Feature": this.readPart(obj.geometry, obj.properties); break; case "FeatureCollection": for (i = 0;
                                            i < obj.features.length; i++) { this.readPart(obj.features[i]); } break;
                }
            }, addTo: function (layer) {
                var i; for (i = 0;
                i < this.geometries.length; i++) { layer.addGeometry(this.geometries[i]); }
            }
        }; exports.GeoJsonImporter = GeoJsonImporter;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var GeocoderResult = function (resultObject) {
            if (!resultObject) {
                throw new Error("Please specify the geocoder result!");
            } if (resultObject.Location && resultObject.Location.Latitude && resultObject.Location.Longitude) {
                this.location = new T.LatLng(resultObject.Location.Latitude, resultObject.Location.Longitude);
            } if (resultObject.BoundingBox && resultObject.BoundingBox.NorthEast && resultObject.BoundingBox.NorthEast.Latitude && resultObject.BoundingBox.NorthEast.Longitude && resultObject.BoundingBox.SouthWest && resultObject.BoundingBox.SouthWest.Latitude && resultObject.BoundingBox.SouthWest.Longitude) {
                this.bounds = new T.LatLngBounds(new T.LatLng(resultObject.BoundingBox.SouthWest.Latitude, resultObject.BoundingBox.SouthWest.Longitude), new T.LatLng(resultObject.BoundingBox.NorthEast.Latitude, resultObject.BoundingBox.NorthEast.Longitude));
            } if (resultObject.City) { this.city = resultObject.City; } if (resultObject.Country) {
                this.country = resultObject.Country;
            } if (resultObject.EntireAddress) { this.address = resultObject.EntireAddress; } if (resultObject.State) {
                this.state = resultObject.State;
            } if (resultObject.Street) { this.street = resultObject.Street; } if (resultObject.StreetName) {
                this.streetName = resultObject.StreetName;
            } if (resultObject.StreetNb) { this.streetNumber = resultObject.StreetNb; } if (resultObject.StreetType) {
                this.streetType = resultObject.StreetType;
            } if (resultObject.Zip) { this.zip = resultObject.Zip; } if (resultObject.Level) {
                this.level = resultObject.Level;
            } if (resultObject.LevelInfo) { this.levelInfo = resultObject.LevelInfo; } if (resultObject.Score) {
                this.score = resultObject.Score;
            }
        }; GeocoderResult.prototype = { location: null, bounds: null, country: null, city: null, address: null, state: null, street: null, streetName: null, streetNumber: null, streetType: null, zip: null, level: null, levelInfo: null, score: null };
        exports.GeocoderResult = GeocoderResult;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var Geocoder = function (customer, key, url) {
            if (!customer || !key) {
                throw new Error("Please set the geocoder customer and key!");
            } this.customer = customer; this.key = key; this.url = url ? url : T.settings.geoWebServices;
        }; Geocoder.prototype = {
            geocode: function (options) {
                var url = null, promise = new T.Promise();
                if (!this.customer || !this.key) { throw new Error("Please set the geocoder customer and key!"); } if (!options || !options.country) {
                    throw new Error("Please set the country!");
                } if (!options.city && !options.zip) {
                    throw new Error("Please set one of the following options, necessary in order to geocode: city or zip!");
                } url = this.url; var cfg = {
                    method: "GET", withCredentials: false, on: {
                        success: function (result) {
                            var resultObject = JSON.parse(result), geocoderResults = [], i = 0;
                            for (i = 0; i < resultObject.length; i++) { geocoderResults.push(new T.GeocoderResult(resultObject[i])); } promise.resolve(geocoderResults);
                        }, error: function (errorObject) { promise.reject(errorObject); }
                    }
                }; url += this.customer; url += "/coder.json"; url += "?geocoder=maporama";
                url += "&maporamakey=" + this.key; url += "&country=" + options.country; if (options.city) {
                    url += "&city=" + options.city;
                } if (options.zip) { url += "&zip=" + options.zip; } if (options.state) { url += "&state=" + options.state; } if (options.street) {
                    url += "&street=" + options.street;
                } new T.Ajax().send(url, cfg); return promise;
            }, reverseGeocode: function (latLngObject) {
                var url = null, promise = new T.Promise();
                if (!this.customer || !this.key) { throw new Error("Please set the geocoder customer and key!"); } if (!latLngObject || !latLngObject.lat || !latLngObject.lng) {
                    throw new Error("Please specify the location!");
                } url = this.url; var cfg = {
                    method: "GET", withCredentials: false, on: {
                        success: function (result) {
                            var resultObject = JSON.parse(result), geocoderResults = [], i = 0;
                            for (i = 0; i < resultObject.length; i++) { geocoderResults.push(new T.GeocoderResult(resultObject[i])); } promise.resolve(geocoderResults);
                        }, error: function (errorObject) { promise.reject(errorObject); }
                    }
                }; url += this.customer; url += "/coder.json"; url += "?geocoder=maporama";
                url += "&maporamakey=" + this.key; url += "&latitude=" + latLngObject.lat; url += "&longitude=" + latLngObject.lng;
                new T.Ajax().send(url, cfg); return promise;
            }
        }; exports.Geocoder = Geocoder;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var DistanceServiceResult = function (resultObject) {
            if (!resultObject) {
                throw new Error("Please specify the distance service result!");
            } this.distance = {}; this.time = {}; if (resultObject.StartLocation) {
                this.startLocation = new T.LatLng(resultObject.StartLocation.Latitude, resultObject.StartLocation.Longitude);
            } if (resultObject.EndLocation) {
                this.endLocation = new T.LatLng(resultObject.EndLocation.Latitude, resultObject.EndLocation.Longitude);
            } if (resultObject.StartName) { this.startName = resultObject.StartName; } if (resultObject.EndName) {
                this.endName = resultObject.EndName;
            } if (resultObject.DrivingDistance) {
                this.distance.kilometers = resultObject.DrivingDistance.Km || null; this.distance.meters = resultObject.DrivingDistance.Meters || null;
                this.distance.miles = resultObject.DrivingDistance.Miles || null; this.distance.feet = resultObject.DrivingDistance.Feet || null;
            } if (resultObject.DrivingTime) {
                this.time.seconds = resultObject.DrivingTime.seconds || null; this.time.hh_mm = resultObject.DrivingTime.hh_mm || null;
            }
        }; DistanceServiceResult.prototype = { startLocation: null, endLocation: null, startName: "", endName: "", distance: null, time: null };
        exports.DistanceServiceResult = DistanceServiceResult;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var DistanceService = function (customer, key, url) {
            if (!customer || !key) {
                throw new Error("Please set the DistanceService customer and key!");
            } this.customer = customer; this.key = key; this.url = url || T.settings.geoWebServices;
        }; DistanceService.prototype = {
            computeDistance: function (start, waypoints, options) {
                var url = null, promise = new T.Promise(), i = 0;
                if (!this.customer || !this.key) { throw new Error("Please set the DistanceService customer and key!"); } if (!start || !start.lat || !start.lng) {
                    throw new Error("Invalid start point!");
                } if (!waypoints || waypoints.length === 0) { throw new Error("Waypoints missing!"); } for (i = 0; i < waypoints.length;
                i++) {
                    if (!waypoints[i].location || !waypoints[i].location.lat || !waypoints[i].location.lng) {
                        throw new Error("Invalid waypoints!");
                    }
                } url = this.url; var cfg = {
                    method: "POST", withCredentials: false, data: this._buildDistancePayload(start, waypoints, options), on: {
                        success: function (result) {
                            var resultObject = JSON.parse(result).Segments, DistanceServiceResults = [], i = 0, theResult;
                            for (i = 0; i < resultObject.length; i++) {
                                theResult = new T.DistanceServiceResult(resultObject[i]); DistanceServiceResults.push(theResult);
                            } promise.resolve(DistanceServiceResults);
                        }, error: function (errorObject) { promise.reject(errorObject); }
                    }
                };
                url += this.customer; url += "/itinerary/distance/onetomany.json"; url += "?maporamakey=" + this.key; new T.Ajax().send(url, cfg);
                return promise;
            }, _buildDistancePayload: function (start, waypoints, options) {
                var payload = ""; payload += "startpoint=" + start.lng + "," + start.lat;
                payload += this._buildWaypointsPayload(waypoints); if (options && options.travelMode) {
                    payload += "&travelmode=" + options.travelMode;
                } if (options && options.avoidTollRoad !== undefined) { payload += "&avoidtollroad=" + options.avoidTollRoad; } if (options && options.avoidHighways) {
                    payload += "&avoidhighways=" + options.avoidHighways;
                } if (options && options.unitSystem) { payload += "&unitsystem=" + options.unitSystem; } if (options && options.optimizationType) {
                    payload += "&optimizationtype=" + options.optimizationType;
                } if (options && options.customSpeedProfile && options.customSpeedProfile.length > 0) {
                    payload += "&customspeedprofile=" + options.customSpeedProfile.join();
                } return payload;
            }, _buildWaypointsPayload: function (waypoints) {
                var i = 0, waypointName = "", waypointsPayload = "&waypoints=", pointIndex = 0;
                for (i = 0; i < waypoints.length; i++) {
                    pointIndex = i + 1; waypointName = waypoints[i].name || "point" + pointIndex; waypointsPayload += "n:" + waypointName + ";ll:" + waypoints[i].location.lng + "," + waypoints[i].location.lat + "|";
                } waypointsPayload = waypointsPayload.substring(0, waypointsPayload.length - 1); return waypointsPayload;
            }
        };
        exports.DistanceService = DistanceService;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ItineraryService = function (customer, key, url) {
            if (!customer || !key) {
                throw new Error("Please set the ItineraryService customer and key!");
            } this.customer = customer; this.key = key; this.url = url || T.settings.geoWebServices;
        }; ItineraryService.prototype = {
            computeItinerary: function (start, end, waypoints, options) {
                var url = null, promise = new T.Promise(), i = 0;
                if (!this.customer || !this.key) { throw new Error("Please set the ItineraryService customer and key!"); } if (!start || !start.lat || !start.lng) {
                    throw new Error("Invalid start point!");
                } if (!end || !end.lat || !end.lng) { throw new Error("Invalid end point!"); } if (waypoints && waypoints.length > 0) {
                    for (i = 0;
                    i < waypoints.length; i++) {
                        if (!waypoints[i].lat || !waypoints[i].lng) {
                            throw new Error("Invalid waypoints!");
                        }
                    }
                } url = this.url; var cfg = {
                    method: "POST", withCredentials: false, data: this._buildItineraryPayload(start, end, waypoints, options), on: {
                        success: function (result) {
                            var resultObject = JSON.parse(result);
                            promise.resolve(resultObject);
                        }, error: function (errorObject) { promise.reject(errorObject); }
                    }
                }; url += this.customer;
                url += "/itinerary.json"; url += "?maporamakey=" + this.key; new T.Ajax().send(url, cfg); return promise;
            }, _buildItineraryPayload: function (start, end, waypoints, options) {
                var payload = "";
                payload += "start=" + start.lng + ";" + start.lat; payload += "&end=" + end.lng + ";" + end.lat; if (waypoints && waypoints.length > 0) {
                    payload += this._buildWaypointsPayload(waypoints);
                } if (options && options.language) { payload += "&language=" + options.language; } if (options && options.travelMode) {
                    payload += "&mode=" + options.travelMode;
                } if (options && options.avoidTollRoad !== undefined) { payload += "&avoidtollroad=" + options.avoidTollRoad; } if (options && options.returnPolyline !== undefined) {
                    payload += "&polyline=" + options.returnPolyline;
                } if (options && options.avoidHighways) { payload += "&avoidhighways=" + options.avoidHighways; } if (options && options.unitSystem) {
                    payload += "&unitsystem=" + options.unitSystem;
                } if (options && options.optimizationType) { payload += "&optimizationtype=" + options.optimizationType; } if (options && options.customSpeedProfile && options.customSpeedProfile.length > 0) {
                    payload += "&customspeedprofile=" + options.customSpeedProfile.join();
                } return payload;
            }, _buildWaypointsPayload: function (waypoints) {
                var i = 0, waypointsPayload = "&steps=", pointIndex = 0;
                for (i = 0; i < waypoints.length; i++) { waypointsPayload += waypoints[i].lng + ";" + waypoints[i].lat + "|"; } waypointsPayload = waypointsPayload.substring(0, waypointsPayload.length - 1);
                return waypointsPayload;
            }
        }; exports.ItineraryService = ItineraryService;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var ItineraryRenderer = function (map) {
            if (!map) {
                throw new Error("Please specify the map on which the itinerray is displayed!");
            } this.map = map; this.vectorLayer = new T.VectorLayer({ useCanvas: false }); this.markersLayer = new T.MarkersLayer();
            this.map.addLayer(this.vectorLayer); this.map.addLayer(this.markersLayer);
        }; ItineraryRenderer.prototype = {
            displayItinerary: function (computedItinerary, options) {
                var i = 0, allPoints = [], polylines = [], itineraryBounds = new T.LatLngBounds();
                options = options || {}; if (!computedItinerary || !computedItinerary.Polyline) {
                    throw new Error("Invalid itinerary!");
                } for (i = 0; i < computedItinerary.Polyline.length - 1; i++) {
                    polylines.push(this._createPolyline(computedItinerary.Polyline[i], computedItinerary.Polyline[i + 1], options));
                    if (options.zoomToItinerary) {
                        itineraryBounds.extend(new T.LatLng(computedItinerary.Polyline[i].Latitude, computedItinerary.Polyline[i].Longitude));
                    }
                } var f = T.Util.bind(function () {
                    this._addMarker(computedItinerary.Polyline[0], options.startMarkerPath || "http://geoanalytics.tibco.com/documentation/assets/img/marker.png", options.startMarkerOffset || new T.Point(0, -10));
                    this._addMarker(computedItinerary.Polyline[computedItinerary.Polyline.length - 1], options.endMarkerPath || "http://geoanalytics.tibco.com/documentation/assets/img/marker.png", options.endMarkerOffset || new T.Point(0, -10));
                    for (i = 0; i < polylines.length; i++) { this.vectorLayer.addGeometry(polylines[i]); } this._getTileLayer().events.detach("tiles-loaded", f);
                }, this); this._getTileLayer().events.on("tiles-loaded", f); if (options.zoomToItinerary) {
                    itineraryBounds.extend(computedItinerary.Polyline[computedItinerary.Polyline.length - 1].Latitude, computedItinerary.Polyline[computedItinerary.Polyline.length - 1].Longitude);
                    this.map.fitToBounds(itineraryBounds);
                }
            }, removeItinerary: function () {
                var i = 0; this.markersLayer.removeAllMarkers();
                this.vectorLayer.removeAllGeometries();
            }, _createPolyline: function (start, end, options) {
                var stroke = (options.stroke !== undefined) ? options.stroke : true, strokeColor = options.strokeColor || "#428bca", strokeOpacity = (options.strokeOpacity !== undefined) ? options.strokeOpacity : 1, strokeWeight = (options.strokeWeight !== undefined) ? options.strokeWeight : 2, polyline = null;
                polyline = new T.Polyline([[start.Latitude, start.Longitude], [end.Latitude, end.Longitude]]); polyline.setStyle({ stroke: stroke, color: strokeColor, opacity: strokeOpacity, weight: strokeWeight });
                return polyline;
            }, _addMarker: function (polylineItem, imgPath, offset) {
                var marker = new T.ImageMarker(new T.LatLng(polylineItem.Latitude, polylineItem.Longitude), imgPath, { offset: offset });
                this.markersLayer.addMarker(marker);
            }, _getTileLayer: function () {
                var i = 0; for (i = 0; i < this.map.layersArray.length;
                i++) { if (this.map.layersArray[i] instanceof T.TibcoLayer) { return this.map.layersArray[i]; } } return null;
            }
        }; exports.ItineraryRenderer = ItineraryRenderer;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var TradeAreaService = function (customer, key, url) {
            if (!customer || !key) {
                throw new Error("Please set the TradeAreaService customer and key!");
            } this.customer = customer; this.key = key; this.url = url || T.settings.geoWebServices;
        }; TradeAreaService.prototype = {
            computeTradeArea: function (center, value, options) {
                var url = null, promise = new T.Promise(), i = 0;
                if (!this.customer || !this.key) { throw new Error("Please set the TradeAreaService customer and key!"); } if (!center || !center.lat || !center.lng) {
                    throw new Error("Invalid center point!");
                } if (options && options.travelMode) {
                    if (options.travelMode === "vehicle") { options.travelMode = "drive"; } else {
                        if (options.travelMode === "pedestrian") {
                            options.travelMode = "walk";
                        } else {
                            throw new Error("Invalid travel mode: " + options.travelMode + ". Accepted values are: 'vehicle' or 'pedestrian'!");
                        }
                    }
                } if (options && options.computationType) {
                    if (options.computationType === "time") {
                        options.computationType = "bytime";
                    } else {
                        if (options.computationType === "distance") { options.computationType = "bydistance"; } else {
                            throw new Error("Invalid computation type: " + options.computationType + ". Accepted values are: 'time' or 'distance'!");
                        }
                    }
                } url = this.url; var cfg = {
                    method: "GET", withCredentials: false, on: {
                        success: function (result) {
                            var resultObject = JSON.parse(result);
                            promise.resolve(resultObject);
                        }, error: function (errorObject) { promise.reject(errorObject); }
                    }
                }; url += this.customer;
                url += "/tradearea.json"; url += "?maporamakey=" + this.key; url += "&point=" + center.lng + ";" + center.lat; url += "&unit=" + value;
                url += "&format=arrayOfPosition"; if (options && options.computationType) {
                    url += "&type=" + options.computationType;
                } if (options && options.travelMode) { url += "&mode=" + options.travelMode; } if (options && options.precision) {
                    url += "&precision=" + options.precision;
                } if (options && options.tableName) { url += "&tablename=" + options.tableName; } if (options && options.costRation) {
                    url += "&costratio=" + options.costRation;
                } new T.Ajax().send(url, cfg); return promise;
            }
        }; exports.TradeAreaService = TradeAreaService;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var LegacyDragHandler = function (options) { }; LegacyDragHandler.prototype = {
            init: function (map) {
                this.map = map;
                this.drag = new T.LegacyDragUtil(map.$container.layers, map.$container.layers); this.drag.events.on("drag-start", this.onDragStart, this);
                this.drag.events.on("drag", this.onDrag, this); this.drag.events.on("drag-end", this.onDragEnd, this); this.drag.enable();
            }, onDragStart: function (evt) { this.map.events.fire("move-start"); }, onDrag: function (evt) {
                this.map.events.fire("move", { offset: evt.offset });
            }, onDragEnd: function (evt) { if (this.drag.moved) { this.map.events.fire("move-end"); } }, disable: function () {
                this.drag.disable();
            }, enable: function () { this.drag.enable(); }
        }; exports.LegacyDragHandler = LegacyDragHandler;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var LegacyDragUtil = function (element, dragTarget, options) {
            this.element = element;
            this.events = new T.EventDispatcher(); this.dragTarget = dragTarget || element; this.options = T.Util.defaults(options, this.options);
        }; LegacyDragUtil.prototype = {
            options: {}, enable: function () {
                if (this.isEnable) { return; } T.DomEventUtil.on(this.dragTarget, "mousedown", this.onDown, this);
                this.isEnable = true;
            }, disable: function () {
                if (!this.isEnable) { return; } T.DomEventUtil.off(this.dragTarget, "mousedown", this.onDown, this);
                this.isEnable = false;
            }, onDown: function (evt) {
                T.DomEventUtil.stop(evt); this.moved = false; this.startPoint = new T.Point(evt.clientX, evt.clientY);
                this.startPos = this.newPos = T.DomUtil.position(this.element); T.DomEventUtil.on(document, "mousemove", this.onMove, this);
                T.DomEventUtil.on(document, "mouseup", this.onUp, this); this.events.fire("before-drag");
            }, onMove: function (evt) {
                var newPoint = new T.Point(evt.clientX, evt.clientY), offset = newPoint.substract(this.startPoint);
                T.DomEventUtil.preventDefault(evt); if (!this.moved) {
                    this.events.fire("drag-start"); this.moved = true; this.startPos = T.DomUtil.position(this.element).substract(offset);
                } this.newPos = this.startPos.add(offset); this.moving = true; if (this.options.limit) {
                    if (this.options.limit.minX !== undefined && this.options.limit.minX > this.newPos.x) {
                        this.newPos.x = this.options.limit.minX;
                    } if (this.options.limit.maxX !== undefined && this.options.limit.maxX < this.newPos.x) {
                        this.newPos.x = this.options.limit.maxX;
                    } if (this.options.limit.minY !== undefined && this.options.limit.minY > this.newPos.y) {
                        this.newPos.y = this.options.limit.minY;
                    } if (this.options.limit.maxY !== undefined && this.options.limit.maxY < this.newPos.y) {
                        this.newPos.y = this.options.limit.maxY;
                    }
                } if (this.options.skipInterval) {
                    if (this.options.skipInterval.y) {
                        this.newPos.y = this.newPos.y - (this.newPos.y % this.options.skipInterval.y);
                    } if (this.options.skipInterval.x) {
                        this.newPos.x = this.newPos.x - (this.newPos.x % this.options.skipInterval.x);
                    }
                } T.DomUtil.position(this.element, this.newPos); this.events.fire("drag", { offset: offset });
            }, onUp: function (evt) {
                T.DomEventUtil.off(document, "mousemove", this.onMove, this);
                T.DomEventUtil.off(document, "mouseup", this.onUp, this); this.events.fire("drag-end"); this.moving = false;
                this.moved = false;
            }
        }; exports.LegacyDragUtil = LegacyDragUtil;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var LegacyHtmlMarker = function (latlng, html, options) {
            this.latlng = latlng;
            this.html = html; this.options = T.Util.defaults(options, this.options); this.dragOffset = new T.Point(0, 0); this.initContainer();
            if (this.options.draggable) { this.addHandler(new T.LegacyMarkerDragHandler()); }
        }; LegacyHtmlMarker.prototype = {
            options: { draggable: false, draggableUsingOffset: false, popOnClick: false, offset: new T.Point(0, 0) }, initContainer: function () {
                if (!this.$container) {
                    this.$container = T.DomUtil.create("div", "tibco-marker");
                    this.$container.marker = this; this.$container.style.position = "absolute"; if (this.html) {
                        this.$container.innerHTML = this.html;
                    }
                }
            }, addHandler: function (handler) { handler.init(this); }, reset: function () {
                var pxPosition = this.layer.map.latLngToPoint(this.latlng).floor();
                pxPosition = pxPosition.substract(this.options.offset).add(this.dragOffset); T.DomUtil.position(this.$container, pxPosition);
            }, resetFromPx: function () {
                var p = T.DomUtil.position(this.$container).add(this.options.offset); this.latlng = this.layer.map.pointToLatLng(p);
            }, resetOffset: function () {
                var viewportPos = this.layer.map.latLngToPoint(this.latlng); var currentPos = T.DomUtil.position(this.$container);
                this.dragOffset = currentPos.substract(viewportPos);
            }, onAdd: function (layer) {
                if (!(layer instanceof T.LegacyMarkersLayer)) {
                    throw new Error("Legacy HTML Markers should only be added to LegacyMarkersLayer!");
                }
            }, onRemove: function (layer) { }
        }; exports.LegacyHtmlMarker = LegacyHtmlMarker;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var LegacyMarkerDragHandler = function (options) { };
        LegacyMarkerDragHandler.prototype = {
            init: function (marker) {
                this.marker = marker; this.drag = new T.LegacyDragUtil(marker.$container, marker.$container);
                this.drag.events.on("before-drag", this.onBeforeStart, this); this.drag.events.on("drag", this.onDrag, this);
                this.drag.events.on("drag-end", this.onDragEnd, this); this.drag.enable();
            }, onBeforeStart: function (evt) {
                if (this.marker.options.popOnClick) {
                    var p = T.DomUtil.position(this.marker.$container);
                    p.y -= 2; T.DomUtil.position(this.marker.$container, p);
                }
            }, onDrag: function (evt) { }, onDragEnd: function (evt) {
                if (this.marker.options.popOnClick) {
                    var p = T.DomUtil.position(this.marker.$container);
                    p.y += 2; T.DomUtil.position(this.marker.$container, p);
                } if (this.marker.options.draggableUsingOffset) {
                    this.marker.resetOffset();
                } else { this.marker.resetFromPx(); } if (this.marker.layer) {
                    this.marker.layer.events.fire("marker-drag-end", this.marker);
                }
            }
        }; exports.LegacyMarkerDragHandler = LegacyMarkerDragHandler;
    }(window.T));
}, function (module, exports) {
    (function (exports) {
        var base = T.MarkersLayer;
        var LegacyMarkersLayer = function (options) { base.call(this, options); this.markers = []; }; LegacyMarkersLayer.prototype = {
            addMarker: function (marker) {
                if (!(marker instanceof T.LegacyHtmlMarker)) {
                    throw new Error("Legacy markers layer only works with LegacyHtmlMarker");
                } marker.layer = this; marker.onAdd(this); marker.reset(); if (this.$container) {
                    this.$container.appendChild(marker.$container);
                } this.markers.push(marker); marker.$container = base.prototype.setAsInteractiveTarget.call(this, marker.$container, marker);
            }
        }; T.Util.inherit(LegacyMarkersLayer, T.MarkersLayer); exports.LegacyMarkersLayer = LegacyMarkersLayer;
    }(window.T));
}]); 

$(function () {
    var createSplitterFeedback = function ($viewport, mouseEvent, immediate, splitterSettings) {
        var noFeedback = { update: $.noop, remove: $.noop };
        if (immediate) { return noFeedback; } var xStart = mouseEvent.pageX; var yStart = mouseEvent.pageY; var offset = $viewport.offset();
        var bounds = splitterSettings.bounds; var cursor = splitterSettings.isHorizontal ? "row-resize" : "col-resize";
        var $splitter = $("<div>").css("position", "absolute").css("left", offset.left + bounds.x).css("top", offset.top + bounds.y).css("width", bounds.width).css("height", bounds.height).css("background-color", "#666666").css("opacity", "0.3").css("cursor", cursor).appendTo("body");
        return {
            update: function (mouseEvent) {
                var delta = splitterSettings.isHorizontal ? mouseEvent.pageY - yStart : mouseEvent.pageX - xStart;
                delta = Math.max(-splitterSettings.lowerLimit, delta); delta = Math.min(splitterSettings.upperLimit, delta);
                if (splitterSettings.isHorizontal) { $splitter.css("top", offset.top + bounds.y + delta); } else {
                    $splitter.css("left", offset.left + bounds.x + delta);
                }
            }, remove: function () { $splitter.remove(); }
        };
    }; var create = function ($viewport, canvasState, modify) {
        var Point = Spotfire.Drawing.Point;
        var getMarkArea = function (area) {
            if (!area) { return null; } var markArea = { horizontal: area.alignment === "top" || area.alignment === "bottom" };
            $.extend(markArea, canvasState.renderResult.data.panelsBounds); return markArea;
        }; var getEntryPoint = function (event) {
            var offset = $viewport.offset();
            return new Point(event.pageX - offset.left, event.pageY - offset.top);
        }; var startRectangleZoom = function (mouseDownEvent, area) {
            var markArea = getMarkArea(area);
            var entryPoint = getEntryPoint(mouseDownEvent); var zoomCallback = function (points) {
                modify("MarkZoom", { token: canvasState.currentToken, points: points });
            }; Spotfire.Visuals.CanvasVisualization.Marking.createOverlay($viewport, entryPoint, "sf-overlay-zoom", false, zoomCallback, markArea);
        }; var startMarking = function (mouseDownEvent, area, markingDoneCallback, forceLasso) {
            var isLasso = mouseDownEvent.altKey || forceLasso;
            var markArea = getMarkArea(area); var entryPoint = getEntryPoint(mouseDownEvent); var markMode = mouseDownEvent.shiftKey ? "Add" : (mouseDownEvent.ctrlKey ? "Toggle" : "Replace");
            var markingCallback = function (points, isSingleClickOnAxis) {
                if (!isSingleClickOnAxis) {
                    modify("Mark", { mode: markMode, token: canvasState.currentToken, lasso: isLasso, points: points, isAxisMarking: markArea !== null });
                } (markingDoneCallback || $.noop)();
            }; Spotfire.Visuals.CanvasVisualization.Marking.createOverlay($viewport, entryPoint, "sf-overlay-mark", isLasso, markingCallback, markArea);
        }; var startButtonBehavior = function (mouseDownEvent, buttonBounds) {
            var entryPoint = getEntryPoint(mouseDownEvent);
            Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                mouseUp: function (e) {
                    if (new Rectangle(buttonBounds).containsPoint(e.x, e.y)) {
                        modify("Mark", { mode: "Replace", token: canvasState.currentToken, lasso: false, points: [entryPoint], isAxisMarking: false });
                    }
                }
            }, $viewport);
        }; var clickInteractionArea = function (mouseDownEvent, area) {
            var clickPoint = getEntryPoint(mouseDownEvent);
            var showPoint = null; switch (area.alignment) {
                case "top": showPoint = new Point(clickPoint.x, area.bounds.y + area.bounds.height);
                    break; case "bottom": showPoint = new Point(clickPoint.x, area.bounds.y); break; case "left": showPoint = new Point(area.bounds.x + area.bounds.width, clickPoint.y);
                        break; case "right": showPoint = new Point(area.bounds.x, clickPoint.y); break;
            } modify("InteractionAreaClick", { clickPoint: clickPoint, showPoint: showPoint });
        }; var clickArea = function (mouseDownEvent) {
            modify("AreaClick", { clickPoint: getEntryPoint(mouseDownEvent) });
        }; var startMoveSplitter = function (downEvent, area, bounds) {
            var horizontal = area.alignment === "top" || area.alignment === "bottom";
            var immediate = Spotfire.isProfessional(); var entryPoint = getEntryPoint(downEvent); var splitterData = { bounds: bounds, isHorizontal: horizontal, lowerLimit: area.resizeData.min, upperLimit: area.resizeData.max };
            var splitter = createSplitterFeedback($viewport, downEvent, immediate, splitterData); modify("BeginResize", { id: area.resizeData.id, x: entryPoint.x, y: entryPoint.y });
            Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                cursor: horizontal ? "row-resize" : "col-resize", mouseMove: function (e) {
                    splitter.update(e);
                    if (immediate) { modify("Drag", e); }
                }, mouseUp: function (e) { modify("DragEnd", e); }, cancelled: function () {
                    modify("DragCancel");
                }, done: function () { splitter.remove(); }
            }, $viewport);
        }; var startMovePruneLine = function (mouseDownEvent) {
            var immediate = Spotfire.isProfessional();
            var splitterData = canvasState.pickDetails.getSplitterData(); var splitter = createSplitterFeedback($viewport, mouseDownEvent, immediate, splitterData);
            var entryPoint = getEntryPoint(mouseDownEvent); modify("DragBegin", entryPoint); Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                cursor: splitterData.isHorizontal ? "row-resize" : "col-resize", mouseMove: function (e) {
                    splitter.update(e);
                    if (immediate) { modify("Drag", e); }
                }, mouseUp: function (e) { modify("DragEnd", e); }, cancelled: function () {
                    modify("DragCancel");
                }, done: function () { splitter.remove(); canvasState.pickDetails.clear(); }
            }, $viewport);
        }; var createMarkerLabelFeedback = function ($viewport, mouseEvent, markerLabelData) {
            var offset = $viewport.offset();
            var bounds = markerLabelData.bounds; var originalPageX = mouseEvent.pageX; var originalPageY = mouseEvent.pageY;
            var viewportWidth = $viewport.width(); var viewportHeight = $viewport.height(); var color = markerLabelData.color;
            var $overlay = $("<div>").css("position", "absolute").css("left", offset.left).css("top", offset.top).css("width", viewportWidth).css("height", viewportHeight).css("opacity", "0.5").appendTo("body");
            var $label = $("<div>").css("position", "absolute").css("left", bounds.x).css("top", bounds.y).css("width", bounds.width).css("height", bounds.height).css("background-color", color).appendTo($overlay);
            var svgns = "http://www.w3.org/2000/svg"; var svg = document.createElementNS(svgns, "svg"); svg.setAttribute("width", viewportWidth);
            svg.setAttribute("height", viewportHeight); var line = document.createElementNS(svgns, "line"); line.setAttribute("stroke", color);
            line.setAttribute("stroke-width", "2px"); svg.appendChild(line); $overlay.get(0).appendChild(svg); var update = function (e) {
                var markerBounds = new Rectangle(markerLabelData.markerBounds);
                var markerX = markerBounds.centerX(); var markerY = markerBounds.centerY(); var left = bounds.x + e.pageX - originalPageX;
                var top = bounds.y + e.pageY - originalPageY; var width = bounds.width; var height = bounds.height; var panelBounds = new Rectangle(markerLabelData.panelBounds);
                if (left + width > panelBounds.right()) { left = panelBounds.right() - width; } if (left < panelBounds.left()) {
                    left = panelBounds.left();
                } if (top + height > panelBounds.bottom()) { top = panelBounds.bottom() - height; } if (top < panelBounds.top()) {
                    top = panelBounds.top();
                } var labelCenterX = left + bounds.width / 2; var labelCenterY = top + bounds.height / 2; var labelCornerX = markerX < labelCenterX ? left : left + bounds.width;
                var labelCornerY = markerY < labelCenterY ? top : top + bounds.height; $label.css("left", left); $label.css("top", top);
                line.setAttribute("x1", markerX); line.setAttribute("y1", markerY); line.setAttribute("x2", labelCornerX);
                line.setAttribute("y2", labelCornerY);
            }; update(mouseEvent); return {
                update: update, remove: function () {
                    $overlay.remove();
                }
            };
        }; var startMoveLabel = function (mouseDownEvent) {
            var label = createMarkerLabelFeedback($viewport, mouseDownEvent, canvasState.pickDetails.getMarkerLabelData());
            var entryPoint = getEntryPoint(mouseDownEvent); modify("DragBegin", entryPoint); Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                dragPredicate: function (e) {
                    return new Point(e.x, e.y).distance(entryPoint) > 2;
                }, mouseMove: function (e) { label.update(e); }, mouseUp: function (e) { modify("DragEnd", e); }, click: function (e) {
                    var markMode = mouseDownEvent.shiftKey ? "Add" : (mouseDownEvent.ctrlKey ? "Toggle" : "Replace");
                    modify("Mark", { mode: markMode, token: canvasState.currentToken, lasso: false, points: [{ x: e.x, y: e.y }] });
                }, done: function () {
                    label.remove();
                    canvasState.pickDetails.clear();
                }
            }, $viewport);
        }; var startRotate3DScatterPlot = function (mouseDownEvent) {
            var entryPoint = getEntryPoint(mouseDownEvent);
            modify("DragBegin", { x: entryPoint.x, y: entryPoint.y, ctrlKey: mouseDownEvent.ctrlKey, shiftKey: mouseDownEvent.shiftKey, which: mouseDownEvent.which });
            Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                preventContextMenuOnRelease: true, mouseMove: function (e) {
                    modify("Drag", e);
                }, mouseUp: function (e) { modify("DragEnd", e); }, cancelled: function () { modify("DragCancel"); }
            }, $viewport);
        };
        var detectTouchClick = function (mouseDownEvent) {
            var entryPoint = getEntryPoint(mouseDownEvent); $(window).one("sf-touchmouseup", function (upEvent) {
                if (mouseDownEvent.pageX === upEvent.pageX && mouseDownEvent.pageY === upEvent.pageY) {
                    modify("Mark", { mode: "Replace", token: canvasState.currentToken, lasso: false, points: [{ x: entryPoint.x, y: entryPoint.y }] });
                } upEvent.preventDefault();
            });
        }; return { startRectangleZoom: startRectangleZoom, startMarking: startMarking, startMoveSplitter: startMoveSplitter, startMovePruneLine: startMovePruneLine, startMoveLabel: startMoveLabel, startRotate3DScatterPlot: startRotate3DScatterPlot, startButtonBehavior: startButtonBehavior, clickInteractionArea: clickInteractionArea, clickArea: clickArea, detectTouchClick: detectTouchClick };
    }; Spotfire.registerNameSpace("Visuals.CanvasVisualization.Actions", { create: create });
});

$(function () {
    var debugging = false;
    var createPngBlob = function (base64) {
        var decoded = window.atob(base64); var map = Array.prototype.map; var charCodeArray = map.call(decoded, function (s) {
            return s.charCodeAt(0);
        }); return new window.Blob([new window.Uint8Array(charCodeArray)], { type: "image/png" });
    }; var imageUrlStore = (function () {
        var oldUrls = {};
        var getPrevious = function (id) { return oldUrls[id]; }; var create = function (id, base64) {
            var blob = createPngBlob(base64);
            var url = window.URL.createObjectURL(blob); var oldUrl = oldUrls[id]; if (oldUrl) {
                window.setTimeout(function () {
                    window.URL.revokeObjectURL(oldUrl);
                }, 1000);
            } oldUrls[id] = url; return url;
        }; var get = function (id, base64) {
            if (base64 === null || base64 === undefined) {
                return getPrevious(id);
            } return create(id, base64);
        }; return { get: get };
    }()); function ImageLayer($viewport, modelDocumentId) {
        var frameCount = 0;
        var expectedUrl = null; var $container = $("<div/>").addClass("sf-element-canvas-image").appendTo($viewport);
        var $preloadImage = $("<img/>").load(function () {
            var url = this.src; if (expectedUrl !== url) { return; } expectedUrl = null;
            frameCount++; $container.css("background-image", "url(" + url + ")");
        }); var preload = function (url) {
            expectedUrl = url;
            if (url !== null) { $preloadImage.attr("src", url); } else { $container.css("background-image", ""); }
        }; if (debugging) {
            var everySecond = function () {
                $container.html(($container.prev().length > 0 ? "<br/>" : "") + "FPS: " + frameCount);
                frameCount = 0;
            }; window.setInterval(everySecond, 1000);
        } var oldUrl = imageUrlStore.get(modelDocumentId); if (oldUrl) {
            preload(oldUrl);
        } return {
            update: function (base64, useTransition) {
                var url = imageUrlStore.get(modelDocumentId, base64); var backgroundTransition = "sfc-transition-background";
                if (useTransition) { $container.addClass(backgroundTransition); } else {
                    $container.removeClass(backgroundTransition);
                } preload(url);
            }, clear: function () { preload(null); }
        };
    } var globalProgressCounter = (function () {
        var count = 0;
        var onActivityHandlers = []; var onActivity = function (pendingCount) {
            $.each(onActivityHandlers, function () {
                this(pendingCount);
            });
        }; return {
            addHandler: function (handler) {
                if (typeof handler !== "function") { throw "Not a function"; } onActivityHandlers.push(handler);
            }, inc: function () { count++; onActivity(count); }, dec: function () { count--; onActivity(count); }
        };
    }()); function Progress($viewport) {
        var progressTimer = null;
        var delay = 500; var progressAnimation = null; var seconds = delay / 1000; var interval = null; var showOverlay = function () {
            var w = $viewport.width();
            var h = $viewport.height(); progressAnimation = Spotfire.Progress.createFadingProgressAnimation($viewport, w, h);
            var $overlay = progressAnimation.$element; $overlay.css("cursor", "progress"); $overlay.css("text-align", "center");
            if (debugging) {
                var $text = $("<h2/>").appendTo($overlay); var stopwatch = function () {
                    $text.text(seconds.toFixed(1) + "s");
                    seconds += 0.1;
                }; interval = window.setInterval(stopwatch, 100); stopwatch();
            }
        }; var cleanup = function () {
            if (progressTimer !== null) {
                window.clearTimeout(progressTimer);
                progressTimer = null;
            } if (interval !== null) {
                seconds = delay / 1000; window.clearInterval(interval); interval = null;
            } if (progressAnimation !== null) { progressAnimation.remove(); progressAnimation = null; }
        }; return {
            start: function () {
                if (progressTimer !== null || progressAnimation !== null) {
                    return;
                } progressTimer = window.setTimeout(showOverlay, delay);
            }, stop: function () { cleanup(); }
        };
    } function InteractionLayer($viewportContainer, canvasActions, canvasState, $viewport) {
        var Point = Spotfire.Drawing.Point;
        var $interactionLayer = $("<div/>").appendTo($viewportContainer); var addInteractionArea = function (area) {
            var mouseUpEventName = "sf-touchmouseup.sf-interaction-layer";
            var mouseMoveEventName = "sf-touchmousemove.sf-interaction-layer"; var onTouchHold = function (holdEvent) {
                Touch.showTouchHoldImage(holdEvent.pageX, holdEvent.pageY);
                Touch.clickBlocker(); var moveTouchHoldImage = function (moveEvent) {
                    Touch.moveTouchHoldImage(moveEvent.pageX, moveEvent.pageY);
                    moveEvent.preventDefault();
                }; $(window).on("sf-touchmousemove", moveTouchHoldImage); var onMarkingDone = function () {
                    Touch.removeTouchHoldImage();
                    $(window).off("sf-touchmousemove", moveTouchHoldImage);
                }; canvasActions.startMarking(holdEvent, area, onMarkingDone);
            }; var onMouseDown = function (downEvent) {
                if (downEvent.which !== 1) { return; } var $activeElement = $(this).addClass("sfpc-active");
                var dragStarted = (function () {
                    var moved = false; var entryPoint = new Point(downEvent.pageX, downEvent.pageY);
                    return function (mouseEvent) {
                        moved = moved || entryPoint.distance(new Point(mouseEvent.pageX, mouseEvent.pageY)) > 0;
                        return moved;
                    };
                }()); $(document.body).on(mouseMoveEventName, function (e) {
                    if (!dragStarted(e)) { return; } $(document.body).off(mouseUpEventName);
                    $(document.body).off(mouseMoveEventName); $activeElement.removeClass("sfpc-active"); if (Spotfire.capabilities.supportsTouch()) {
                        return;
                    } var isZoom = downEvent.altKey && downEvent.ctrlKey && downEvent.shiftKey; if (isZoom && !canvasState.canZoom) {
                        return;
                    } if (isZoom) { canvasActions.startRectangleZoom(downEvent); } else {
                        if (canvasState.canMark) {
                            canvasActions.startMarking(downEvent, area);
                        }
                    }
                }); $(document.body).on(mouseUpEventName, function (upEvent) {
                    $(document.body).off(mouseUpEventName); $(document.body).off(mouseMoveEventName);
                    $activeElement.removeClass("sfpc-active"); var isClick = !dragStarted(upEvent); if (isClick) {
                        if (area.contextualPopout === true) {
                            canvasActions.clickInteractionArea(downEvent, area);
                        } else { canvasActions.clickArea(downEvent); }
                    }
                });
            }; var margin = 3; var left = area.bounds.x; var top = area.bounds.y;
            var width = area.bounds.width; var height = area.bounds.height; switch (area.alignment) {
                case "top": height -= margin;
                    break; case "bottom": top += margin; height -= margin; break; case "left": width -= margin; break; case "right": left += margin;
                        width -= margin; break;
            } var $interactionDiv = $("<div/>").addClass("sfpc-" + area.alignment).css("left", left + "px").css("top", top + "px").css("width", width + "px").css("height", height + "px").on("sf-touchmousedown", onMouseDown).on("sf-touchhold", onTouchHold).on("mousemove", function (e) {
                $viewport.trigger(e);
            }).appendTo($interactionLayer); if (area.contextualPopout === true) {
                $interactionDiv.addClass("sf-element-interaction-access-area");
            } else { $interactionDiv.css("position", "absolute"); }
        }; var addResizeSplitter = function (area) {
            var bounds = new Rectangle(area.bounds);
            var size = 5; var halfSize = (size - 1) / 2; var horizontal = area.alignment === "top" || area.alignment === "bottom"; switch (area.alignment) {
                case "top": bounds.y += bounds.height - halfSize;
                    bounds.height = size; break; case "left": bounds.x += bounds.width - halfSize; bounds.width = size; break; case "right": bounds.x -= halfSize;
                        bounds.width = size; break; case "bottom": bounds.y -= halfSize; bounds.height = size; break;
            } $("<div>").addClass("sf-splitter").css("position", "absolute").css("left", bounds.x).css("top", bounds.y).css("width", bounds.width).css("height", bounds.height).css("cursor", horizontal ? "row-resize" : "col-resize").appendTo($interactionLayer).on("sf-touchmousedown", function (downEvent) {
                canvasActions.startMoveSplitter(downEvent, area, bounds);
            });
        }; return {
            update: function (data) {
                $interactionLayer.empty(); $.each(data.areas, function (i, area) {
                    if (area.contextualPopout === true || area.axisMarking === true) {
                        addInteractionArea(area);
                    } if (area.resizeData !== undefined) { addResizeSplitter(area); }
                });
            }
        };
    } function RenderStatisticsLayer($viewport) {
        var $overlay = null;
        return {
            update: function (statistics) {
                if (statistics === null || statistics === undefined) {
                    if ($overlay !== null) {
                        $overlay.remove();
                        $overlay = null;
                    } return;
                } $overlay = $overlay || $("<div class='sfc-render-stats'/>").appendTo($viewport); $overlay.children().remove();
                var stats = statistics.statistics.split(";"); $.each(stats, function (i, item) {
                    $overlay.append($("<div/>").text(item));
                });
            }
        };
    } function CanvasVisualization(settings) {
        var Point = Spotfire.Drawing.Point; var mouseButtons = Spotfire.Visuals.CanvasVisualization.MouseButtons;
        var viewId = settings.id; var $viewportContainer = $("#" + viewId).addClass("sf-element sf-element-canvas-visualization");
        var $viewport = $("<div/>").css({ width: "100%", height: "100%", position: "absolute" }).appendTo($viewportContainer);
        var $debug = null; var debugLog = function (s) {
            if (debugging) {
                if ($debug === null) {
                    $debug = $("<div/>").appendTo($viewport).css({ position: "absolute", "font-family": "Courier", "background-color": "lightsalmon", "font-size": "0.8em", "z-index": 100 });
                } console.log(viewId + ": " + s); $debug.prepend(s + "<br/>");
            }
        }; var modify = function (method, args) {
            Spotfire.Dxp.Web.Forms.AjaxService.Modify(viewId, method, args);
        }; var read = function (method, args, callback, errorCallback) {
            Spotfire.Dxp.Web.Forms.AjaxService.Read(viewId, method, args, callback, errorCallback);
        }; var canvasState = { renderResult: null, currentToken: -1, canMark: false, canZoom: false, pickDetails: null }; var canvasActions = Spotfire.Visuals.CanvasVisualization.Actions.create($viewport, canvasState, modify);
        var plotImage = new ImageLayer($viewport, settings.modelDocumentNodeId); var highlightImage = new ImageLayer($viewport, settings.modelDocumentNodeId);
        var interactionLayer = new InteractionLayer($viewportContainer, canvasActions, canvasState, $viewport); var progress = new Progress($viewport);
        var statisticsLayer = new RenderStatisticsLayer($viewport); canvasState.pickDetails = Spotfire.Visuals.CanvasVisualization.PickDetails.create(highlightImage, $viewport);
        var useTransition = (function () {
            var lastRenderTime = 0; var lastHeight = 0; var lastWidth = 0; return function (width, height) {
                var currentRenderTime = Date.now();
                var transition = width !== lastWidth || height !== lastHeight || (currentRenderTime - lastRenderTime) > 300; lastWidth = width;
                lastHeight = height; lastRenderTime = currentRenderTime; return transition;
            };
        }()); var handleRenderResult = function (result) {
            if (result.token > canvasState.currentToken) {
                debugLog("This is a newer image than expected! " + result.token);
                canvasState.currentToken = result.token;
            } progress.stop(); canvasState.renderResult = result; plotImage.update(result.base64, useTransition(result.width, result.height));
            interactionLayer.update(result.data); canvasState.pickDetails.clear(); statisticsLayer.update(result.data.renderStatistics);
            canvasState.canMark = result.data.options.canMark; canvasState.canZoom = result.data.options.canZoom; if (result.data.updateLegend) {
                Spotfire.Visuals.onUpdateLegend($viewport, {});
            } Spotfire.Visuals.onPlotIssues($viewport, { viewId: viewId, issues: result.data.issues, plotMessages: result.data.plotMessages });
        }; var isMouseOverViewport = (function () {
            var isMouseOver = false; $viewport.on("mouseenter mousemove", function () {
                isMouseOver = true;
            }); $viewport.on("mouseleave", function () { isMouseOver = false; }); return function () { return isMouseOver; };
        }());
        var setDetails = function (data, highlightBase64) {
            canvasState.pickDetails.setHighlightBase64(highlightBase64);
            canvasState.pickDetails.setTooltip(data.tooltipHtml); canvasState.pickDetails.setCursor(data.splitter, data.button, data.markerLabel);
        }; var highlight = (function () {
            var lastCursorPos = new Point(0, 0); var highlightToken = -1; var getHighlightImage = function (x, y) {
                var args = { x: x, y: y, token: canvasState.currentToken, highlightToken: ++highlightToken };
                debugLog("HighlightRequest token: " + highlightToken + " x: " + x + " y: " + y); read("GetHighlightImage", args, function (image) {
                    debugLog("HighlightResponse token: " + highlightToken);
                    if (isMouseOverViewport()) { setDetails(image.data, image.base64); }
                });
            }; var clearHighlight = function () {
                lastCursorPos = new Point(0, 0);
                getHighlightImage(-1, -1); canvasState.pickDetails.setHighlightBase64(); canvasState.pickDetails.setTooltip();
            }; var requestHighlight = function (pageX, pageY, mouseMoveThreshold) {
                var offset = $viewport.sfBoxOffset(); var currentPos = new Point(pageX - offset.left, pageY - offset.top);
                if (currentPos.x < 0 || currentPos.x > $viewport.sfBoxWidth() || currentPos.y < 0 || currentPos.y > $viewport.sfBoxHeight()) {
                    return;
                } if (Math.abs(currentPos.x - lastCursorPos.x) < mouseMoveThreshold && Math.abs(currentPos.y - lastCursorPos.y) < mouseMoveThreshold) {
                    return;
                } lastCursorPos = currentPos; getHighlightImage(currentPos.x, currentPos.y);
            }; var onMouseMove = function (e) {
                if (mouseButtons.which() === 0) {
                    requestHighlight(e.pageX, e.pageY, 2);
                }
            }; $viewport.on("mousemove", Spotfire.isProfessional() ? _.throttle(onMouseMove, 20) : _.debounce(onMouseMove, 200)).on("mouseleave", function () {
                clearHighlight();
            }).on("mousedown", function () { clearHighlight(); }); return {
                redo: function () {
                    requestHighlight(Spotfire.Cursor.getX(), Spotfire.Cursor.getY(), 0);
                }
            };
        }()); $viewport.on("sf-touchhold", function (holdEvent) {
            Touch.showTouchHoldImage(holdEvent.pageX, holdEvent.pageY);
            Touch.clickBlocker(); var moveTouchHoldImage = function (moveEvent) {
                Touch.moveTouchHoldImage(moveEvent.pageX, moveEvent.pageY);
                moveEvent.preventDefault();
            }; $(window).on("sf-touchmousemove", moveTouchHoldImage); var onMarkingDone = function () {
                Touch.removeTouchHoldImage();
                $(window).off("sf-touchmousemove", moveTouchHoldImage);
            }; canvasActions.startMarking(holdEvent, null, onMarkingDone, true);
        }); $viewport.on("sf-touchmousedown", function (mouseDownEvent) {
            if (Spotfire.capabilities.supportsTouch()) {
                canvasActions.detectTouchClick(mouseDownEvent);
                return;
            } var isZoom = mouseDownEvent.altKey && mouseDownEvent.ctrlKey && mouseDownEvent.shiftKey; if (isZoom && !canvasState.canZoom) {
                return;
            } if (mouseDownEvent.which === 3 && (mouseDownEvent.ctrlKey || mouseDownEvent.shiftKey) && settings.canRightClickDrag) {
                canvasActions.startRotate3DScatterPlot(mouseDownEvent);
                return;
            } if (mouseDownEvent.which !== 1) { return; } if (canvasState.pickDetails.hasSplitterData()) {
                canvasActions.startMovePruneLine(mouseDownEvent);
                return;
            } if (canvasState.pickDetails.hasMarkerLabelData()) {
                canvasActions.startMoveLabel(mouseDownEvent);
                return;
            } if (isZoom) { canvasActions.startRectangleZoom(mouseDownEvent); } else {
                if (canvasState.canMark) {
                    canvasActions.startMarking(mouseDownEvent);
                } else {
                    if (canvasState.pickDetails.hasButtonData()) {
                        canvasActions.startButtonBehavior(mouseDownEvent, canvasState.pickDetails.getButtonData().bounds);
                    }
                }
            }
        }); var onKeyDown = function (e) {
            if (Keys.F10 === e.keyCode && e.shiftKey) {
                var ce = $.Event("contextmenu"); var offset = $viewport.offset();
                ce.pageX = offset.left + $viewport.width() / 2; ce.pageY = offset.top + $viewport.height() / 2; $viewport.trigger(ce);
                return;
            } modify("KeyDown", { ctrlKey: e.ctrlKey, shiftKey: e.shiftKey, altKey: e.altKey, keyCode: e.keyCode });
        };
        Spotfire.Focus.handleKeyDown($viewport, onKeyDown); var onMouseWheel = function (e) {
            var offset = $viewport.offset();
            modify("ScrollWheel", { x: e.pageX - offset.left, y: e.pageY - offset.top, scrollWheelX: e.scrollWheelX, scrollWheelY: e.scrollWheelY, ctrlKey: e.ctrlKey, shiftKey: e.shiftKey, altKey: e.altKey });
            canvasState.pickDetails.clear();
        }; $viewport.on("scrollwheel", onMouseWheel); return {
            start: function () {
                modify("Start", "");
                progress.start();
            }, updatePlot: function (args) {
                var token = args.token; debugLog("updatePlot imageToken: " + token);
                if (token <= canvasState.currentToken) {
                    debugLog("This image has already been pushed. Ignoring."); return;
                } canvasState.currentToken = token; progress.start(); if (args.push) { return; } if (plotImage.requesting) {
                    debugLog("Already requesting");
                    return;
                } var requestStart = function () { plotImage.requesting = true; globalProgressCounter.inc(); }; var requestEnd = function () {
                    plotImage.requesting = false;
                    globalProgressCounter.dec();
                }; var getImageCallback = function (image) {
                    requestEnd(); debugLog("GetPlotImage currentToken: " + canvasState.currentToken + " imageToken: " + image.token);
                    if (image.token < canvasState.currentToken) {
                        debugLog("Old image! Asking again."); read("GetPlotImage", "", getImageCallback, requestEnd);
                    } if (!image.data) { return; } handleRenderResult(image); if (image.token > canvasState.currentToken) {
                        debugLog("Got a newer image than expected. Updating currentToken to " + image.token);
                        canvasState.currentToken = image.token;
                    }
                }; requestStart(); read("GetPlotImage", "", getImageCallback, requestEnd);
            }, setPlotImage: function (data) { var result = JSON.parse(data); handleRenderResult(result); }, setDetailsResult: function (data) {
                if (mouseButtons.which() === 0) {
                    var result = JSON.parse(data);
                    if (isMouseOverViewport()) { setDetails(result.data, result.base64); }
                }
            }, setHighlightImage: function (base64) {
                canvasState.pickDetails.setHighlightBase64(base64);
            }, clearHighlight: function () { canvasState.pickDetails.setHighlightBase64(); }, redoHighlight: function () {
                highlight.redo();
            }
        };
    }
    var nomad = function (id) {
        var $element = $("#" + id); return {
            bind: function (value) {
                $element.data("plot", value);
                return this;
            }, invoke: function (func) {
                var plot = $element.data("plot"); if (plot !== undefined && plot !== null && typeof func === "function") {
                    func.apply(plot, [plot]);
                } return this;
            }
        };
    };
    Spotfire.registerNameSpace("Visuals.CanvasVisualization", {
        initialize: function (settings) {
            nomad(settings.id).bind(new CanvasVisualization(settings)).invoke(function () {
                this.start();
            });
        }, clearHighlight: function (id) { nomad(id).invoke(function () { this.clearHighlight(); }); }, initializeWebSocket: function (proxy) {
            proxy.registerHandler("PushDetails", function (args, data) {
                nomad(args.id).invoke(function () {
                    this.setDetailsResult(data);
                });
            }); proxy.registerHandler("PushHighlight", function (args, data) {
                nomad(args.id).invoke(function () {
                    this.setHighlightImage(data);
                });
            }); proxy.registerHandler("PushRenderResult", function (args, data) {
                nomad(args.id).invoke(function () {
                    this.setPlotImage(data);
                });
            });
        }, update: function (args) { nomad(args.id).invoke(function () { this.updatePlot(args); }); }, setCursor: function (id, cursor) {
            nomad(id).invoke(function () {
                this.setCursor(cursor);
            });
        }, redoHighlight: function (id) { nomad(id).invoke(function () { this.redoHighlight(); }); }, onActivity: function (handler) {
            globalProgressCounter.addHandler(handler);
        }
    });
}); 

$(function () {
    var CursorDiv = function () {
        var classString = "sf-canvas-drag-cursor"; var selector = "." + classString;
        var sizeInPixels = 100; var getCursorDiv = function () {
            var $div = $(selector); if ($div.length !== 0) {
                return $div;
            } return $("<div/>").addClass(classString).css("position", "absolute").css("width", sizeInPixels + "px").css("height", sizeInPixels + "px").css("opacity", 0).appendTo("body");
        }; return {
            update: function (pageX, pageY, cursor) {
                getCursorDiv().css("left", (pageX - sizeInPixels / 2) + "px").css("top", (pageY - sizeInPixels / 2) + "px").css("cursor", cursor);
            }, hide: function () { $(selector).remove(); }
        };
    }; var cursor = new CursorDiv();
    var beginDrag = function (options, $viewport) {
        var defaultOptions = {
            mouseMove: $.noop, mouseUp: $.noop, done: $.noop, cancelled: $.noop, dragPredicate: function () {
                return true;
            }, click: $.noop, cursor: "auto", preventContextMenuOnRelease: false
        }; options = $.extend(defaultOptions, options);
        var offset = $viewport.offset(); var dragEvent = function (mouseEvent) {
            var e = mouseEvent; return {
                x: e.pageX - offset.left, y: e.pageY - offset.top, pageX: e.pageX, pageY: e.pageY, clientX: e.clientX, clientY: e.clientY, altKey: e.altKey, ctrlKey: e.ctrlKey, shiftKey: e.shiftKey, stopPropagation: function () {
                    mouseEvent.stopPropagation();
                }, preventDefault: function () { mouseEvent.preventDefault(); }
            };
        }; var nameSpace = ".spotfireDragOperation"; var $window = $(window);
        var end = function () {
            if (options.preventContextMenuOnRelease) { _.defer(function () { cursor.hide(); }); } else {
                cursor.hide();
            } $window.off(nameSpace); options.done();
        }; var checkDragStart = (function () {
            var dragStarted = false; return function (event) {
                dragStarted = dragStarted || options.dragPredicate(event);
                return dragStarted;
            };
        }()); $window.on("sf-touchmousemove" + nameSpace, function (e) {
            var event = dragEvent(e);
            if (checkDragStart(event)) { options.mouseMove(event); cursor.update(e.pageX, e.pageY, options.cursor); }
        });
        $window.on("sf-touchmouseup" + nameSpace, function (e) {
            var event = dragEvent(e); if (checkDragStart(event)) {
                options.mouseUp(event);
            } else { options.click(event); } end();
        }); $window.on("keydown" + nameSpace, function (e) {
            if (e.which === 27) {
                options.cancelled();
                end();
            }
        });
    };
    
    Spotfire.registerNameSpace("Visuals.CanvasVisualization.Dragging", { begin: beginDrag });
}); 

$(function () {
    var validateNew = function (instance, type) {
        if (instance instanceof type) {
            return;
        } throw "Instantiate object using the new keyword";
    }; 
    var pointDistance = function (point) {
        var dx = this.x - point.x;
        var dy = this.y - point.y; return Math.sqrt((dx * dx) + (dy * dy));
    }; 
    function Point(x, y) {
        validateNew(this, Point);
        this.x = x; this.y = y; this.distance = pointDistance;
    }
    
    Spotfire.registerNameSpace("Drawing", { Point: Point });
});

// Canvas Visualization - Marking
$(function () {
    var createOverlay = function ($viewport, entryPoint, overlayCssClass, isLasso, callback, markArea) {
        var Point = Spotfire.Drawing.Point;
        if (!(entryPoint instanceof Point)) { throw "Expected a Spotfire.Drawing.Point"; }
        var viewportWidth = $viewport.width();
        var viewportHeight = $viewport.height();
        var svgns = "http://www.w3.org/2000/svg"; 
        var svg = document.createElementNS(svgns, "svg");
        svg.setAttribute("width", viewportWidth);
        svg.setAttribute("height", viewportHeight);
        var polygon = isLasso ? document.createElementNS(svgns, "polyline") : document.createElementNS(svgns, "rect");
        polygon.setAttribute("class", "sf-overlay " + overlayCssClass); svg.appendChild(polygon); 
        var $selection = $("<div/>").append(svg).appendTo($viewport).css({ position: "absolute", width: viewportWidth + "px", height: viewportHeight + "px" });
        var points = []; points.push(entryPoint);
        var avoidFuzzyness = 0.5;
        var mouseMove = function (e) {
            var x = Math.max(0, Math.min(e.x, viewportWidth - 2 * avoidFuzzyness));
            var y = Math.max(0, Math.min(e.y, viewportHeight - 2 * avoidFuzzyness)); if (isLasso) {
                points.push(new Point(x, y));
                var svgPath = points.map(function (p) { return p.x + "," + p.y; }).join(", "); polygon.setAttribute("points", svgPath);
            } else {
                if (points.length === 1) { points.push(new Point(x, y)); } else { points[1].x = x; points[1].y = y; } if (markArea !== null) {
                    if (markArea.horizontal) {
                        points[0].y = markArea.y;
                        points[1].y = markArea.y + markArea.height;
                    } else {
                        points[0].x = markArea.x; points[1].x = markArea.x + markArea.width;
                    }
                } var xx = Math.min(points[0].x, points[1].x) + avoidFuzzyness; var yy = Math.min(points[0].y, points[1].y) + avoidFuzzyness;
                var width = Math.abs(points[0].x - points[1].x); var height = Math.abs(points[0].y - points[1].y); polygon.setAttribute("x", xx);
                polygon.setAttribute("y", yy); polygon.setAttribute("width", width); polygon.setAttribute("height", height);
            }
        };
        var mouseUp = function () {
            var isSingleClickOnAxis = (markArea && points.length === 1); callback(points, isSingleClickOnAxis);
            $selection.remove();
        }; 
        var done = function () { $selection.remove(); };

        Spotfire.Visuals.CanvasVisualization.Dragging.begin({ mouseMove: mouseMove, mouseUp: mouseUp, done: done }, $viewport);
    };

    Spotfire.registerNameSpace("Visuals.CanvasVisualization.Marking", { createOverlay: createOverlay });
});

// Canvas Visualization - MouseButtons
$(function () {
    var which = 0;
    window.addEventListener("mouseup", function () {
        which = 0;
    }, true);
    window.addEventListener("mousedown", function (e) {
        which = e.which;
    }, true);
    Spotfire.registerNameSpace("Visuals.CanvasVisualization.MouseButtons", {
        which: function () {
            return which;
        }
    });
});

// NavigationBar3D
$(function () {
    var repeatButtonBehavior = function ($div, pressed) {
        $div.on("mousedown", function (e) {
            $div.addClass("sfpc-active");
            var pressInvoked = false; var timer = window.setInterval(function () {
                pressed(!pressInvoked); pressInvoked = true;
            }, 100); Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                mouseUp: function (e) {
                    if (!pressInvoked) {
                        pressed(true);
                    }
                }, done: function () { $div.removeClass("sfpc-active"); window.clearInterval(timer); }
            }, $div);
        });
    };

    var NavigationBar = function (viewId) {
        var $element = $("#" + viewId);
        $element.addClass("sf-element-navigation-bar-3d"); var modify = function (method, args) {
            Spotfire.Dxp.Web.Forms.AjaxService.Modify(viewId, method, JSON.stringify(args));
        }; var addButton = function (callback, icon, tooltip) {
            var $button = $("<div>").addClass("sf-element-button").prop("title", tooltip).appendTo($element);
            Spotfire.getSvg("Images/NavigationBar3D/" + icon, function (svg) { $button.append(svg); }); repeatButtonBehavior($button, function (firstTime) {
                modify(callback, { beginNew: firstTime });
            });
        }; var resources = Spotfire.Localization.resources; addButton("ZoomIn", "ZoomIn.svg", resources.NavigationBar3D_ZoomIn);
        addButton("ZoomOut", "ZoomOut.svg", resources.NavigationBar3D_ZoomOut); addButton("RotateRight", "RotateRight.svg", resources.NavigationBar3D_Rotate);
        addButton("RotateLeft", "RotateLeft.svg", resources.NavigationBar3D_Rotate); addButton("RotateUp", "RotateUp.svg", resources.NavigationBar3D_Rotate);
        addButton("RotateDown", "RotateDown.svg", resources.NavigationBar3D_Rotate); addButton("Reset", "Reset.svg", resources.NavigationBar3D_Reset);
        $element.children().sfSetSequencePseudoClasses(); $element.on("contextmenu", function (e) {
            e.preventDefault();
            e.stopPropagation(); Spotfire.PageBus.publish("spotfire.navigationbar3d.showcontextmenu", {}, viewId);
        });
        return this;
    }; 

    Spotfire.registerNameSpace("Visuals.NavigationBar3D", {
        initialize: function (id, settings) {
            var selector = "#" + id;
            $(selector).data("navigationbar", new NavigationBar(id, settings));
        }
    });
});

// Canvas Visualization - PickDetails
$(function () {
    var create = function (highlightImage, $viewport) {
        var splitterData = null;
        var markerLabelData = null; var buttonData = null; var setHighlightBase64 = function (base64) {
            if (typeof base64 === "string" && base64.length > 0) {
                highlightImage.update(base64);
            } else { highlightImage.clear(); }
        }; var setTooltip = function (html) {
            if (typeof html === "string" && html.length > 0) {
                Spotfire.Visuals.PlotTooltip.showHtml(html, 0);
            } else { Spotfire.Visuals.PlotTooltip.hide(); }
        }; var setCursor = function (splitter, button, markerLabel) {
            var cursor = "default";
            splitterData = splitter; markerLabelData = markerLabel; buttonData = button; if (splitter !== undefined && splitter !== null) {
                cursor = splitter.isHorizontal ? "row-resize" : "col-resize";
            } if (button !== undefined && button !== null) { cursor = "pointer"; } $viewport.css("cursor", cursor);
        }; var clear = function () {
            setHighlightBase64();
            setTooltip(); setCursor();
        }; var hasButtonData = function () {
            return typeof buttonData === "object" && buttonData !== null;
        }; var getButtonData = function () { return buttonData; }; var hasSplitterData = function () {
            return typeof splitterData === "object" && splitterData !== null;
        }; var getSplitterData = function () { return splitterData; }; var hasMarkerLabelData = function () {
            return typeof markerLabelData === "object" && markerLabelData !== null;
        }; var getMarkerLabelData = function () { return markerLabelData; }; return { setHighlightBase64: setHighlightBase64, setTooltip: setTooltip, setCursor: setCursor, clear: clear, hasButtonData: hasButtonData, getButtonData: getButtonData, hasSplitterData: hasSplitterData, getSplitterData: getSplitterData, hasMarkerLabelData: hasMarkerLabelData, getMarkerLabelData: getMarkerLabelData };
    };
    Spotfire.registerNameSpace("Visuals.CanvasVisualization.PickDetails", { create: create });
});

// body mouse move
$(function () {
    var mouseX, mouseY;
    var padding = 10; var cursorOffset = 5; var fadeState = { IN: 1, OUT: 2, HIDDEN: 3, SHOWN: 4, current: 3 }; var fadeDuration = 150;
    var fadeInDelay = 500; var fadeOutDelay = 200; var $body = $(document.body); var tooltipAppearanceCss = {}; var hide;
    var onMouseDown = function () { hide(); };
    var onMouseMove = function (e) { mouseX = e.pageX; mouseY = e.pageY; }; hide = function () {
        var delay = fadeState.current === fadeState.IN ? 0 : fadeOutDelay;
        var duration = fadeDuration; var tooltipScene = d3.select($body.get(0)).selectAll(".sf-tooltip.sf-plot-tooltip").data([]);
        tooltipScene.exit().transition("fade").delay(delay).duration(duration).style("opacity", "0.001").remove().each("start", function () {
            fadeState.current = fadeState.OUT;
        }).each("end", function () { fadeState.current = fadeState.HIDDEN; $body.unbind("mousedown", onMouseDown); });
    };
    var showHtml = function (content) {
        if (Spotfire.capabilities.supportsTouch()) { return; } if (!content) {
            return;
        } var maxWidth = $(window).width() - padding * 2; var maxHeight = $(window).height() - padding * 2; var tooltipScene = d3.select($body.get(0)).selectAll(".sf-tooltip.sf-plot-tooltip").data([1]);
        tooltipScene.enter().append(function () {
            var $tooltipDiv = $("<div/>").addClass("sf-tooltip sf-plot-tooltip").css({ width: "0", height: "0" }).css(tooltipAppearanceCss);
            $("<div/>").addClass("sf-tooltip-content").appendTo($tooltipDiv).css({ width: maxWidth + "px", height: maxHeight + "px" });
            $body.mousedown(onMouseDown); return $tooltipDiv.get(0);
        }); if (fadeState.current === fadeState.OUT) {
            tooltipScene.interrupt("fade").transition("fade").duration(fadeDuration).style("opacity", "1").each("start", function () {
                fadeState.current = fadeState.IN;
            }).each("end", function () { fadeState.current = fadeState.SHOWN; });
        } else {
            if (fadeState.current === fadeState.HIDDEN) {
                tooltipScene.style("opacity", "0.001").transition("fade").duration(fadeInDelay).transition().duration(fadeDuration).style("opacity", "1").each("start", function () {
                    fadeState.current = fadeState.IN;
                }).each("end", function () { fadeState.current = fadeState.SHOWN; });
            } else {
                if (fadeState.current === fadeState.SHOWN) {
                    tooltipScene.interrupt("fade").transition("fade");
                }
            }
        } var layoutTooltip = function () {
            var width; var height; var left; var bottom; tooltipScene.each(function () {
                var $tooltipDiv = $(this);
                var $contentSpan = $(".sf-tooltip-content span", $tooltipDiv); width = $contentSpan.width() + 1; height = $contentSpan.height();
                var documentHeight = $(window).height(); bottom = Math.max(padding, Math.min(documentHeight - mouseY + cursorOffset, documentHeight - height - padding));
                var documentWidth = $(window).width() - padding * 2; left = Math.max(padding, Math.min(mouseX + cursorOffset, documentWidth - width));
            }); tooltipScene.style("left", left + "px").style("bottom", bottom + "px").transition("layout").duration(100).style("width", width + "px").style("height", height + "px");
        }; tooltipScene.each(function () {
            var $tooltipDiv = $(this); var $contentDiv = $(".sf-tooltip-content", $tooltipDiv);
            $contentDiv.empty(); var $contentSpan = $("<span/>"); $("img", $contentSpan).on("load", layoutTooltip); $contentSpan.html(content);
            $contentDiv.append($contentSpan);
        }); layoutTooltip();
    };
    var setAppearance = function (textColor, backgroundColor, borderColor, borderWidth) {
        tooltipAppearanceCss = { "background-color": backgroundColor, color: textColor, "border-color": borderColor, "border-width": borderWidth + "px" };
    };
    Spotfire.registerNameSpace("Visuals.PlotTooltip", { showHtml: showHtml, hide: hide, setAppearance: setAppearance });
    $body.mousemove(onMouseMove);
});

// KPI chart
$(function () {
    var stringify = function (args) {
        return typeof args === "string" ? args : JSON.stringify(args);
    };

    var textOrNbsp = function ($el, text, useNbsp) {
        if (text) { $el.text(text).attr("title", text); } else {
            if (useNbsp) {
                $el.html("&nbsp;");
            }
        }
    };
    
    function toRGBA(color) { return "rgba(" + color.R + "," + color.G + "," + color.B + "," + color.A + ")"; } function Progress($viewport) {
        var progressTimer = null;
        var delay = 500; var progressAnimation = null; var interval = null; var showOverlay = function () {
            var w = $viewport.width();
            var h = $viewport.height(); progressAnimation = Spotfire.Progress.createFadingProgressAnimation($viewport, w, h);
            var $overlay = progressAnimation.$element; $overlay.css("cursor", "progress"); $overlay.css("text-align", "center");
        }; var cleanup = function () {
            if (progressTimer !== null) {
                window.clearTimeout(progressTimer); progressTimer = null;
            } if (interval !== null) { window.clearInterval(interval); interval = null; } if (progressAnimation !== null) {
                progressAnimation.remove();
                progressAnimation = null;
            }
        }; return {
            start: function () {
                if (progressTimer !== null || progressAnimation !== null) {
                    return;
                } progressTimer = window.setTimeout(showOverlay, delay);
            }, stop: function () { cleanup(); }
        };
    }

    function KpiChart(id) {
        var $kpiChart = $("#" + id).addClass("sf-kpi-chart");
        var progress = new Progress($kpiChart); var resultTiles = { lastResult: { x: true, data: [] } }; var currentToken = -1;
        var pendingToken = -1; var layoutPadding = 5; var read = function (method, args, callback, errorCallback) {
            Spotfire.Dxp.Web.Forms.AjaxService.Read(id, method, stringify(args), callback, errorCallback);
        }; var modify = function (method, args) {
            var json = stringify(args); Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, method, json);
        }; var createKpiTile = function (result, kpi) {
            kpi.token = currentToken; var $kpiTile = Spotfire.Flex.item({ container: "vertical", inline: true, "align-items": "stretch" }).addClass("sf-kpi-tile").data("kpi", kpi);
            $kpiTile.css({ "background-color": toRGBA(kpi.backgroundColor), color: toRGBA(kpi.textColor) }); var $topContainer = Spotfire.Flex.item({ container: "horizontal", "justify-content": "space-between", "align-items": "center" }).addClass("KpiTopContainer");
            var $tileValue = $("<div/>").addClass("KpiTitle"); textOrNbsp($tileValue, kpi.formattedTileValue, result.tile);
            $topContainer.append($tileValue); var $timeValue = $("<div/>").addClass("KpiTime"); textOrNbsp($timeValue, kpi.formattedXvalue, result.x);
            $topContainer.append($timeValue); $kpiTile.append($topContainer); var $yValue = $("<div/>").addClass("KpiValue");
            textOrNbsp($yValue, kpi.formattedYValue, result.compAndY); $kpiTile.append($yValue); var $yDisplayName = $("<div/>").addClass("KpiActual");
            textOrNbsp($yDisplayName, kpi.yDisplayName, result.compAndY); $kpiTile.append($yDisplayName); var $perfCont = Spotfire.Flex.item({ container: "vertical", "align-items": "stretch", "justify-content": "end" }).addClass("KpiFromTargetCont");
            var $perfValue = $("<div/>").addClass("KpiTargetValue"); textOrNbsp($perfValue, kpi.formattedComparativeValue, result.compAndY);
            $perfCont.append($perfValue); if (result.compAndY || kpi.formattedComparativeValue) {
                $perfCont.addClass("KpiLast");
            } else { $yDisplayName.addClass("KpiLast"); } var $comDisplayName = $("<div/>").addClass("KpiTarget"); textOrNbsp($comDisplayName, kpi.comparativeAxisDisplayName, result.compAndY);
            $perfCont.append($comDisplayName); $kpiTile.append($perfCont); var isActive = result.activeKpi === kpi.kpiNodeId;
            var activeAlpha = result.markedOutlineColor.R > 127 ? 0.25 : kpi.textColor.R > 127 ? 0.75 : 0.25; var activeColor = kpi.textColor.R > 127 ? "rgba(255,255,255," : "rgba(0,0,0,";
            activeColor += activeAlpha + ")"; $kpiTile.css("border", "1px solid " + (kpi.isMarked ? toRGBA(result.markedOutlineColor) : (isActive ? activeColor : "transparent")));
            if (isActive) { $kpiTile.css("box-shadow", "inset 0 0 0 1px " + activeColor); } if (kpi.hasAction) {
                $kpiTile.addClass("sf-action-tile");
            } return $kpiTile;
        }; var updateStyling = function () {
            var $kpiLayout = $kpiChart.find(".KpiLayout"); var $tile = createKpiTile(resultTiles.lastResult, { backgroundColor: { R: 1, G: 1, B: 1, A: 1 }, textColor: { R: 1, G: 1, B: 1, A: 1 }, formattedYValue: "test", yDisplayName: "test" }).css({ position: "absolute", height: "initial" });
            $kpiLayout.prepend($tile); var paddingBorderMarginPerKpi = $tile.sfBoxWidth() - $tile.width(); var height = $tile.height();
            var boxHeight = $tile.sfBoxHeight(); $tile.remove(); var totalWidth = $kpiChart.width(); var kpiLayoutHeight = $kpiChart.height() - layoutPadding;
            var styledScrollbar = $kpiLayout.data("scrollbar") || $kpiLayout.StyledScrollbar({ allowResize: true }); var scrollbarHeight = styledScrollbar.getVScrollbarSize(true);
            var preferredWidth = (resultTiles.lastResult.x ? 240 : 200); var maxWidth = 2 * (preferredWidth + paddingBorderMarginPerKpi);
            var numberOfKpis = resultTiles.lastResult.data.length; var maxKpisPerRow = Math.floor(totalWidth / (preferredWidth + paddingBorderMarginPerKpi));
            var kpisPerRow = Math.max(1, Math.min(maxKpisPerRow, numberOfKpis)); var totalHeight = Math.ceil(numberOfKpis / kpisPerRow) * boxHeight;
            var scrollWidth = totalWidth; if (totalHeight > kpiLayoutHeight) {
                scrollWidth = totalWidth - scrollbarHeight; maxKpisPerRow = Math.floor(totalWidth / (preferredWidth + paddingBorderMarginPerKpi));
                kpisPerRow = Math.max(1, Math.min(maxKpisPerRow, numberOfKpis));
            } var widthPerTile = Math.floor(scrollWidth / kpisPerRow);
            if (widthPerTile > maxWidth) { widthPerTile = maxWidth; } var escapedId = $.isNumeric(id[0]) ? ("#\\3" + id[0] + " " + id.substring(1)) : ("#" + id);
            var rule = escapedId + " .sf-kpi-tile { width:" + (widthPerTile - paddingBorderMarginPerKpi) + "px; height:" + height + "px;}";
            Spotfire.StyleManager.updateOverrideCss($kpiChart, rule); $kpiLayout.css({ width: totalWidth + "px", height: kpiLayoutHeight + "px" });
            styledScrollbar.refresh();
        }; var renderKpis = _.throttle(function (result) {
            resultTiles.lastResult = result;
            var $oldKpiLayout = $(".KpiLayout", $kpiChart); var newLayout = false; if ($oldKpiLayout.length === 0) {
                newLayout = true;
                $oldKpiLayout = $("<div/>").addClass("KpiLayout").css({ width: $kpiChart.width() + "px", height: ($kpiChart.height() - layoutPadding) + "px" });
                if (Spotfire.capabilities.supportsTouch()) { $oldKpiLayout.addClass("sf-touch-scrolling"); } $kpiChart.append($oldKpiLayout);
            } var $kpiLayout = $("<div/>").addClass("KpiLayout").css({ width: $kpiChart.width() + "px", height: ($kpiChart.height() - layoutPadding) + "px" });
            var i; var numberOfKpis = result.data.length; for (i = 0; i < numberOfKpis; i++) {
                $kpiLayout.append(createKpiTile(result, result.data[i]));
            } if (!newLayout) { $oldKpiLayout.empty(); } $oldKpiLayout.append($kpiLayout.children()); updateStyling(); progress.stop();
        }, 100); var getTarget = function (e) {
            var $target = $(e.target); var targets = [".sf-kpi-tile", ".KpiLayout"].join();
            if (!$target.is(targets)) { $target = $target.closest(targets); } return $target;
        }; $kpiChart.on("contextmenu", function (e) {
            var $target = getTarget(e);
            var args = { token: currentToken, pointOnpage: new Point(e.pageX, e.pageY) }; if ($target.is(".sf-kpi-tile")) {
                var kpi = $target.data("kpi");
                args.token = kpi.token; args.kpiNodeId = kpi.kpiNodeId; args.leafNodeIndex = kpi.leafNodeIndex;
            } args.pointOnPage = new Point(e.pageX, e.pageY);
            modify("RightClick", args);
        }); $kpiChart.on("click", function (e) {
            var $target = getTarget(e); var args = {}; if ($target.is(".sf-kpi-tile")) {
                var markMode = e.shiftKey ? "Add" : (e.ctrlKey ? "Toggle" : "Replace");
                var kpi = $target.data("kpi"); args.token = kpi.token; args.kpiNodeId = kpi.kpiNodeId; args.leafNodeIndex = kpi.leafNodeIndex;
                args.mode = markMode; modify("Mark", args);
            } if ($target.is(".KpiLayout")) {
                args.token = currentToken; modify("Mark", args);
            }
        }); var onKeyDown = function (e) {
            if (Keys.F10 === e.keyCode && e.shiftKey) {
                var ce = $.Event("contextmenu"); var offset = $kpiChart.offset();
                ce.pageX = offset.left + $kpiChart.width() / 2; ce.pageY = offset.top + $kpiChart.height() / 2; $kpiChart.trigger(ce);
                return;
            } modify("KeyDown", { ctrlKey: e.ctrlKey, shiftKey: e.shiftKey, altKey: e.altKey, keyCode: e.keyCode });
        };
        Spotfire.Focus.handleKeyDown($kpiChart, onKeyDown); return {
            resize: updateStyling, updateTiles: function (args) {
                var token = args.token;
                if (token <= currentToken) { return; } if (token > pendingToken) { pendingToken = token; } progress.start(); if (resultTiles.requesting) {
                    return;
                } var requestStart = function () { resultTiles.requesting = true; }; var requestEnd = function () {
                    resultTiles.requesting = false;
                }; var getKpiCallback = function (result) {
                    requestEnd(); if (result.token < pendingToken) {
                        requestStart(); read("GetKpiTiles", "", getKpiCallback, requestEnd);
                    } if (result.token === -1) { return; } currentToken = result.token; renderKpis(result); Spotfire.Visuals.onPlotIssues($kpiChart, { viewId: id, issues: result.issues });
                }; requestStart(); if (args.result) { getKpiCallback(args.result); } else {
                    read("GetKpiTiles", "", getKpiCallback, requestEnd);
                }
            }
        };
    }

    Spotfire.registerNameSpace("Visuals.KpiChart", {
        initialize: function (settings) {
            var $kpiChart = $("#" + settings.id);
            var plot = new KpiChart(settings.id); $kpiChart.data("plot", plot); plot.updateTiles(settings);
        }, updateTiles: function (settings) {
            var $kpiChart = $("#" + settings.id);
            var kpiChart = $kpiChart.data("plot"); kpiChart.updateTiles(settings);
        }, resize: function (id) {
            var $kpiChart = $("#" + id);
            var kpiChart = $kpiChart.data("plot"); kpiChart.resize();
        }
    });
});

// Point class

function Point(x, y) {
    this.x = Math.round(x);
    this.y = Math.round(y);
}
Point.prototype.offset = function (x, y) {
    this.x += Math.round(x); this.y += Math.round(y);
    return this;
}; 
Point.prototype.equals = function (point) { return (point.x === this.x && point.y === this.y); }; Point.prototype.toString = function () {
    return "(" + this.x + ", " + this.y + ")";
}; 
Point.prototype.clone = function () { return new Point(this.x, this.y); }; Point.prototype.distance = function (point) {
    var deltaX = this.x - point.x;
    var deltaY = this.y - point.y; return Math.sqrt((deltaX * deltaX) + (deltaY * deltaY));
};

// Rectangle class

function Rectangle(x, y, width, height) {
    if (typeof x === "object") {
        var original = x;
        this.x = original.x; this.y = original.y; this.width = original.width; this.height = original.height; return;
    } this.x = x;
    this.y = y; this.width = width; this.height = height;
} Rectangle.prototype.equals = function (rect) {
    return (rect.x === this.x && rect.y === this.y && rect.width === this.width && rect.height === this.height);
}; Rectangle.prototype.toString = function () {
    return "(" + this.x + ", " + this.y + ", " + this.width + ", " + this.height + ")";
}; Rectangle.prototype.clone = function () { return new Rectangle(this.x, this.y, this.width, this.height); }; Rectangle.prototype.left = function () {
    return this.x;
}; Rectangle.prototype.top = function () { return this.y; }; Rectangle.prototype.right = function () {
    return this.x + this.width;
}; Rectangle.prototype.bottom = function () { return this.y + this.height; }; Rectangle.prototype.centerX = function () {
    return this.x + this.width / 2;
}; Rectangle.prototype.centerY = function () { return this.y + this.height / 2; }; Rectangle.prototype.getHalf = function (side) {
    switch (side) {
        case "top": return new Rectangle(this.x, this.y, this.width, this.height / 2);
        case "bottom": return new Rectangle(this.x, this.y + this.height / 2, this.width, this.height / 2); case "left": return new Rectangle(this.x, this.y, this.width / 2, this.height);
        case "right": return new Rectangle(this.x + this.width / 2, this.y, this.width / 2, this.height); default: return new Rectangle(this);
    }
}; Rectangle.prototype.round = function () {
    this.x = Math.round(this.x); this.y = Math.round(this.y); this.width = Math.round(this.width);
    this.height = Math.round(this.height); return this;
}; Rectangle.prototype.containsPoint = function (x, y) {
    if (x >= this.x && y >= this.y && x < (this.x + this.width) && y < (this.y + this.height)) {
        return true;
    } return false;
}; Rectangle.prototype.offset = function (x, y) { this.x += x; this.y += y; return this; }; Rectangle.prototype.pointOffset = function (point) {
    return this.offset(point.x, point.y);
}; Rectangle.prototype.intersect = function (rectangle) { return this.clip(rectangle); }; Rectangle.prototype.intersectsWith = function (rect) {
    return !(rect.x > this.x + this.width || rect.x + rect.width < this.x || rect.y > this.y + this.height || rect.y + rect.height < this.y);
}; Rectangle.prototype.clip = function (clipRectangle) {
    if (clipRectangle.intersectsWith(this)) {
        var origX = this.x;
        var origY = this.y; this.x = Math.max(this.x, clipRectangle.x); this.y = Math.max(this.y, clipRectangle.y); this.width = Math.max(0, Math.min(origX + this.width, clipRectangle.x + clipRectangle.width) - this.x);
        this.height = Math.max(0, Math.min(origY + this.height, clipRectangle.y + clipRectangle.height) - this.y);
    } else {
        this.width = 0;
        this.height = 0;
    } return this;
}; Rectangle.prototype.inflate = function (width, height) {
    this.y -= height; this.height += 2 * height;
    this.x -= width; this.width += 2 * width;
}; Rectangle.prototype.subtract = function (rect) {
    var a = new Rectangle(this);
    var b = new Rectangle(rect).intersect(a); if (b.width === 0 && b.height === 0) { return this; } if (!(a.width === b.width || a.height === b.height)) {
        return this;
    } if (a.height > b.height) { this.height = a.height - b.height; if (a.y === b.y) { this.y = b.y + b.height; } } else {
        if (a.width > b.width) {
            this.width = a.width - b.width;
            if (a.x === b.x) { this.x = b.x + b.width; }
        } else { this.width = 0; this.height = 0; }
    } return this;
}; 

// size class

function Size(width, height) {
    this.width = width;
    this.height = height;
} Size.prototype.toString = function () { return "(" + this.width + ", " + this.height + ")"; }; function Range(low, high) {
    this.low = low;
    this.high = high;
}

// Range

Range.prototype.toString = function () { return (this.low + " " + this.high); }; function Path(points) {
    this.pathString = "";
    this.pathArray = []; if (!points) { return; } var i; for (i = 0; i < points.length; i++) {
        this.addPoint(points[i].x, points[i].y);
    }
} 

// Path

Path.prototype.addPoint = function (x, y) {
    var pathStringStart = "L "; if (this.pathArray.length === 0) {
        pathStringStart = "M ";
    } this.pathString += pathStringStart + x + " " + y + " "; this.pathArray.push(new Point(x, y));
}; Path.prototype.toArray = function () {
    return this.pathArray;
}; Path.prototype.toString = function () { return this.pathString; }; function Circle(x, y, radius) {
    this.x = x; this.x = y;
    this.radius = radius;
} 

Circle.prototype.circleToPolygon = function () {
    var step = 2 * Math.PI / 100; var points = [];
    var pointsString = ""; var theta, point; for (theta = 0; theta < 2 * Math.PI; theta += step) {
        point = new Point(0, 0); point.x = Math.round(this.x + this.radius * Math.cos(theta));
        point.y = Math.round(this.y - this.radius * Math.sin(theta)); points.push(point); pointsString += "L " + point.x + " " + point.y + " ";
    } pointsString = pointsString.replace("L", "M"); return { pointsString: pointsString, points: points };
}; function Triangle(width, height) {
    this.width = width;
    this.height = height;
} Triangle.prototype.toPathString = function () {
    return "M0 0 L0 " + this.height + " L" + this.width + " " + (this.height / 2) + " Z";
}; function Margins(left, top, right, bottom) {
    if (typeof left === "object") {
        var original = left; this.left = original.left;
        this.top = original.top; this.right = original.right; this.bottom = original.bottom; return;
    } this.left = left; this.top = top;
    this.right = right; this.bottom = bottom;
} Margins.prototype.equals = function (margins) {
    return (margins.left === this.left && margins.top === this.top && margins.right === this.right && margins.bottom === this.bottom);
}; Margins.prototype.toString = function () {
    return "(" + this.left + ", " + this.top + ", " + this.right + ", " + this.bottom + ")";
}; Margins.prototype.toCss = function () {
    return this.top + "px " + this.right + "px " + this.bottom + "px " + this.left + "px";
}; Margins.prototype.clone = function () { return new Margins(this.left, this.top, this.right, this.bottom); };

Margins.prototype.horizontal = function () {
    return this.left + this.right;
};

Margins.prototype.vertical = function () {
    return this.top + this.bottom;
};

// Utilities

Spotfire.registerNameSpace("Utilities");

Spotfire.Utilities.SafeColor = function (color) {
    var colorString = color;
    this.colornames = { aqua: "#00ffff", black: "#000000", blue: "#0000ff", fuchsia: "#ff00ff", gray: "#808080", green: "#008000", lime: "#00ff00", maroon: "#800000", navy: "#000080", olive: "#808000", purple: "#800080", red: "#ff0000", silver: "#c0c0c0", teal: "#008080", white: "#ffffff", yellow: "#ffff00" };
    if (this.colornames[color] !== undefined) { colorString = this.colornames[color]; } if (colorString.charAt(0) === "#" && colorString.length > 6) {
        this.r = parseInt(colorString.substring(1, 3), 16);
        this.g = parseInt(colorString.substring(3, 5), 16); this.b = parseInt(colorString.substring(5, 7), 16);
    } else {
        if (colorString.charAt(0) === "#" && colorString.length > 3) {
            this.r = parseInt(colorString.substring(1, 2), 16);
            this.g = parseInt(colorString.substring(2, 3), 16); this.b = parseInt(colorString.substring(3, 4), 16); this.r += 16 * this.r;
            this.g += 16 * this.g; this.b += 16 * this.b;
        } else {
            if (colorString.indexOf("rgb(") === 0) {
                var str = colorString.substring(4, colorString.length - 1);
                var rgbArray = str.split(",", 3); this.r = parseInt(rgbArray[0], 10); this.g = parseInt(rgbArray[1], 10); this.b = parseInt(rgbArray[2], 10);
            } else { this.r = 255; this.g = 255; this.b = 255; }
        }
    }
};

Spotfire.Utilities.SafeColor.prototype.toHexString = function () {
    var rc = Math.min(255, Math.max(0, this.r));
    var gc = Math.min(255, Math.max(0, this.g)); var bc = Math.min(255, Math.max(0, this.b)); var rgb = bc | (gc << 8) | (rc << 16);
    var colorString = "000000" + rgb.toString(16); colorString = "#" + colorString.substring(colorString.length - 6, colorString.length);
    return colorString;
}; 

Spotfire.Utilities.SafeColor.prototype.luminance = function () {
    var rc = Math.min(255, Math.max(0, this.r));
    var gc = Math.min(255, Math.max(0, this.g)); var bc = Math.min(255, Math.max(0, this.b)); return (0.2126 * rc + 0.7152 * gc + 0.0722 * bc) / 255;
}; 

Spotfire.Utilities.SafeColor.prototype.adjustBrightness = function (value) {
    if (value !== undefined) {
        this.r += value;
        this.g += value; this.b += value;
    }
}; 

// Table Contextual Menu
$(function () {
    Spotfire.registerNameSpace("Visuals.TableContextualMenu");
    function addCheckBox(inputId, text, tooltipText, checked, enabled, callback) {
        var $itemWrapper = Spotfire.Flex.item({ container: "horizontal", inline: true, "align-items": "center" });
        $itemWrapper.css("max-width", "100%"); var $checkbox = $("<div/>").addClass("sf-element sf-element-check-box");
        Spotfire.getSvg("Images/Filters/CheckMark.svg", (function ($cb) {
            return function ($svg) {
                $cb.append($svg);
            };
        }($checkbox))); $checkbox.sfFlex({ shrink: false }).addClass(checked ? "sfpc-checked" : "sfpc-unchecked").appendTo($itemWrapper);
        var $label = Spotfire.Flex.item().addClass("sf-element sf-element-contextual-popout-label").css("text-overflow", "ellipsis").appendTo($itemWrapper);
        $label.text(text); $label.attr("title", tooltipText); if (!enabled) {
            $checkbox.addClass("sfpc-disabled"); $label.addClass("sfpc-disabled");
        } var onClick = function () {
            if (!$checkbox.hasClass("sfpc-disabled")) {
                if ($checkbox.hasClass("sfpc-unchecked")) {
                    $checkbox.addClass("sfpc-checked").removeClass("sfpc-unchecked");
                } else { $checkbox.addClass("sfpc-unchecked").removeClass("sfpc-checked"); } var isChecked = $checkbox.hasClass("sfpc-checked");
                if (!isChecked) { $checkbox.trigger("close"); } callback(isChecked);
            } return false;
        }; $itemWrapper.on("click", onClick);
        return $itemWrapper;
    }

    var buildCrossTableContextMenu = function (args, builder, resizeCallback, individualHeaderStyleCallback, individualColumnStyleCallback) {
        builder.beginSection().
            beginRow(true).
            addCheckBox("markValuesHorizontal", Spotfire.Localization.resources.TablePlotContextMenu_MarkValues, undefined, false, undefined, Spotfire.Localization.resources.TablePlotContextMenu_MarkValuesTitle).
            addCheckBox("markValuesVertical", Spotfire.Localization.resources.TablePlotContextMenu_MarkValues, undefined, false, undefined, Spotfire.Localization.resources.TablePlotContextMenu_MarkValuesTitle).
            endRow().
            endSection();

        builder.beginSection().beginRow().addHeading(Spotfire.Localization.resources.TablePlotContextMenu_Sorting, "column", " ", Spotfire.Localization.resources.TablePlotContextMenu_SortingTitle).endRow().beginRow().addRadioTextButton("columnSorting", Spotfire.Localization.resources.TablePlotContextMenu_SortNoneText, Spotfire.Localization.resources.TablePlotContextMenu_SortNone, "None", undefined).addRadioButton("columnSorting", "Ascending", { text: Spotfire.Localization.resources.TablePlotContextMenu_SortAsc, title: Spotfire.Localization.resources.TablePlotContextMenu_SortAsc, compactMode: true }).addRadioButton("columnSorting", "Descending", { text: Spotfire.Localization.resources.TablePlotContextMenu_SortDesc, title: Spotfire.Localization.resources.TablePlotContextMenu_SortDesc, compactMode: true }).endRow().endSection();
        builder.beginSection().beginRow(true).addCheckBox("sizeToFit", Spotfire.Localization.resources.TablePlotContextMenu_SizeToFit, undefined, false, resizeCallback, Spotfire.Localization.resources.TablePlotContextMenu_SizeToFitTitle).endRow().beginRow().addNullableField("columnWidth", Spotfire.Localization.resources.TablePlotContextMenu_ColumnWidth, true, Spotfire.Localization.resources.TablePlotContextMenu_ColumnWidthTitle).endRow().endSection();
        builder.beginSection().beginRow().addHeading(Spotfire.Localization.resources.TablePlotContextMenu_HeaderSection, "columnHeader", " ", Spotfire.Localization.resources.TablePlotContextMenu_HeaderSectionTitle).endRow().beginRow().addRadioButton("headerHorizontalAlign", "Left", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignLeft, compactMode: true }).addRadioButton("headerHorizontalAlign", "Center", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignCenter, compactMode: true }).addRadioButton("headerHorizontalAlign", "Right", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignRight, compactMode: true }).endRow().beginRow().addRadioButton("headerVerticalAlign", "Top", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignTop, compactMode: true }).addRadioButton("headerVerticalAlign", "Middle", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignMiddle, compactMode: true }).addRadioButton("headerVerticalAlign", "Bottom", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderAlignBottom, compactMode: true }).endRow().beginRow().addRadioButton("headerOrientation", "Vertical", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderOrientationVertical, compactMode: true }).addRadioButton("headerOrientation", "Horizontal", { text: Spotfire.Localization.resources.TablePlotContextMenu_HeaderOrientationHorizontal, compactMode: true }).endRow().beginRow().addNode("individualHeaderStyle", addCheckBox("individualHeaderStyle", Spotfire.Localization.resources.TablePlotContextMenu_StyleHeaderIndividually, args.individualHeaderStyleEnabled ? Spotfire.Localization.resources.TablePlotContextMenu_StyleHeaderIndividuallyTooltip : Spotfire.Localization.resources.TablePlotContextMenu_StyleHeaderIndividuallyDisabledTooltip, args.individualHeaderStyle, args.individualHeaderStyleEnabled, individualHeaderStyleCallback)).endRow().endSection();
        builder.beginSection().beginRow().addHeading(Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignValues, "cellValues", " ", Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignValuesTitle).endRow().beginRow().addRadioButton("columnHorizontalAlign", "DataType", { text: Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignDataType, compactMode: true }).addRadioButton("columnHorizontalAlign", "Left", { text: Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignLeft, compactMode: true }).addRadioButton("columnHorizontalAlign", "Center", { text: Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignCenter, compactMode: true }).addRadioButton("columnHorizontalAlign", "Right", { text: Spotfire.Localization.resources.TablePlotContextMenu_ColumnAlignRight, compactMode: true }).endRow().beginRow().addNode("individualColumnStyle", addCheckBox("individualColumnStyle", Spotfire.Localization.resources.TablePlotContextMenu_StyleAlignValuesIndividually, Spotfire.Localization.resources.TablePlotContextMenu_StyleAlignValuesIndividuallyTooltip, args.individualColumnStyle, args.individualColumnStyleEnabled, individualColumnStyleCallback)).endRow().endSection();
        builder.beginSection().beginRow(true).addCheckBox("hideSubtotals", Spotfire.Localization.resources.CrossTablePlotContextMenu_HideAllSubtotals, undefined, false).endRow().endSection();
        builder.beginSection().beginRow(true).addCheckBox("hideGrandTotalForRows", Spotfire.Localization.resources.CrossTablePlotContextMenu_HideGrandTotalsForRows, undefined, false).endRow().endSection();
        builder.beginSection().beginRow(true).addCheckBox("hideGrandTotalForColumns", Spotfire.Localization.resources.CrossTablePlotContextMenu_HideGrandTotalsForColumns, undefined, false).endRow().endSection();
    };
    
    var showCrossTableMenu = function (id, args, invokeModifyCallback, resizeCallback) {
        var $popover = $("<div>");
        var individualHeaderStyle = args.individualHeaderStyle; var individualColumnStyle = args.individualColumnStyle;
        var callback = function (name, value, checked) {
            invokeModifyCallback("ContextMenu", { method: name, value: value, checked: checked === true, rowIndex: args.rowIndex, columnIndex: args.columnIndex, individualHeaderStyle: individualHeaderStyle, individualColumnStyle: individualColumnStyle });
        }; var individualHeaderStyleCallback = function (checked) {
            individualHeaderStyle = checked; invokeModifyCallback("ContextMenu", { method: "individualHeaderStyle", individualHeaderStyle: individualHeaderStyle, rowIndex: args.rowIndex, value: "none", columnIndex: args.columnIndex });
        }; var individualColumnStyleCallback = function (checked) {
            individualColumnStyle = checked; invokeModifyCallback("ContextMenu", { method: "individualColumnStyle", individualColumnStyle: individualColumnStyle, rowIndex: args.rowIndex, value: "none", columnIndex: args.columnIndex });
        }; var builder = Spotfire.Visuals.ContextualPopout.builder(id, args, $popover, callback); buildCrossTableContextMenu(args, builder, resizeCallback, individualHeaderStyleCallback, individualColumnStyleCallback);
        if ($popover.children().length > 0) {
            Spotfire.Visuals.ContextualPopout.showPropertiesPopover(id, args, $popover);
        }
    };
    
    var show = function (id, args, invokeModify, resizeCallback) {
        switch (args.TypeId) {
            case "Spotfire.CrossTable": showCrossTableMenu(id, args, invokeModify, resizeCallback);
                break;
        }
    }; 
    
    Spotfire.Visuals.TableContextualMenu.show = show;
}); 

// TableHighlight
$(function () {
    var SELECTION_INDICATION_MODE_ROW = 1;
    var SELECTION_INDICATION_MODE_CELL = 2;

    var clear = function (contentContainer) {
        contentContainer.children(".highlightContainer").empty();
    };
    var internalClear = function (id, contentContainer) {
        if (Spotfire.isProfessional()) {
            Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ClearHighlight", "");
        } clear(contentContainer);
    }; 
    var createHighlightDivString = function (left, top, width, height) {
        return "<div class='tableHighlight' style='transform: translate(" + left + "px, " + top + "px);width:" + width + "px; height:" + height + "px'></div>";
    };
    var createHighlightString = function (rect, tableLayout) {
        var top = rect.top;
        var left = rect.left;
        var width = rect.width;
        var height = rect.height; 
        var leftBound = tableLayout.allowFrozenColumnsInteraction ? 0 : tableLayout.frozenColumnsWidth;
        var topBound = tableLayout.frozenRowsHeight;
        var highlightDivs = [];
        var divCounter = 0;
        if (tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_CELL) {
            if (top < topBound) {
                height = height - (topBound - top);
                top = topBound;
            }
            if (left < leftBound) { width = width - (leftBound - left); left = leftBound; } left--; top--; highlightDivs[divCounter++] = createHighlightDivString(left, top, width, 1);
            highlightDivs[divCounter++] = createHighlightDivString(left, top, 1, height); highlightDivs[divCounter++] = createHighlightDivString(left + width, top, 1, height + 1);
            highlightDivs[divCounter++] = createHighlightDivString(left, top + height, width, 1);
        }
        else {
            if (tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_ROW) {
                left = 0;
                width = tableLayout.markableArea.width;
                top--;
                highlightDivs[divCounter++] = createHighlightDivString(left, top, width, 1);
                highlightDivs[divCounter++] = createHighlightDivString(left, top + height, width, 1);
            }
        }
        return highlightDivs.join("");
    }; 
    var render = function (contentContainer, tableLayout, highlightRectangles) {
        var divString = "", i, rect; var length = highlightRectangles.length;
        for (i = 0; i < length; i++) {
            rect = highlightRectangles[i]; divString += createHighlightString(rect, tableLayout);
        }
        var $highlight = contentContainer.children(".highlightContainer"); 
        $highlight.empty(); $highlight.append($(divString));
    };
    Spotfire.registerNameSpace("Visuals.TableHighlight", { render: render, internalClear: internalClear, clear: clear });
}); 

// TablePlot visualization
$(function () {
    var SELECTION_INDICATION_MODE_ROW = 1;
    var SELECTION_INDICATION_MODE_CELL = 2; 
    var allowRelativeLinks = false;
    var classFlag = { valueCell: 1, rowHeader: 2, columnHeader: 4, totalCell: 8, sectionHeader: 16, topLeftHeader: 32, grandTotalRow: 64, grandTotalColumn: 128, subtotal: 256, level1: 512, level2: 1024, levelLast: 2048, oddColumn: 4096, evenColumn: 8192, evenRow: 16384, oddRow: 32768, sectionContent: 65536, wrap: 131072, textOrientationVertical: 262144 };

    var cellTypes = (function () {
        var toClasses = function (types) {
            if (!types || types === classFlag.valueCell) {
                return "sfc-value-cell";
            } var classes = ""; if ((types & classFlag.valueCell) !== 0) { classes += " sfc-value-cell"; } if ((types & classFlag.rowHeader) !== 0) {
                classes += " sfc-row-header";
            } if ((types & classFlag.columnHeader) !== 0) { classes += " sfc-column-header"; } if ((types & classFlag.totalCell) !== 0) {
                classes += " sfpc-total-value";
            } if ((types & classFlag.sectionHeader) !== 0) { classes += " sfpc-section-header"; } if ((types & classFlag.topLeftHeader) !== 0) {
                classes += " sfc-top-left-header";
            } if ((types & classFlag.grandTotalRow) !== 0) { classes += " sfc-grand-total-row"; } if ((types & classFlag.grandTotalColumn) !== 0) {
                classes += " sfc-grand-total-column";
            } if ((types & classFlag.subtotal) !== 0) { classes += " sfc-subtotal"; } if ((types & classFlag.level1) !== 0) {
                classes += " sfpc-level-1";
            } if ((types & classFlag.level2) !== 0) { classes += " sfpc-level-2"; } if ((types & classFlag.levelLast) !== 0) {
                classes += " sfpc-level-last";
            } if ((types & classFlag.oddColumn) !== 0) { classes += " sfpc-odd-column"; } if ((types & classFlag.evenColumn) !== 0) {
                classes += " sfpc-even-column";
            } if ((types & classFlag.evenRow) !== 0) { classes += " sfpc-even-row"; } if ((types & classFlag.oddRow) !== 0) {
                classes += " sfpc-odd-row";
            } if ((types & classFlag.sectionContent) !== 0) { classes += " sfpc-section-content"; } if ((types & classFlag.wrap) !== 0) {
                classes += " sfc-wrap";
            } if ((types & classFlag.textOrientationVertical) !== 0) { classes += " textOrientationDirection-vertical"; } return classes;
        }; return { toClasses: toClasses };
    }());

    function TableTiming(enabled) {
        var startTimes = {}; var log = {}; var begin = function (id) {
            if (!enabled) {
                return;
            } startTimes[id] = $.now();
        }; var end = function (id) {
            if (!enabled) { return; } if (startTimes[id] !== undefined) {
                log[id] = $.now() - startTimes[id];
            }
        }; var render = function (parent) {
            if (!enabled) { return; } parent.children(".tableTiming").remove(); var messageDiv = $("<div class='tableTiming' style='position: absolute; top: 0px; left: 0px; background-color: #E8E8E8; padding: 4px; border: 1px solid; border-color: #282828'></div>");
            var table = $("<table></table>"); $.each(log, function (id, value) {
                var row = $("<tr></tr>"); var idCell = $("<td></td>");
                var valueCell = $("<td></td>"); idCell.text(id); valueCell.text(value + " ms"); row.append(idCell); row.append(valueCell);
                table.prepend(row);
            }); startTimes = {}; log = {}; messageDiv.append(table); parent.append(messageDiv);
        }; this.begin = begin;
        this.end = end; this.render = render;
    }

    var tableTiming = new TableTiming(false);
    var updateGradients = function (tableLayout, container, leftPos, scrollSize, viewportWidth, canvas, frozenRowsCanvas) {
        var gradientWidth = 6;
        var max = Math.max(0, scrollSize.width - viewportWidth); var gradientPositionRight = Math.min(gradientWidth, Math.max(0, max - leftPos)) - gradientWidth;
        var gradientPositionLeft = Math.max(-gradientWidth, Math.min(0, leftPos - gradientWidth)); var $gradient = $("<div class='sf-element-table-gradient' style='position:absolute; top: 0' />");
        $gradient.css("width", gradientWidth + "px"); var $leftGradient = $gradient.clone().addClass("sfpc-left"); var $rightGradient = $gradient.clone().addClass("sfpc-right");
        var $leftContentGradient = $(".sf-element-table-gradient.sfpc-left", canvas.parent()); if ($leftContentGradient.length === 0) {
            $leftContentGradient = $leftGradient.clone();
            $leftContentGradient.insertAfter(canvas);
        } var $leftHeaderGradient = $(".sf-element-table-gradient.sfpc-left", frozenRowsCanvas.parent());
        if ($leftHeaderGradient.length === 0) {
            $leftHeaderGradient = $leftGradient.clone(); $leftHeaderGradient.insertAfter(frozenRowsCanvas);
        } $leftContentGradient.css("left", gradientPositionLeft + "px"); $leftHeaderGradient.css("left", gradientPositionLeft + "px");
        var $rightContentGradient = $(".sf-element-table-gradient.sfpc-right", canvas.parent()); if ($rightContentGradient.length === 0) {
            $rightContentGradient = $rightGradient.clone();
            $rightContentGradient.insertAfter(canvas);
        } var $rightHeaderGradient = $(".sf-element-table-gradient.sfpc-right", frozenRowsCanvas.parent());
        if ($rightHeaderGradient.length === 0) {
            $rightHeaderGradient = $rightGradient.clone(); $rightHeaderGradient.insertAfter(frozenRowsCanvas);
        } $rightContentGradient.css("right", gradientPositionRight + "px"); $rightHeaderGradient.css("right", gradientPositionRight + "px");
        $leftContentGradient.height(container.parent().height()); $rightContentGradient.height(container.parent().height());
        $rightHeaderGradient.height(frozenRowsCanvas.parent().height()); $leftHeaderGradient.height(frozenRowsCanvas.parent().height());
    };

    var hasHorizontalScrollbar = function (tableLayout) {
        return tableLayout.scrollBounds.width + tableLayout.frozenColumnsWidth > tableLayout.viewportSize.width;
    };

    var computeScrollSize = function (tableLayout, scrollbarWidth) {
        var remainder = Math.ceil(tableLayout.rowHeight / 2);
        var scrollWidth = tableLayout.scrollBounds.width + tableLayout.frozenColumnsWidth; var scrollHeight = tableLayout.scrollBounds.height + tableLayout.frozenRowsHeight + remainder;
        var showHorizontalScrollbar = hasHorizontalScrollbar(tableLayout); var showVerticalScrollbar = scrollHeight > tableLayout.viewportSize.height;
        scrollWidth += showVerticalScrollbar ? scrollbarWidth : 0; scrollHeight += showHorizontalScrollbar ? scrollbarWidth : 0;
        return new Size(scrollWidth, scrollHeight);
    };
    
    var getScrollbarWidth = function () {
        var mockDocumentElement = document.createElement("div");
        $(mockDocumentElement).addClass("sf-element sf-element-document"); document.body.appendChild(mockDocumentElement);
        var testElement = document.createElement("div"); testElement.style.position = "absolute"; testElement.style.left = "0px";
        testElement.style.top = "0px"; testElement.style.height = "100px"; testElement.style.width = "100px"; testElement.style.overflowY = "scroll";
        mockDocumentElement.appendChild(testElement); var scrollbar = $(testElement).StyledScrollbar({ cssClass: "TablePlotScroll" });
        var width = scrollbar.getVScrollbarSize(true); scrollbar.destroy(); document.body.removeChild(mockDocumentElement);
        return width;
    };

    var setFont = function (element, jsonFont) {
        if (jsonFont) {
            element.css("font-family", jsonFont.fontFamily);
            element.css("font-size", jsonFont.fontSize); element.css("font-style", jsonFont.fontStyle); element.css("font-weight", jsonFont.fontWeight);
            element.css("line-height", jsonFont.lineHeight);
        }
    }; 

    var renderLayout = function (id, tableLayout) {
        var valueCellsContainerSize = { width: tableLayout.viewportSize.width - tableLayout.frozenColumnsWidth, height: tableLayout.viewportSize.height - tableLayout.frozenRowsHeight };
        var scrollContainer = $("<div style='position:absolute; overflow: auto; left:0px; top:0px'></div>"); scrollContainer.css("width", tableLayout.viewportSize.width + "px");
        scrollContainer.css("height", tableLayout.viewportSize.height + "px"); var scrolledElement = $("<div style='position:absolute'></div>");
        scrolledElement.css("left", "0"); scrolledElement.css("top", "0"); scrollContainer.append(scrolledElement);
        var canvasContainer = $("<div style='position:absolute; overflow: hidden;'></div>"); canvasContainer.css("top", tableLayout.frozenRowsHeight + "px");
        canvasContainer.css("left", tableLayout.frozenColumnsWidth + "px"); canvasContainer.css("width", valueCellsContainerSize.width + "px");
        canvasContainer.css("height", valueCellsContainerSize.height + "px"); var canvas = $("<div style='position:absolute; overflow: visible'></div>");
        canvasContainer.append(canvas); var frozenRowsContainer = $("<div style='position:absolute; overflow: hidden;'></div>");
        frozenRowsContainer.css("top", "0"); frozenRowsContainer.css("left", tableLayout.frozenColumnsWidth + "px");
        frozenRowsContainer.css("width", valueCellsContainerSize.width + "px"); frozenRowsContainer.css("height", tableLayout.frozenRowsHeight + "px");
        var frozenRowsCanvas = $("<div style='position:absolute; overflow: visible'></div>"); frozenRowsContainer.append(frozenRowsCanvas);
        var frozenColumnsContainer = $("<div style='position:absolute; overflow: hidden'></div>"); frozenColumnsContainer.css("top", tableLayout.frozenRowsHeight + "px");
        frozenColumnsContainer.css("left", "0"); frozenColumnsContainer.css("width", tableLayout.frozenColumnsWidth + "px");
        frozenColumnsContainer.css("height", valueCellsContainerSize.height + "px"); var frozenColumnsCanvas = $("<div style='position:absolute; overflow: visible'></div>");
        frozenColumnsContainer.append(frozenColumnsCanvas); var topLeftCornerCanvas = $("<div style='position:absolute;'></div>");
        topLeftCornerCanvas.css("width", tableLayout.frozenColumnsWidth + "px"); topLeftCornerCanvas.css("height", tableLayout.frozenRowsHeight + "px");
        var contentContainer = $("<div name='contentContainer' style='position:absolute; overflow: hidden; left:0px; top:0px; cursor: default'></div>");
        contentContainer.css("width", tableLayout.viewportSize.width + "px"); contentContainer.css("height", tableLayout.viewportSize.height + "px");
        if (tableLayout.css) { Spotfire.StyleManager.updateOverrideCss(contentContainer, tableLayout.css); } else {
            setFont(contentContainer, tableLayout.tableFont);
        } contentContainer.append(canvasContainer); contentContainer.append(frozenColumnsContainer); contentContainer.append(frozenRowsContainer);
        contentContainer.append(topLeftCornerCanvas); return { scrollContainer: scrollContainer, contentContainer: contentContainer, canvas: canvas, frozenRowsCanvas: frozenRowsCanvas, frozenColumnsCanvas: frozenColumnsCanvas, topLeftCornerCanvas: topLeftCornerCanvas };
    }; 

    var renderSortedHeader = function (cell) {
        var sortImage = ""; switch (cell.sort) {
            case "up": sortImage = "Images/Plots/TablePlot/TableUpArrow.gif";
                break; case "down": sortImage = "Images/Plots/TablePlot/TableDownArrow.gif"; break; case "left": sortImage = "Images/Plots/TablePlot/TableLeftArrow.gif";
                    break; case "right": sortImage = "Images/Plots/TablePlot/TableRightArrow.gif"; break;
        } var sortDirection = "vertical";
        switch (cell.sort) { case "left": case "right": sortDirection = "horizontal"; break; } var position = sortDirection === "vertical" ? "right: 2px; bottom: 3px;" : "right: 2px; top: 4px;";
        var imageDiv = "<img src='" + sortImage + "' alt='sort order' style='position: absolute; " + position + "'>"; return imageDiv;
    }; 
    
    var getRotatedBackgroundAlign = function (align, verticalAlign) {
        switch (verticalAlign) {
            case "top": align = "right";
                break; case "center": align = "center"; break; case "bottom": align = "left"; break;
        } return align;
    }; 
    
    var getRotatedBackgroundVerticalAlign = function (align, verticalAlign) {
        switch (align) {
            case "left": verticalAlign = "top";
                break; case "center": verticalAlign = "center"; break; case "right": verticalAlign = "bottom"; break;
        } return verticalAlign;
    };

    var getImageHtml = function (cell) {
        var align = (cell.hasOwnProperty("align") && cell.align !== "") ? cell.align : "right";
        var verticalAlign = (cell.hasOwnProperty("valign") && cell.valign !== "") ? ((cell.valign === "middle") ? "center" : cell.valign) : "center";
        if ((cell.cellTypes & classFlag.textOrientationVertical) !== 0) {
            var tempAlign = getRotatedBackgroundAlign(align, verticalAlign);
            verticalAlign = getRotatedBackgroundVerticalAlign(align, verticalAlign); align = tempAlign;
        } var backgroundImage = "background-repeat: no-repeat; background-image: url('" + cell.imageUrl + "');";
        var imageAlign = align + " " + verticalAlign; backgroundImage += "background-position: " + imageAlign + ";"; return '<div style="width:100%;height:100%;' + backgroundImage + '"></div>';
    }; 
    
    var renderCell = function (htmlArr, cell, offset) {
        var backgroundColor = ""; if (cell.hasOwnProperty("bgColor") && cell.bgColor !== null && cell.bgColor !== "") {
            backgroundColor = "background-color: " + cell.bgColor + ";";
        } var color = ""; if (cell.hasOwnProperty("color") && cell.color !== null && cell.color !== "") {
            color = "color: " + cell.color + ";";
        } var textAlign = ""; var justifyContent = ""; if (cell.hasOwnProperty("align") && cell.align !== "") {
            if (cell.align === "left") {
                justifyContent = "flex-start;";
            } else {
                if (cell.align === "right") { justifyContent = "flex-end;"; } else {
                    if (cell.align === "center") {
                        justifyContent = "center;";
                    }
                }
            } textAlign = "text-align: " + cell.align + ";";
        } var alignItems = ""; if (cell.hasOwnProperty("valign") && cell.valign !== "") {
            if (cell.valign === "top") {
                alignItems = "flex-start;";
            } else {
                if (cell.valign === "middle") { alignItems = "center;"; } else {
                    if (cell.valign === "bottom") {
                        alignItems = "flex-end;";
                    }
                }
            }
        } var cellText = (cell.hasOwnProperty("text") && cell.text !== null) ? cell.text : ""; if (cell.hasOwnProperty("link") && cell.link) {
            var link = cell.link.uri;
            if (Spotfire.isWebPlayer()) { if (!cell.link.isAbsolute && !allowRelativeLinks) { link = "http://" + link; } } cellText = '<a href="' + link + '" target="_blank">' + cellText + "</a>";
        } var cellContentStyle = textAlign.length === 0 ? "" : " style='" + textAlign + "'"; var cellContent = "<div class='cell-text'" + cellContentStyle + ">" + cellText + "</div>";
        if (cell.hasOwnProperty("imageUrl")) { cellContent = getImageHtml(cell); } var verticalSortArrow = false; if (cell.hasOwnProperty("sort")) {
            cellContent = cellContent + renderSortedHeader(cell);
            if (cell.sort === "up" || cell.sort === "down") { verticalSortArrow = true; }
        } var key = ""; if (cell.hasOwnProperty("key") && cell.key) {
            key = "id = '" + cell.key + "'";
        } var actionClass = ""; if (cell.hasOwnProperty("actionEnabled") && cell.actionEnabled) {
            actionClass = " actionCell";
        } var border = ""; if (cell.hasOwnProperty("hideBorder") && cell.hideBorder) {
            border = "border-color: transparent;";
        } var font = ""; if (cell.hasOwnProperty("fontFamily") && cell.fontFamily) {
            font += "font-family: " + cell.fontFamily + ";";
        } if (cell.hasOwnProperty("fontSize") && cell.fontSize) { font += "font-size: " + cell.fontSize + ";"; } if (cell.hasOwnProperty("fontStyle") && cell.fontStyle) {
            font += "font-style: " + cell.fontStyle + ";";
        } if (cell.hasOwnProperty("fontWeight") && cell.fontWeight) { font += "font-weight: " + cell.fontWeight + ";"; } if (cell.hasOwnProperty("lineHeight") && cell.lineHeight) {
            font += "line-height: " + cell.lineHeight + ";";
        } htmlArr.push("<div "); htmlArr.push(key); htmlArr.push(' style="'); if (font !== "") { htmlArr.push(font); } if (border !== "") {
            htmlArr.push(border);
        } if (color !== "") { htmlArr.push(color); } if (justifyContent !== "") {
            htmlArr.push("justify-content: " + justifyContent);
        } if (alignItems !== "") { htmlArr.push("align-items: " + alignItems); } if (backgroundColor !== "") {
            htmlArr.push(backgroundColor);
        } if (verticalSortArrow) { htmlArr.push("padding-right: 11px;"); } var posCanvas = new Point(cell.b[0] - offset.x, cell.b[1] - offset.y);
        htmlArr.push("left: "); htmlArr.push(posCanvas.x); htmlArr.push("px; top: "); htmlArr.push(posCanvas.y);
        htmlArr.push("px; width: "); htmlArr.push(cell.b[2]); htmlArr.push("px; height: "); htmlArr.push(cell.b[3]);
        htmlArr.push("px;"); htmlArr.push("\" class='sf-element-table-cell "); htmlArr.push(cellTypes.toClasses(cell.cellTypes));
        if (actionClass !== "") { htmlArr.push(actionClass); } htmlArr.push("'"); htmlArr.push(">"); htmlArr.push(cellContent);
        htmlArr.push("</div>");
    };

    var renderCellsInternetExplorer = function (cells, $canvas, offset) {
        var keys = []; var keyIndex = 0;
        var i, cell, column, htmlArr, colOffset, strCell, left; var columns = []; for (i = 0; i < cells.length; i++) {
            htmlArr = [];
            cell = cells[i]; left = cell.b[0]; column = columns[left]; if (!column) {
                column = {}; column.cell = []; column.left = left - offset.x;
                column.top = cell.b[1] - offset.y; columns[left] = column;
            } colOffset = { x: offset.x + column.left, y: offset.y + column.top };
            renderCell(htmlArr, cell, colOffset); strCell = htmlArr.join(""); column.cell.push(strCell); if (cell.key) {
                keys[keyIndex] = cell.key;
                keyIndex++;
            }
        } var $part = $("<div name='column' style='position:absolute'></div>"); var key; var $column; for (key in columns) {
            if (columns.hasOwnProperty(key)) {
                column = columns[key];
                $column = $("<div style='position:absolute;'></div>"); $column.css({ left: column.left, top: column.top }); $column.get(0).innerHTML = column.cell.join("");
                $part.append($column);
            }
        } $canvas.append($part); return keys;
    }; 

    var renderCells = function (cells, $canvas, offset, renderedHeaderBounds) {
        var htmlArr = [];
        var keys = []; var keyIndex = 0, cellBounds, isRendered = false; var i, cell, intersection; for (i = 0; i < cells.length;
        i++) {
            cell = cells[i]; if (renderedHeaderBounds) {
                cellBounds = new Rectangle(cell.b[0], cell.b[1], cell.b[2], cell.b[3]);
                intersection = cellBounds.intersect(renderedHeaderBounds); isRendered = intersection && intersection.height > 0 && intersection.width > 0;
            } if (!isRendered) { renderCell(htmlArr, cell, offset); if (cell.key) { keys[keyIndex] = cell.key; keyIndex++; } }
        } var cellContainer = document.createElement("div");
        cellContainer.style.position = "absolute"; cellContainer.innerHTML = htmlArr.join(""); $canvas.append(cellContainer);
        return keys;
    };

    var displayErrors = function (viewport, messages, font) {
        var messagesDiv = $("<div style='visibility: hidden; text-align:center; position: absolute; top: 0px'></div>");
        var i, message, messageDiv; for (i = 0; i < messages.length; i++) {
            message = messages[i]; messageDiv = $("<div style='word-wrap: break-word; visibility: visible; text-align:center; position: relative; top: 0px'></div>");
            messageDiv.text(message); setFont(messageDiv, font[i]); messagesDiv.append(messageDiv);
        } messagesDiv.css("width", viewport.width() + "px");
        viewport.append(messagesDiv); var top = viewport.height() / 2 - messagesDiv.height() / 2; messagesDiv.css("top", top + "px");
        messagesDiv.css("visibility", "visible");
    }; 
    
    var getAdaptedColumnWidth = function ($cells, maxColumnWidth) {
        $cells.each(function () {
            var $item = $(this);
            $item.after($item.clone().addClass("measure-cell").css({ position: "absolute", visibility: "hidden" }));
        });
        var maxWidth = 0; $(".measure-cell").each(function () { maxWidth = Math.max(maxWidth, $(this).width()); }); $(".measure-cell").remove();
        return Math.round(Math.min(maxWidth, maxColumnWidth));
    };

    var computeColumnResize = function (x, viewport, viewportRect, maxColumnWidth, isFrozenColumn) {
        var verifyClass;
        if (isFrozenColumn) { verifyClass = function (cell) { return cell.hasClass("sfc-row-header"); }; } else {
            verifyClass = function (cell) {
                return cell.hasClass("sfpc-level-last") || (cell.hasClass("sfc-grand-total-column") || cell.hasClass("sfc-value-cell"));
            };
        } var columnX = x - 5; var columnCells = viewport.find(".cell-text").filter(function () {
            var cell = $(this).parent();
            var cellOffset = cell.offset(); var cellRect = new Rectangle(cellOffset.left, cellOffset.top, cell.width(), cell.height());
            var ok = !cell.hasClass("sf-element-rotated-cell") && (cellOffset.left <= columnX && (cellOffset.left + cell.outerWidth()) > columnX) && verifyClass(cell) && cellRect.bottom() >= viewportRect.top() && cellRect.top() <= viewportRect.bottom();
            return ok;
        }); if (columnCells.length === 0) { return 0; } var originalWidth = columnCells.first().parent().width();
        var newWidth = getAdaptedColumnWidth(columnCells, maxColumnWidth) + 1; return newWidth - originalWidth;
    };

    function TableInstance(id, layoutGeneration, tableType) {
        var tableLayout = null;
        var scrollContainer; var contentContainer; var canvas; var frozenRowsCanvas; var frozenColumnsCanvas; var topLeftCornerCanvas;
        var pendingResizeToFit; var virtualScrollbar; var getLayout = null; var isMouseOver = null; var model; var scrollbarWidth = getScrollbarWidth();
        var latestHighlightGeneration = -1; var tooltipDelay = 350; if (Spotfire.Web !== undefined) {
            tooltipDelay = Spotfire.Web.tooltipDelay;
            allowRelativeLinks = Spotfire.Web.allowRelativeLinks;
        } var viewport = $("#" + id); viewport.css("width", "100%");
        viewport.css("height", "100%"); var progressTimer = null; function getViewportPos(e) {
            var offset = viewport.offset();
            return new Point(Math.round(e.pageX - offset.left), Math.round(e.pageY - offset.top));
        } function getValueCellTablePos(x, y) {
            var offset = viewport.offset();
            var documentPos = model.getScrollPosition(); var viewPortPos = new Point(Math.round(x - offset.left), Math.round(y - offset.top));
            var xPos = viewPortPos.x + documentPos.x; var yPos = viewPortPos.y + documentPos.y; return new Point(Math.round(xPos), Math.round(yPos));
        } function getTablePos(x, y) {
            var offset = viewport.offset(); var documentPos = model.getScrollPosition(); var viewPortPos = new Point(Math.round(x - offset.left), Math.round(y - offset.top));
            var xPos = (viewPortPos.x < tableLayout.frozenColumnsWidth) ? viewPortPos.x : viewPortPos.x + documentPos.x; var yPos = (viewPortPos.y < tableLayout.frozenRowsHeight) ? viewPortPos.y : viewPortPos.y + documentPos.y;
            return new Point(Math.round(xPos), Math.round(yPos));
        } function getTablePosFromEvent(e) {
            return getTablePos(e.pageX, e.pageY);
        } var handleProgress = function () {
            var showProgress = function () {
                if (!jQuery.contains(document, viewport[0])) {
                    return;
                } Progress.showPlotOverlay(id); progressTimer = null;
            }; if (progressTimer === null) {
                progressTimer = window.setTimeout(showProgress, 1000);
            }
        }; var clearProgress = function () {
            if (progressTimer !== null) {
                window.clearTimeout(progressTimer); progressTimer = null;
            }
        }; var visibleValueCellRows = function () {
            var visibleRows = Math.floor((tableLayout.viewportSize.height - tableLayout.frozenRowsHeight - scrollbarWidth) / tableLayout.rowHeight);
            return visibleRows < 1 ? 1 : visibleRows;
        }; var pageScrollSize = function () {
            var visibleRows = visibleValueCellRows();
            var rowsToScroll = visibleRows === 1 ? 1 : visibleRows - 1; return { width: Math.abs(tableLayout.viewportSize.width - tableLayout.frozenColumnsWidth - scrollbarWidth), height: rowsToScroll * tableLayout.rowHeight };
        }; var handleKeyScroll = function (keyDownArgs) {
            var keys = { Up: 38, Down: 40, Left: 37, Right: 39, PageUp: 33, PageDown: 34, Home: 36, End: 35, Space: 32 };
            var x = virtualScrollbar.scrollLeft(); var y = virtualScrollbar.scrollTop(); switch (keyDownArgs.keyCode) {
                case keys.PageUp: y -= pageScrollSize().height;
                    break; case keys.PageDown: y += pageScrollSize().height; break; case keys.Home: if (keyDownArgs.ctrlKey) {
                        y = 0;
                    } else { x = 0; } break; case keys.End: if (keyDownArgs.ctrlKey) {
                        y = Math.max(0, tableLayout.scrollBounds.height);
                    } else { x = Math.max(0, tableLayout.scrollBounds.width); } break; case keys.Left: x -= 20; break; case keys.Right: x += 20;
                        break; case keys.Up: y -= 20; break; case keys.Down: y += 20; break; default: return;
            } virtualScrollbar.scrollTop(y);
            virtualScrollbar.scrollLeft(x);
        }; var getPendingValueCallback = function (response) {
            if (!response) {
                return;
            } var cell = $("#" + response.key, viewport); if (cell.length === 1) {
                if (response.text) {
                    $(".cell-text", cell).text(response.text);
                } else { cell.text(""); } if (response.color) { cell.css("color", response.color); } else { cell.css("color", ""); } if (response.fontStyle) {
                    cell.css("font-style", response.fontStyle);
                } else { cell.css("font-style", ""); } if (response.fontWeight) {
                    cell.css("font-weight", response.fontWeight);
                } else { cell.css("font-weight", ""); }
            } model.getNextPendingValue(getPendingValueCallback);
        }; var resizeToFit = function () {
            if (!tableLayout.allowColumnResize) {
                return;
            } var offset = viewport.offset(); var viewportRect = new Rectangle(offset.left, offset.top, viewport.width() * 2, viewport.height());
            var $topLeftHeaders = topLeftCornerCanvas.find(".sf-element-table-cell.sfc-top-left-header"); var $grandTotalHeaders = frozenRowsCanvas.find(".sf-element-table-cell.sfc-grand-total-column");
            var $valueCellHeaders = frozenRowsCanvas.find(".sf-element-table-cell.sfpc-level-last"); var columnWidths = [];
            $topLeftHeaders.each(function () {
                var x = $(this).offset().left + 10; var delta = computeColumnResize(x, viewport, viewportRect, tableLayout.maxColumnWidth, true);
                if (delta !== 0) { columnWidths.push({ x: getTablePos(x, 0).x, deltaWidth: delta }); }
            }); $grandTotalHeaders.each(function () {
                var x = $(this).offset().left + 10;
                var delta = computeColumnResize(x, viewport, viewportRect, tableLayout.maxColumnWidth, false); if (delta !== 0) {
                    columnWidths.push({ x: getValueCellTablePos(x, 0).x, deltaWidth: delta });
                }
            }); $valueCellHeaders.each(function () {
                var x = $(this).offset().left + 10; var delta = computeColumnResize(x, viewport, viewportRect, tableLayout.maxColumnWidth, false);
                if (delta !== 0) { columnWidths.push({ x: getValueCellTablePos(x, 0).x, deltaWidth: delta }); }
            }); var totalWidthChange = 0;
            $.each(columnWidths, function (index, item) { totalWidthChange += item.deltaWidth; }); var needToGetMoreCells = !(totalWidthChange >= 0 || pendingResizeToFit || !hasHorizontalScrollbar(tableLayout));
            if (needToGetMoreCells) {
                var viewportFunc = function () {
                    var valueCellViewport = model.getValueCellsViewport();
                    pendingResizeToFit = true; var valueCellViewportWide = new Rectangle(valueCellViewport.x, valueCellViewport.y, valueCellViewport.width * 2, valueCellViewport.height);
                    if (valueCellViewportWide.right() > tableLayout.scrollBounds.width) {
                        valueCellViewportWide.x = Math.floor(valueCellViewport.x - (valueCellViewportWide.right() - tableLayout.scrollBounds.width));
                    } return valueCellViewportWide;
                }; if (model.getCells(viewportFunc)) { pendingResizeToFit = true; return; }
            } pendingResizeToFit = false;
            if (columnWidths.length > 0) { model.modify("ResizeColumnWidths", { columns: columnWidths }); }
        }; var renderTablePart = function (cellType, partCells, partCanvas, offset, renderedHeaderBounds) {
            if (partCells === undefined || partCells === null) {
                return;
            } if (partCells.renderAction === "replace") { partCanvas.empty(); } var newKeys = null; if (cellType === "headers") {
                newKeys = renderCells(partCells.cells, partCanvas, offset, renderedHeaderBounds);
            } else {
                if (cellType === "values") {
                    newKeys = renderCellsInternetExplorer(partCells.cells, partCanvas, offset);
                }
            } if (newKeys && newKeys.length > 0) {
                model.addPendingValueKeys(newKeys); model.getNextPendingValue(getPendingValueCallback);
            }
        }; var setCanvasPos = function (pos) {
            Spotfire.Visuals.Tooltip.hide(); viewport.removeData("toolTipScrollPosition");
            var offsets = model.getRenderOffsets(); var canvasLeft = -(pos.x - offsets.valueCells.x); var canvasTop = -(pos.y - offsets.valueCells.y);
            var frozenRowsLeft = -(pos.x - offsets.frozenRows.x); var frozenColumnsTop = -(pos.y - offsets.frozenColumns.y);
            canvas.css("transform", "translate(" + canvasLeft + "px," + canvasTop + "px)"); frozenRowsCanvas.css("transform", "translate(" + frozenRowsLeft + "px,0px)");
            frozenColumnsCanvas.css("transform", "translate(0px," + frozenColumnsTop + "px)"); contentContainer.trigger("renderMarking");
            contentContainer.trigger("renderMovingHeader"); contentContainer.trigger("renderHighlight");
        }; var setScrollbarVisible = function (visible) {
            if (scrollContainer.parent().length === 0) {
                return;
            } if (scrollbarWidth === 0) { return; } var scrolledElement = scrollContainer.children(); var barWidth = visible ? scrollbarWidth : 0;
            if (scrollContainer.width() < scrolledElement.width()) {
                contentContainer.css("height", (tableLayout.viewportSize.height - barWidth) + "px");
            } if (scrollContainer.height() < scrolledElement.height()) {
                contentContainer.css("width", (tableLayout.viewportSize.width - barWidth) + "px");
            } var scrollBarElement = scrollContainer.parent(); scrollBarElement.css("visibility", visible ? "visible" : "hidden");
        }; var onScroll = function (e, direction) {
            if (direction === "horizontal") {
                updateGradients(tableLayout, scrollContainer, virtualScrollbar.scrollLeft(), virtualScrollbar.scrollSize(), tableLayout.viewportSize.width, canvas, frozenRowsCanvas);
            } var pos = new Point(virtualScrollbar.scrollLeft(), virtualScrollbar.scrollTop()); var snappedPos = model.onScroll(pos);
            if (snappedPos !== null) { setCanvasPos(snappedPos); }
        }; var hideScrollbar = function () {
            if (scrollContainer.parent().length === 0) {
                return;
            } var styledScroll = scrollContainer.StyledScrollbar(); if (styledScroll && styledScroll.isScrolling()) {
                return;
            } if (tableLayout.autoHideTableScrollbars) { setScrollbarVisible(false); }
        }; var showScrollbar = function () {
            if (tableLayout.autoHideTableScrollbars) {
                setScrollbarVisible(true);
            }
        }; var clearRightClickIndication = function (rightClickPoint) {
            if (contentContainer === undefined) { return; } var rightClickData = contentContainer.data("rightClickData");
            if (rightClickData !== undefined && rightClickData !== null) {
                var point = rightClickData.point; if (point !== undefined && point !== null && rightClickPoint !== undefined && rightClickPoint !== null) {
                    if (point.x === rightClickPoint.x && point.y === rightClickPoint.y) {
                        rightClickData.cell.css("background-color", rightClickData.backgroundColor);
                    }
                } else { rightClickData.cell.css("background-color", rightClickData.backgroundColor); }
            }
        }; var eventHandlerScope = function () {
            var isLeftMouseButtonDown = false;
            var isRightMouseButtonDown = false; var getCell = function (eventArgs) {
                return $(eventArgs.target).closest(".sf-element-table-cell");
            }; var viewportOffset = function () { return viewport.offset(); }; var onMouseLeaveViewport = function (e) {
                var offset = viewportOffset();
                var rect = new Rectangle(offset.left, offset.top, viewport.width(), viewport.height()); if (!rect.containsPoint(e.pageX, e.pageY) || (e.relatedTarget && !$(e.relatedTarget).parent().hasClass("Tooltip"))) {
                    Spotfire.Visuals.Tooltip.hide();
                    viewport.data("tooltip", false); viewport.removeData("toolTipScrollPosition");
                } if (rect.containsPoint(e.pageX, e.pageY)) {
                    return;
                } if (isLeftMouseButtonDown) { return; } Spotfire.Visuals.TableHighlight.internalClear(id, contentContainer);
                hideScrollbar();
            }; var handleKeyDown = function (e) {
                var invoke = false; switch (e.keyCode) {
                    case Keys.UP: case Keys.DOWN: case Keys.LEFT: case Keys.RIGHT: case Keys.PAGEUP: case Keys.PAGEDOWN: case Keys.HOME: case Keys.END: case Keys.SPACE: case Keys.F1: invoke = true;
                        break;
                } if (invoke) {
                    var keyDownArgs = { keyCode: e.keyCode, shiftKey: e.shiftKey, ctrlKey: e.ctrlKey }; model.modify("KeyDown", keyDownArgs);
                }
            }; var getValueCell = function (eventArgs) { return $(eventArgs.target).closest(".sfc-value-cell"); }; var getHeaderCell = function (eventArgs) {
                var $cell = $(eventArgs.target).closest(".sf-element-table-cell");
                if (!$cell.hasClass("sfc-value-cell") && ($cell.hasClass("sfc-column-header") || $cell.hasClass("sfc-row-header"))) {
                    return $cell;
                } return $();
            }; var isOnVerticalHeaderBorder = function (eventArgs) {
                var headerCell = getHeaderCell(eventArgs);
                if (headerCell.length === 0) { return false; } var x = eventArgs.pageX; var leftBorder = headerCell.offset().left;
                var rightBorder = leftBorder + headerCell.outerWidth(); return (x > (rightBorder - 3) || x < (leftBorder + 3));
            }; var isOnHorizontalHeaderBorder = function (eventArgs) {
                var headerCell = getHeaderCell(eventArgs);
                if (headerCell.length === 0) { return false; } var y = eventArgs.pageY; var topBorder = headerCell.offset().top; var bottomBorder = topBorder + headerCell.outerHeight();
                return (y > (bottomBorder - 3) || y < (topBorder + 3));
            }; var isOnHeader = function (eventArgs) {
                return getHeaderCell(eventArgs).length !== 0;
            }; var isFarLeftBorder = function (x) { return (x - viewportOffset().left) < 7; }; var isTopBorder = function (y) {
                return (y - viewportOffset().top) < 7;
            }; var isBottomBorder = function (y) { return (y - viewportOffset().top) > tableLayout.frozenRowsHeight + 7; }; var createRectangleFromPoints = function (startPoint, endPoint) {
                var left = Math.min(startPoint.x, endPoint.x);
                var top = Math.min(startPoint.y, endPoint.y); var right = Math.max(startPoint.x, endPoint.x); var bottom = Math.max(startPoint.y, endPoint.y);
                return new Rectangle(left, top, right - left, bottom - top);
            }; var calculateScrollDelta = function (delta) {
                delta = Math.min(100, delta);
                delta = (10 + delta * (delta / 10)); return delta;
            }; var createMarkingRectangle = function () {
                var markingRectangle = $("<div/>").addClass("sf-element-table-marking-rect");
                if (tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_CELL) {
                    markingRectangle.css({ "border-left": "1px solid", "border-right": "1px solid" });
                } markingRectangle.hide(); return markingRectangle;
            }; var createResizeIndicator = function (pos, size, verticalBorder) {
                var left = verticalBorder ? pos : 1;
                var top = verticalBorder ? 1 : pos; var width = verticalBorder ? 1 : size.width; var height = verticalBorder ? size.height : 1;
                var resizeIndicator = $("<div style='position:absolute; overflow: hidden; background: red;'></div>"); resizeIndicator.css({ top: top + "px", left: left + "px", width: width + "px", height: height + "px" });
                return resizeIndicator;
            }; var createHeaderIndicator = function (clickedHeader) {
                var headerIndicator = clickedHeader.clone();
                headerIndicator.attr("id", "HeaderIndicator"); headerIndicator.css({ border: "solid 1px #909090", visibility: "hidden" });
                return headerIndicator;
            }; var createPositionIndicator = function (x, y, height) {
                var headerPositionIndicator = $("<div style='position:absolute; overflow: hidden; background: red;'></div>");
                headerPositionIndicator.css({ top: y + "px", left: x + "px", width: "1px", height: height + "px", visibility: "hidden" });
                return headerPositionIndicator;
            }; var isLeafHeader = function (e) {
                var pageX = e.pageX - 5; var $headers = frozenRowsCanvas.find(".sfc-column-header").filter(function () {
                    var cell = $(this);
                    var cellOffset = cell.offset(); return cellOffset.left <= pageX && (cellOffset.left + cell.outerWidth()) > pageX;
                }); if ($headers.length > 1) {
                    var $leafHeader = null; $headers.each(function () {
                        if ($leafHeader === null || $leafHeader.offset().top < $(this).offset().top) {
                            $leafHeader = $(this);
                        }
                    }); if (e.pageY >= $leafHeader.offset().top) { return true; } return false;
                } return true;
            }; var handleAdaptColumnWidth = function (e) {
                if (!tableLayout.allowColumnResize || isFarLeftBorder(e.pageX)) {
                    return;
                } if (!isLeafHeader(e)) { return; } var pageX = e.pageX - 5; var offset = viewport.offset(); var viewportRect = new Rectangle(offset.left, offset.top, viewport.width(), viewport.height());
                var tablePos = getTablePos(pageX, e.pageY); var isFrozenColumn = tablePos.x <= tableLayout.frozenColumnsWidth;
                var delta = computeColumnResize(pageX, viewport, viewportRect, tableLayout.maxColumnWidth, isFrozenColumn);
                if (delta !== 0) {
                    model.modify("ResizeColumnWidth", { x: tablePos.x, y: tablePos.y, deltaWidth: Math.round(delta), allColumns: false });
                }
            }; var showContextMenu = function (e, args) {
                var clipElement; var cell = getCell(e); var cellRectangle = new Rectangle(cell.offset().left, cell.offset().top, cell.outerWidth(), cell.outerHeight());
                if (cell.hasClass("sfc-top-left-header")) { clipElement = topLeftCornerCanvas.parent(); } else {
                    if (cell.hasClass("sfc-column-header")) {
                        clipElement = frozenRowsCanvas.parent();
                    } else {
                        if (cell.hasClass("sfc-row-header")) { clipElement = frozenColumnsCanvas.parent(); } else {
                            clipElement = contentContainer;
                        }
                    }
                } var clipRectangle = new Rectangle(clipElement.offset().left, clipElement.offset().top, clipElement.outerWidth(), clipElement.outerHeight());
                cellRectangle.clip(clipRectangle); args = _.extend(args, { x: cell.offset().left + cell.outerWidth(), y: cell.offset().top, rectangle: cellRectangle, alignment: ["Left", "Right", "Bottom", "Top"] });
                var modifyCallback = function (method, args) { model.modify(method, args); }; var resizeCallback = function () {
                    handleAdaptColumnWidth(e);
                }; Spotfire.Visuals.TableContextualMenu.show(id, args, modifyCallback, resizeCallback);
            }; var handleHeaderClicked = function (e) {
                var point = getTablePosFromEvent(e);
                var clickData = { x: point.x, y: point.y, shiftKey: e.shiftKey, ctrlKey: e.ctrlKey, altKey: e.altKey }; var onGetContextMenu = function (args) {
                    if (!args.hasOwnProperty("enabled")) {
                        model.modify("CellClicked", clickData);
                        return;
                    } showContextMenu(e, args);
                }; if (clickData.shiftKey || clickData.altKey || clickData.ctrlKey) {
                    model.modify("CellClicked", clickData);
                } else { model.read("GetContextMenu", clickData, onGetContextMenu); }
            }; var handleValueCellClick = function ($clickedValueCell) {
                var mouseMove = $.noop;
                var mouseUp = function (moveUpArgs) {
                    var clickedCellTop = $clickedValueCell.offset().top; var clickedCellLeft = $clickedValueCell.offset().left;
                    var clickedCellBottom = clickedCellTop + $clickedValueCell.height(); var clickedCellRight = clickedCellLeft + $clickedValueCell.width();
                    if (moveUpArgs.pageX < clickedCellLeft || moveUpArgs.pageX > clickedCellRight || moveUpArgs.pageY < clickedCellTop || moveUpArgs.pageY > clickedCellBottom) {
                        return;
                    } var pos = getTablePos($clickedValueCell.offset().left, $clickedValueCell.offset().top); var cellClickItem = { x: pos.x, y: pos.y, shiftKey: moveUpArgs.shiftKey, ctrlKey: moveUpArgs.ctrlKey, altKey: moveUpArgs.altKey };
                    model.modify("CellClicked", cellClickItem);
                }; Spotfire.Touch.legacyTouchMouseCapture(contentContainer, mouseMove, mouseUp);
            }; var handleMarking = function (e) {
                var abortMarking = false; if (e.target && e.target.nodeName === "A") {
                    abortMarking = true;
                } var anchorPoint = getTablePosFromEvent(e); var currentLocalPoint = getViewportPos(e); var bounds; var ctrlKey = e.ctrlKey || (e.metaKey === undefined ? false : e.metaKey);
                var shiftKey = e.shiftKey; var altKey = e.altKey; var markingRectangle = createMarkingRectangle(); contentContainer.append(markingRectangle);
                var markableBounds = new Rectangle(tableLayout.markableArea); var isOutsideBounds = false; var scrollWhileMarkingTimeout;
                function scrollWhileMarking() {
                    var delta; var scrollTop = virtualScrollbar.scrollTop(); if (currentLocalPoint.y > bounds.bottom()) {
                        delta = calculateScrollDelta(currentLocalPoint.y - bounds.bottom());
                        virtualScrollbar.scrollTop(scrollTop + delta);
                    } else {
                        if (currentLocalPoint.y < bounds.top()) {
                            delta = calculateScrollDelta(bounds.top() - currentLocalPoint.y);
                            virtualScrollbar.scrollTop(scrollTop - delta);
                        }
                    } var scrollLeft = virtualScrollbar.scrollLeft(); if (currentLocalPoint.x > bounds.right()) {
                        delta = calculateScrollDelta(currentLocalPoint.x - bounds.right());
                        virtualScrollbar.scrollLeft(scrollLeft + delta);
                    } else {
                        if (currentLocalPoint.x < bounds.left()) {
                            delta = calculateScrollDelta(bounds.left() - currentLocalPoint.x);
                            virtualScrollbar.scrollLeft(scrollLeft - delta);
                        }
                    } scrollWhileMarkingTimeout = setTimeout(scrollWhileMarking, 20);
                } var renderMarkingRectangle = function () {
                    var documentOffset = model.getScrollPosition(); var endPoint = new Point(currentLocalPoint.x + documentOffset.x, currentLocalPoint.y + documentOffset.y);
                    var currentRectangle = createRectangleFromPoints(anchorPoint, endPoint); currentRectangle.offset(-documentOffset.x, -documentOffset.y);
                    if (!currentRectangle.intersectsWith(markableBounds) || abortMarking) { markingRectangle.hide(); return; } markingRectangle.show();
                    currentRectangle.clip(markableBounds); var markingX = tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_ROW ? tableLayout.markableArea.x : currentRectangle.x;
                    var markingWidth = tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_ROW ? Math.min(tableLayout.markableArea.width, contentContainer.outerWidth()) : currentRectangle.width;
                    markingRectangle.css({ left: markingX + "px", top: currentRectangle.y + "px", width: markingWidth + "px", height: currentRectangle.height + "px" });
                }; var mouseMove = function (event) {
                    currentLocalPoint = getViewportPos(event); if (anchorPoint.equals(getTablePosFromEvent(event))) {
                        return;
                    } abortMarking = false; var documentOffset = model.getScrollPosition(); var viewportBounds = new Rectangle(0, 0, tableLayout.viewportSize.width, tableLayout.viewportSize.height);
                    bounds = viewportBounds.clone().intersect(markableBounds); if (bounds.containsPoint(currentLocalPoint.x, currentLocalPoint.y) || (documentOffset.x === 0 && currentLocalPoint.x < bounds.left()) || (documentOffset.y === 0 && currentLocalPoint.y < bounds.top())) {
                        if (isOutsideBounds) {
                            isOutsideBounds = false;
                            clearTimeout(scrollWhileMarkingTimeout);
                        } renderMarkingRectangle();
                    } else {
                        if (!isOutsideBounds) {
                            isOutsideBounds = true;
                            scrollWhileMarking();
                        }
                    }
                }; var mouseUp = function (event) {
                    clearTimeout(scrollWhileMarkingTimeout); contentContainer.unbind("renderMarking");
                    markingRectangle.sfRemoveAsync(); var endPoint = getTablePosFromEvent(event); var rect = createRectangleFromPoints(anchorPoint, endPoint);
                    rect.clip(markableBounds); if (abortMarking) { return; } var marking = { shiftKey: shiftKey, ctrlKey: ctrlKey, altKey: altKey, left: Math.round(rect.left()), top: Math.round(rect.top()), right: Math.round(rect.right()), bottom: Math.round(rect.bottom()) };
                    model.modify("Mark", marking);
                }; contentContainer.bind("renderMarking", renderMarkingRectangle); var markImmediately = Spotfire.capabilities.supportsTouch() && e.type !== undefined && e.type === "mousedown";
                if (markImmediately) { mouseUp(e); } else {
                    Spotfire.Touch.legacyTouchMouseCapture(contentContainer, mouseMove, mouseUp);
                }
            }; var handleMoveColumn = function (e, clickedHeader) {
                var offset = viewportOffset(); if (e.pageY - offset.top > tableLayout.frozenRowsHeight) {
                    return;
                } var initialScrollLeft = model.getScrollPosition().x; var scrollLeft = initialScrollLeft; var uninteractiveFrozenColumnsWidth = tableLayout.nonMovableColumnsWidth;
                var interactiveFrozenColumnsWidth = tableLayout.allowFrozenColumnsInteraction ? tableLayout.frozenColumnsWidth : 0;
                var clickLocalX = e.pageX - offset.left; var clickX = clickLocalX + scrollLeft; var mouseX = clickX; if (clickX < uninteractiveFrozenColumnsWidth) {
                    return;
                } var currentLocalLeft = clickedHeader.offset().left - offset.left; var currentLocalRight = currentLocalLeft + clickedHeader.outerWidth();
                var leftBorder = currentLocalLeft + scrollLeft; var rightBorder = leftBorder + clickedHeader.outerWidth(); var headerIndicator = createHeaderIndicator(clickedHeader);
                contentContainer.append(headerIndicator); var newPositionIndicator = createPositionIndicator(currentLocalLeft, 0, clickedHeader.outerHeight());
                viewport.append(newPositionIndicator); var isOutsideBounds = false; var scrollWhileMovingHeaderTimeout; var leftViewBound;
                var rightViewBound; function scrollWhileMovingHeader() {
                    var newScrollLeft; if (mouseX > rightViewBound) {
                        var scrollRightDelta = calculateScrollDelta(mouseX - rightViewBound);
                        newScrollLeft = virtualScrollbar.scrollLeft() + scrollRightDelta; virtualScrollbar.scrollLeft(newScrollLeft);
                    } else {
                        if (mouseX < leftViewBound) {
                            var scrollLeftDelta = calculateScrollDelta(leftViewBound - mouseX); newScrollLeft = virtualScrollbar.scrollLeft() - scrollLeftDelta;
                            virtualScrollbar.scrollLeft(newScrollLeft);
                        }
                    } scrollWhileMovingHeaderTimeout = setTimeout(scrollWhileMovingHeader, 20);
                } var renderMovingHeader = function () {
                    headerIndicator.css({ left: (leftBorder - scrollLeft) + (mouseX - clickX) + "px", visibility: "visible" });
                    var initialClick = (mouseX - scrollLeft < interactiveFrozenColumnsWidth) || clickLocalX < interactiveFrozenColumnsWidth ? clickLocalX : clickX - scrollLeft;
                    var indicatorLeft = (mouseX - scrollLeft) - initialClick < 0 ? currentLocalLeft : currentLocalRight; newPositionIndicator.css("left", indicatorLeft + "px");
                    var isWithinCell = (mouseX <= rightBorder && mouseX >= leftBorder); if (clickLocalX < interactiveFrozenColumnsWidth) {
                        isWithinCell = (mouseX - scrollLeft) <= (rightBorder - initialScrollLeft) && (mouseX - scrollLeft) >= (leftBorder - initialScrollLeft);
                    } if (isWithinCell || (interactiveFrozenColumnsWidth > 0 && currentLocalLeft < interactiveFrozenColumnsWidth && (mouseX - scrollLeft) >= interactiveFrozenColumnsWidth) || (uninteractiveFrozenColumnsWidth > 0 && currentLocalLeft < uninteractiveFrozenColumnsWidth)) {
                        headerIndicator.css({ opacity: "0.2", filter: "alpha(opacity = 20)" });
                        newPositionIndicator.css("visibility", "hidden");
                    } else {
                        headerIndicator.css({ opacity: "1.0", filter: "alpha(opacity = 100)" });
                        newPositionIndicator.css("visibility", "visible");
                    }
                }; var mouseMoveHeader = function (event) {
                    offset = viewportOffset();
                    var cell = getValueCell(event); if (cell.length === 0) {
                        var localMouseX = mouseX - scrollLeft; var container = (interactiveFrozenColumnsWidth > 0 && localMouseX < interactiveFrozenColumnsWidth) ? frozenColumnsCanvas : contentContainer;
                        container.find(".sf-element-table-cell").each(function () {
                            var left = $(this).offset().left - offset.left; if (left < localMouseX && localMouseX < left + $(this).outerWidth() && !($(this).hasClass("sfpc-section-header"))) {
                                if ($(this).attr("id") !== "HeaderIndicator") {
                                    cell = $(this);
                                    return false;
                                }
                            } return true;
                        });
                    } if (cell.length > 0) {
                        currentLocalLeft = cell.offset().left - offset.left; currentLocalRight = currentLocalLeft + cell.outerWidth();
                    } scrollLeft = model.getScrollPosition().x; mouseX = event.pageX + scrollLeft - offset.left; leftViewBound = scrollLeft;
                    rightViewBound = leftViewBound + tableLayout.viewportSize.width; if (mouseX > leftViewBound && mouseX < rightViewBound) {
                        if (isOutsideBounds) {
                            isOutsideBounds = false;
                            clearTimeout(scrollWhileMovingHeaderTimeout);
                        } renderMovingHeader();
                    } else {
                        if (!isOutsideBounds) {
                            isOutsideBounds = true;
                            scrollWhileMovingHeader();
                        }
                    }
                }; var mouseUpHeader = function (event) {
                    isLeftMouseButtonDown = isRightMouseButtonDown = false;
                    clearTimeout(scrollWhileMovingHeaderTimeout); contentContainer.unbind("renderMovingHeader"); headerIndicator.sfRemoveAsync();
                    newPositionIndicator.sfRemoveAsync(); if (mouseX - clickX === 0) { handleHeaderClicked(event); } else {
                        if ((interactiveFrozenColumnsWidth > 0 && currentLocalLeft < interactiveFrozenColumnsWidth && (mouseX - scrollLeft) > interactiveFrozenColumnsWidth) || (uninteractiveFrozenColumnsWidth > 0 && currentLocalLeft < uninteractiveFrozenColumnsWidth)) {
                            return;
                        } if (clickLocalX < interactiveFrozenColumnsWidth) { clickX = clickLocalX; } if (mouseX - scrollLeft < interactiveFrozenColumnsWidth) {
                            mouseX -= scrollLeft;
                        } var moveColumn = { fromX: Math.round(clickX), toX: Math.round(mouseX) }; model.modify("MoveColumn", moveColumn);
                    }
                }; contentContainer.bind("renderMovingHeader", renderMovingHeader); Spotfire.Touch.legacyTouchMouseCapture(clickedHeader, mouseMoveHeader, mouseUpHeader);
            }; var handleResizeColumn = function (e, verticalBorder) {
                var clickPos = getTablePosFromEvent(e); if (verticalBorder && (!tableLayout.allowColumnResize || isFarLeftBorder(e.pageX))) {
                    return;
                } if (!verticalBorder && !tableLayout.allowRowResize && (!tableLayout.allowFrozenRowResize || isTopBorder(e.pageY) || isBottomBorder(e.pageY))) {
                    return;
                } var headerCell = getHeaderCell(e); var firstBorder = verticalBorder ? headerCell.offset().left : headerCell.offset().top;
                var secondBorder = verticalBorder ? firstBorder + headerCell.outerWidth() : firstBorder + headerCell.outerHeight();
                var initialBrowserMousePos = verticalBorder ? e.pageX : e.pageY; var columnBorder; if (initialBrowserMousePos > (secondBorder - 5)) {
                    columnBorder = secondBorder;
                } else { columnBorder = firstBorder; } var viewportOffsetBorder = verticalBorder ? viewportOffset().left : viewportOffset().top;
                var initialLocalBorderPos = columnBorder - viewportOffsetBorder; var resizeIndicator = createResizeIndicator(initialLocalBorderPos, tableLayout.viewportSize, verticalBorder);
                var resizeIndicatorTimeout = setTimeout(function delayCreateResizeIndicator() {
                    viewport.append(resizeIndicator);
                }, 200); var mouseMove = function (event) {
                    var currentBrowserMousePos = verticalBorder ? event.pageX : event.pageY;
                    var pos = initialLocalBorderPos + (currentBrowserMousePos - initialBrowserMousePos); if (verticalBorder) {
                        resizeIndicator.css("left", pos + "px");
                    } else { resizeIndicator.css("top", pos + "px"); }
                }; var mouseUp = function (event) {
                    isLeftMouseButtonDown = isRightMouseButtonDown = false;
                    clearTimeout(resizeIndicatorTimeout); resizeIndicator.remove(); var delta = verticalBorder ? (event.pageX - initialBrowserMousePos) : (event.pageY - initialBrowserMousePos);
                    if (delta === 0) { return; } if (verticalBorder) {
                        var x = clickPos.x - 5; var resizeColumnWidth = { x: x, y: clickPos.y, deltaWidth: Math.round(delta), allColumns: event.ctrlKey };
                        model.modify("ResizeColumnWidth", resizeColumnWidth);
                    } else {
                        var offset = viewportOffset(); var resizeRowHeight = { y: Math.round(initialBrowserMousePos - offset.top), deltaHeight: Math.round(delta) };
                        model.modify("ResizeRowHeight", resizeRowHeight);
                    }
                }; Spotfire.Touch.legacyTouchMouseCapture(headerCell, mouseMove, mouseUp);
            }; var rightMouseButtonDown = function (e) {
                if (Spotfire.isProfessional()) {
                    var $viewPort = $("#" + id); var offset = $viewPort.offset();
                    var point = new Point(Math.round(e.pageX - offset.left), Math.round(e.pageY - offset.top)); if (tableLayout.allowRightClickIndication) {
                        var adjustCellColor = function (color) {
                            var safeColor = new Spotfire.Utilities.SafeColor(color);
                            safeColor.adjustBrightness(safeColor.luminance() > 0.3 ? -30 : 30); return safeColor.toHexString();
                        }; var valueCell = getValueCell(e);
                        if (valueCell.length > 0) {
                            clearRightClickIndication(); var backgroundColor = valueCell.css("background-color");
                            valueCell.css("background-color", adjustCellColor(backgroundColor)); var rightClickData = { cell: valueCell, clickPoint: point, backgroundColor: backgroundColor };
                            contentContainer.data("rightClickData", rightClickData);
                        }
                    } model.modify("RightClick", point);
                }
            }; var leftMouseButtonDown = function (e) {
                var headerCell = getHeaderCell(e);
                if (headerCell.length === 0) {
                    if (tableLayout.allowMarking) { handleMarking(e); } else {
                        var $clickedValueCell = getValueCell(e);
                        if ($clickedValueCell.length > 0) { handleValueCellClick($clickedValueCell); }
                    }
                } else {
                    var verticalBorder = isOnVerticalHeaderBorder(e);
                    var horizontalBorder = isOnHorizontalHeaderBorder(e); if (verticalBorder || horizontalBorder) {
                        handleResizeColumn(e, verticalBorder);
                    } else {
                        if (tableLayout.allowMoveHeaders) { handleMoveColumn(e, headerCell); } else {
                            if (!Spotfire.capabilities.supportsTouch()) {
                                $(document.body).one("mouseup", handleHeaderClicked);
                            } else { handleHeaderClicked(e); }
                        }
                    }
                }
            }; var handleMouseDown = function (e) {
                isLeftMouseButtonDown = Spotfire.Touch.leftMouseButtonDown(e);
                isRightMouseButtonDown = Spotfire.Touch.rightMouseButtonDown(e); Spotfire.Visuals.TableHighlight.internalClear(id, contentContainer);
                if (isRightMouseButtonDown) { rightMouseButtonDown(e); } else { leftMouseButtonDown(e); }
            }; var handleHighlight = function (currentTargetNode) {
                if (!currentTargetNode) {
                    return;
                } var targetNodeOffset = currentTargetNode.offset(); var newTop = targetNodeOffset.top - viewportOffset().top;
                var newLeft = targetNodeOffset.left - viewportOffset().left; if (Spotfire.isProfessional()) {
                    newTop += 1; var documentOffset = model.getScrollPosition();
                    var x = newLeft + 1 + documentOffset.x; var y = newTop + 1 + documentOffset.y; var highlightPoint = new Point(Math.round(x), Math.round(y));
                    model.modify("Highlight", highlightPoint);
                } else {
                    if (Spotfire.isWebPlayer()) {
                        var width, height; if (tableLayout.selectionIndicationMode === SELECTION_INDICATION_MODE_ROW) {
                            width = tableLayout.markableArea.width;
                            height = tableLayout.rowHeight;
                        } else {
                            width = currentTargetNode.outerWidth(); height = currentTargetNode.outerHeight();
                        } Spotfire.Visuals.TableHighlight.render(contentContainer, tableLayout, [{ top: newTop, left: newLeft, width: width, height: height }]);
                    }
                }
            }; var mouseOverPoint; var tooltipTimeout = null; var getTooltipCallback = function (tooltip) {
                if (!tooltip) {
                    return;
                } if (!viewport.data("tooltip")) { return; } var savedScrollPosition = viewport.data("toolTipScrollPosition");
                var currentScrollPosition = model.getScrollPosition(); if (savedScrollPosition === undefined || savedScrollPosition === null || !savedScrollPosition.equals(currentScrollPosition)) {
                    return;
                } var mouseOverCellPosition = contentContainer.data("mouseOverCellPosition"); if (mouseOverCellPosition) {
                    Spotfire.Visuals.Tooltip.showHtml(tooltip);
                    contentContainer.data("toolTipCellPosition", mouseOverCellPosition);
                } else {
                    contentContainer.removeData("toolTipCellPosition");
                }
            }; var handleTooltip = function (e) {
                var getTooltip = function () {
                    if (!viewport.data("tooltip")) { return; } var offset = getTablePosFromEvent(e);
                    var args = { x: offset.x, y: offset.y }; viewport.data("toolTipScrollPosition", model.getScrollPosition()); model.read("GetTooltip", args, getTooltipCallback);
                }; window.clearTimeout(tooltipTimeout); tooltipTimeout = setTimeout(getTooltip, tooltipDelay);
            }; var handleMouseOver = function (e) {
                if (!(isRightMouseButtonDown || isLeftMouseButtonDown)) {
                    var point = new Point(e.pageX, e.pageY);
                    if (mouseOverPoint !== undefined && point.equals(mouseOverPoint)) { return false; } var isMarking = $(".sf-element-table-marking-rect").is(":visible");
                    if (tableLayout.allowHighlight && !isMarking) {
                        var targetNode = getValueCell(e); if (targetNode.length > 0) {
                            handleHighlight(targetNode, point);
                        } else { Spotfire.Visuals.TableHighlight.internalClear(id, contentContainer); }
                    } var cell = getCell(e); if (cell.length > 0) {
                        contentContainer.data("mouseOverCellPosition", cell.offset());
                        mouseOverPoint = point; handleTooltip(e);
                    } else { contentContainer.removeData("mouseOverCellPosition"); }
                } return true;
            }; var handleResizeHandle = function (e) {
                if (tableLayout.allowColumnResize && isOnVerticalHeaderBorder(e) && !isFarLeftBorder(e.pageX)) {
                    contentContainer.css("cursor", "e-resize");
                } else {
                    if (tableLayout.allowFrozenRowResize && isOnHorizontalHeaderBorder(e) && !isTopBorder(e.pageY) && !isBottomBorder(e.pageY)) {
                        contentContainer.css("cursor", "n-resize");
                    } else {
                        if (tableLayout.allowRowResize && isOnHorizontalHeaderBorder(e)) {
                            contentContainer.css("cursor", "n-resize");
                        } else {
                            var cursor = contentContainer.css("cursor"); if (tableLayout.usePointerCursorOnHeaders && isOnHeader(e)) {
                                if (cursor !== "pointer") {
                                    contentContainer.css("cursor", "pointer");
                                }
                            } else { if (cursor !== "default") { contentContainer.css("cursor", "default"); } }
                        }
                    }
                }
            }; var startedScrolling = false;
            var scrollDeltaY = 0; var scrollDeltaX = 0; var doMouseWheelScroll = function () {
                var scrollTop = virtualScrollbar.scrollTop();
                virtualScrollbar.scrollTop(scrollTop + scrollDeltaY); var scrollLeft = virtualScrollbar.scrollLeft(); virtualScrollbar.scrollLeft(scrollLeft + scrollDeltaX);
                startedScrolling = false; scrollDeltaY = 0; scrollDeltaX = 0;
            }; var handleScrollWheel = function (event) {
                Spotfire.Visuals.TableHighlight.internalClear(id, contentContainer);
                Spotfire.Visuals.Tooltip.hide(); var verticalScroll; if (tableLayout.mouseWheelScrollLines < 0) {
                    verticalScroll = pageScrollSize().height;
                } else { verticalScroll = tableLayout.mouseWheelScrollLines * tableLayout.rowHeight; } var horizontalScroll; if (tableLayout.mouseWheelScrollLines < 0) {
                    horizontalScroll = Math.abs(tableLayout.viewportSize.width - tableLayout.frozenColumnsWidth);
                } else { horizontalScroll = tableLayout.mouseWheelScrollLines * tableLayout.rowHeight; } scrollDeltaY += event.scrollWheelY * verticalScroll;
                scrollDeltaX += event.scrollWheelX * horizontalScroll; if (!startedScrolling) {
                    setTimeout(doMouseWheelScroll, 10);
                    startedScrolling = true;
                }
            }; var mouseMoveOnContentContainer = function (e) {
                var cell = getCell(e); if (cell.length === 0) {
                    Spotfire.Visuals.Tooltip.hide();
                } else {
                    var toolTipCellPosition = contentContainer.data("toolTipCellPosition"); var pos = cell.offset(); if (!toolTipCellPosition || pos.left !== toolTipCellPosition.left || pos.top !== toolTipCellPosition.top) {
                        Spotfire.Visuals.Tooltip.hide();
                    }
                } if (isLeftMouseButtonDown) { return; } handleResizeHandle(e);
            }; var attach = function () {
                viewport.unbind(); viewport.hover(function () {
                    isMouseOver = true;
                }, function () { isMouseOver = false; }); viewport.mouseenter(showScrollbar); viewport.mouseenter(function () {
                    viewport.data("tooltip", true);
                }); viewport.mouseleave(onMouseLeaveViewport); Spotfire.Focus.handleKeyDown(viewport, handleKeyDown); scrollContainer.mouseenter(function () {
                    Spotfire.Visuals.TableHighlight.internalClear(id, contentContainer);
                }); if (!Spotfire.capabilities.supportsTouch()) { contentContainer.mousedown(handleMouseDown); } else {
                    contentContainer.on("mousedown", handleMouseDown);
                    contentContainer.on("sf-touchhold", function (eHold) {
                        handleMouseDown(eHold); Touch.showTouchHoldImage(eHold.pageX, eHold.pageY);
                        Touch.clickBlocker(); Spotfire.Visuals.CanvasVisualization.Dragging.begin({
                            mouseMove: function (eMove) {
                                eMove.stopPropagation();
                                Touch.moveTouchHoldImage(eMove.pageX, eMove.pageY);
                            }, mouseUp: function () { Touch.removeTouchHoldImage(); }
                        }, contentContainer);
                    });
                } contentContainer.dblclick(function (e) {
                    if (isOnVerticalHeaderBorder(e) && tableLayout.allowAdjustColumnWidth) {
                        handleAdaptColumnWidth(e);
                    } return true;
                }); if (!Spotfire.capabilities.supportsTouch()) {
                    contentContainer.mouseover(handleMouseOver);
                } contentContainer.mousemove(mouseMoveOnContentContainer); contentContainer.mouseup(function () {
                    isLeftMouseButtonDown = isRightMouseButtonDown = false;
                }); if (!Spotfire.capabilities.supportsTouch()) { contentContainer.scrollwheel(handleScrollWheel); }
            }; return attach;
        }; var attachEvents = eventHandlerScope(); var renderCallback = function (response, renderedBounds) {
            tableTiming.begin("HtmlRender");
            var scrollPos = model.getScrollPosition(); var offsets = model.getRenderOffsets(); renderTablePart("values", response.valueCells, canvas, offsets.valueCells);
            var frozenRowsRenderedBounds = null; var frozenColumnsRenderedBounds = null; if (renderedBounds) {
                frozenRowsRenderedBounds = new Rectangle(renderedBounds.x, 0, renderedBounds.width, tableLayout.frozenRowsHeight);
                frozenColumnsRenderedBounds = new Rectangle(0, renderedBounds.y, tableLayout.frozenColumnsWidth, renderedBounds.height);
            } renderTablePart("headers", response.frozenRowsCells, frozenRowsCanvas, offsets.frozenRows, frozenRowsRenderedBounds);
            renderTablePart("headers", response.frozenColumnsCells, frozenColumnsCanvas, offsets.frozenColumns, frozenColumnsRenderedBounds);
            renderTablePart("headers", response.topLeftCornerCells, topLeftCornerCanvas, new Point(0, 0), null); setCanvasPos(scrollPos);
            if (scrollContainer.parent().length === 0) {
                var scrollSize = computeScrollSize(tableLayout, scrollbarWidth);
                virtualScrollbar = Spotfire.Table.VirtualScrollbar.create(new Size(tableLayout.viewportSize.width, tableLayout.viewportSize.height), scrollSize, scrollbarWidth, scrollContainer, contentContainer);
                viewport.empty(); var $hightlightContainer = $("<div class='highlightContainer' style='position:absolute; overflow: visible'></div>");
                contentContainer.append($hightlightContainer); viewport.append(scrollContainer); viewport.append(contentContainer);
                if ((getLayout.pendingCall === true || getLayout.pendingResponse === true)) { Progress.showPlotOverlay(id); } else {
                    clearProgress();
                } var styledScrollbar = scrollContainer.StyledScrollbar({ cssClass: "TablePlotScroll " + tableType, pageSize: pageScrollSize() });
                styledScrollbar.scrollend(function () { if (isMouseOver !== null && !isMouseOver) { hideScrollbar(); } }); virtualScrollbar.scrollTop(scrollPos.y);
                virtualScrollbar.scrollLeft(scrollPos.x); scrollContainer.bind("virtualScroll", onScroll); setScrollbarVisible(tableLayout.autoHideTableScrollbars ? (isMouseOver !== null && isMouseOver) : true);
                updateGradients(tableLayout, scrollContainer, virtualScrollbar.scrollLeft(), virtualScrollbar.scrollSize(), tableLayout.viewportSize.width, canvas, frozenRowsCanvas);
            } if (viewport[0]) {
                Spotfire.Visuals.TablePlot.Text.rotate(viewport[0].querySelectorAll(".textOrientationDirection-vertical"));
                Spotfire.Visuals.TablePlot.Text.applyWordWrap(viewport[0].querySelectorAll(".sfc-wrap:not(.sfc-value-cell) .cell-text:not(.sf-element-text-overflow-check)"), true);
                Spotfire.Visuals.TablePlot.Text.applyWordWrap(viewport[0].querySelectorAll(".sfc-value-cell.sfc-wrap .cell-text:not(.sf-element-text-overflow-check)"));
            } if (pendingResizeToFit) { resizeToFit(); } tableTiming.end("HtmlRender"); tableTiming.end("Total"); tableTiming.render(viewport);
        }; var getLayoutCallback = function (layout) {
            tableTiming.end("getLayoutRequest"); if (tableLayout !== null && tableLayout.generation > layout.generation) {
                return;
            } viewport.width(layout.viewportSize.width); viewport.height(layout.viewportSize.height); if (layout.isError) {
                viewport.empty();
                setFont(viewport, layout.font); displayErrors(viewport, layout.messages, layout.font); clearProgress(); return;
            } tableLayout = layout; pendingResizeToFit = false; var render = renderLayout(id, tableLayout); scrollContainer = render.scrollContainer;
            canvas = render.canvas; frozenRowsCanvas = render.frozenRowsCanvas; frozenColumnsCanvas = render.frozenColumnsCanvas;
            topLeftCornerCanvas = render.topLeftCornerCanvas; contentContainer = render.contentContainer; if (model) {
                model.dispose();
            } var highLatency = Spotfire.capabilities.supportsTouch(); model = Spotfire.Visuals.TablePlotModel.create(id, tableLayout, highLatency, renderCallback, scrollbarWidth, computeScrollSize(tableLayout, scrollbarWidth));
            attachEvents();
        }; getLayout = function (generation) {
            if (Spotfire.isProfessional()) {
                var handleRightClick = function (e) {
                    if (Spotfire.Touch.rightMouseButtonDown(e)) {
                        var $viewPort = $("#" + id);
                        var offset = $viewPort.offset(); var objArgs = new Point(Math.round(e.pageX - offset.left), Math.round(e.pageY - offset.top));
                        objArgs.generation = generation; var args = JSON.stringify(objArgs); Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "RightClick", args);
                        return false;
                    } return true;
                }; viewport.unbind("mousedown.rightclickfallback").bind("mousedown.rightclickfallback", handleRightClick);
            } tableTiming.begin("getLayoutRequest"); getLayout.generation = generation; var requestEnd = function () {
                getLayout.pendingResponse = false;
                if (getLayout.pendingCall === true) { getLayout.pendingCall = false; getLayout(getLayout.generation); }
            }; var cb = function (value) {
                requestEnd();
                getLayoutCallback(value);
            }; if (getLayout.pendingResponse === false) {
                getLayout.pendingResponse = true; var clientData = { scrollbarWidth: scrollbarWidth, generation: generation };
                Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "GetLayout", JSON.stringify(clientData), cb, requestEnd);
            } else {
                getLayout.pendingCall = true;
            }
        }; var update = function (layoutGen, viewportSize) {
            tableTiming.begin("Total"); viewport.width(viewportSize.width);
            viewport.height(viewportSize.height); handleProgress(); getLayout(layoutGen);
        }; var updateHighlight = function (ensureVisible, highlightGeneration) {
            if (!tableLayout) {
                return;
            } latestHighlightGeneration = highlightGeneration; var documentOffset = model.getScrollPosition(); var visibleBounds = { x: documentOffset.x, y: documentOffset.y, width: tableLayout.viewportSize.width, height: tableLayout.viewportSize.height, highlightGeneration: highlightGeneration };
            var getHighlightedCellBoundsCallback = function (args) {
                var callbackGeneration = args.highlightGeneration; if (callbackGeneration !== latestHighlightGeneration) {
                    return;
                } var highlightedCellBounds = args.highlightedCellBounds; var renderHighlight = function () {
                    documentOffset = model.getScrollPosition();
                    var highlightRectangles = []; var i, cellBounds, left, top, width, height; for (i = 0; i < highlightedCellBounds.length;
                    i++) {
                        cellBounds = highlightedCellBounds[i]; left = cellBounds.x - documentOffset.x; top = cellBounds.y - documentOffset.y;
                        width = cellBounds.width; height = cellBounds.height; highlightRectangles.push({ left: left, top: top, width: width, height: height });
                    } Spotfire.Visuals.TableHighlight.render(contentContainer, tableLayout, highlightRectangles);
                }; if (highlightedCellBounds.length === 0) {
                    Spotfire.Visuals.TableHighlight.clear(contentContainer);
                    contentContainer.unbind("renderHighlight"); return;
                } var cellTop = highlightedCellBounds[0].y; var cellHeight = highlightedCellBounds[0].height;
                if (ensureVisible && (cellTop < visibleBounds.y || cellTop + cellHeight > visibleBounds.y + visibleBounds.height)) {
                    contentContainer.unbind("renderHighlight");
                    contentContainer.bind("renderHighlight", renderHighlight); if (cellTop < visibleBounds.y) {
                        virtualScrollbar.scrollTop(cellTop - tableLayout.frozenRowsHeight);
                    } else {
                        var scrollTop = cellTop - (visibleBounds.height - cellHeight) - tableLayout.frozenRowsHeight + cellHeight;
                        virtualScrollbar.scrollTop(scrollTop);
                    }
                } else {
                    var callbackDocumentOffset = model.getScrollPosition(); if (!callbackDocumentOffset.equals(documentOffset)) {
                        return;
                    } renderHighlight();
                }
            }; if (visibleBounds.width > 0 && visibleBounds.height > 0) {
                if (ensureVisible) {
                    var totalBounds = { x: tableLayout.markableArea.x, y: tableLayout.markableArea.y, width: tableLayout.markableArea.width, height: tableLayout.markableArea.height, highlightGeneration: highlightGeneration };
                    model.read("GetHighlight", totalBounds, getHighlightedCellBoundsCallback);
                } else {
                    model.read("GetHighlight", visibleBounds, getHighlightedCellBoundsCallback);
                }
            }
        }; this.clearRightClickIndication = clearRightClickIndication; this.handleKeyScroll = handleKeyScroll; this.update = update;
        this.resizeToFit = resizeToFit; this.updateHighlight = updateHighlight; handleProgress(); getLayout.pendingCall = false;
        getLayout.pendingResponse = false; getLayout(layoutGeneration);
    }

    (function () {
        var getTable = function (id) {
            var viewport = $("#" + id);
            return viewport.data("TablePlot");
        };
        var update = function (id, layoutGeneration, viewportSize) {
            var table = getTable(id);
            if (table) { table.update(layoutGeneration, viewportSize); }
        };
        var updateHighlight = function (id, ensureVisible, generation) {
            if (Spotfire.isProfessional()) {
                var table = getTable(id);
                if (table) { table.updateHighlight(ensureVisible, generation); }
            }
        };
        var handleKeyScroll = function (id, keyDownArgs) {
            var table = getTable(id);
            if (table) { table.handleKeyScroll(keyDownArgs); }
        };
        var clearRightClickIndication = function (id, rightClickPoint) {
            var table = getTable(id);
            table.clearRightClickIndication(rightClickPoint);
        }; 
        var resizeToFit = function (id) {
            var table = getTable(id);
            table.resizeToFit();
        };
        var initialize = function (id, layoutGeneration, tableType) {
            var table = new TableInstance(id, layoutGeneration, tableType);
            $("#" + id).data("TablePlot", table);
        }; 
        var copyCellValue = function (cell) {
            var container = $("<div></div>").css({ overflow: "hidden", height: "100%" });
            var $input = $("<textarea readonly/>"); $input.val(cell.text); container.append($input); var buttons = [{ text: Spotfire.Localization.resources.Close, isDefault: true }];
            var options = { title: Spotfire.Localization.resources.Table_CopyCellValue, modal: true, resizable: true, buttons: buttons, width: 300, height: 180, minWidth: 300, minHeight: 180 };
            Spotfire.Controls.ModalDialog.initialize(container, options); $input.css({ width: "100%", height: "100%", resize: "none", "box-sizing": "border-box" }).select();
        };
        Spotfire.registerNameSpace("Visuals.TablePlot", { update: update, updateHighlight: updateHighlight, handleKeyScroll: handleKeyScroll, clearRightClickIndication: clearRightClickIndication, resizeToFit: resizeToFit, copyCellValue: copyCellValue, initialize: initialize });
    }());
}); 

// TablePlot Model
$(function () {
    var addRectangles = function (a, b) {
        var c = new Rectangle(0, 0, 0, 0); if (a.intersectsWith(b)) {
            var intersection = new Rectangle(a).intersect(b);
            if (a.x === b.x && a.width === b.width) {
                c.x = a.x; c.y = Math.min(a.y, b.y); c.width = a.width; c.height = a.height + b.height - intersection.height;
            } else {
                if (a.y === b.y && a.height === b.height) {
                    c.x = Math.min(a.x, b.x); c.y = a.y; c.width = a.width + b.width - intersection.width;
                    c.height = a.height;
                }
            }
        } return c;
    };

    var snapToRow = function (rowHeight, newPos) {
        var row = Math.floor(newPos.y / rowHeight);
        var remainder = newPos.y - row * rowHeight; row += Math.round(remainder / rowHeight); var pos = new Point(newPos.x, row * rowHeight);
        return pos;
    };

    var forceScrollBounds = function (tableLayout, scrollSize, scrollbarWidth) {
        var scrollWidth = scrollSize.width;
        var scrollHeight = scrollSize.height; var hasHorizontalScrollbar = scrollWidth > tableLayout.viewportSize.width;
        var hasVerticalScrollbar = scrollHeight > tableLayout.viewportSize.height; scrollWidth = hasVerticalScrollbar ? scrollWidth + scrollbarWidth : scrollWidth;
        scrollHeight = hasHorizontalScrollbar ? scrollHeight + scrollbarWidth : scrollHeight; var maxScrollX = Math.max(0, scrollWidth - tableLayout.viewportSize.width);
        var maxScrollY = Math.max(0, scrollHeight - tableLayout.viewportSize.height); if (!hasVerticalScrollbar) {
            maxScrollY = 0;
        } if (!hasHorizontalScrollbar) { maxScrollX = 0; } if (maxScrollY !== 0) {
            maxScrollY = snapToRow(tableLayout.rowHeight, new Point(0, maxScrollY)).y;
        } var x = Math.min(maxScrollX, tableLayout.scrollPosition.x); var y = snapToRow(tableLayout.rowHeight, tableLayout.scrollPosition).y;
        y = Math.min(maxScrollY, y); var point = new Point(x, y); return point;
    };

    function TableModel(id, tableLayout, highLatency, renderCallback, scrollbarWidth, scrollSize) {
        var valueCellsViewportSize = { width: Math.max(0, tableLayout.viewportSize.width - tableLayout.frozenColumnsWidth), height: Math.max(0, tableLayout.viewportSize.height - tableLayout.frozenRowsHeight) };
        var isDisposed = false; var getCellsPending = false; var getCellsTimeout = null; var scrollPosition = forceScrollBounds(tableLayout, scrollSize, scrollbarWidth);
        var requestedSnappedPos = scrollPosition.clone(); var scrollbarPos = scrollPosition.clone(); var scrollDirection = "none";
        var needToGetTopLeftCells = true; var valueCellsBounds = new Rectangle(0, 0, 0, 0); var renderOffsets = {}; renderOffsets.valueCells = scrollPosition.clone();
        renderOffsets.frozenRows = new Point(renderOffsets.valueCells.x, 0); renderOffsets.frozenColumns = new Point(0, renderOffsets.valueCells.y);
        var pendingValueKeys = []; var addPendingValueKeys = function (newKeys) {
            pendingValueKeys = pendingValueKeys.concat(newKeys);
        };
        
        var clearPendingValueKeys = function () { 
            pendingValueKeys = [];
        };

        var dispose = function () {
            isDisposed = true; clearPendingValueKeys();
            renderCallback = null;
        }; 
        
        var read = function (method, objArgs, callback) {
            if (!objArgs) { objArgs = {}; } objArgs.generation = tableLayout.generation;
            Spotfire.Dxp.Web.Forms.AjaxService.Read(id, method, JSON.stringify(objArgs), callback);
        };

        var getNextPendingValue = function (callback) {
            if (pendingValueKeys.length > 0) {
                read("GetPendingValue", { key: pendingValueKeys.shift() }, callback);
            }
        };
        
        var getScrollPosition = function () { return scrollPosition.clone(); };

        var modify = function (method, objArgs) {
            if (!objArgs) {
                objArgs = {};
            } objArgs.generation = tableLayout.generation; var scrollPos; if (getCellsPending) {
                scrollPos = requestedSnappedPos.clone();
            } else { scrollPos = getScrollPosition(); } objArgs.scrollPosition = scrollPos; var args = JSON.stringify(objArgs);
            Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, method, args);
        }; var getRenderOffsets = function () {
            return renderOffsets;
        };
        
        var getInvalidRect = function (x, y) {
            var invalidRect = new Rectangle(x, y, valueCellsViewportSize.width, valueCellsViewportSize.height);
            invalidRect.intersect(new Rectangle(0, 0, tableLayout.scrollBounds.width, tableLayout.scrollBounds.height));
            return invalidRect;
        };

        var getValueCellsViewport = function () {
            var snappedPos = snapToRow(tableLayout.rowHeight, scrollbarPos);
            return getInvalidRect(snappedPos.x, snappedPos.y);
        }; 

        var isCachedPosition = function (pos) {
            var visibleBounds = getInvalidRect(pos.x, pos.y);
            var intersection = new Rectangle(visibleBounds).intersect(valueCellsBounds); return visibleBounds.equals(intersection);
        };

        var getCellsCallback = function (response) {
            getCellsPending = false; if (isDisposed || !response || tableLayout.generation > response.generation) {
                return;
            } var renderAction = "replace"; var renderedBounds = null; if (response.valueCells !== null) {
                var bounds = new Rectangle(response.valueCells.bounds);
                var emptyCanvas = true; if (bounds.intersectsWith(valueCellsBounds)) {
                    var sumRect = addRectangles(bounds, valueCellsBounds);
                    if (sumRect.width > 0 && sumRect.height > 0) {
                        renderedBounds = valueCellsBounds; valueCellsBounds = sumRect; emptyCanvas = false;
                    } else { valueCellsBounds = new Rectangle(response.valueCells.bounds); }
                } else {
                    valueCellsBounds = new Rectangle(response.valueCells.bounds);
                } renderAction = emptyCanvas ? "replace" : "add"; response.valueCells.renderAction = renderAction; if (renderAction === "replace") {
                    clearPendingValueKeys();
                    renderOffsets.valueCells = requestedSnappedPos.clone();
                }
            } if (response.frozenRowsCells !== null) {
                response.frozenRowsCells.renderAction = renderAction;
                if (renderAction === "replace") { renderOffsets.frozenRows = new Point(requestedSnappedPos.x, 0); }
            } if (response.frozenColumnsCells !== null) {
                response.frozenColumnsCells.renderAction = renderAction;
                if (renderAction === "replace") { renderOffsets.frozenColumns = new Point(0, requestedSnappedPos.y); }
            } if (response.topLeftCornerCells !== null) {
                response.topLeftCornerCells.renderAction = "replace";
            } var snappedPos = snapToRow(tableLayout.rowHeight, scrollbarPos); if (isCachedPosition(snappedPos)) {
                scrollPosition = snappedPos;
            } else { scrollPosition = requestedSnappedPos.clone(); } if (renderCallback !== null) {
                renderCallback(response, renderedBounds);
            }
        };

        var isBoundsValid = function () {
            var valid = true; var direction = "none"; var snappedScrollPos = snapToRow(tableLayout.rowHeight, scrollbarPos);
            if (snappedScrollPos.x !== requestedSnappedPos.x && snappedScrollPos.y === requestedSnappedPos.y) {
                direction = "horizontal";
            } else {
                if (snappedScrollPos.y !== requestedSnappedPos.y && snappedScrollPos.x === requestedSnappedPos.x) {
                    direction = "vertical";
                }
            } if (direction === "none" || (scrollDirection !== "none" && scrollDirection !== direction)) { valid = false; } scrollDirection = direction;
            return valid;
        };

        var getCells = function (viewportFunction, forceGetCells) {
            if (getCellsPending) {
                window.clearTimeout(getCellsTimeout);
                getCellsTimeout = window.setTimeout(function () { getCells(viewportFunction); }, 20);
            } else {
                var valueCellsViewport = viewportFunction();
                var invalidRect = valueCellsViewport.intersect(new Rectangle(0, 0, tableLayout.scrollBounds.width, tableLayout.scrollBounds.height));
                if (!isBoundsValid()) { valueCellsBounds = new Rectangle(0, 0, 0, 0); } if (invalidRect.intersectsWith(valueCellsBounds)) {
                    invalidRect.subtract(valueCellsBounds);
                } var frozenRowsWidth = invalidRect.width > 0 ? invalidRect.width : tableLayout.viewportSize.height <= tableLayout.frozenRowsHeight ? tableLayout.viewportSize.width : 0;
                var frozenRowsRect = new Rectangle(invalidRect.x, 0, frozenRowsWidth, tableLayout.frozenRowsHeight); var frozenRowsHeight = invalidRect.height > 0 ? invalidRect.height : tableLayout.viewportSize.width <= tableLayout.frozenColumnsWidth ? tableLayout.viewportSize.height : 0;
                var frozenColumnsRect = new Rectangle(0, invalidRect.y, tableLayout.frozenColumnsWidth, frozenRowsHeight);
                var topLeftCornerRect = new Rectangle(0, 0, 0, 0); if (needToGetTopLeftCells) {
                    needToGetTopLeftCells = false; topLeftCornerRect = new Rectangle(0, 0, tableLayout.frozenColumnsWidth, tableLayout.frozenRowsHeight);
                } if (forceGetCells || (invalidRect.width > 0 && invalidRect.height > 0) || (frozenRowsRect.width > 0 && frozenRowsRect.height > 0) || (frozenColumnsRect.width > 0 && frozenColumnsRect.height > 0)) {
                    var snappedScrollPos = snapToRow(tableLayout.rowHeight, scrollbarPos);
                    requestedSnappedPos = snappedScrollPos.clone(); getCellsPending = true; var invalidRectangles = { valueCells: invalidRect, frozenRows: frozenRowsRect, frozenColumns: frozenColumnsRect, topLeftCorner: topLeftCornerRect };
                    read("GetCells", invalidRectangles, getCellsCallback); return true;
                }
            } return false;
        }; 

        var scrollTimeout = null;

        var onScroll = function (pos) {
            var snappedPos = snapToRow(tableLayout.rowHeight, pos); if (!pos.equals(scrollbarPos)) {
                scrollbarPos = pos.clone();
                window.clearTimeout(scrollTimeout); scrollTimeout = window.setTimeout(function () {
                    if (highLatency) {
                        getCells(getValueCellsViewport);
                    } var serverPos = snappedPos.clone(); modify("Scroll", serverPos);
                }, 500); if (!highLatency) {
                    getCells(getValueCellsViewport);
                }
            } var newCanvasPos = null; if (highLatency || isCachedPosition(snappedPos)) {
                newCanvasPos = snappedPos.clone();
                scrollPosition = newCanvasPos.clone();
            } return newCanvasPos;
        };

        if (scrollPosition.x !== tableLayout.scrollPosition.x || scrollPosition.y !== tableLayout.scrollPosition.y) {
            modify("Scroll", scrollPosition);
        }
        
        this.onScroll = onScroll; this.addPendingValueKeys = addPendingValueKeys; this.clearPendingValueKeys = clearPendingValueKeys;
        this.dispose = dispose; this.getNextPendingValue = getNextPendingValue; this.getScrollPosition = getScrollPosition;
        this.getRenderOffsets = getRenderOffsets; this.read = read; this.getCells = getCells; this.getValueCellsViewport = getValueCellsViewport;
        this.modify = modify; getCells(getValueCellsViewport, true);
    }

    Spotfire.registerNameSpace("Visuals.TablePlotModel");

    Spotfire.Visuals.TablePlotModel.create = function (id, tableLayout, highLatency, renderCallback, scrollbarWidth, scrollSize) {
        return new TableModel(id, tableLayout, highLatency, renderCallback, scrollbarWidth, scrollSize);
    };
}); 

// TablePlot text
$(function () {
    function validBackground(elem) {
        if (!elem.parentNode) { return "rgb(255, 255, 255)"; }
        var style = window.getComputedStyle(elem);
        var background = style.getPropertyValue("background-color");
        if (background === "rgba(0, 0, 0, 0)") {
            return validBackground(elem.parentNode);
        }
        return background;
    }

    function filter(arr, fn) {
        var value, i, results = [];
        for (i = 0; i < arr.length; i += 1) {
            value = arr[i];
            if (fn(value, i)) { results.push(value); }
        }
        return results;
    }

    function loop(arr, fn) {
        var value, i, results = [];
        for (i = 0; i < arr.length; i += 1) {
            value = arr[i]; results.push(fn(value, i));
        } 
        return results;
    }

    var applyWordWrap = function (elems, transparentHover) {
        var measuredElements = loop(Array.prototype.slice.call(elems, 0), function (elem) {
            var style = window.getComputedStyle(elem);
            return { node: elem, height: elem.parentNode.clientHeight, background: validBackground(elem.parentNode), fontSize: parseInt(style.getPropertyValue("font-size"), 10), lineHeight: parseInt(style.getPropertyValue("line-height"), 10) };
        }); loop(measuredElements, function (elemData) {
            var maxHeight = Math.floor(elemData.height / elemData.lineHeight) * elemData.lineHeight;
            elemData.node.style.maxHeight = maxHeight + "px"; elemData.node.classList.add("sf-element-text-overflow-check");
        }); var elementsWithOverFlow = filter(measuredElements, function (elemData) {
            return elemData.node.clientHeight < elemData.node.scrollHeight - 1;
        }); loop(elementsWithOverFlow, function (elem) {
            var ellipsis = document.createElement("div"); ellipsis.classList.add("sf-element-text-ellipsis");
            if (transparentHover) { ellipsis.classList.add("sf-element-text-ellipsis-hover"); } ellipsis.innerHTML = "&hellip;";
            ellipsis.style.backgroundImage = "linear-gradient(to right, rgba(255, 255, 255, 0), " + elem.background + ", " + elem.background + ")";
            elem.node.classList.add("sf-element-text-overflow"); elem.node.appendChild(ellipsis);
        });
    };

    function rotateCells(elements, angle) {
        var descentFactor = (11 / 2.68 + 20 / 6.57) / 2;
        elements = Array.prototype.slice.call(elements, 0); if (!elements.length) { return; } angle = angle || 90; elements.forEach(function (elem) {
            elem.classList.remove("textOrientationDirection-vertical");
        }); elements.forEach(function (elem) {
            var classes = elem.getAttribute("class") || ""; var rotationCell = document.createElement("div");
            rotationCell.setAttribute("class", classes.replace("sf-element-table-cell", "") + " sf-element-rotated-cell");
            var childCount = elem.childElementCount; rotationCell.appendChild(elem.firstChild); if (childCount > 1) {
                elem.insertBefore(rotationCell, elem.children[0]);
            } else { elem.appendChild(rotationCell); }
        }); elements.forEach(function (elem) {
            var style = window.getComputedStyle(elem);
            var fontSize = style.getPropertyValue("font-size"); var justifyContent = style.getPropertyValue("justify-content");
            var flexStart = style.getPropertyValue("flex-start"); var alignItems = style.getPropertyValue("align-items");
            var paddingTop = parseInt(style.getPropertyValue("padding-top"), 10); var paddingBottom = parseInt(style.getPropertyValue("padding-bottom"), 10);
            var paddingLeft = parseInt(style.getPropertyValue("padding-left"), 10); var paddingRight = parseInt(style.getPropertyValue("padding-right"), 10);
            var descent = parseFloat(fontSize) / descentFactor - 1; var width = elem.offsetWidth - paddingLeft - paddingRight;
            var height = elem.offsetHeight - paddingTop - paddingBottom; var temp = alignItems; alignItems = justifyContent; justifyContent = temp;
            if (justifyContent === "flex-start") { justifyContent = "flex-end"; } else {
                if (justifyContent === "flex-end") {
                    justifyContent = "flex-start";
                } else { if (justifyContent === "middle") { justifyContent = "center"; } }
            } if (alignItems === "center") {
                alignItems = "middle";
            } elem.dimensions = { paddingLeft: paddingLeft, paddingTop: paddingTop, width: width, height: height, descent: descent, justifyContent: justifyContent, flexStart: flexStart, alignItems: alignItems };
        }); elements.forEach(function (elem) {
            var child = elem.firstChild; var dimensions = elem.dimensions; var value = "rotate(-" + angle + "deg) translateX( " + (-(dimensions.height - dimensions.descent)) + "px)";
            var textAlign = ""; if (dimensions.justifyContent === "flex-start") { textAlign = "left"; } else {
                if (dimensions.justifyContent === "center") {
                    textAlign = "center";
                } else { if (dimensions.justifyContent === "flex-end") { textAlign = "right"; } }
            } child.style.top = dimensions.paddingTop + "px";
            child.style.left = dimensions.paddingLeft + "px"; child.style.webkitTransform = value; child.style.transform = value;
            child.style.justifyContent = dimensions.justifyContent; child.style.flexStart = dimensions.flexStart; child.style.alignItems = dimensions.alignItems;
            child.firstChild.style.textAlign = textAlign; child.style.height = dimensions.width + "px"; child.style.width = (dimensions.height - dimensions.descent) + "px";
        });
    }

    Spotfire.registerNameSpace("Visuals.TablePlot.Text", { applyWordWrap: applyWordWrap, rotate: rotateCells });
});

// body mouse move event
$(function () {
    var mouseX, mouseY;
    var padding = 10;
    var cursorOffset = 5;
    var visible = false;
    var followCursor = true;
    var timer = null; var $body = $(document.body);
    var $div = $("<div/>").addClass("sf-tooltip sf-tooltip-content").css({ "background-color": "#000", color: "#fff", "border-width": "0px" });
    var onMouseDown = function () {
        hide();
    }; 
    
    var onMouseMove = function (e) {
        mouseX = e.pageX + cursorOffset; mouseY = e.pageY;
        if (visible && followCursor) {
            $div.css("left", getAdjustedXPosition(mouseX) + "px"); $div.css("top", getAdjustedYPosition(mouseY - cursorOffset - $div.outerHeight()) + "px");
        }
    };

    var getAdjustedYPosition = function (y) {
        var documentHeight = $(window).height() - padding * 2;
        return Math.max(padding, Math.min(y, documentHeight - $div.height()));
    }; 

    var getAdjustedXPosition = function (x) {
        var documentWidth = $(window).width() - padding * 2; return Math.max(padding, Math.min(x, documentWidth - $div.width()));
    }; 

    var showAtFixed = function (contentIsHtml, content, x, y) {
        showAt(contentIsHtml, content, x, y); followCursor = false;
    }; 
    
    var showAt = function (contentIsHtml, content, x, y) {
        if (Spotfire.capabilities.supportsTouch()) { return; } followCursor = true;
        if (!content) { return; } if (!visible) { $body.mousedown(onMouseDown); $body.append($div); visible = true; } $div.empty();
        var maxWidth = $(window).width() - padding * 2; var maxHeight = $(window).height() - padding * 2; $div.css({ left: "0px", top: "0px", width: maxWidth + "px", height: maxHeight + "px" });
        var $content = $("<span/>"); if (contentIsHtml) { $content.html(content); } else { $content.text(content); } $content.css({ "max-width": maxWidth + "px", "max-height": maxHeight + "px", "word-wrap": "break-word", "white-space": "pre" });
        var layoutTooltip = function () {
            $div.width($content.width() + 1); $div.height($content.height()); $div.css("left", getAdjustedXPosition(x) + "px");
            $div.css("top", getAdjustedYPosition(y - cursorOffset - $div.outerHeight()) + "px");
        }; $("img", $content).on("load", layoutTooltip);
        $div.append($content); var closeOnLeave = function () { $div.off("mouseout", closeOnLeave); hide(); }; $div.on("mouseout", closeOnLeave);
        layoutTooltip();
    };
    
    var show = function (contentIsHtml, content, pauseTime) {
        if (pauseTime === undefined) {
            pauseTime = 0;
        } if (timer) { window.clearTimeout(timer); } var onTimeout = function () {
            showAt(contentIsHtml, content, mouseX, mouseY);
        }; timer = window.setTimeout(onTimeout, pauseTime, true);
    };

    var hide = function () {
        if (timer) {
            window.clearTimeout(timer);
        } if (visible) { $body.unbind("mousedown", onMouseDown); $div.remove(); visible = false; }
    }; var setAppearance = function (textColor, backgroundColor, borderColor, borderWidth) {
        $div.css({ "background-color": backgroundColor, color: textColor, "border-color": borderColor, "border-width": borderWidth + "px" });
    };
    
    var getTooltipDelay = function () {
        if (Spotfire.Web === undefined || Spotfire.Web.tooltipDelay === undefined) {
            return 500;
        } return Spotfire.Web.tooltipDelay;
    };
    
    var addToolTip = function (ctrl, text) {
        $(ctrl).mouseover(function () {
            show(false, text, getTooltipDelay());
        }); $(ctrl).mouseout(function () { hide(); });
    };
    
    Spotfire.registerNameSpace("Visuals.Tooltip", {
        showHtml: _.partial(show, true), show: _.partial(show, false), hide: hide, showHtmlAt: _.partial(showAt, true), showHtmlAtFixed: _.partial(showAtFixed, true), showAt: _.partial(showAt, false), showAtFixed: _.partial(showAtFixed, false), setAppearance: setAppearance, addToolTip: addToolTip, defaultPauseTime: 500
    });

    $body.mousemove(onMouseMove);
});

// Virtual Scrollbar on table
$(function () {
    function VirtualScrollbar(viewportSize, scrollSize, argScrollbarWidth, argScrollContainer, contentContainer) {
        var maxPixels = 1000000;
        var scrollFactor; var topPos = 0; var leftPos = 0; var updating = false; var scrollEvent = jQuery.Event("virtualScroll");
        var container = argScrollContainer; var viewportHeight = viewportSize.height; var viewportWidth = viewportSize.width;
        var forceTopBounds = function (top) {
            var max = Math.max(0, scrollSize.height - viewportHeight); top = Math.max(0, top);
            top = Math.min(top, max); return top;
        }; var forceLeftBounds = function (left) {
            var max = Math.max(0, scrollSize.width - viewportWidth);
            left = Math.max(0, left); left = Math.min(left, max); return left;
        }; var scrollTop = function (value) {
            if (value === undefined) {
                return topPos;
            } value = forceTopBounds(value); value = Math.round(value); var triggerScrollEvent = topPos !== value; topPos = value;
            var y = Math.round(value / scrollFactor.vertical); updating = true; if (y !== container.scrollTop()) {
                container.scrollTop(y);
            } updating = false; if (triggerScrollEvent) { argScrollContainer.trigger(scrollEvent, "vertical"); } return topPos;
        }; var scrollLeft = function (value) {
            if (value === undefined) { return leftPos; } value = forceLeftBounds(value); value = Math.round(value);
            var triggerScrollEvent = leftPos !== value; leftPos = value; var x = Math.round(value / scrollFactor.horizontal);
            updating = true; if (x !== container.scrollLeft()) { container.scrollLeft(x); } updating = false; if (triggerScrollEvent) {
                argScrollContainer.trigger(scrollEvent, "horizontal");
            } return leftPos;
        }; var onScrollBarScroll = function () {
            if (!updating) {
                scrollTop(Math.round(container.scrollTop() * scrollFactor.vertical));
                scrollLeft(Math.round(container.scrollLeft() * scrollFactor.horizontal));
            }
        }; if (Spotfire.capabilities.supportsTouch()) {
            container = new IScroll(argScrollContainer.children().get(0), contentContainer.get(0), { bounce: false, notifyOnPositionChanged: true });
            container.onScroll = onScrollBarScroll;
        } else { container.bind("scroll", onScrollBarScroll); } var getScrollFactor = function () {
            var factor = { vertical: 1, horizontal: 1 };
            if (scrollSize.height > maxPixels) {
                factor.vertical = (scrollSize.height - viewportHeight) / (maxPixels - viewportHeight);
            } if (scrollSize.width > maxPixels) {
                factor.horizontal = (scrollSize.width - viewportWidth) / (maxPixels - viewportWidth);
            } return factor;
        }; var getScrollCanvasSize = function () {
            var size = new Size(scrollSize.width, scrollSize.height);
            if (scrollSize.height > maxPixels) { size.height = maxPixels; } if (scrollSize.width > maxPixels) {
                size.width = maxPixels;
            } return size;
        }; scrollFactor = getScrollFactor(); var scrollCanvasSize = getScrollCanvasSize(); var scrolledElement = argScrollContainer.children();
        scrolledElement.css("width", scrollCanvasSize.width + "px"); scrolledElement.css("height", scrollCanvasSize.height + "px");
        this.scrollSize = function () { return scrollSize; }; this.scrollTop = scrollTop; this.scrollLeft = scrollLeft;
    }

    Spotfire.registerNameSpace("Table.VirtualScrollbar", {
        create: function (viewportSize, scrollSize, argScrollbarWidth, argScrollContainer, contentContainer) {
            return new VirtualScrollbar(viewportSize, scrollSize, argScrollbarWidth, argScrollContainer, contentContainer);
        }
    });
});

// HtmlText Area
$(function () {
    var update = function (viewId) {
        var $view = $("#" + viewId); var status = $view.data("status");
        if (!status) { status = { pending: 0 }; $view.data("status", status); } var callback = function (result) {
            try {
                Spotfire.evaluate(result.code);
            } catch (ignore) { } $view.trigger("sf-refresh-scrollbar"); status.pending--; if (status.pending > 0) {
                status.pending = 1;
                Spotfire.Dxp.Web.Forms.AjaxService.Read(viewId, "Update", "", callback);
            }
        }; status.pending++; if (status.pending === 1) {
            Spotfire.Dxp.Web.Forms.AjaxService.Read(viewId, "Update", "", callback);
        }
    };

    var initialize = function (viewId, backgroundCss) {
        var $view = $("#" + viewId).addClass("HtmlTextArea"); $view.css(backgroundCss);
        $view.StyledScrollbar({ allowResize: true }); var $parent = $("[viewId=" + viewId + "]"); var resize = function () {
            $view.sfFitInside($parent);
            $view.trigger("sf-refresh-scrollbar");
        }; $parent.on("sf-resize", resize); resize(); $view.on("contextmenu", function (e) {
            e.preventDefault();
            var point = { x: e.pageX, y: e.pageY }; var args = { pointOnPage: point }; Spotfire.PageBus.publish("spotfire.visuals.showcontextmenu", args, viewId);
        }); Spotfire.Focus.handleKeyDown($view, function (e) {
            if (e.keyCode === Keys.F1) {
                var keyArgs = { keyCode: e.keyCode, shiftKey: e.shiftKey, ctrlKey: e.ctrlKey };
                Spotfire.Dxp.Web.Forms.AjaxService.Modify(viewId, "KeyDown", JSON.stringify(keyArgs));
            }
        });
    };

    var initActionControlButton = function (id) {
        var $element = $("#" + id);
        $element.mousedown(function () {
            var $this = $(this); var mouseleave = function () {
                $this.removeClass("sfpc-active");
            }; var mouseenter = function () { $this.addClass("sfpc-active"); }; var handleMouseUp = function () {
                $this.removeClass("sfpc-active").off("mouseleave", mouseleave).off("mouseenter", mouseenter);
                $(window).off("mouseup", handleMouseUp);
            }; $this.addClass("sfpc-active").on("mouseleave", mouseleave).on("mouseenter", mouseenter);
            $(window).on("mouseup", handleMouseUp);
        });
    };

    var getControlBounds = function (id) {
        var getBounds = function (selector) {
            var $elem = $(selector);
            var elementOffset = $elem.offset(); return { x: elementOffset.left, y: elementOffset.top, width: $elem.outerWidth(), height: $elem.outerHeight() };
        }; var parentBounds = getBounds("#" + id); var rectangles = []; $("#" + id).find(":visible").each(function () {
            rectangles.push(getBounds(this));
        }); var x = parentBounds.x; var y = parentBounds.y; var xx = parentBounds.x + parentBounds.width; var yy = parentBounds.y + parentBounds.height;
        $.each(rectangles, function () {
            x = Math.min(x, this.x); y = Math.min(y, this.y); xx = Math.max(xx, this.x + this.width);
            yy = Math.max(yy, this.y + this.height);
        }); return { x: x, y: y, width: xx - x, height: yy - y };
    };

    var evalCustomScripts = function (scripts) {
        $.each(scripts, function (i, script) {
            try {
                var fn = new Function(script.paramNames, script.code);
                fn.apply(window, script.paramValues);
            } catch (e) {
                Spotfire.WebAnalysis.notifyError("Execution of Javascript failed", "Exception details:\r\n" + Spotfire.unwrapException(e));
            }
        });
    };

    Spotfire.registerNameSpace("HtmlTextArea", { update: update, initialize: initialize, initActionControlButton: initActionControlButton, getControlBounds: getControlBounds, evalCustomScripts: evalCustomScripts });
}); 


// Property controls - DropDown, Listbox

Spotfire.registerNameSpace("PropertyControls.DropDown");

Spotfire.PropertyControls.DropDown.initialize = function (id, controlSettings) {
    var items = controlSettings.items;
    var $container = $("#" + id); $container.empty(); $container.css("display", "inline-block"); var $dropdown = $("<div/>").appendTo($container);
    var settings = {}; settings.values = items; settings.useIndexAsValueId = true; settings.layoutForTextFlow = true;
    settings.useContainerSize = controlSettings.hasSizeSet; settings.onSelected = function (selectedValue, selectedIndex) {
        if (selectedIndex >= 0) {
            Spotfire.WebView.modifyControl(id, selectedIndex);
        }
    }; Spotfire.Controls.DropDown.initialize($dropdown, settings);
}; 

Spotfire.PropertyControls.DropDown.update = function (id, selectedIndex) {
    var $container = $("#" + id);
    var $dropDownDiv = $(".sf-element-dropdown", $container); var settings = {}; settings.selectedIndex = selectedIndex;
    Spotfire.Controls.DropDown.update($dropDownDiv, settings);
}; 

$(function () {
    Spotfire.registerNameSpace("PropertyControls.ListBox");
    Spotfire.PropertyControls.ListBox.initialize = function (id, settings) {
        var $container = $("#" + id); if ($container.length === 0) {
            return;
        } $container.empty(); $container.css({ display: "inline-block" }); var $listboxDiv = $("<div/>").appendTo($container);
        $listboxDiv.css("position", "relative"); var $tmpListBox = $("<div/>").addClass("sf-element-list-box").appendTo($container);
        var $tmpBoxItem = $("<div/>").addClass("sf-element-list-box-item").css({ display: "inline-block", overflow: "hidden", "white-space": "pre" }).text("A").appendTo($tmpListBox);
        var itemHeight = $tmpBoxItem.sfBoxHeight(); var itemWidth = 0; if (!settings.HasSizeSet) {
            var allItems = _.reduce(settings.Items, function (memo, item) {
                return memo + "\n" + item;
            }, ""); $tmpBoxItem.text(allItems); itemWidth = $tmpBoxItem.sfBoxWidth();
        } var nrOfRows = 4; if (settings.HasSizeSet && itemHeight !== 0) {
            nrOfRows = Math.floor(settings.Size.height / itemHeight);
        } $tmpListBox.remove(); var listBoxSettings = {
            height: nrOfRows, itemHeight: itemHeight, showSearchField: false, showImageMask: false, multiSelect: settings.SupportsMultiSelect, onSelectionChanged: function (selection) {
                if (settings.SupportsMultiSelect) {
                    var value = { method: "Select", pendingSelects: selection };
                    Spotfire.WebView.modifyControl(id, JSON.stringify(value));
                } else {
                    Spotfire.WebView.modifyControl(id, selection);
                }
            }, onGetValues: function (low, high, callback) {
                var requestedItems = []; for (var i = low; i <= high; ++i) {
                    var item = { Text: settings.Items[i], Selected: false };
                    requestedItems.push(item);
                } var result = { Items: requestedItems, TopIndex: low }; callback(result);
            }, onScrollToSubString: function (currentIndex, substring, callback) {
                var indexOfSubstring = function (currentIndex) {
                    var substringUpper = substring.toUpperCase();
                    var len = substring.length; var match = function (value) {
                        return value.substring(0, len).toUpperCase() === substringUpper;
                    }; var itemCount = settings.Items.length; var i; for (i = currentIndex + 1; i < itemCount; ++i) {
                        if (match(settings.Items[i])) {
                            return i;
                        }
                    } for (i = 0; i < currentIndex; ++i) { if (match(settings.Items[i])) { return i; } } return currentIndex;
                }; callback(indexOfSubstring(currentIndex));
            }, isScrollWheelDisabled: false
        }; if (!settings.HasSizeSet) {
            listBoxSettings.updateContainerToFitLongestItem = true;
            listBoxSettings.longestItemWidth = itemWidth;
        } var listbox = Spotfire.Controls.VirtualListBox.create($listboxDiv, listBoxSettings);
        $container.data("listbox", listbox); $container.data("items", settings.Items); var updatedSettings = { totalVisibleValues: settings.Items.length };
        listbox.update(updatedSettings);
    }; Spotfire.PropertyControls.ListBox.selectIndices = function (id, selectedIndices) {
        var virtualListbox = $("#" + id).data("listbox");
        var items = $("#" + id).data("items"); if (virtualListbox && items) {
            var updatedListBoxSettings = {
                onGetValues: function (low, high, callback) {
                    var requestedItems = [];
                    for (var i = low; i <= high; ++i) {
                        var item = { Text: items[i], Selected: $.inArray(i, selectedIndices) >= 0 }; requestedItems.push(item);
                    } var result = { Items: requestedItems, TopIndex: low }; callback(result);
                }
            }; virtualListbox.update(updatedListBoxSettings);
            var maxIndex = _.max(selectedIndices); virtualListbox.ensureVisible(maxIndex);
        }
    };
}); 

// TextBox Control
var TextBoxControl = {};

TextBoxControl.initialize = function (id) {
    var $input = $("#" + id); var $body = $(document.body); var multiLine = $input.get(0).tagName.toLowerCase() === "textarea";
    $input.data("serverValue", $input.val()); var hasCapture = false; var onBlur; var onChange = function () {
        if (hasCapture) {
            $body.unbind("mousedown", onBlur);
            $body.get(0).releaseCapture(); hasCapture = false;
        } var value = $input.val(); if (value === $input.data("serverValue")) {
            return;
        } Spotfire.WebView.modifyControl(id, value); $input.data("serverValue", value);
    }; onBlur = function () {
        onChange();
    }; var onKeyDown = function (e) {
        if (!hasCapture && $body.get(0).setCapture) {
            hasCapture = true; $body.mousedown(onBlur);
            $body.get(0).setCapture();
        } if (multiLine) { return true; } if (e.which === 13) { onChange(); } return true;
    }; $input.keydown(onKeyDown);
    $input.blur(onBlur);
}; 

TextBoxControl.setErrorMessage = function (id, errorMessage, explicitColor) {
    var $input = $("#" + id);
    if (typeof errorMessage === "string" && errorMessage.length > 0) {
        $input.addClass("sfpc-error"); $input.attr("title", errorMessage);
        $input.css("color", "");
    } else {
        $input.removeClass("sfpc-error"); $input.attr("title", ""); $input.css("color", explicitColor);
    }
}; 

TextBoxControl.update = function (id, value) {
    var $input = $("#" + id); if (value !== $input.val()) {
        $input.val(value);
    } $input.data("serverValue", value);
}; 

// Slider
$(function () {
    var initializeSlider = function (id, showMinMaxLabel, values, selectedIndex, formattedValue) {
        var $parent = $("#" + id);
        $parent.addClass("TextAreaSlider"); if (showMinMaxLabel) { $parent.addClass("ShowLabels"); } $parent.empty();
        var ticks = values.length; var snapPositions = null; var thumbPos = 0; var thumbMax = -1; var previousClientX = null;
        var $outercontainer = $("<div />").addClass("ItemSlider sf-element sf-element-item-slider").appendTo($parent);
        $outercontainer.css("font-size", "12px"); var $container = $("<div />").addClass("SliderContainer").css("top", "14px").appendTo($outercontainer);
        var $background = $("<div />").addClass("Background sf-element sf-element-range sfc-outer").appendTo($container);
        $outercontainer.on("selectstart", function () { return false; }); $outercontainer.on("mousedown", function () {
            return false;
        }); var $slider = $("<div/>").addClass("Line sf-element sf-element-range sfc-inner").appendTo($background);
        var $leftButton = $("<div />").addClass("Button LeftEnabled sf-element sf-element-button").appendTo($container);
        var $rightButton = $("<div />").addClass("Button RightEnabled sf-element sf-element-button").appendTo($container);
        var buttonWidth = $leftButton.outerWidth(); $slider.css("left", $leftButton.outerWidth(true) + "px"); Spotfire.getSvg("Images/Filters/LeftArrow.svg", function (svg) {
            $leftButton.append(svg);
        }); Spotfire.getSvg("Images/Filters/RightArrow.svg", function (svg) { $rightButton.append(svg); }); var $thumb = $("<div />").addClass("Thumb sf-element sf-element-thumb").appendTo($container);
        var thumbWidth = $thumb.outerWidth(); var valueLabel = $("<span />").addClass("ValueLabel").appendTo($outercontainer);
        $("<span />").addClass("MinLabel").appendTo($outercontainer).text(values[0]); $("<span />").addClass("MaxLabel").appendTo($outercontainer).text(values[values.length - 1]);
        var drawTick = function (pos, width) {
            var $tick = $("<span />").addClass("Tick sf-element sf-element-range sfc-inner-dimmed").html("&nbsp;");
            $tick.css("left", (pos + thumbWidth / 2) + "px"); $tick.css("width", width + "px"); $slider.append($tick);
        }; var draw = function () {
            var width = Math.max($parent.outerWidth(), thumbWidth + buttonWidth * 2);
            var sliderWidth = width - buttonWidth * 2; thumbMax = sliderWidth - thumbWidth; var tickSize = thumbMax / Math.max(1, (ticks - 1));
            $slider.empty(); var drawTicks = width > ticks * 2; snapPositions = []; var i; for (i = 0; i < ticks; i++) {
                snapPositions.push(tickSize * i);
                if (drawTicks) { drawTick(Math.round(snapPositions[i]), tickSize); }
            } $outercontainer.css("width", width + "px");
            $container.css("width", width + "px"); $slider.css("width", sliderWidth + "px"); if (Spotfire.capabilities.supportsTouch()) {
                $slider.parent().css("overflow", "visible");
                $slider.css("overflow", "visible"); Touch.addTouchTarget($leftButton, 20, 20, $leftButton.outerWidth() / 6, 20);
                Touch.addTouchTarget($rightButton, $rightButton.outerWidth() / 6, 20, 20, 20); Touch.addTouchTarget($slider, $slider.outerWidth() / 2 + $rightButton.outerWidth() / 3, 12, $slider.outerWidth() / 2 + $rightButton.outerWidth() / 3, 8);
            }
        }; var updateValueLabel = function () {
            var text = formattedValue; if (selectedIndex >= 0 && selectedIndex < values.length) {
                text = values[selectedIndex];
            } if (selectedIndex <= 0) { $leftButton.addClass("LeftDisabled"); $leftButton.removeClass("LeftEnabled"); } else {
                $leftButton.removeClass("LeftDisabled");
                $leftButton.addClass("LeftEnabled");
            } if (selectedIndex >= values.length - 1) {
                $rightButton.addClass("RightDisabled");
                $rightButton.removeClass("RightEnabled");
            } else {
                $rightButton.removeClass("RightDisabled"); $rightButton.addClass("RightEnabled");
            } valueLabel.text(text);
        }; var updateThumbPosition = function () {
            updateValueLabel(); $thumb.css("left", thumbPos + buttonWidth + "px");
        }; var snapThumb = function () {
            if (selectedIndex >= 0 && selectedIndex < snapPositions.length) {
                thumbPos = Math.round(snapPositions[selectedIndex]);
            } updateThumbPosition();
        }; var setSelectedIndex = function (index) { selectedIndex = index; snapThumb(); }; var onValueChanged = function () {
            if (selectedIndex >= 0) {
                Spotfire.WebView.modifyControl(id, selectedIndex);
            }
        }; var getClosestSnapIndex = function (pos) {
            var snapIndex = 0; var i; for (i = 0; i < snapPositions.length; i++) {
                if (Math.abs(snapPositions[i] - pos) < Math.abs(snapPositions[snapIndex] - pos)) {
                    snapIndex = i;
                }
            } return snapIndex;
        }; var onMouseMove = function (e) {
            var delta = e.clientX - previousClientX; previousClientX = e.clientX;
            thumbPos = Math.max(0, Math.min(thumbMax, thumbPos + delta)); selectedIndex = getClosestSnapIndex(thumbPos); updateThumbPosition();
        }; var onMouseUp = function () { snapThumb(); onValueChanged(); }; var onMouseDown = function (e) {
            $thumb.focus();
            previousClientX = e.clientX;
        }; var onLeftButtonClick = function () {
            var i = selectedIndex - 1; setSelectedIndex(Math.max(0, Math.min(i, ticks - 1)));
            onValueChanged();
        }; var onRightButtonClick = function () {
            var i = selectedIndex + 1; setSelectedIndex(Math.max(0, Math.min(i, ticks - 1)));
            onValueChanged();
        }; var onResize = function () { draw(); snapThumb(); }; var onClick = function (e) {
            var $target = $(e.target);
            if ($target === $thumb) { return; } var x = e.pageX - $slider.offset().left - $thumb.outerWidth() / 2; selectedIndex = getClosestSnapIndex(x);
            snapThumb(); onValueChanged();
        }; $parent.bind("resize", onResize); draw(); snapThumb(); if (ticks > 0) {
            $slider.on("click", onClick);
            $leftButton.on("click", onLeftButtonClick); $rightButton.on("click", onRightButtonClick); Spotfire.Touch.registerTouchEvents($thumb, onMouseDown, onMouseMove, onMouseUp);
        }
    };

    Spotfire.registerNameSpace("HtmlTextArea", {
        initializeSlider: function (id, settings) {
            initializeSlider(id, settings.showMinMaxLabels, settings.values, settings.selectedIndex, settings.formattedValue);
        }
    });
});

Spotfire.registerNameSpace("Visuals.Miniatures.MiniatureVisualization");

Spotfire.Visuals.Miniatures.MiniatureVisualization.create = function (id, settings) {
    function miniatureVisualization() {
        var $root = $("#" + id).empty();
        $root.addClass("EmbeddedMiniatureVisualization"); var shallShowTooltip = false; var updateCell = function (index, $cell, attributes) {
            $cell.unbind("click");
            $cell.unbind("mouseenter mouseleave"); shallShowTooltip = false; if (attributes.hasPendingValue) {
                $cell.css("opacity", "0.2");
                return;
            } if (typeof attributes.text !== "undefined") { $cell.empty(); $cell.text(attributes.text); } var updateCss = function (key, value) {
                if (value) {
                    $cell.css(key, value);
                } else { $cell.css(key, ""); }
            }; updateCss("color", attributes.color); updateCss("font-style", attributes.fontStyle);
            updateCss("font-weight", attributes.fontWeight); updateCss("text-align", attributes.textAlign); if (attributes.imageUrl) {
                var $img = $cell.children("img");
                if (!$img.length) { $cell.empty(); $img = $("<img/>"); $cell.append($img); } $img.attr("src", attributes.imageUrl);
            } if (typeof attributes.actionEnabled !== "undefined") {
                if (attributes.actionEnabled) {
                    var onCellClick = function () {
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "PerformAction", JSON.stringify(index));
                    }; $cell.click(onCellClick); $cell.addClass("actionCell");
                } else { $cell.removeClass("actionCell"); }
            } var tooltipLines = null;
            var timer = null; var fetchAndShowTooltip = function () {
                shallShowTooltip = true; var showTooltipDelayed = function (lines, delayMillis) {
                    var showTooltip = function () {
                        if (shallShowTooltip) {
                            Spotfire.Visuals.Tooltip.show(lines.join("\n"));
                        }
                    }; timer = window.setTimeout(showTooltip, delayMillis);
                }; var delay = 350; var targetTime = delay + $.now(); var getTooltipCallback = function (lines) {
                    tooltipLines = lines;
                    var remaningDelay = Math.max(0, targetTime - $.now()); showTooltipDelayed(lines, remaningDelay);
                }; if (tooltipLines === null) {
                    Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "GetTooltip", JSON.stringify(index), getTooltipCallback);
                } else { showTooltipDelayed(tooltipLines, delay); }
            }; var hideTooltip = function () {
                shallShowTooltip = false; if (timer) {
                    window.clearTimeout(timer);
                } Spotfire.Visuals.Tooltip.hide();
            }; $cell.hover(fetchAndShowTooltip, hideTooltip); $cell.css("opacity", "");
        }; var cells = []; var update = function (mvSettings) {
            var $cell; var i; if (cells.length !== mvSettings.cells.length) {
                cells = [];
                $root.empty(); for (i = 0; i < mvSettings.cells.length; i++) {
                    $cell = $("<span></span>"); cells.push($cell); $root.append($cell);
                }
            } for (i = 0; i < cells.length; i++) { updateCell(i, cells[i], mvSettings.cells[i]); }
        }; this.update = update;
    } var miniVis = new miniatureVisualization();
    var $rootElement = $("#" + id); $rootElement.data("miniVis", miniVis); miniVis.update(settings);
};

Spotfire.Visuals.Miniatures.MiniatureVisualization.update = function (id, settings) {
    var miniVis = $("#" + id).data("miniVis");
    if (miniVis) { miniVis.update(settings); }
};

// MapChart Visualization - touch/mouse handler
$(function () {
    Spotfire.registerNameSpace("Visuals.MapChartVisualization");

    Spotfire.Visuals.MapChartVisualization.MapChartTouchHandler = function (interactionLayer, widgets) {
        var pixelsPerZoomStep = 50;
        var panEvent, panStoppedEvent, startMarkingEvent, quickZoomEvent, zoomStoppedEvent, clickMarkingEvent, clickZoomInEvent, clickZoomOutEvent;
        var panIsDefaultMode; this.pan = function (func) { panEvent = func; }; this.panStopped = function (func) {
            panStoppedEvent = func;
        }; this.startMarking = function (func) { startMarkingEvent = func; }; this.clickMarking = function (func) {
            clickMarkingEvent = func;
        }; this.quickZoom = function (func) { quickZoomEvent = func; }; this.zoomStopped = function (func) {
            zoomStoppedEvent = func;
        }; this.clickZoomIn = function (func) { clickZoomInEvent = func; }; this.clickZoomOut = function (func) {
            clickZoomOutEvent = func;
        }; this.setPanAsDeafultMode = function (value) { panIsDefaultMode = value; }; var touchTimer; var hasPanned = false;
        var longTouch = false; var touchEnded = false; var lastX, lastY; var pinchDistance; var lastDownEvent; var lastZoomStep = 0;
        var isMarking = false; var touchesDown = 0; var isPinching = false; var timerEvent; var touchEnd; var touchMove;
        var touchStart; var calculatePinchDistance; timerEvent = function () {
            if (touchEnded && !pinchDistance && !isPinching) {
                clickMarkingEvent(new Point(lastDownEvent.originalEvent.touches[0].pageX - interactionLayer.offset().left, lastDownEvent.originalEvent.touches[0].pageY - interactionLayer.offset().top));
            } else {
                if (!pinchDistance) {
                    isMarking = true; Touch.showTouchHoldImage(lastDownEvent.originalEvent.touches[0].pageX, lastDownEvent.originalEvent.touches[0].pageY);
                    startMarkingEvent(lastDownEvent.originalEvent); longTouch = true;
                }
            } clearTimeout(touchTimer); touchTimer = undefined;
        }; touchEnd = function (touch) {
            touch.preventDefault(); $(document.body).unbind("touchend", touchEnd); $(document.body).unbind("touchmove", touchMove);
            if (touchesDown === 2 && !isPinching && panIsDefaultMode) {
                clickZoomOutEvent(new Point(touch.originalEvent.touches[0].pageX - interactionLayer.offset().left, touch.originalEvent.touches[0].pageY - interactionLayer.offset().top));
            } else {
                if (isMarking || !panIsDefaultMode) { Touch.removeTouchHoldImage(); } else {
                    if (hasPanned) {
                        panStoppedEvent();
                    } else { if (isPinching) { zoomStoppedEvent(); lastZoomStep = 0; } }
                }
            } touchEnded = true; pinchDistance = undefined;
        };
        touchMove = function (touch) {
            touch.preventDefault(); clearTimeout(touchTimer); touchTimer = undefined; if (!longTouch && pinchDistance && touch.originalEvent.touches.length >= 2 && panIsDefaultMode) {
                var deltaDistance = pinchDistance - calculatePinchDistance(touch.originalEvent.touches);
                var steps = Math.round(deltaDistance / pixelsPerZoomStep); if (steps - lastZoomStep !== 0) {
                    isPinching = true; quickZoomEvent(steps - lastZoomStep);
                    lastZoomStep = steps;
                }
            } else {
                if (!longTouch && panIsDefaultMode) {
                    var offSetX = (lastX - touch.originalEvent.changedTouches[0].pageX) * -1;
                    var offSetY = (lastY - touch.originalEvent.changedTouches[0].pageY) * -1; lastX = touch.originalEvent.changedTouches[0].pageX;
                    lastY = touch.originalEvent.changedTouches[0].pageY; if (Math.abs(offSetX) > 0 || Math.abs(offSetY) > 0) {
                        panEvent(offSetX, offSetY);
                        hasPanned = true;
                    }
                } else {
                    if (!isMarking && !panIsDefaultMode && !longTouch) {
                        isMarking = true; Touch.showTouchHoldImage(lastDownEvent.originalEvent.touches[0].pageX, lastDownEvent.originalEvent.touches[0].pageY);
                        startMarkingEvent(touch.originalEvent.changedTouches[0]);
                    } else {
                        if (isMarking || !panIsDefaultMode) {
                            Touch.moveTouchHoldImage(touch.originalEvent.touches[0].pageX, touch.originalEvent.touches[0].pageY);
                        }
                    }
                }
            }
        }; touchStart = function (event) {
            event.preventDefault(); isMarking = false; longTouch = false; touchEnded = false;
            isPinching = false; touchesDown = event.originalEvent.touches.length; if (event.originalEvent.touches.length > 2 || event.originalEvent.touches.length < 1) {
                return;
            } if (event.originalEvent.touches.length === 2) {
                pinchDistance = calculatePinchDistance(event.originalEvent.touches);
            } else {
                var index; for (index = 0; index < widgets.length; index++) {
                    if ($.contains(widgets[index].get(0), event.originalEvent.touches[0].target)) {
                        return;
                    }
                } if (touchTimer) {
                    clickZoomInEvent(new Point(event.originalEvent.touches[0].pageX - interactionLayer.offset().left, event.originalEvent.touches[0].pageY - interactionLayer.offset().top));
                    clearTimeout(touchTimer); touchTimer = undefined;
                } else {
                    touchTimer = setTimeout(timerEvent, 500); var touch = event.originalEvent.touches[0];
                    lastX = touch.pageX; lastY = touch.pageY;
                }
            } lastDownEvent = event; $(document.body).unbind("touchend", touchEnd);
            $(document.body).bind("touchend", touchEnd); $(document.body).unbind("touchmove", touchMove); $(document.body).bind("touchmove", touchMove);
        }; interactionLayer.unbind("touchstart", touchStart); interactionLayer.bind("touchstart", touchStart); calculatePinchDistance = function (touches) {
            var x0 = touches[0].pageX;
            var y0 = touches[0].pageY; var x1 = touches[1].pageX; var y1 = touches[1].pageY; var distance = Math.sqrt(Math.pow(x0 - x1, 2) + Math.pow(y0 - y1, 2));
            var absDistance = Math.abs(distance); return absDistance;
        };
    };

    Spotfire.Visuals.MapChartVisualization.MapChartMouseHandler = function (interactionLayer, widgets, editLabelsPositionMode) {
        var panEvent, panStoppedEvent, startMarkingEvent, rightClickEvent, clickMarkingEvent, clickZoomInEvent;
        var panIsDefaultMode; this.pan = function (func) { panEvent = func; }; this.panStopped = function (func) {
            panStoppedEvent = func;
        }; this.startMarking = function (func) { startMarkingEvent = func; }; this.rightClick = function (func) {
            rightClickEvent = func;
        }; this.clickMarking = function (func) { clickMarkingEvent = func; }; this.clickZoomIn = function (func) {
            clickZoomInEvent = func;
        }; this.setPanAsDeafultMode = function (value) { panIsDefaultMode = value; }; var hasPanned = false, lastX, lastY; var doubleClickTimer;
        var mouseUp; var mouseMove; var mouseDown; mouseUp = function (upEvent) {
            $(document).unbind("mousemove", mouseMove);
            $(document).unbind("mouseup", mouseUp); if (hasPanned) { hasPanned = false; panStoppedEvent(); } else {
                if (upEvent.which === 3) {
                    if (rightClickEvent) {
                        rightClickEvent(upEvent);
                    }
                } else {
                    if (upEvent.which === 1) {
                        if (panIsDefaultMode) {
                            doubleClickTimer = setTimeout(function () {
                                doubleClickTimer = undefined;
                                clickMarkingEvent(new Point(upEvent.pageX - interactionLayer.offset().left, upEvent.pageY - interactionLayer.offset().top), upEvent.ctrlKey || upEvent.metaKey);
                            }, 500);
                        } else {
                            clickMarkingEvent(new Point(upEvent.pageX - interactionLayer.offset().left, upEvent.pageY - interactionLayer.offset().top), upEvent.ctrlKey || upEvent.metaKey);
                        }
                    }
                }
            }
        }; mouseMove = function (moveEvent) {
            moveEvent.preventDefault(); if (moveEvent.ctrlKey || moveEvent.metaKey || panIsDefaultMode) {
                var offSetX = (lastX - moveEvent.pageX) * -1;
                var offSetY = (lastY - moveEvent.pageY) * -1; lastX = moveEvent.pageX; lastY = moveEvent.pageY; if (Math.abs(offSetX) > 0 || Math.abs(offSetY) > 0) {
                    hasPanned = true;
                    panEvent(offSetX, offSetY);
                }
            }
        }; mouseDown = function (eventDown) {
            eventDown.preventDefault(); if (eventDown.target === undefined) {
                eventDown.target = eventDown.srcElement;
            } var hitWidget = false; var index; for (index = 0; index < widgets.length; index++) {
                if ($.contains(widgets[index].get(0), eventDown.target)) {
                    hitWidget = true;
                }
            } if ((eventDown.which === 3 || panIsDefaultMode) && !hitWidget) {
                lastX = eventDown.pageX; lastY = eventDown.pageY;
                $(document).unbind("mousemove", mouseMove); $(document).bind("mousemove", mouseMove); $(document).unbind("mouseup", mouseUp);
                $(document).bind("mouseup", mouseUp);
            } else {
                if (eventDown.which === 1 && !hitWidget && !editLabelsPositionMode) {
                    startMarkingEvent(eventDown);
                }
            } return true;
        }; interactionLayer.dblclick(function (e) {
            if (panIsDefaultMode) {
                if (e.target === undefined) {
                    e.target = e.srcElement;
                } var index; for (index = 0; index < widgets.length; index++) {
                    if ($.contains(widgets[index].get(0), e.target)) {
                        return true;
                    }
                } clearTimeout(doubleClickTimer); if (clickZoomInEvent) {
                    clickZoomInEvent(new Point(e.pageX - interactionLayer.offset().left, e.pageY - interactionLayer.offset().top));
                }
            }
        }); interactionLayer.unbind("mousedown", mouseDown); interactionLayer.bind("mousedown", mouseDown);
    };
});

// MapChart Panel Visualization
$(function () {
    Spotfire.registerNameSpace("Visuals.MapChartPanelVisualization");
    var MapChartPanel;

    Spotfire.Visuals.MapChartPanelVisualization.initialize = function (id, panelIndex, generation) {
        var panelViewport = $("#" + id + panelIndex);
        var mapChartPanel = new MapChartPanel(id, panelIndex); panelViewport.data("MapChartPanel", mapChartPanel);
        var args = { panelIndex: panelIndex, generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "MapChartPanelData", JSON.stringify(args), function (data) {
            mapChartPanel.doUpdate(generation, data);
        });
    };

    Spotfire.Visuals.MapChartPanelVisualization.updateHighlight = function (id, panelIndex, generation, data) {
        var panelViewport = $("#" + id + panelIndex);
        var mapChartPanel = panelViewport.data("MapChartPanel"); if (mapChartPanel) {
            mapChartPanel.performHighlight(data);
        }
    };

    MapChartPanel = function (id, panelIndex) {
        var viewport = $("#" + id + panelIndex); var mapChartViewport = $("#" + id);
        var mapObj = mapChartViewport.data("MapChart"); var bounds, boundsLatLng; var highlightLayer; var markerLayer;
        var containsTileLayer; var htmlEncode; var addLabels; if (Spotfire.capabilities.supportsTouch()) {
            viewport.css("overflow", "auto");
        } this.doUpdate = function (generation, data) {
            if (!data) { return; } mapObj.reportProgress(false, generation); viewport.empty();
            var mapContainer = $("<div></div>"); mapContainer.css("width", viewport.css("width")); mapContainer.css("height", viewport.css("height"));
            viewport.append(mapContainer); var waitingImages = 0; if (!data.noneCrs && !data.center) { return; } var scaleControl = { fontSize: data.scaleFontSize, fontFamily: data.scaleFontName, fontStyle: data.scaleFontItalic ? "italic" : "normal", fontWeight: data.scaleFontBold ? "bold" : "normal", kmLabel: data.kmLabel, mLabel: data.mLabel, miLabel: data.miLabel, ftLabel: data.ftLabel, unitSystem: data.useMetricUnits ? "metric" : "imperial" };
            var attributionControl = { prefix: "", fontSize: 7, fontFamily: "Arial" }; if (!data.showScale) {
                scaleControl.addToMap = false;
            } if (data.showAttribution && containsTileLayer(data.layers)) { attributionControl.addToMap = true; } else {
                attributionControl.addToMap = false;
            } var crs = new T.Crs({ code: data.epsg, proj: data.proj4def, resolutions: data.scaleSteps }); var map = new T.Map(mapContainer.get(0), { maxZoom: (data.maxLevel || data.maxLevel === 0) ? data.maxLevel : 18, minZoom: data.minLevel || 0, zoom: data.noneCrs ? 10 : data.zoomLevel, center: data.noneCrs ? new T.LatLng(0, 0) : new T.LatLng(data.center.Y, data.center.X), repeatX: true, repeatY: false, skipDefaultHandlers: true, controls: { scale: scaleControl, attribution: attributionControl } });
            map.setCrs(crs); bounds = map.getProjectedBounds(); boundsLatLng = map.getBounds(); if (data.noneCrs) {
                map.useNoneCrs = true;
                map.startingBounds = boundsLatLng;
            } mapObj.addMap(map); var tileLayers = []; var hasImageLayer = false; var preventDefaultDragFunction = function (e) {
                e.preventDefault();
            }; var imageLoadedEvent = function () {
                waitingImages--; if (!waitingImages) {
                    mapObj.reportProgress(true, generation);
                    $.each(tileLayers, function (tileLayerIndex, tileLayerObject) {
                        tileLayerObject.reloadTiles(); tileLayerObject.options.autoLoadTiles = true;
                    });
                }
            }; var errorTimer; var index, layer, copyrightTag, tileLayer, tiledRendered, wmsOptions, wmsLayer, imageLayer;
            var layerId; var wmsErrorFunction = function () {
                if (tiledRendered) { imageLoadedEvent(); } Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "ReportWmsError", JSON.stringify({ generation: generation, layerId: layerId }));
                if (errorTimer) { clearTimeout(errorTimer); }
            }; var tiledWmsErrorFunction = function (tile) {
                if (!errorTimer) {
                    errorTimer = setTimeout(wmsErrorFunction, 1000);
                }
            }; var tileLayerProperties; for (index = 0; index < data.layers.length; index++) {
                layer = data.layers[index]; if (layer.type === "tile" && layer.url) {
                    if (layer.copyrightLink && layer.copyrightText) {
                        copyrightTag = '<a target="_blank" href="' + htmlEncode(layer.copyrightLink) + '" class="mapChart attribution" title="' + htmlEncode(layer.copyrightLink) + '">' + htmlEncode(layer.copyrightText) + "</a>";
                    } else { if (layer.copyrightText) { copyrightTag = layer.copyrightText; } } tileLayerProperties = { attribution: copyrightTag, tile404: "Images/Plots/WebMapChart/Error404.png", autoLoadTiles: false };
                    if (layer.hasOwnProperty("opacity")) { tileLayerProperties.opacity = layer.opacity; } tileLayer = new T.TileLayer(layer.url, tileLayerProperties);
                    map.addLayer(tileLayer); tileLayers.push(tileLayer);
                } else {
                    if (layer.type === "wms") {
                        tiledRendered = layer.tiledRendered;
                        wmsOptions = { version: "1.1.1", layers: layer.layers, styles: layer.styles, tile404: "Images/Plots/WebMapChart/EmptyImage.gif", errorTileAttemptsThreshold: 0 };
                        wmsOptions.maxBounds = new T.Bounds(new T.Point(layer.maxBoundsWest, layer.maxBoundsSouth), new T.Point(layer.maxBoundsEast, layer.maxBoundsNorth));
                        wmsOptions.queryParams = layer.queryParams; if (!layer.useCache) { wmsOptions.queryParams.gen = generation; } if (layer.hasOwnProperty("opacity")) {
                            wmsOptions.opacity = layer.opacity;
                        } wmsLayer = layer.tiledRendered ? new T.WmsTileLayer(layer.serverUrl, wmsOptions) : new T.WmsLayer(layer.serverUrl, wmsOptions);
                        layerId = layer.id; if (tiledRendered) { wmsLayer.events.on("tile-error", tiledWmsErrorFunction); } else {
                            wmsLayer.events.on("wms-error", wmsErrorFunction);
                            hasImageLayer = true; waitingImages++; wmsLayer.events.on("image-load", imageLoadedEvent);
                        } $(wmsLayer.image).on("dragstart", preventDefaultDragFunction);
                        map.addLayer(wmsLayer);
                    } else {
                        if (layer.type === "image") {
                            imageLayer = new T.ImageLayer(layer.url, bounds); $(imageLayer.image).on("dragstart", preventDefaultDragFunction);
                            map.addLayer(imageLayer); hasImageLayer = true; waitingImages++; imageLayer.events.on("image-load", imageLoadedEvent);
                        }
                    }
                }
            } if (data.containsLabels && data.editLabelMode) {
                markerLayer = new T.LegacyMarkersLayer(); map.addLayer(markerLayer);
                var args = { panelIndex: panelIndex, generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "MapChartReadLabelsForEditMode", JSON.stringify(args), addLabels);
            } if (!hasImageLayer) {
                mapObj.reportProgress(true, generation); var i; for (i = 0; i < tileLayers.length; i++) {
                    tileLayers[i].reloadTiles();
                    tileLayers[i].options.autoLoadTiles = true;
                }
            } if (!data.editLabelMode && hasImageLayer) {
                highlightLayer = new T.ImageLayer(data.highlightUrl, bounds);
                $(highlightLayer.image).on("dragstart", function (e) { e.preventDefault(); return false; }); map.addLayer(highlightLayer);
            }
        }; this.performHighlight = function (data) {
            if (highlightLayer) {
                highlightLayer.reload(data.url, bounds); if (Spotfire.isWebPlayer()) {
                    var moveEvent = function () {
                        $(document.body).unbind("mousemove", moveEvent);
                        highlightLayer.reload("Images/EmptyImage.gif", bounds); Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ClearHighlight", "{}");
                    }; $(document.body).bind("mousemove", moveEvent);
                }
            }
        }; htmlEncode = function (html) {
            return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML;
        }; containsTileLayer = function (layers) {
            var index; for (index = 0; index < layers.length; index++) {
                if (layers[index].type === "tile") {
                    return true;
                }
            } return false;
        }; function olderIe() {
            var v = 3; var div = document.createElement("div"); while (v < 10) {
                div.innerHTML = "<!--[if gt IE " + (++v) + "]><i></i><![endif]-->";
                if (div.getElementsByTagName("i").length === 0) { break; }
            } return v <= 9 && v > 4;
        } addLabels = function (data) {
            if (!data) {
                return;
            } var useOldIeClass = olderIe(); var layerIndex, layerData, layerId, labelIndex, label, labelDiv, divAsString, mapBounds, offsetX, offsetY, percentX, percentY, labelMarker;
            for (layerIndex = 0; layerIndex < data.layers.length; layerIndex++) {
                layerData = data.layers[layerIndex]; layerId = layerData.layerId;
                for (labelIndex = 0; labelIndex < layerData.Labels.length; labelIndex++) {
                    label = layerData.Labels[labelIndex];
                    labelDiv = $("<div></div>"); labelDiv.css("font-family", layerData.FontName); if (layerData.FontBold) {
                        labelDiv.css("font-weight", "bold");
                    } if (layerData.FontItalic) { labelDiv.css("font-style", "italic"); } labelDiv.css("margin-top", "-" + Math.ceil(layerData.FontSize / 2) + "pt");
                    labelDiv.css("font-size", layerData.FontSize + "pt"); if (useOldIeClass) {
                        labelDiv.addClass("mapChart labels ie");
                    } else { labelDiv.addClass("mapChart labels noneIe"); } labelDiv.html(htmlEncode(label.Label)); divAsString = $("<p>").append(labelDiv).html();
                    if (data.useNoneCrs) {
                        mapBounds = mapObj.getFirstMap().getBounds(); offsetX = label.CenterPoint.X - data.boundsLow.X;
                        offsetY = label.CenterPoint.Y - data.boundsLow.Y; percentX = offsetX / (data.boundsHigh.X - data.boundsLow.X); percentY = offsetY / (data.boundsHigh.Y - data.boundsLow.Y);
                        label.CenterPoint.X = (percentX * (mapBounds.getEast() - mapBounds.getWest())) + mapBounds.getWest(); label.CenterPoint.Y = (percentY * (mapBounds.getNorth() - mapBounds.getSouth())) + mapBounds.getSouth();
                    } labelMarker = new T.LegacyHtmlMarker(new T.LatLng(label.CenterPoint.Y, label.CenterPoint.X), divAsString, { draggable: layerData.editLabelPositionsMode });
                    labelMarker.geometryKey = label.key; labelMarker.layerId = layerId; markerLayer.addMarker(labelMarker);
                }
            } markerLayer.events.on("marker-drag-end", function (marker) {
                var args = { layerId: marker.layerId, key: marker.geometryKey, x: marker.latlng.lng.toString(), y: marker.latlng.lat.toString() };
                if (data.useNoneCrs) {
                    var mapBounds_ = mapObj.getFirstMap().getBounds(); var offsetX_ = marker.latlng.lng - mapBounds_.getWest();
                    var offsetY_ = marker.latlng.lat - mapBounds_.getSouth(); var percentX_ = offsetX_ / (mapBounds_.getEast() - mapBounds_.getWest());
                    var percentY_ = offsetY_ / (mapBounds_.getNorth() - mapBounds_.getSouth()); args.x = (percentX_ * (data.boundsHigh.X - data.boundsLow.X)) + data.boundsLow.X;
                    args.x = args.x.toString(); args.y = (percentY_ * (data.boundsHigh.Y - data.boundsLow.Y)) + data.boundsLow.Y; args.y = args.y.toString();
                } Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "LabelPositionChanged", JSON.stringify(args));
            });
        };
    };
});

// MapChart Visualization
$(function () {
    Spotfire.registerNameSpace("Visuals.MapChartVisualization"); 
    var MapChartObject; var MapCircleCalculations = (function () {
        var isIe = window.navigator.userAgent.indexOf("MSIE ") > 0 || window.navigator.userAgent.indexOf("Trident/") > 0 || window.navigator.userAgent.indexOf("Edge/") > 0;
        var CIRCLE_SIDES = isIe ? 500 : 5000; var EARTH_RADIUS = 6371; function rotate(u, v, theta) {
            var x = v.x * (Math.cos(theta) + u.x * u.x * (1 - Math.cos(theta))) + v.y * (u.x * u.y * (1 - Math.cos(theta)) - u.z * Math.sin(theta)) + v.z * (u.x * u.z * (1 - Math.cos(theta)) + u.y * Math.sin(theta));
            var y = v.x * (u.y * u.x * (1 - Math.cos(theta)) + u.z * Math.sin(theta)) + v.y * (Math.cos(theta) + u.y * u.y * (1 - Math.cos(theta))) + v.z * (u.y * u.z * (1 - Math.cos(theta)) - u.x * Math.sin(theta));
            var z = v.x * (u.z * u.x * (1 - Math.cos(theta)) - u.y * Math.sin(theta)) + v.y * (u.z * u.y * (1 - Math.cos(theta)) + u.x * Math.sin(theta)) + v.z * (Math.cos(theta) + u.z * u.z * (1 - Math.cos(theta)));
            return { x: x, y: y, z: z };
        } function normalize(vector) {
            var module = Math.sqrt(Math.pow(vector.x, 2) + Math.pow(vector.y, 2) + Math.pow(vector.z, 2));
            var result = { x: vector.x / module, y: vector.y / module, z: vector.z / module }; return result;
        } function toCartesian(point) {
            var x = EARTH_RADIUS * Math.sin(Math.PI / 2 - point.lat * Math.PI / 180) * Math.cos(point.lng * Math.PI / 180);
            var y = EARTH_RADIUS * Math.sin(Math.PI / 2 - point.lat * Math.PI / 180) * Math.sin(point.lng * Math.PI / 180); var z = EARTH_RADIUS * Math.cos(Math.PI / 2 - point.lat * Math.PI / 180);
            return { x: x, y: y, z: z };
        } function fromCartesian(point) {
            var module = Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2) + Math.pow(point.z, 2));
            var lat = (Math.PI / 2 - Math.acos(point.z / module)) * 180 / Math.PI; var lng = Math.atan2(point.y, point.x) * 180 / Math.PI;
            return new T.LatLng(lat, lng);
        } var polygonSign = function (polygon, center) {
            var closestOnX = { distance: Math.abs(center.x - polygon[0].x), index: 0 };
            var i, newClosestOnXDistance; for (i = 0; i < polygon.length; i++) {
                newClosestOnXDistance = Math.min(closestOnX.distance, Math.abs(center.x - polygon[i].x));
                if (newClosestOnXDistance !== closestOnX.distance) { closestOnX = { distance: newClosestOnXDistance, index: i }; }
            } return center.y - polygon[closestOnX.index].y >= 0 ? 1 : -1;
        }; var isInside = function (pointX, pointY, minX, minY, maxX, maxY) {
            return pointX >= minX && pointX <= maxX && pointY >= minY && pointY <= maxY;
        }; var extendPolygonBounds = function (bounds, point) {
            bounds.minX = bounds.minX === undefined ? point.x : Math.min(bounds.minX, point.x);
            bounds.maxX = bounds.maxX === undefined ? point.x : Math.max(bounds.maxX, point.x); bounds.minY = bounds.minY === undefined ? point.y : Math.min(bounds.minY, point.y);
            bounds.maxY = bounds.maxY === undefined ? point.y : Math.max(bounds.maxY, point.y);
        }; var getRectPolygon = function (topLeft, bottomRight, viewportBottomRight) {
            var polygon = [];
            polygon.push({ x: topLeft.x, y: 0 }); polygon.push({ x: topLeft.x, y: viewportBottomRight.y }); polygon.push({ x: bottomRight.x, y: viewportBottomRight.y });
            polygon.push({ x: bottomRight.x, y: 0 }); return polygon;
        }; var fixProjectionDrawingErrors = function (polygon, center, topLeft, bottomRight, viewportBottomRight, mapZoomLevel) {
            var polygon1 = [];
            var polygon2 = []; var polygonToggle = false; var polygonToggleCount = 0; var minX = polygon[0].x; var maxX = polygon[0].x;
            var minY = polygon[0].y; var maxY = polygon[0].y; var polygon1Bounds = {}; var polygon2Bounds = {}; var i; var margin1, margin2;
            var xDiff; for (i = 0; i < polygon.length; i++) {
                if (i > 0) {
                    minX = Math.min(minX, polygon[i].x); maxX = Math.max(maxX, polygon[i].x);
                    minY = Math.min(minY, polygon[i].y); maxY = Math.max(maxY, polygon[i].y); xDiff = Math.abs(polygon[i].x - polygon[i - 1].x);
                    if (xDiff > 200 * Math.pow(2, mapZoomLevel)) {
                        polygonToggle = !polygonToggle; polygonToggleCount++; if (Math.abs(bottomRight.x - polygon[i - 1].x) < 50) {
                            margin1 = [bottomRight.x, polygon[i - 1].y];
                            margin2 = [topLeft.x, polygon[i].y]; maxX = bottomRight.x; minX = topLeft.x;
                        } else {
                            if (Math.abs(topLeft.x - polygon[i - 1].x) < 50) {
                                margin1 = [topLeft.x, polygon[i - 1].y];
                                margin2 = [bottomRight.x, polygon[i].y]; maxX = bottomRight.x; minX = topLeft.x;
                            }
                        }
                    } if (polygonToggle) {
                        if (margin1) {
                            polygon1.push({ x: margin1[0], y: margin1[1] });
                            polygon2.push({ x: margin2[0], y: margin2[1] }); margin1 = null;
                        } extendPolygonBounds(polygon2Bounds, polygon[i]);
                        polygon2.push({ x: polygon[i].x, y: polygon[i].y });
                    } else {
                        if (margin1) {
                            polygon2.push({ x: margin1[0], y: margin1[1] });
                            polygon1.push({ x: margin2[0], y: margin2[1] }); margin1 = null;
                        } extendPolygonBounds(polygon1Bounds, polygon[i]);
                        polygon1.push({ x: polygon[i].x, y: polygon[i].y });
                    }
                } else {
                    extendPolygonBounds(polygon1Bounds, polygon[i]);
                    polygon1.push({ x: polygon[i].x, y: polygon[i].y });
                }
            } if (polygonToggleCount === 0 && !isInside(center.x, center.y, minX, minY, maxX, maxY)) {
                return [getRectPolygon(topLeft, bottomRight, viewportBottomRight), polygon1];
            } if (polygonToggleCount === 2) {
                if (!isInside(center.x, center.y, polygon1Bounds.minX, polygon1Bounds.minY, polygon1Bounds.maxX, polygon1Bounds.maxY) && !isInside(center.x, center.y, polygon2Bounds.minX, polygon2Bounds.minY, polygon2Bounds.maxX, polygon2Bounds.maxY)) {
                    return [getRectPolygon(topLeft, bottomRight, viewportBottomRight), polygon1, polygon2];
                } return [polygon1, polygon2];
            } if (polygonToggleCount === 1 || polygonToggleCount >= 3) {
                var sign = polygonSign(polygon, center);
                if (sign === 1) {
                    polygon1.push({ x: minX, y: viewportBottomRight.y * sign }); polygon1.push({ x: maxX, y: viewportBottomRight.y * sign });
                } else { polygon1.push({ x: maxX, y: 0 }); polygon1.push({ x: minX, y: 0 }); } for (i = 0; i < polygon2.length; i++) {
                    polygon1.push({ x: polygon2[i].x, y: polygon2[i].y });
                } return [polygon1];
            } return [polygon];
        }; var pointToLineDistance = function (point, point1, point2) {
            if (point1.x === point2.x) {
                return Math.abs(point.x - point1.x);
            } var triangleArea = Math.abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x);
            var pointsDistance = Math.sqrt(Math.pow(point2.y - point1.y, 2) + Math.pow(point2.x - point1.x, 2)); var distance = triangleArea / pointsDistance;
            return distance;
        }; var simplifyPolygon = function (polygon, epsilon) {
            if (polygon.length <= 4) {
                return polygon;
            } var firstPoint = polygon[0]; var lastPoint = polygon[polygon.length - 1]; var maxDistanceIndex = -1; var maxDistance = 0;
            var i, currentDistance, firstRecursiveResult, secondRecursiveResult, recursiveResult; for (i = 1; i < polygon.length - 1;
            i++) {
                currentDistance = pointToLineDistance(polygon[i], firstPoint, lastPoint); if (currentDistance > maxDistance) {
                    maxDistance = currentDistance;
                    maxDistanceIndex = i;
                }
            } if (maxDistance > epsilon) {
                firstRecursiveResult = simplifyPolygon(polygon.slice(0, maxDistanceIndex + 1), epsilon);
                secondRecursiveResult = simplifyPolygon(polygon.slice(maxDistanceIndex), epsilon); recursiveResult = firstRecursiveResult.slice(0, firstRecursiveResult.length - 1).concat(secondRecursiveResult);
                return recursiveResult;
            } return [firstPoint, lastPoint];
        }; var transformToPolygon = function (map, center, point, viewport) {
            var centerLatLng = map.containerPointToLatLng(new T.Point(center.x, center.y));
            var pointLatLng = map.containerPointToLatLng(new T.Point(point.x, point.y)); var topLeft = map.latLngToContainerPoint(new T.LatLng(85, -180));
            var bottomRight = map.latLngToContainerPoint(new T.LatLng(-85, 180)); var viewportBottomRight = { x: viewport.width(), y: viewport.height() };
            var c = toCartesian(centerLatLng); var p = toCartesian(pointLatLng); var nc = normalize(c); var projectedCircle = [];
            var i, angle, result, pp, cp; for (i = 0; i < CIRCLE_SIDES; i++) {
                angle = i * (360 / CIRCLE_SIDES) * (Math.PI / 180); result = rotate(nc, p, angle);
                pp = fromCartesian(result); cp = map.latLngToContainerPoint(pp); projectedCircle.push({ x: cp.x, y: cp.y });
            } var wrappedLng = Math.abs(centerLatLng.lng / 180) > 1 ? centerLatLng.lng % 180 - (centerLatLng.lng / Math.abs(centerLatLng.lng)) * 180 : centerLatLng.lng;
            var polygons = fixProjectionDrawingErrors(projectedCircle, map.latLngToContainerPoint(new T.LatLng(centerLatLng.lat, wrappedLng)), topLeft, bottomRight, viewportBottomRight, map.getZoom());
            var simplifiedPolygons = []; for (i = 0; i < polygons.length; i++) {
                simplifiedPolygons.push(simplifyPolygon(polygons[i], 1));
            } return simplifiedPolygons;
        }; var computeDistance = function (map, point1, point2) {
            var a = map.containerPointToLatLng(new T.Point(point1.x, point1.y));
            var b = map.containerPointToLatLng(new T.Point(point2.x, point2.y)); var dLat = (b.lat - a.lat).toRad(); var dLon = (b.lng - a.lng).toRad();
            var lat1 = a.lat.toRad(); var lat2 = b.lat.toRad(); var x = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);
            var y = 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x)); var d = EARTH_RADIUS * y; return d;
        }; return { transformToPolygon: transformToPolygon, computeDistance: computeDistance };
    }());

    Spotfire.Visuals.MapChartVisualization.initialize = function (id) {
        var viewport = $("#" + id); var mapChart = new MapChartObject(id);
        viewport.data("MapChart", mapChart);
    };

    Spotfire.Visuals.MapChartVisualization.update = function (id, generation) {
        var viewport = $("#" + id);
        var mapChart = viewport.data("MapChart"); if (mapChart) {
            var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "MapChartData", JSON.stringify(args), function (data) {
                mapChart.doUpdate(generation, data);
            });
        }
    };

    MapChartObject = function (id) {
        var viewport = $("#" + id); var widgets = []; var navigationWidgetPlaceholder;
        var layerHandlerWidgetPlaceholder; var interativLayer; var panelMaps = []; var lastUpdateGeneration; var trellis = viewport.data("TrellisPlot");
        var initInteractivLayer; var initNavigationWidget; var initLayerHandlerWidget; var initScrollZoom; interativLayer = viewport;
        var waitingPanels = 0; viewport.parent().css("overflow", "hidden"); this.reportProgress = function (finished, generation) {
            if (lastUpdateGeneration !== generation) {
                return;
            } if (!finished) { waitingPanels++; } else { waitingPanels--; } if (waitingPanels === 0) {
                var args = { generation: generation };
                Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "ReadyForPickAndMark", JSON.stringify(args)); viewport.children("div").each(function () {
                    if ($(this).attr("remove")) {
                        $(this).find("img").attr("src", "");
                        $(this).find("img").remove(); $(this).get(0).innerHTML = ""; $(this).remove();
                    } else {
                        if (!$(this).attr("progress")) {
                            $(this).css("visibility", "visible");
                        }
                    }
                }); if (trellis) { trellis.hideProgressOverlay(); }
            }
        }; this.addMap = function (map) { panelMaps.push(map); }; this.getFirstMap = function () {
            return panelMaps[0];
        }; var quickZoom = function (steps, absoluteValue) {
            if (panelMaps && panelMaps.length > 0) {
                $.each(panelMaps, function (mapIndex, map) {
                    if (absoluteValue) {
                        map.zoomAround(map.calculateCenter(), steps, false);
                    } else { var oldZoomLevel = map.getZoom(); map.zoomAround(map.calculateCenter(), oldZoomLevel - steps, true); }
                });
            }
        }; this.doUpdate = function (generation, data) {
            lastUpdateGeneration = generation; if (!data) { return; } waitingPanels = 0;
            var i; for (i = 0; i < widgets.length; i++) { widgets[i] = null; } widgets = []; viewport.unbind(); panelMaps = []; Spotfire.Focus.handleKeyDown(viewport, function (e) {
                var keyArgs = { keyCode: e.keyCode, shiftKey: e.shiftKey, ctrlKey: e.ctrlKey };
                Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "KeyDown", JSON.stringify(keyArgs));
            }); viewport.children("div").each(function () {
                if ($(this).attr("panel") === undefined && $(this).attr("widget") !== undefined) {
                    $(this).get(0).innerHTML = "";
                    $(this).remove();
                }
            }); initInteractivLayer(generation, data); if (data.showNavigationControls || data.showNavigationMode) {
                if (navigationWidgetPlaceholder) {
                    navigationWidgetPlaceholder.get(0).innerHTML = "";
                } navigationWidgetPlaceholder = $("<div></div>"); navigationWidgetPlaceholder.attr("widget", true); navigationWidgetPlaceholder.attr("id", id + "_navWidget");
                viewport.append(navigationWidgetPlaceholder); initNavigationWidget(data.NavigationWidgetData, generation);
                widgets.push(navigationWidgetPlaceholder);
            } if (data.showLayerHandler) {
                if (layerHandlerWidgetPlaceholder) {
                    layerHandlerWidgetPlaceholder.get(0).innerHTML = "";
                } layerHandlerWidgetPlaceholder = $("<div></div>"); layerHandlerWidgetPlaceholder.attr("widget", true); viewport.append(layerHandlerWidgetPlaceholder);
                initLayerHandlerWidget(data.LayerHandlerWidgetData); widgets.push(layerHandlerWidgetPlaceholder);
            } if (data.enableMarking) {
                viewport.data("innerPlotBounds", new Rectangle(data.bounds.X, data.bounds.Y, data.bounds.Width, data.bounds.Height));
            } if (data.postScript) { eval(data.postScript); }
        }; var mapChartEventHandler; initInteractivLayer = function (generation, data) {
            var enableHighlight = true;
            interativLayer.css("overflow", "hidden"); interativLayer.css("position", "absolute"); interativLayer.css("top", data.bounds.Y + "px");
            interativLayer.css("left", data.bounds.X + "px"); interativLayer.css("width", data.bounds.Width + "px"); interativLayer.css("height", data.bounds.Height + "px");
            interativLayer.css("cursor", "default"); interativLayer.addClass("mapChart noSelection"); mapChartEventHandler = Spotfire.capabilities.supportsTouch() ? new Spotfire.Visuals.MapChartVisualization.MapChartTouchHandler(interativLayer, widgets) : new Spotfire.Visuals.MapChartVisualization.MapChartMouseHandler(interativLayer, widgets, data.editLabelPositionsMode);
            mapChartEventHandler.setPanAsDeafultMode(data.panNavigationMode); if (mapChartEventHandler.rightClick) {
                mapChartEventHandler.rightClick(function (e) {
                    var args = { isMouseUp: true, x: e.clientX, y: e.clientY };
                    if (Spotfire.isProfessional()) { PageBus.publish("spotfire.rightclick", JSON.stringify(args)); } else {
                        var pointArgs = { x: e.clientX - interativLayer.offset().left, y: e.clientY - interativLayer.offset().top };
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ShowContextMenu", JSON.stringify(pointArgs));
                    }
                });
            } mapChartEventHandler.pan(function (offsetX, offsetY) {
                if (data.allowInteraction) {
                    enableHighlight = false;
                    viewport.css("cursor", "move"); var point = new T.Point(offsetX, offsetY); $.each(panelMaps, function (mapIndex, map) {
                        map.panBy(point, true);
                    });
                }
            }); mapChartEventHandler.panStopped(function () {
                if (data.allowInteraction) {
                    enableHighlight = true; viewport.css("cursor", "default");
                    var map = panelMaps[0]; if (map) {
                        var newCenter = map.getCenter(); if (panelMaps[0].useNoneCrs) {
                            var bounds = panelMaps[0].startingBounds;
                            var oldCenterX = (bounds.getEast() + bounds.getWest()) / 2; var oldCenterY = (bounds.getNorth() + bounds.getSouth()) / 2;
                            var offsetX = newCenter.lng - oldCenterX; var offsetY = newCenter.lat - oldCenterY; newCenter.lng = offsetX / (bounds.getEast() - bounds.getWest());
                            newCenter.lat = (offsetY / (bounds.getSouth() - bounds.getNorth())) * -1;
                        } var args = { x: newCenter.lng, y: newCenter.lat, generation: generation };
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "SetCenter", JSON.stringify(args));
                    }
                }
            }); mapChartEventHandler.startMarking(function (event) {
                if (data.enableMarking) {
                    var markCallback = function (method, args) {
                        args.generation = generation;
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, method, JSON.stringify(args));
                    }; var moveCallback = function (center, point, isCircle) {
                        var mapChart = $("#" + id).data("MapChart").getFirstMap();
                        if (!mapChart || mapChart.options.crs.code !== "EPSG:3857" || data.isTrellis) { return null; } var distance = MapCircleCalculations.computeDistance(mapChart, center, point);
                        var polygons = null; if (isCircle) {
                            polygons = MapCircleCalculations.transformToPolygon(mapChart, center, point, viewport);
                        } var label = "km"; var kmToMCuttoff = 10; var milesToFtCuttoff = 2; if (data.useMetricUnits) {
                            if (distance >= kmToMCuttoff) {
                                distance = Math.round(distance);
                            } else { distance = Math.round(distance * 1000); label = "m"; }
                        } else {
                            var kmToMiles = 0.621371; var kmToFeet = 3280.84;
                            if (Math.round(distance * kmToMiles) >= milesToFtCuttoff) {
                                distance = Math.round(distance * kmToMiles); label = "miles";
                            } else { distance = Math.round(distance * kmToFeet); label = "ft"; }
                        } return { value: distance, label: label, polygons: polygons };
                    }; Spotfire.Visuals.Marking.onMouseDown(event, viewport, true, markCallback, null, data.markingMode, moveCallback, data.markingStyle);
                }
            }); mapChartEventHandler.clickMarking(function (point, eCtrl) {
                if (data.enableMarking) {
                    var marking = {}; marking.AltMode = false;
                    marking.AlongAxisMarking = false; marking.Points = [point]; marking.IsRectangleMarking = false; marking.generation = generation;
                    Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, eCtrl ? "MarkAdd" : "MarkReplace", JSON.stringify(marking));
                }
            });
            mapChartEventHandler.clickZoomIn(function (point) {
                if (data.allowInteraction) {
                    data.allowInteraction = false;
                    quickZoom(-1);
                } var args = { generation: generation, x: point.x, y: point.y, zoom: 1 }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ScrollZoom", JSON.stringify(args));
            }); if (mapChartEventHandler.clickZoomOut) {
                mapChartEventHandler.clickZoomOut(function (point) {
                    if (data.allowInteraction) {
                        data.allowInteraction = false;
                        quickZoom(1);
                    } var args = { generation: generation, x: point.x, y: point.y, zoom: -1 }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ScrollZoom", JSON.stringify(args));
                });
            } if (mapChartEventHandler.quickZoom) {
                mapChartEventHandler.quickZoom(function (value) {
                    if (data.allowInteraction) {
                        data.allowInteraction = false;
                        quickZoom(value);
                    }
                });
            } if (mapChartEventHandler.zoomStopped) {
                mapChartEventHandler.zoomStopped(function () {
                    if (panelMaps && panelMaps.length > 0) {
                        var args = { generation: generation, zoom: panelMaps[0].getZoom() };
                        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ZoomTo", JSON.stringify(args));
                    }
                });
            } if (!Spotfire.capabilities.supportsTouch()) {
                initScrollZoom(generation, data);
            } var highlightTimeout; var tooltipTimeout; var highlightDelay = 250; if (Spotfire.isProfessional()) {
                highlightDelay = 20;
            } var tooltipDelay = 250; if (Spotfire.Web !== undefined) { tooltipDelay = Spotfire.Web.tooltipDelay; } var mouseOverPoint;
            var tooltipPoint; var isLeftMouseButtonDown = false; var handleHighlight = function () {
                clearTimeout(highlightTimeout);
                var offset = viewport.offset(); var x = mouseOverPoint.x - offset.left; var y = mouseOverPoint.y - offset.top; var highlightPoint = new Point(x, y);
                var args = { highlightPoint: highlightPoint, generation: generation }; if (enableHighlight) {
                    Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "Highlight", JSON.stringify(args));
                }
            }; var handleMouseDown = function (e) { isLeftMouseButtonDown = Spotfire.Touch.leftMouseButtonDown(e); }; var handleMouseUp = function (e) {
                isLeftMouseButtonDown = false;
            }; var handleMouseLeave = function (e) {
                viewport.data("tooltip", false); clearTimeout(highlightTimeout); clearTimeout(tooltipTimeout);
                if (Spotfire.isProfessional()) { Spotfire.Visuals.Tooltip.hide(); } Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ClearHighlight", "{}");
            }; var handleMouseEnter = function (e) { viewport.data("tooltip", true); }; var handleMouseMove = function (e) {
                clearTimeout(highlightTimeout);
                if (isLeftMouseButtonDown) { return true; } var point = new Point(e.clientX, e.clientY); if (mouseOverPoint !== undefined && point.equals(mouseOverPoint)) {
                    return false;
                } clearTimeout(tooltipTimeout); highlightTimeout = setTimeout(handleHighlight, highlightDelay); mouseOverPoint = point;
                var getTooltip = function () {
                    if (!viewport.data("tooltip")) { return; } if (mouseOverPoint === undefined || !point.equals(mouseOverPoint)) {
                        return;
                    } var getTooltipCallback = function (tooltipText) {
                        if (!viewport.data("tooltip")) { return; } Spotfire.Visuals.Tooltip.showHtml(tooltipText);
                        window.setTimeout(function () {
                            var hideTooltip = function (evt) {
                                var currentPoint = new Point(evt.clientX, evt.clientY);
                                if (tooltipPoint !== undefined && currentPoint.equals(tooltipPoint)) { return false; } $(document.body).unbind("mousemove", hideTooltip);
                                Spotfire.Visuals.Tooltip.hide(); return true;
                            }; $(document.body).bind("mousemove", hideTooltip);
                        }, 100);
                    };
                    var offset = viewport.offset(); var x = e.clientX - offset.left; var y = e.clientY - offset.top; tooltipPoint = mouseOverPoint;
                    var args = { generation: generation, x: x, y: y }; Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "GetTooltip", JSON.stringify(args), getTooltipCallback);
                    if (Spotfire.isWebPlayer()) { handleHighlight(); }
                }; tooltipTimeout = setTimeout(getTooltip, tooltipDelay); return true;
            }; if (!Spotfire.capabilities.supportsTouch()) {
                interativLayer.mousemove(handleMouseMove); interativLayer.mousedown(handleMouseDown);
                interativLayer.mouseup(handleMouseUp); interativLayer.mouseleave(handleMouseLeave); interativLayer.mouseenter(handleMouseEnter);
            }
        }; initNavigationWidget = function (data, generation) {
            var navDiv = navigationWidgetPlaceholder; var marginTop = data.reservedAreaAtTop || 19;
            if (marginTop < 19) { marginTop = 19; } var marginLeft = 19; var navigationSize = 60; navDiv.css("position", "absolute");
            if (data.navigationControlToRight) { navDiv.css("right", marginLeft + "px"); } else {
                navDiv.css("left", marginLeft + "px");
            } navDiv.css("top", marginTop + "px"); navDiv.css("width", navigationSize + "px"); var navControl = new Spotfire.Visuals.MapChartVisualization.NavigationWidget(id + "_navWidget", { width: navigationSize, maxHeight: data.maxHeight, top: marginTop, panNavigationMode: data.panNavigationMode, markingMode: data.markingMode, showNavigationControl: data.showNavigationControls, showNavigationMode: data.showNavigationMode, isMobile: Spotfire.capabilities.supportsTouch(), navigationHelpText: data.helpText, disabled: data.allowInteraction, backgroundColor: data.backgroundColor, borderColor: data.borderColor, borderAlpha: data.borderAlpha, defaultColor: data.defaultColor, selectedColor: data.selectedColor, hoverColor: data.hoverColor, hoverBackgroundColor: data.hoverBackgroundColor, disabledColor: data.disabledColor, iconBackgroundColor: data.iconBackgroundColor, iconBorderColor: data.iconBorderColor, markingRectangle: data.markingRectangle, markingLasso: data.markingLasso, markingCircle: data.markingCircle, menuColor: data.menuColor, menuBackgroundColor: data.menuBackgroundColor, menuBorderColor: data.menuBorderColor, menuHoverBackgroundColor: data.menuHoverBackgroundColor, enableZoomIn: data.enableZoomIn, enableZoomOut: data.enableZoomOut }, data.minLevel, data.maxLevel, data.currentZoomLevel);
            navDiv.css("height", navControl.getHeight() + "px"); if (data.showNavigationMode) {
                navControl.navigationModeChanged(function (panNavigationMode) {
                    mapChartEventHandler.setPanAsDeafultMode(panNavigationMode);
                    var args = { panNavigationMode: panNavigationMode }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "SetPanAsDefaultMode", JSON.stringify(args));
                }); navControl.markingModeChanged(function (mode) {
                    var args = { markingMode: mode }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "SetMarkingMode", JSON.stringify(args));
                }); Spotfire.Focus.handleKeyDown(viewport, function (e) {
                    if (e.shiftKey) {
                        navControl.changeMarkingIcon(Spotfire.Visuals.Marking.Types.CIRCLE);
                    } else { if (e.altKey) { navControl.changeMarkingIcon(Spotfire.Visuals.Marking.Types.LASSO); } }
                }); Spotfire.Focus.handleKeyUp(viewport, function (e) {
                    if (e.keyCode === 16 || e.keyCode === 18) {
                        navControl.changeMarkingIcon(null);
                    }
                });
            } if (data.showNavigationControls) {
                navControl.reset(function () {
                    var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "Reset", JSON.stringify(args));
                }); navControl.panLeft(function () {
                    var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "MoveLeft", JSON.stringify(args));
                }); navControl.panRight(function () {
                    var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "MoveRight", JSON.stringify(args));
                }); navControl.panDown(function () {
                    var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "MoveDown", JSON.stringify(args));
                }); navControl.panUp(function () {
                    var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "MoveUp", JSON.stringify(args));
                }); navControl.zoomIn(function (value) {
                    quickZoom(-1); var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ZoomIn", JSON.stringify(args));
                }); navControl.zoomOut(function (value) {
                    quickZoom(1); var args = { generation: generation }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ZoomOut", JSON.stringify(args));
                }); navControl.zoomStopped(function (value) {
                    var args = { generation: generation, zoom: value }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ZoomTo", JSON.stringify(args));
                }); navControl.zoomChange(function (value) { quickZoom(Math.round(value), true); }); navControl.setEnableReset(data.enableReset);
                navControl.setEnableZoomIn(data.enableZoomIn); navControl.setEnableZoomOut(data.enableZoomOut); navControl.setEnableRight(data.enablePanRight);
                navControl.setEnableLeft(data.enablePanLeft); navControl.setEnableUp(data.enablePanUp); navControl.setEnableDown(data.enablePanDown);
            }
        }; initLayerHandlerWidget = function (data) {
            var layDiv = layerHandlerWidgetPlaceholder; var marginTop = data.reservedAreaAtTop || 19;
            if (marginTop < 19) { marginTop = 19; } var marginLeft = 19; var size = 182; var maxHeight = data.maxHeight - marginTop * 2;
            layDiv.attr("id", id + "_layerWidget"); layDiv.css("position", "absolute"); if (data.layerControlToRight) {
                layDiv.css("right", marginLeft + "px");
            } else { layDiv.css("left", marginLeft + "px"); } layDiv.css("top", marginTop + "px"); layDiv.css("width", size + "px");
            var options = {}; options.title = data.title; options.nameTitle = data.nameTitle; options.width = size; options.maxHeight = maxHeight;
            options.expanded = data.expandLayerHandler; options.isMobile = Spotfire.capabilities.supportsTouch(); options.helpInteractive = data.helpInteractive;
            options.helpVisibility = data.helpVisibility; options.headerBackgroundColor = data.headerBackgroundColor; options.headerColor = data.headerColor;
            options.backgroundColor = data.backgroundColor; options.defaultColor = data.defaultColor; options.borderColor = data.borderColor;
            options.hoverBackgroundColor = data.hoverBackgroundColor; options.checkboxColor = data.checkboxColor; options.checkboxBackgroundColor = data.checkboxBackgroundColor;
            options.checkboxBorderColor = data.checkboxBorderColor; options.iconBackgroundColor = data.iconBackgroundColor;
            options.iconBorderColor = data.iconBorderColor; var layerHandler = new Spotfire.Visuals.MapChartVisualization.LayerHandlerWidget(id + "_layerWidget", options, data.layers);
            layerHandler.interactiveChanged(function (layerId) {
                var args = { layerId: layerId }; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "InteractiveChanged", JSON.stringify(args));
            }); layerHandler.visiblityChanged(function (layerId, isChecked) {
                var args = { layerId: layerId, isChecked: isChecked };
                Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "VisibilityChanged", JSON.stringify(args));
            }); layerHandler.expandChanged(function (isExpanded) {
                var args = { isExpanded: isExpanded };
                Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "SetLayerHandlerShowHide", JSON.stringify(args));
            }); if (layerHandler.rightClick) {
                layerHandler.rightClick(function (layerId, x, y) {
                    var args = { isMouseUp: true, viewId: id, layerId: layerId, x: x, y: y };
                    if (Spotfire.isProfessional()) { PageBus.publish("spotfire.rightclick", JSON.stringify(args)); }
                });
            }
        }; initScrollZoom = function (generation, data) {
            var scrollDeltaY = 0;
            var startedScrolling = false; var mouseX, mouseY; var scrollEvent; var args; var doMouseWheelScroll = function () {
                if (data.allowScrollPage && !scrollEvent.shiftKey) {
                    args = { pages: scrollDeltaY };
                    Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ScrollPage", JSON.stringify(args));
                } else {
                    if (scrollEvent.shiftKey) {
                        args = { delta: (scrollDeltaY * -1) };
                        if (Spotfire.isProfessional()) {
                            Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ScrollMarkerSize", JSON.stringify(args));
                        }
                    } else {
                        if (data.allowInteraction) {
                            args = { generation: generation, x: mouseX, y: mouseY, zoom: (scrollDeltaY * -1) };
                            var enableZoom = args.zoom > 0 ? data.enableZoomIn : data.enableZoomOut; if (enableZoom) {
                                var $target = $(scrollEvent.currentTarget);
                                var x = args.x; var y = args.y; $target.children().each(function (index, child) {
                                    var $child = $(child); var panelIndex = 0;
                                    if ($child.attr("panel")) {
                                        if ($child.position().left < x && $child.position().top < y && $child.width() > x - $child.position().left && $child.height() > y - $child.position().top) {
                                            var panelMap = panelMaps[panelIndex];
                                            if (!panelMap) { return; } var zoom = panelMap.getZoom() - scrollDeltaY; var mousePosition = new T.Point(x + 2, y + 2);
                                            mousePosition.x = mousePosition.x - $child.position().left; mousePosition.y = mousePosition.y - $child.position().top;
                                            var point = panelMap.unproject(mousePosition.add(panelMap.getTopLeftInPixels())); $.each(panelMaps, function (mapIndex, map) {
                                                map.zoomAround(point, zoom, true);
                                            }); data.allowInteraction = false;
                                        } panelIndex++;
                                    }
                                }); Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ScrollZoom", JSON.stringify(args));
                            }
                        }
                    }
                } startedScrolling = false; scrollDeltaY = 0;
            }; var handleScrollWheel = function (e) {
                scrollEvent = e; mouseX = e.pageX - interativLayer.offset().left;
                mouseY = e.pageY - interativLayer.offset().top; Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "ClearHighlight", "");
                Spotfire.Visuals.Tooltip.hide(); scrollDeltaY += e.scrollWheelY; if (!startedScrolling) {
                    setTimeout(doMouseWheelScroll, 10);
                    startedScrolling = true;
                }
            }; if (!Spotfire.capabilities.supportsTouch()) {
                interativLayer.unscrollwheel(handleScrollWheel);
                interativLayer.scrollwheel(handleScrollWheel);
            }
        };
    };
});

// Trellis Visualization
$(function () {
    Spotfire.registerNameSpace("Visuals.TrellisVisualization");
    var TrellisObject; Spotfire.Visuals.TrellisVisualization.initialize = function (id) {
        var viewport = $("#" + id);
        var trellis = new TrellisObject(id); viewport.data("TrellisPlot", trellis); var args = { isProfessional: Spotfire.isProfessional() };
        Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, "Update", JSON.stringify(args));
    };

    Spotfire.Visuals.TrellisVisualization.update = function (id, generation) {
        var viewport = $("#" + id);
        var trellis = viewport.data("TrellisPlot"); if (trellis) {
            trellis.showProgressOverlay(); var args = { generation: generation };
            Spotfire.Dxp.Web.Forms.AjaxService.Read(id, "ReadTrellisData", JSON.stringify(args), function (data) {
                trellis.doUpdate(data, generation);
            });
        }
    };

    TrellisObject = function (id) {
        var viewport = $("#" + id); viewport.css("width", "100%"); viewport.css("height", "100%");
        var $background; var createSubPanel; this.doUpdate = function (data, generation) {
            if (!data) { return; } viewport.children("div").each(function () {
                if ($(this).attr("panel") !== undefined) {
                    if (data.clearView) {
                        $(this).get(0).innerHTML = "";
                        $(this).remove();
                    } else { $(this).attr("id", "-1"); $(this).attr("remove", true); }
                }
            }); var $curtain = $("<div></div>");
            $curtain.addClass("trellisVisualization curtain"); $curtain.css("background-color", data.backgroundColor);
            $curtain.attr("remove", true); $curtain.prependTo(viewport); if ($background && data.panels.length === 0) {
                $background.get(0).innerHTML = "";
                $background.remove();
            } else { if ($background && data.panels.length !== 0) { $background.attr("remove", true); } } $background = $("<div></div>");
            $background.addClass("trellisVisualization trellisBackground"); $background.css("background-image", "url(" + data.url + ")");
            $background.css("visibility", "hidden"); var panelIndex; for (panelIndex = 0; panelIndex < data.panels.length;
            panelIndex++) { createSubPanel(viewport, data.panels[panelIndex]); } $background.prependTo(viewport); if (data.panels.length === 0) {
                $background.css("visibility", "visible");
                $curtain.remove(); this.hideProgressOverlay();
            } if (data.postScript) { eval(data.postScript); } if (data.updateLegend) {
                Spotfire.Visuals.onUpdateLegend(viewport, {});
            }
        }; var $progressOverlay = null; var progressTimer = null; this.hideProgressOverlay = function () {
            if (progressTimer !== null) {
                window.clearTimeout(progressTimer);
                progressTimer = null;
            } $progressOverlay.css("visibility", "hidden"); $progressOverlay.detach();
        }; this.showProgressOverlay = function () {
            if ($progressOverlay !== null) {
                $progressOverlay.remove();
            } $progressOverlay = $(Spotfire.Progress.createProgressAnimation(viewport.innerWidth(), viewport.innerHeight()));
            $progressOverlay.attr("progress", true); $progressOverlay.css("visibility", "hidden"); var isProgressAppended = function () {
                return viewport.children(".progressAnimation").length !== 0;
            }; if (!isProgressAppended()) {
                if (progressTimer !== null) {
                    window.clearTimeout(progressTimer); progressTimer = null;
                } var showProgressInternal = function () {
                    progressTimer = null; $progressOverlay.css("visibility", "visible");
                }; progressTimer = window.setTimeout(showProgressInternal, 1000); $progressOverlay.css("visibility", "hidden");
                viewport.append($progressOverlay);
            }
        }; createSubPanel = function (parent, subPanel) {
            var panel = $("<div></div>");
            panel.attr("id", subPanel.parentId + subPanel.panelIndex); panel.css("overflow", "hidden"); panel.css("position", "absolute");
            panel.css("top", subPanel.bounds.Y + "px"); panel.css("left", subPanel.bounds.X + "px"); panel.css("width", subPanel.bounds.Width + "px");
            panel.css("height", subPanel.bounds.Height + "px"); panel.attr("panel", subPanel.panelIndex); panel.prependTo(parent);
            panel.css("visibility", "hidden"); return panel;
        };
    };
});

// MapChart Visualization - Layer Handler widget
$(function () {
    Spotfire.registerNameSpace("Visuals.MapChartVisualization");
    Spotfire.Visuals.MapChartVisualization.LayerHandlerWidget = function (containerId, options, layers) {
        var isExpanded = options.expanded === undefined ? false : options.expanded;
        var headerWidth = 91; options.title = options.title === undefined ? "" : options.title; options.width = options.width === undefined ? 150 : options.width;
        options.maxHeight = options.maxHeight === undefined ? 500 : options.maxHeight; options.isMobile = options.isMobile === undefined ? false : options.isMobile;
        options.colors = { headerBackground: options.headerBackgroundColor, header: options.headerColor, background: options.backgroundColor, "default": options.defaultColor, border: options.borderColor, hoverBackground: options.hoverBackgroundColor, checkbox: options.checkboxColor, checkboxBackground: options.checkboxBackgroundColor, checkboxBorder: options.checkboxBorderColor, checkboxDisabledOpacity: "0.5", iconBackground: options.iconBackgroundColor, iconBorder: options.iconBorderColor };
        var interactiveChangedInternal, visibilityChangedInternal, expandChangedInternal, rightClickInternal; this.interactiveChanged = function (func) {
            interactiveChangedInternal = func;
        }; this.visiblityChanged = function (func) { visibilityChangedInternal = func; }; this.expandChanged = function (func) {
            expandChangedInternal = func;
        }; this.rightClick = function (func) { rightClickInternal = func; }; var baseViewport = $("#" + containerId); if (!baseViewport) {
            throw ("Container id did not match any node in DOM");
        } var scrollFunc = function (e) { e.stopPropagation(); }; baseViewport.bind("DOMMouseScroll", scrollFunc); baseViewport.bind("mousewheel", scrollFunc);
        baseViewport.onmousewheel = scrollFunc; var viewport = $(document.createElement("div")); baseViewport.empty();
        baseViewport.append(viewport); viewport.css("position", "relative"); viewport.css("width", options.width);
        var titleDiv; var layerFrame; var headerDiv; var layerHolder; var layerHolderContainer; var headerImage; var initHeader;
        var initLayers; var position; var rawPosition; var htmlEncode; var titleHeight = 29; viewport.css("height", titleHeight + "px");
        function handleInteractiveChange() {
            var radio = $(this); if (!radio.hasClass("radio")) {
                radio = $(this).children(".radio").first();
            } $("svg", layerFrame.find(".layerHandlerWidget.radio")).hide(); $("svg", radio).show(); var id = radio.data("id");
            if (interactiveChangedInternal) { interactiveChangedInternal(id); } return false;
        } function handleVisibilityChange(e) {
            e.stopPropagation();
            var checkbox = $(this); checkbox.css("opacity", options.colors.checkboxDisabledOpacity); var id = checkbox.data("id");
            if (visibilityChangedInternal) {
                var isVisible = !checkbox.data("checked"); checkbox.data("checked", isVisible);
                this.checked = isVisible; visibilityChangedInternal(id, isVisible);
            } return false;
        } function show() {
            var rowHeight = 26;
            var preferedHeight = (layers.length + 1) * rowHeight + titleHeight; headerImage.addClass("expanded"); viewport.css("height", preferedHeight + "px");
            layerFrame = $("<div></div>"); layerFrame.css("overflow", "hidden"); layerFrame.addClass("layerHandlerWidget layerBox noSelection");
            layerFrame.css("position", "absolute"); layerFrame.css("left", "0px"); layerFrame.css("background-color", options.colors.background);
            layerFrame.css("color", options.colors["default"]); layerFrame.css("border-color", options.colors.border);
            var y = titleHeight + "px"; var w = options.width - 1 + "px"; layerFrame.css("top", y); var h = (layers.length + 1) * rowHeight + 1 + "px";
            layerFrame.css("height", h); layerFrame.css("width", w); viewport.append(layerFrame); headerDiv = $("<div></div>");
            layerFrame.append(headerDiv); initHeader(rowHeight); initLayers(rowHeight); if (expandChangedInternal) {
                expandChangedInternal(true);
            }
        } function hide() {
            viewport.css("height", titleHeight + "pt"); headerImage.removeClass("expanded"); if (layerFrame) {
                layerFrame.remove();
            } if (expandChangedInternal) { expandChangedInternal(false); }
        } function handleShowHideLayerHandler() {
            isExpanded = !isExpanded;
            if (isExpanded) { show(); } else { hide(); } return false;
        } function getSvg(url, element) {
            Spotfire.getSvg(url, (function ($el) {
                return function ($svg) {
                    $el.append($svg);
                };
            }(element)));
        } initLayers = function (height) {
            var marginTop = 6; var eventName = "click"; if (options.isMobile) {
                eventName = "touchstart";
            } layerHolder = $("<div></div>"); layerHolderContainer = $("<div></div>"); rawPosition(layerHolder, "0px", height + "px", options.width - 1 + "px", layers.length * height + 1 + "px");
            layerHolderContainer.css("position", "absolute"); layerHolderContainer.css("cursor", "default"); layerHolder.append(layerHolderContainer);
            layerFrame.append(layerHolder); var addScroll = height * (layers.length + 1) + titleHeight > options.maxHeight; layerHolder.css("overflow", addScroll ? "auto" : "hidden");
            var enterEvent = function () { $(this).css("background-color", options.colors.hoverBackground); }; var leaveEvent = function () {
                $(this).css("background-color", "inherit");
            }; var downEvent = function (e) {
                if (Spotfire.Touch.rightMouseButtonDown(e) && rightClickInternal) {
                    rightClickInternal($(this).data("id"), e.clientX, e.clientY);
                }
            }; var offsetY = 1; var index, layer, rowDiv, column1, column2, column3, encodedName, noOfCharToRemove; for (index = 0;
            index < layers.length; index++) {
                layer = layers[index]; rowDiv = $("<div></div>"); rawPosition(rowDiv, "0px", offsetY + "px", options.width - (addScroll ? 19 : 1) + "px", height + "px");
                rowDiv.addClass("layerHandlerWidget row"); layerHolderContainer.append(rowDiv); rowDiv.data("id", layer.id);
                rowDiv.mouseenter(enterEvent); rowDiv.mouseleave(leaveEvent); rowDiv.mousedown(downEvent); if (layer.allowInteractive) {
                    column1 = Spotfire.Filters.StyledFilters.createSvgRadio(13, 13);
                    column1.css("color", options.colors.checkbox); column1.css("background-image", options.colors.checkboxBackground);
                    column1.css("border-color", options.colors.checkboxBorder); if (!layer.isInteractive) {
                        $("svg", column1).hide();
                    } column1.removeClass("sf-element"); column1.addClass("layerHandlerWidget radio"); column1.data("id", layer.id);
                    if (!layer.enable || !layer.visible) { column1.css("opacity", options.colors.checkboxDisabledOpacity); } else {
                        rowDiv.bind(eventName, handleInteractiveChange);
                        column1.bind(eventName, handleInteractiveChange);
                    } rawPosition(column1, marginTop - 1 + "px", marginTop + "px", "11px", "11px");
                    rowDiv.append(column1);
                } column2 = $("<div></div>"); column2.addClass("layerHandlerWidget checkbox"); column2.data("checked", layer.enable);
                column2.css("color", options.colors.checkbox); column2.css("background-image", options.colors.checkboxBackground);
                column2.css("border-color", options.colors.checkboxBorder); if (layer.enable) {
                    getSvg("Images/Filters/CheckMark.svg", column2);
                } if (layer.visible) { column2.bind(eventName, handleVisibilityChange); } else {
                    column2.css("opacity", options.colors.checkboxDisabledOpacity);
                } column2.data("id", layer.id); column2.attr("type", "checkbox"); rawPosition(column2, 24 + marginTop - 1 + "px", marginTop + "px", "11px", "11px");
                rowDiv.append(column2); column3 = $("<div></div>"); column3.addClass("layerHandlerWidget displayName"); if (!layer.visible) {
                    column3.addClass(" disabled");
                } encodedName = htmlEncode(layer.name); column3.html(encodedName); column3.css("vertical-align", "bottom");
                rawPosition(column3, 48 + marginTop + "px", (marginTop + 1) + "px", options.width - 48 - marginTop * 2 - (addScroll ? 18 : 0) + "px", height - marginTop + "px");
                column3.css("width", "auto"); rowDiv.append(column3); noOfCharToRemove = 1; while (column3[0].clientWidth > options.width - 48 - marginTop * 2 - (addScroll ? 20 : 0)) {
                    column3.attr("title", encodedName);
                    column3.html(encodedName.substring(0, (addScroll ? 16 - noOfCharToRemove : 20 - noOfCharToRemove)) + "..."); noOfCharToRemove++;
                } offsetY += height;
            } if (addScroll) {
                viewport.css("height", options.maxHeight + "px"); layerFrame.css("height", options.maxHeight - titleDiv.outerHeight() + "px");
                layerHolder.css("height", (options.maxHeight - titleDiv.outerHeight() - headerDiv.outerHeight()) + "px"); if (options.isMobile) {
                    layerHolder.css("overflow", "scroll");
                    layerHolderContainer.css("height", layers.length * height + "px"); var scroll = new IScroll(layerHolderContainer.get(0), layerHolder.get(0), { bounce: false, hScrollbarEnabled: false, vScrollbarEnabled: true });
                    scroll.refresh();
                }
            }
        }; htmlEncode = function (html) {
            return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML;
        }; initHeader = function (height) {
            rawPosition(headerDiv, "0px", "0px", options.width - 1 + "px", height + "px"); headerDiv.addClass("layerHandlerWidget header noSelection");
            headerDiv.css("border-color", options.colors.border); var headerColumn1 = $("<div></div>"); headerColumn1.on("dragstart", function (event) {
                event.preventDefault();
            }); Spotfire.getSvg("Images/Plots/WebMapChart/LayerHandlerWidget/Pointer.svg", (function ($cb) {
                return function ($svg) {
                    $svg.find("[class=background]").css("fill", options.colors.iconBackground);
                    $svg.find("[class=border]").css("fill", options.colors.iconBorder); $cb.append($svg);
                };
            }(headerColumn1)));
            headerColumn1.attr("title", options.helpInteractive); rawPosition(headerColumn1, "8px", (height - 14) / 2 + "px", "8px", "14px");
            headerDiv.append(headerColumn1); var headerColumn2 = $("<div></div>"); headerColumn2.on("dragstart", function (event) {
                event.preventDefault();
            }); Spotfire.getSvg("Images/Plots/WebMapChart/LayerHandlerWidget/Eye.svg", (function ($cb) {
                return function ($svg) {
                    $svg.find("[class=background]").css("fill", options.colors.iconBorder);
                    $cb.append($svg);
                };
            }(headerColumn2))); headerColumn2.attr("title", options.helpVisibility); rawPosition(headerColumn2, 24 + 5 + "px", (height - 8) / 2 + "px", "14px", "8px");
            headerDiv.append(headerColumn2); var headerColumn3 = $("<div></div>"); headerColumn3.text(options.nameTitle);
            rawPosition(headerColumn3, 48 + 4 + "px", (height - 12) / 2 + "px", options.width - 56 + "px", 12 + "pt"); headerDiv.append(headerColumn3);
        }; function initTextTitle(clickFunction, height) {
            titleDiv = $("<div></div>"); var mouseDownFunction = function (e) {
                if (Spotfire.Touch.leftMouseButtonDown(e)) {
                    Spotfire.Touch.legacyTouchMouseCapture(titleDiv, function () {
                        return;
                    }, clickFunction);
                }
            }; if (options.isMobile) { titleDiv.bind("touchstart", mouseDownFunction); } else {
                titleDiv.mousedown(mouseDownFunction);
            } titleDiv.text(options.title); titleDiv.addClass("layerHandlerWidget textHeader"); titleDiv.css("background-color", options.colors.headerBackground);
            titleDiv.css("color", options.colors.header); titleDiv.css("border-color", options.colors.border); position(titleDiv, 0, 0, headerWidth - 14, 0);
            titleDiv.css("height", height - 14 + "px"); viewport.append(titleDiv); headerImage = $("<div></div>"); headerImage.addClass("layer-arrow");
            if (options.expanded) { headerImage.addClass("expanded"); } else { headerImage.removeClass("expanded"); } rawPosition(headerImage, "9px", "7px", "7px", "7px", true);
            titleDiv.append(headerImage);
        } position = function (element, x, y, width, height, useRightInsteadOfLeft) {
            rawPosition(element, x + "px", y + "px", width + "px", height + "px", useRightInsteadOfLeft);
        }; rawPosition = function (element, x, y, width, height, useRightInsteadOfLeft) {
            element.css("position", "absolute");
            element.css("top", y); if (useRightInsteadOfLeft) { element.css("right", x); } else { element.css("left", x); } element.css("width", width);
            element.css("height", height);
        }; initTextTitle(handleShowHideLayerHandler, titleHeight); if (options.expanded) {
            show();
        }
    };
});

// MapChart Visualization - navigation widget
$(function () {
    Spotfire.registerNameSpace("Visuals.MapChartVisualization");

    // navigation widget
    Spotfire.Visuals.MapChartVisualization.NavigationWidget = function (containerId, options, minLevel, maxLevel, activeZoomLevel) {
        var colors = {
            "default": options.defaultColor, hover: options.hoverColor, hoverBackground: options.hoverBackgroundColor, selected: options.selectedColor, disabled: options.disabledColor, background: options.backgroundColor, border: options.borderColor, borderAlpha: options.borderAlpha.toString(), iconBackground: options.iconBackgroundColor, iconBorder: options.iconBorderColor, menu: options.menuColor, menuBackground: options.menuBackgroundColor, menuBorder: options.menuBorderColor, menuHoverBackground: options.menuHoverBackgroundColor
        };

        var zoomLevels = maxLevel - minLevel + 1;
        var navigationWidget = this; 
        var isZooming = false; var marginBetweenNavZoomMode = 5;
        var navContainer = $("#" + containerId);
        navContainer.empty();
        var eventName = options.isMobile ? "touchstart" : "click";
        var rootNavWid = $("<div></div>");
        rootNavWid.addClass("navigation-widget"); 
        var boxHeight = (1.5 * options.width) + marginBetweenNavZoomMode + 20 + Math.floor(options.width / 7) * zoomLevels + Math.floor(options.width / 3) * 2 + (zoomLevels === 0 ? 3 : 0);

        if (!options.showNavigationMode) {
            boxHeight = options.width + marginBetweenNavZoomMode + 20 + Math.floor(options.width / 7) * zoomLevels + Math.floor(options.width / 3) * 2;
        }

        if (boxHeight + 20 > options.maxHeight) {
            zoomLevels = 0; boxHeight = (1.5 * options.width) + marginBetweenNavZoomMode + 20 + Math.floor(options.width / 3) * 2 + 3;
        }

        if (options.showNavigationMode && !options.showNavigationControl) {
            boxHeight = options.width / 2;
        }

        this.getHeight = function () {
            return boxHeight;
        };

        function position(jElement, x, y, width, height) {
            jElement.css("position", "absolute"); jElement.css("top", y + "px");
            jElement.css("left", x + "px"); jElement.css("width", width + "px"); jElement.css("height", height + "px");
        }
        
        position(rootNavWid, 0, 0, options.width, boxHeight);

        var rootNav = $("<div></div>");
        var enableReset = true;
        var enableLeft = true;
        var enableRight = true;
        var enableUp = true;
        var enableDown = true;
        var enableZoomIn = true;
        var enableZoomOut = true;
        var markingIcons = ["Images/Plots/WebMapChart/NavigationWidget/MarkingRectangle.svg", "Images/Plots/WebMapChart/NavigationWidget/MarkingLasso.svg", "Images/Plots/WebMapChart/NavigationWidget/MarkingRadius.svg"];
        var heightPerZoomLevel;
        var box; var zoomOutButton;
        var zoomInButton;
        var createNavigationControl;
        var createZoomBarControl;
        var createPanNavigationModeControl; 
        var openMarkingOptionsPopup;
        var measureText;
        var initBackgroundLayer;
        var initIconLayer; 
        var initZoomInButton;
        var removeHover;
        var addHover; var findElementAt;
        var updateSelectedMarkingIcon;

        function ZoomLevelIndicator(size, heightPerZoomLevel, zoomLevels) {
            var zoomStoppedFunction, zoomChangeFunction;
            navigationWidget.zoomStopped = function (func) { zoomStoppedFunction = func; }; navigationWidget.zoomChange = function (func) {
                zoomChangeFunction = func;
            }; var indicatorBox = $("<div></div>"); var lastSetZoomLevel; if (zoomLevels > 1) {
                var centerLine = $("<div></div>");
                centerLine.addClass("navigationWidgetNavRoot img"); centerLine.css("left", size / 2 - 3 + "px"); indicatorBox.append(centerLine);
                Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/ZoomLine.svg", (function ($cb) {
                    return function ($svg) {
                        $("#background", $svg).css("fill", colors.background);
                        $("#border", $svg).css("fill", colors.border); $("#border", $svg).css("fill-opacity", Number(colors.borderAlpha) - 0.2);
                        $svg.attr("height", Math.round(heightPerZoomLevel * zoomLevels) + 2); $cb.append($svg);
                    };
                }(centerLine))); box = $("<div></div>");
                box.addClass("navigationWidgetNavRoot img"); Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/ZoomThumb.svg", (function ($cb) {
                    return function ($svg) {
                        $cb.append($svg);
                        $("#background", box).css("fill", colors.background); $("#border", box).css("fill", colors.border); $("#border", box).css("fill-opacity", colors.borderAlpha);
                        $("#center", box).css("fill", colors["default"]);
                    };
                }(box))); box.css("top", "0"); box.css("left", "-1px"); box.css("display", "flex");
                indicatorBox.append(box); box.hover(function () {
                    if (enableZoomIn || enableZoomOut) {
                        $("#center", box).css("fill", colors.hover);
                    }
                }, function () { if (enableZoomIn || enableZoomOut) { $("#center", box).css("fill", colors["default"]); } }); var downEventName = options.isMobile ? "touchstart" : "mousedown";
                var moveEventName = options.isMobile ? "touchmove" : "mousemove"; var upEventName = options.isMobile ? "touchend" : "mouseup";
                var boxOffSet = 0; var handleMove = function (eventMove) {
                    if (options.isMobile) {
                        eventMove.clientY = eventMove.originalEvent.touches[0].pageY;
                    } var mouseY = eventMove.clientY - indicatorBox.offset().top - boxOffSet; mouseY = Math.max(0, mouseY); mouseY = Math.min(mouseY, (zoomLevels - 1) * heightPerZoomLevel);
                    box.css("top", mouseY + "px"); var newZoomLevel = zoomLevels - 1 - mouseY / heightPerZoomLevel; if (zoomChangeFunction) {
                        zoomChangeFunction(newZoomLevel);
                    }
                }; var handleMouseUp = function (eventUp) {
                    $(document).unbind(upEventName, handleMouseUp); $(document).unbind(moveEventName, handleMove);
                    isZooming = false; if (options.isMobile) { eventUp.clientY = eventUp.originalEvent.changedTouches[0].pageY; } var mouseY = eventUp.clientY - indicatorBox.offset().top - boxOffSet;
                    mouseY = Math.max(0, mouseY); mouseY = Math.min(mouseY, (zoomLevels - 1) * heightPerZoomLevel); var newZoomLevel = zoomLevels - 1 - Math.round(mouseY / heightPerZoomLevel);
                    var yPosition = (zoomLevels - newZoomLevel) * heightPerZoomLevel; box.css("top", yPosition + "px"); lastSetZoomLevel = newZoomLevel;
                    if (zoomStoppedFunction) { zoomStoppedFunction(newZoomLevel); }
                }; var handleMouseDown = function (eventDown) {
                    if (enableZoomIn || enableZoomOut) {
                        if (options.isMobile) {
                            eventDown.clientY = eventDown.originalEvent.touches[0].pageY;
                        } isZooming = true; boxOffSet = eventDown.clientY - box.offset().top; $(document).bind(upEventName, handleMouseUp);
                        $(document).bind(moveEventName, handleMove);
                    } return true;
                }; box.bind(downEventName, handleMouseDown);
            } this.getIndicatorBox = function () {
                return indicatorBox;
            }; navigationWidget.setZoomLevel = function (zoomLevel) {
                if (zoomLevel < minLevel || zoomLevel > maxLevel) {
                    return;
                } lastSetZoomLevel = zoomLevel; if (zoomLevels > 1) {
                    var yPosition = (maxLevel - zoomLevel) * heightPerZoomLevel; box.css("top", yPosition + "px");
                }
            }; navigationWidget.getZoomLevel = function () { return lastSetZoomLevel; };
        } 

        createNavigationControl = function (jElement) {
            var resetFunction, leftFunction, rightFunction, upFunction, downFunction;
            navigationWidget.reset = function (func) { resetFunction = func; }; navigationWidget.panLeft = function (func) {
                leftFunction = func;
            }; navigationWidget.panRight = function (func) { rightFunction = func; }; navigationWidget.panUp = function (func) {
                upFunction = func;
            }; navigationWidget.panDown = function (func) { downFunction = func; }; navigationWidget.changeMarkingIcon = function (markingMode) {
                updateSelectedMarkingIcon(markingMode, $(".markingModeIconContainer", jElement.parent()));
            }; var r = Math.floor(options.width / 2); var backgroundLayer = initBackgroundLayer(); backgroundLayer.appendTo(jElement);
            var arrowObjects = initIconLayer(r); arrowObjects.iconLayer.appendTo(jElement); var lastElement = null; jElement.mouseout(function () {
                if (lastElement !== null) {
                    removeHover(lastElement, arrowObjects);
                    lastElement = null;
                }
            }); var hoverFunction = function (e) {
                var position_current = { x: e.clientX - $(this).offset().left, y: e.clientY - $(this).offset().top };
                var element = findElementAt(position_current, options.width); if (element !== lastElement) {
                    removeHover(lastElement, arrowObjects);
                    addHover(element, arrowObjects); lastElement = element;
                }
            }; jElement.mousemove(hoverFunction); navigationWidget.reset();
            var clickFunction = function (e) {
                var position_current; if (options.isMobile) {
                    position_current = { x: e.originalEvent.touches[0].pageX - $(this).offset().left, y: e.originalEvent.touches[0].pageY - $(this).offset().top };
                } else { position_current = { x: e.clientX - $(this).offset().left, y: e.clientY - $(this).offset().top }; } var element = findElementAt(position_current, options.width);
                if (element === "center" && resetFunction && enableReset) { resetFunction(); } if (element === "left" && leftFunction && enableLeft) {
                    leftFunction();
                } if (element === "right" && rightFunction && enableRight) { rightFunction(); } if (element === "up" && upFunction && enableUp) {
                    upFunction();
                } if (element === "down" && downFunction && enableDown) { downFunction(); }
            }; jElement.bind(eventName, clickFunction);
            var applyDisable = function (element, value) {
                if (value) { element.css("color", colors["default"]); } else {
                    element.css("color", colors.disabled);
                }
            }; navigationWidget.setEnableReset = function (value) {
                enableReset = value; applyDisable(arrowObjects.resetImg, value);
            }; navigationWidget.getEnableReset = function () { return enableReset; }; navigationWidget.setEnableLeft = function (value) {
                enableLeft = value;
                applyDisable(arrowObjects.leftImg, value);
            }; navigationWidget.getEnableLeft = function () {
                return enableLeft;
            }; navigationWidget.setEnableRight = function (value) {
                enableRight = value; applyDisable(arrowObjects.rightImg, value);
            }; navigationWidget.getEnableRight = function () { return enableRight; }; navigationWidget.setEnableUp = function (value) {
                enableUp = value;
                applyDisable(arrowObjects.upImg, value);
            }; navigationWidget.getEnableUp = function () { return enableUp; }; navigationWidget.setEnableDown = function (value) {
                enableDown = value;
                applyDisable(arrowObjects.downImg, value);
            }; navigationWidget.getEnableDown = function () {
                return enableDown;
            };
        }; 

        function initZoomOutButton(size) {
            zoomOutButton = $("<div></div>"); zoomOutButton.addClass("navigationWidgetNavRoot img zoomButton");
            zoomOutButton.css("top", (marginBetweenNavZoomMode + size + (heightPerZoomLevel * zoomLevels)) + (zoomLevels === 0 ? 5 : 2) + "px");
            zoomOutButton.css("left", "18px"); Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/ZoomOut.svg", (function ($cb) {
                return function ($svg) {
                    $cb.append($svg);
                    $("#background", zoomOutButton).css("fill", colors.background); $("#background", zoomOutButton).css("stroke", colors.border);
                    $("#background", zoomOutButton).css("stroke-opacity", colors.borderAlpha); $("#center", zoomOutButton).css("fill", options.enableZoomOut ? colors["default"] : colors.disabled);
                };
            }(zoomOutButton))); zoomOutButton.hover(function () {
                if (!isZooming && enableZoomOut) {
                    $("#center", zoomOutButton).css("fill", colors.hover);
                }
            }, function () { if (enableZoomOut) { $("#center", zoomOutButton).css("fill", colors["default"]); } }); return zoomOutButton;
        }

        initZoomInButton = function (size) {
            zoomInButton = $("<div></div>"); zoomInButton.addClass("navigationWidgetNavRoot img");
            zoomInButton.css("top", "3px"); zoomInButton.css("left", "18px"); zoomInButton.css("display", "flex"); Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/ZoomIn.svg", (function ($cb) {
                return function ($svg) {
                    $cb.append($svg);
                    $("#background", zoomInButton).css("fill", colors.background); $("#background", zoomInButton).css("stroke", colors.border);
                    $("#background", zoomInButton).css("stroke-opacity", colors.borderAlpha); $("#center", zoomInButton).css("fill", options.enableZoomIn ? colors["default"] : colors.disabled);
                };
            }(zoomInButton))); zoomInButton.hover(function () {
                if (!isZooming && enableZoomIn) {
                    $("#center", zoomInButton).css("fill", colors.hover);
                }
            }, function () { if (enableZoomIn) { $("#center", zoomInButton).css("fill", colors["default"]); } }); return zoomInButton;
        };

        removeHover = function (elementId, arrowItems) {
            if (elementId === "center" && enableReset) {
                arrowItems.resetImg.css("color", colors["default"]);
            } if (elementId === "right" && enableRight) { arrowItems.rightImg.css("color", colors["default"]); } if (elementId === "left" && enableLeft) {
                arrowItems.leftImg.css("color", colors["default"]);
            } if (elementId === "up" && enableUp) { arrowItems.upImg.css("color", colors["default"]); } if (elementId === "down" && enableDown) {
                arrowItems.downImg.css("color", colors["default"]);
            }
        }; 
        
        addHover = function (elementId, arrowItems) {
            if (!isZooming) {
                if (elementId === "center" && enableReset) {
                    arrowItems.resetImg.css("color", colors.hover);
                } if (elementId === "right" && enableRight) { arrowItems.rightImg.css("color", colors.hover); } if (elementId === "left" && enableLeft) {
                    arrowItems.leftImg.css("color", colors.hover);
                } if (elementId === "up" && enableUp) { arrowItems.upImg.css("color", colors.hover); } if (elementId === "down" && enableDown) {
                    arrowItems.downImg.css("color", colors.hover);
                }
            }
        }; 
        
        findElementAt = function (position, width) {
            var height = width; var dy = position.y - width / 2; var dx = position.x - width / 2;
            var r = Math.sqrt(Math.pow(dy, 2) + Math.pow(dx, 2)); if (position.x > width / 3 && position.x < (width / 3) * 2 && position.y > height / 3 && position.y < (height / 3) * 2 && r <= width / 6) {
                return "center";
            } if (position.x > position.y && position.x > position.y * -1 + width && r <= width / 2) { return "right"; } if (position.x > position.y && position.x <= position.y * -1 + width && r <= width / 2) {
                return "up";
            } if (position.x <= position.y && position.y > position.x * -1 + height && r <= width / 2) { return "down"; } if (position.x <= position.y && position.y <= position.x * -1 + height && r <= width / 2) {
                return "left";
            } return null;
        };

        initBackgroundLayer = function () {
            var backgroundLayer = $("<div></div>"); backgroundLayer.css("fill", colors.background);
            backgroundLayer.css("stroke", colors.border); backgroundLayer.css("stroke-opacity", colors.borderAlpha);
            backgroundLayer.on("dragstart", function (event) { event.preventDefault(); }); position(backgroundLayer, -10, -10, options.width, options.width);
            Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/NavRoot.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(backgroundLayer))); return backgroundLayer;
        }; 

        initIconLayer = function () {
            var result = {}; var iconLayer = $("<div></div>");
            position(iconLayer, 0, 0, options.width, options.width); var margin = Math.floor(options.width * 0.08); var upImg = $("<div></div>");
            upImg.addClass("navigationWidgetNavRoot img"); upImg.css("top", margin + 1 + "px"); upImg.css("left", (options.width / 2) - 6 + "px");
            upImg.css("color", colors["default"]); upImg.appendTo(iconLayer); result.upImg = upImg; Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Up.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(upImg))); var leftImg = $("<div></div>"); leftImg.addClass("navigationWidgetNavRoot img"); leftImg.css("left", margin + 3 + "px");
            leftImg.css("top", (options.width / 2) - 6 + "px"); leftImg.css("color", colors["default"]); leftImg.appendTo(iconLayer);
            result.leftImg = leftImg; Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Left.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(leftImg))); var downImg = $("<div></div>"); downImg.addClass("navigationWidgetNavRoot img"); downImg.css("bottom", margin + 1 + "px");
            downImg.css("left", (options.width / 2) - 6 + "px"); downImg.css("color", colors["default"]); downImg.appendTo(iconLayer);
            result.downImg = downImg; Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Down.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(downImg))); var rightImg = $("<div></div>"); rightImg.addClass("navigationWidgetNavRoot img"); rightImg.css("right", margin + 3 + "px");
            rightImg.css("top", (options.width / 2) - 6 + "px"); rightImg.css("color", colors["default"]); rightImg.appendTo(iconLayer);
            result.rightImg = rightImg; Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Right.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(rightImg))); var resetImg = $("<div></div>"); resetImg.addClass("navigationWidgetNavRoot img"); resetImg.css("top", (options.width / 2) - 6 + "px");
            resetImg.css("left", (options.width / 2) - 4 + "px"); resetImg.css("color", colors["default"]); resetImg.appendTo(iconLayer);
            result.resetImg = resetImg; Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Reset.svg", (function (container) {
                return function ($svg) {
                    container.append($svg);
                };
            }(resetImg))); result.iconLayer = iconLayer; return result;
        }; 
        
        updateSelectedMarkingIcon = function (markingMode, container) {
            if ($("svg", container).length > 1) {
                ($("svg", container)[0]).remove();
            } if (options.isMobile) { Spotfire.getSvg(markingIcons[1], function ($svg) { container.prepend($svg); }); } else {
                if (markingMode) {
                    Spotfire.getSvg(markingIcons[markingMode], function ($svg) {
                        container.prepend($svg);
                    });
                } else {
                    Spotfire.getSvg(markingIcons[options.markingMode], function ($svg) { container.prepend($svg); });
                }
            }
        }; 
        
        measureText = function (canvas, element) {
            var context = canvas.getContext("2d"); context.font = window.getComputedStyle(element, null).getPropertyValue("font");
            var textMetrics = context.measureText(element.innerHTML); return textMetrics.width;
        }; 
        
        openMarkingOptionsPopup = function (jElement, markingModeChangeEvent) {
            if ($(".markingOptionsPopup").length > 0) {
                return;
            } var popup = $("<div></div>"); popup.addClass("markingOptionsPopup"); popup.css("background-color", colors.menuBackground);
            popup.css("border-color", colors.menuBorder); var createOption = function (markingText, markingIconUrl, markingType) {
                var $option = $("<div></div>");
                var $optionIcon = $("<div></div>"); var $optionLabel = $("<div></div>"); $optionIcon.addClass("markingOptionIcon");
                $optionLabel.addClass("markingOptionLabel"); $option.addClass("markingOption"); $option.css("color", colors.menu);
                Spotfire.getSvg(markingIconUrl, function ($svg) { $optionIcon.append($svg); }); $optionLabel.append(markingText);
                $optionIcon.appendTo($option); $optionLabel.appendTo($option); $option.appendTo(popup); $option.hover(function () {
                    $option.css("background-color", colors.menuHoverBackground);
                }, function () { $option.css("background-color", colors.menuBackground); }); $option.click(function () {
                    markingModeChangeEvent(markingType);
                    $(".markingOptionsPopup", jElement).remove();
                });
            }; createOption(options.markingRectangle, markingIcons[0], Spotfire.Visuals.Marking.Types.RECTANGLE);
            createOption(options.markingLasso, markingIcons[1], Spotfire.Visuals.Marking.Types.LASSO); createOption(options.markingCircle, markingIcons[2], Spotfire.Visuals.Marking.Types.CIRCLE);
            popup.appendTo($(".frame", jElement)); var onMouseUp = function (e) {
                var container = $(".markingOptionsPopup", jElement);
                if (!container.is(e.target) && container.has(e.target).length === 0) {
                    container.remove(); $(document).off("mouseup", onMouseUp);
                }
            }; var popupOutOfBounds = popup.height() - (jElement.offset().top - options.top - popup.offset().top + options.maxHeight - 10);
            if (popupOutOfBounds > 0) {
                popup.css("top", parseInt(popup.css("top"), 10) - popupOutOfBounds); popup.css("right", "61px");
            } var maxLabelWidth = 0; var canvas = document.createElement("canvas"); $(".markingOptionLabel", jElement).each(function (i, el) {
                maxLabelWidth = Math.max(maxLabelWidth, measureText(canvas, el));
            }); var iconSize = 14; var safetyGap = 5; var popupWidth = maxLabelWidth + iconSize + safetyGap + parseInt($(".markingOptionIcon").css("margin-right"), 10) + parseInt($(".markingOption").css("padding-left"), 10) * 2;
            $(".markingOptionsPopup", jElement).width(popupWidth); $(document).mouseup(onMouseUp);
        }; 

        createPanNavigationModeControl = function (jElement) {
            var panModeChangeEvent, markModeChangeEvent;
            navigationWidget.navigationModeChanged = function (func) { panModeChangeEvent = func; }; navigationWidget.markingModeChanged = function (func) {
                markModeChangeEvent = func;
            }; var frame = $("<div></div>"); frame.addClass("navigationWidget frame"); Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/NavModeBg.svg", (function (container) {
                return function ($svg) {
                    $svg.find("[class=background-left]").css("fill", colors.selected);
                    $svg.find("[class=background-right]").css("fill", colors.background); $("#border", $svg).css("fill", colors.border);
                    $("#border", $svg).css("fill-opacity", colors.borderAlpha); $("#separator", $svg).css("fill", colors.border);
                    if (options.panNavigationMode) {
                        $svg.find("[class=background-left]").css("fill", colors.background); $svg.find("[class=background-right]").css("fill", colors.selected);
                    } container.append($svg);
                };
            }(frame))); jElement.append(frame); var pointerButton = $("<div></div>"); pointerButton.addClass("navigationWidget pointerButton");
            frame.append(pointerButton); var pointerImage = $("<div></div>"); pointerImage.addClass("markingModeIconContainer");
            pointerImage.css("color", colors.iconBorder); pointerImage.on("dragstart", function (event) {
                event.preventDefault();
            }); updateSelectedMarkingIcon(options.markingMode, pointerImage); if (!options.isMobile) {
                Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/SubmenuArrow.svg", function ($svg) {
                    position($svg, 15, 15);
                    pointerImage.append($svg);
                });
            } position(pointerImage, 7, 6, 19, 18); pointerButton.append(pointerImage); var panButton = $("<div></div>");
            panButton.addClass("navigationWidget panButton"); frame.append(panButton); var panImage = $("<div></div>");
            panImage.on("dragstart", function (event) { event.preventDefault(); }); Spotfire.getSvg("Images/Plots/WebMapChart/NavigationWidget/Hand.svg", (function (container) {
                return function ($svg) {
                    $svg.find("[class=background]").css("fill", colors.iconBackground);
                    $svg.find("[class=border]").css("fill", colors.iconBorder); container.append($svg);
                };
            }(panImage))); if (options.disabled) {
                panImage.css("fill-opacity", "0.4");
            } position(panImage, 9, 6, 11, 15); panButton.append(panImage); var pointClick = function (e) {
                e.preventDefault();
                if (options.panNavigationMode) {
                    options.panNavigationMode = false; if (panModeChangeEvent) {
                        panModeChangeEvent(false);
                    } panButton.removeClass("selected"); pointerButton.addClass("selected");
                } else {
                    if (!options.isMobile) {
                        openMarkingOptionsPopup(jElement, markModeChangeEvent);
                    }
                }
            }; pointerButton.bind(eventName, pointClick); if (!options.disabled) {
                var panClick = function (e) {
                    e.preventDefault();
                    if (!options.panNavigationMode) {
                        options.panNavigationMode = true; if (panModeChangeEvent) {
                            panModeChangeEvent(true);
                        } pointerButton.removeClass("selected"); panButton.addClass("selected");
                    }
                }; panButton.bind(eventName, panClick);
            }
        }; 

        createZoomBarControl = function (jElement) {
            var zoomInFunction, zoomOutFunction; navigationWidget.zoomIn = function (func) {
                zoomInFunction = func;
            }; navigationWidget.zoomOut = function (func) { zoomOutFunction = func; }; var zoomBarHolder = $("<div></div>"); zoomBarHolder.bind("mousedown", function () {
                return true;
            }); position(zoomBarHolder, -1, options.width + marginBetweenNavZoomMode, options.width + 2, options.width * 3);
            jElement.append(zoomBarHolder); var size = Math.floor(options.width / 3); heightPerZoomLevel = Math.floor(options.width / 7);
            if (options.maxHeight < (heightPerZoomLevel * zoomLevels) + (options.width * 2) + 15) { zoomLevels = 0; } var zoomLevelIndicator = new ZoomLevelIndicator(size, heightPerZoomLevel, zoomLevels);
            position(zoomLevelIndicator.getIndicatorBox(), size + 1, marginBetweenNavZoomMode + size + 2, size, heightPerZoomLevel * zoomLevels);
            zoomBarHolder.append(zoomLevelIndicator.getIndicatorBox()); var zoomInButton_ = initZoomInButton(size); zoomBarHolder.append(zoomInButton_);
            var zoomOutButton_ = initZoomOutButton(size); zoomBarHolder.append(zoomOutButton_); zoomInButton_.bind(eventName, function () {
                if (enableZoomIn) {
                    var oldZoomLevel = navigationWidget.getZoomLevel();
                    if (oldZoomLevel + 1 > maxLevel) { return; } navigationWidget.setZoomLevel(oldZoomLevel + 1); zoomInFunction(navigationWidget.getZoomLevel());
                }
            }); zoomOutButton_.bind(eventName, function () {
                if (enableZoomOut) {
                    var oldZoomLevel = navigationWidget.getZoomLevel();
                    if (oldZoomLevel - 1 < minLevel) { return; } navigationWidget.setZoomLevel(oldZoomLevel - 1); zoomOutFunction(navigationWidget.getZoomLevel());
                }
            }); navigationWidget.setZoomLevel(activeZoomLevel); navigationWidget.setEnableZoomIn = function (value) {
                enableZoomIn = value;
                if (value) { $("#center", zoomInButton).css("fill", colors["default"]); } else {
                    $("#center", zoomInButton).css("fill", colors.disabled);
                } if (zoomLevels > 1) {
                    if (enableZoomIn || enableZoomOut) { box.removeClass("disabled"); } else {
                        box.addClass("disabled");
                    }
                }
            }; navigationWidget.getEnableZoomIn = function () { return enableZoomIn; }; navigationWidget.setEnableZoomOut = function (value) {
                enableZoomOut = value;
                if (value) { $("#center", zoomOutButton).css("fill", colors["default"]); } else {
                    $("#center", zoomOutButton).css("fill", colors.disabled);
                } if (zoomLevels > 1) {
                    if (enableZoomIn || enableZoomOut) { box.removeClass("disabled"); } else {
                        box.addClass("disabled");
                    }
                }
            }; navigationWidget.getEnableZoomOut = function () { return enableZoomOut; };
        }; 
        
        if (options.showNavigationControl) {
            createNavigationControl(rootNav);
            rootNav.appendTo(rootNavWid); rootNav.attr("title", options.navigationHelpText); var zoomBar = $("<div></div>");
            createZoomBarControl(zoomBar); zoomBar.appendTo(rootNavWid); zoomBar.attr("title", options.navigationHelpText);
        }

        if (options.showNavigationMode) { createPanNavigationModeControl(rootNavWid); } navContainer.append(rootNavWid);
    };
});

// String.endsWith()
String.prototype.endsWith = function (ending) {
    return this.indexOf(ending, this.length - ending.length) !== -1;
};

// String.clip()
String.prototype.clip = function (index) {
    if (this.length <= index) {
        return this;
    }

    return this.substring(0, index);
};

// Filter panel controls
$(function () {
    var promptIndex = 0; var numPages;
    var $view, $pageContent, $pageFooter, $pageHeader;
    var prompt, decimalSeparator;
    var loadPage = null;

    var parseDate = function (str) {
        return new Date(+str.match(/Date\((\-?\d+)\)/)[1]);
    };

    var formatDateAndTime = function (value, callback) {
        prompt.read("FormatDateAndTime", JSON.stringify({ value: value }), function (result) {
            callback(result.localizedDate, result.localizedTime);
        });
    };

    var parseDateAndTime = function (date, time, callback) {
        prompt.read("ParseDateAndTime", JSON.stringify({
        date: date, time: time }), function (result) {
            callback(result.validDate, result.validTime, result.value ? parseDate(result.value) : null);
        });
    };

    var validation = function (arg) {
        if (typeof arg === "function") {
            $view.on("sf-connection-prompt-validation", function (event, data) {
                if (data.promptIndex === undefined || data.promptIndex === promptIndex) {
                    arg({
                    isValid: data.isValid,
                    errorMessages: data.errorMessages || [],
                    validatedValues: data.validatedValues || [] });
                }
            });
        } else {
            $view.trigger("sf-connection-prompt-validation", arg);
        }
    };

    function BooleanControl(currentValue) {
        var self = {};
        self.onChange = _.noop; 
        
        var dummyName = Spotfire.newFakeGuid(); 
        var $true = $("<input type='radio'/>").attr("name", dummyName);
        var $false = $("<input type='radio'/>").attr("name", dummyName);

        var $trueContainer = $("<label>").addClass("sf-connection-prompt-radio");
        $trueContainer.append($true).append($("<span>").text(Spotfire.Localization.resources.Prompt_True));

        var $container = $("<form/>"); 
        $container.append($trueContainer);

        var $falseContainer = $("<label/>").addClass("sf-connection-prompt-radio"); 
        $falseContainer.append($false).append($("<span/>").text(Spotfire.Localization.resources.Prompt_False));
        $container.append($falseContainer);

        var radioButtonChange = function () {
            self.onChange($true.prop("checked").toString());
        };

        if (currentValue === true) {
            $true.prop("checked", true);
            _.defer(radioButtonChange);
        }
        else {
            if (currentValue === false) {
                $false.prop("checked", true);
                _.defer(radioButtonChange);
            }
        }

        $true.change(radioButtonChange);

        $false.change(radioButtonChange);
        Spotfire.Filters.StyledFilters.createStyledInput($container, 13, 13);
        self.onValidation = _.noop;

        self.elem = function () {
            return $container;
        };

        return self;
    }

    function CalendarControl(dataType, currentValue) {
        var self = {};
        self.onChange = _.noop; var $container = Spotfire.Flex.item({ container: "horizontal" }); var $combobox = Spotfire.Flex.item({ container: "horizontal" }).addClass("sf-element-combobox sf-connection-prompt-calendar");
        var $dateInputContainer = Spotfire.Flex.item({ grow: true }).addClass("sf-element-text-box"); var $dateInput = $("<input type='text'/>").addClass("ComboBoxSearchField");
        var $comboboxButton = Spotfire.Flex.item().addClass("sf-element-combobox-button"); var $comboboxIcon = $("<span>").addClass("sf-element-icon");
        $comboboxButton.attr("title", Spotfire.Localization.resources.Prompt_ClickToSelectDate); $dateInputContainer.append($dateInput);
        $combobox.append($dateInputContainer); $comboboxButton.append($comboboxIcon); $combobox.append($comboboxButton);
        var $timeInput = $("<input type='text'/>").addClass("sf-element-input sf-connection-prompt-time"); if (dataType.name === "DateTime" || dataType.name === "Date") {
            $container.append($combobox);
        } if (dataType.name === "DateTime" || dataType.name === "Time") { $container.append($timeInput); } if (currentValue) {
            formatDateAndTime(currentValue, function (localizedDate, localizedTime) {
                $dateInput.val(localizedDate);
                $timeInput.val(localizedTime); validation({ isValid: true });
            });
        } else {
            formatDateAndTime(new Date(1970, 0), function (localizedDate, localizedTime) {
                $timeInput.val(localizedTime);
                if (dataType.name === "Time") { $dateInput.val(localizedDate); validation({ isValid: true }); }
            });
        } var parseCallback = function (validDate, validTime, value) {
            $timeInput.toggleClass("sf-invalid", !validTime);
            var hasDateInput = $dateInput.val().trim() !== ""; $dateInputContainer.toggleClass("sf-invalid", hasDateInput && !validDate);
            currentValue = value; self.onChange(value);
        }; var inputHandler = function () {
            validation({ isValid: false }); parseDateAndTime($dateInput.val(), $timeInput.val(), parseCallback);
        }; $dateInput.on("input", inputHandler); $timeInput.on("input", inputHandler); $comboboxButton.click(function () {
            var offset = $combobox.offset();
            var datePicker = new DatePicker(currentValue || new Date(), offset.left, offset.top + $combobox.outerHeight());
            datePicker.onValueChanged = function () {
                validation({ isValid: false }); formatDateAndTime(datePicker.getValue(), function (localizedDate) {
                    $dateInput.val(localizedDate);
                    parseDateAndTime(localizedDate, $timeInput.val(), parseCallback);
                });
            };
        }); self.onValidation = _.noop; self.elem = function () {
            return $container;
        }; return self;
    }

    function TextControl(dataType, currentValue) {
        var self = {}; self.onChange = _.noop; var $container = $("<div/>");
        var $input = $("<input type='text'/>").addClass("sf-connection-prompt-free-text sf-element-input").appendTo($container);
        var $errorMessage = $("<div/>").html("&nbsp;").addClass("sf-error-message").appendTo($container); if (currentValue) {
            $input.val(currentValue);
        } var handleInput = function () {
            var text = $input.val(); var isValid = false, errorMessage = null; switch (dataType.name) {
                case "Long": case "Integer": text = $.trim(text);
                    isValid = text.match(/^-?\d+$/) !== null; if (isValid) {
                        var parsed = parseInt(text, 10); isValid = parsed >= dataType.minValue && parsed <= dataType.maxValue;
                        if (!isValid) {
                            var format = Spotfire.Localization.resources.Prompt_ErrorNumberOutsideRange; errorMessage = Spotfire.Utilities.formatString(format, dataType.minValue, dataType.maxValue);
                        }
                    } else { errorMessage = Spotfire.Localization.resources.Prompt_ErrorProvideInteger; } break; case "Float": case "Double": case "Decimal": text = $.trim(text);
                        isValid = text.match(new RegExp("^-?\\d+(" + decimalSeparator + "\\d+)?$")) !== null; if (!isValid) {
                            errorMessage = Spotfire.Localization.resources.Prompt_ErrorProvideNumber;
                        } break; case "TimeSpan": text = $.trim(text); isValid = text.length !== 0; break; case "String": isValid = $.trim(text).length !== 0;
                            break;
            } self.onValidation(isValid, errorMessage, text); self.onChange(isValid ? text : null);
        }; $input.on("input", handleInput);
        self.onValidation = function (isValid, errorMessage, validatedValue) {
            if (validatedValue !== $.trim($input.val())) {
                return;
            } if (isValid) { $errorMessage.html("&nbsp;"); $input.removeClass("sf-invalid"); } else {
                if (errorMessage) {
                    $errorMessage.text(errorMessage);
                    $input.addClass("sf-invalid");
                }
            }
        }; self.elem = function () { return $container; }; return self;
    }

    var createInputControl = function (dataType, currentValue) {
        switch (dataType.name) {
            case "Boolean":
                return new BooleanControl(currentValue);
            case "Date":
            case "DateTime":
            case "Time":
                return new CalendarControl(dataType, currentValue);
            default:
                return new TextControl(dataType, currentValue);
        }
    };

    var submitValues = function (values, submitIndex) {
        if (submitIndex === promptIndex) {
            var args = { index: promptIndex, values: values };
            prompt.modify("SetValues", JSON.stringify(args));
        }
    };

    submitValues = _.debounce(submitValues, 250); var renderHeader = function () {
        $pageHeader.empty();
        var format = Spotfire.Localization.resources.Prompt_StepIndication; var text = Spotfire.Utilities.formatString(format, promptIndex + 1, numPages);
        $pageHeader.text(text);
    };

    var separator = function () {
        return $("<span/>").addClass("sf-separator");
    };

    var renderFooter = function (buttons) {
        $pageFooter.empty();
        _.each(buttons, function ($b) { $pageFooter.append($b); }); var $cancelButton = $("<button/>").addClass("sf-element-button sfpc-secondary").text(Spotfire.Localization.resources.Cancel);
        $cancelButton.click(function () { prompt.cancel(); }); $pageFooter.append($cancelButton);
    };

    var renderSelect = function ($container, page) {
        var renderedIndex = promptIndex;
        var $instructionLabel = $("<div/>").addClass("sf-connection-prompt-instruction").appendTo($pageContent);
        var format; if (page.maxSelection === null) {
            format = Spotfire.Localization.resources.Prompt_SelectXOrMoreValues;
        } else {
            if (page.maxSelection === 1 && page.minSelection === 1) {
                format = Spotfire.Localization.resources.Prompt_SelectOneValue;
            } else {
                if (page.maxSelection === page.minSelection) {
                    format = Spotfire.Localization.resources.Prompt_SelectXValues;
                } else { format = Spotfire.Localization.resources.Prompt_SelectXToYValues; }
            }
        } $instructionLabel.text(Spotfire.Utilities.formatString(format, page.minSelection, page.maxSelection));
        var $listboxContainer = Spotfire.Flex.item({ grow: true }).appendTo($container); var $errorMessage = $("<div/>").addClass("sf-error-message").html("&nbsp").appendTo($container);
        var generation = 0; var listbox = null, $listbox = null; var searchExpression = ""; validation(function (data) {
            if (data.errorMessages[0]) {
                $errorMessage.text(data.errorMessages[0]);
            } else { $errorMessage.html("&nbsp;"); }
        }); var totalVisibleValues = page.totalItemCount; var listBoxSettings = {
            showSearchField: true, showImageMask: false, multiSelect: !(page.minSelection === 1 && page.maxSelection === 1), totalVisibleValues: totalVisibleValues, onSelectionChanged: function (selection) {
                if (promptIndex !== renderedIndex) {
                    return;
                } validation(false); var value = { index: promptIndex, method: "Select", pendingSelects: selection, generation: generation };
                prompt.modify("Select", JSON.stringify(value));
            }, onGetValues: function (low, high, callback) {
                var args = { index: promptIndex, searchExpression: searchExpression, low: low, high: Math.ceil(high), generation: generation };
                var getValuesCallback = function (result) { generation = result.generation; callback(result); }; prompt.read("GetVisibleItems", JSON.stringify(args), getValuesCallback);
            }, onSearch: function (searchString) {
                searchExpression = searchString; var args = { index: promptIndex, searchExpression: searchString, low: 0, high: 0 };
                prompt.read("GetVisibleItems", JSON.stringify(args), function (result) {
                    listbox.setScrollPosition(0); listbox.update({ totalVisibleValues: result.totalVisibleValues });
                });
            }
        }; _.defer(function () {
            $listbox = $("<div/>").addClass("sf-connection-prompt-select").appendTo($listboxContainer);
            listbox = Spotfire.Controls.VirtualListBox.create($listbox, listBoxSettings); listbox.adjustHeightToContainer($listboxContainer);
            $view.on("sf-resize", function () { listbox.adjustHeightToContainer($listboxContainer); });
        });
    };
    
    var renderRange = function ($container, page) {
        var $instructionLabel = $("<div/>").addClass("sf-connection-prompt-instruction").appendTo($pageContent);
        $instructionLabel.text(Spotfire.Localization.resources.Prompt_SpecifyRange); var fromValue = null; var toValue = null;
        var renderedIndex = promptIndex; if (page.values.length !== 0) {
            fromValue = page.dataType.isTime ? parseDate(page.values[0]) : page.values[0];
            toValue = page.dataType.isTime ? parseDate(page.values[1]) : page.values[1];
        } var isValidRange = function () {
            if (fromValue === null || toValue === null) {
                return false;
            } if (page.dataType.isTime) { return fromValue <= toValue; } if (page.dataType.name === "Integer" || page.dataType.name === "Long") {
                return parseInt(fromValue, 10) <= parseInt(toValue, 10);
            } return true;
        }; var submit = function () {
            validation({ isValid: false, validatedValues: [fromValue, toValue] });
            if (isValidRange()) { submitValues([fromValue, toValue], renderedIndex); }
        }; var $fromContainer = $("<div/>").addClass("sf-connection-prompt-range");
        var $fromLabel = $("<div/>").addClass("sf-connection-prompt-label").text(Spotfire.Localization.resources.Prompt_FromLabel);
        var fromControl = createInputControl(page.dataType, fromValue); fromControl.onChange = function (value) {
            fromValue = value;
            submit();
        }; $fromContainer.append($fromLabel); $fromContainer.append(fromControl.elem()); var $toContainer = $("<div/>").addClass("sf-connection-prompt-range");
        var $toLabel = $("<div/>").addClass("sf-connection-prompt-label").text(Spotfire.Localization.resources.Prompt_ToLabel);
        var toControl = createInputControl(page.dataType, toValue); toControl.onChange = function (value) {
            toValue = value;
            submit();
        }; $toContainer.append($toLabel); $toContainer.append(toControl.elem()); var $rangeContainer = $("<div/>").addClass("sf-connection-prompt-range-container");
        $rangeContainer.append($fromContainer); $rangeContainer.append($toContainer); $rangeContainer.appendTo($container);
        $container.append($rangeContainer); validation(function (data) {
            fromControl.onValidation(data.isValid, data.errorMessages[0], data.validatedValues[0]);
            toControl.onValidation(data.isValid, data.errorMessages[1], data.validatedValues[1]);
        });
    };

    var renderFreeText = function ($container, page) {
        var renderedIndex = promptIndex;
        var $instructionLabel = $("<div/>").addClass("sf-connection-prompt-instruction").appendTo($pageContent);
        var resource = "Prompt_Specify" + page.dataType.name; if (!Spotfire.Localization.resources.hasOwnProperty(resource)) {
            resource = "Prompt_SpecifyValue";
        } $instructionLabel.text(Spotfire.Localization.resources[resource]); var currentValue = null; if (page.values.length !== 0) {
            currentValue = page.dataType.isTime ? parseDate(page.values[0]) : page.values[0];
        } var inputControl = createInputControl(page.dataType, currentValue); inputControl.onChange = function (value) {
            validation({ isValid: false, validatedValues: [value] });
            if (value !== null) { submitValues([value], renderedIndex); }
        }; validation(function (data) {
            inputControl.onValidation(data.isValid, data.errorMessages[0], data.validatedValues[0]);
        }); $container.append(inputControl.elem());
    };

    var renderPage = function (page) {
        var $okButton = $("<button/>").addClass("sf-element-button").text(numPages === 1 ? Spotfire.Localization.resources.Ok : Spotfire.Localization.resources.Finish);
        var $backButton = $("<button/>").addClass("sf-element-button sfpc-secondary").text(Spotfire.Localization.resources.Back);
        var $nextButton = $("<button/>").addClass("sf-element-button").text(Spotfire.Localization.resources.Next);
        if (promptIndex === numPages - 1) { $nextButton.addClass("sfpc-secondary"); } else {
            $okButton.addClass("sfpc-secondary");
        } var $nameLabel = $("<div/>").addClass("sf-connection-prompt-title").appendTo($pageContent); $nameLabel.text(page.name);
        if (page.description) {
            var $descriptionLabel = $("<div/>").addClass("sf-connection-prompt-description").appendTo($pageContent);
            $descriptionLabel.text(page.description);
        } var disableButtons = function () {
            $nextButton.attr("disabled", true);
            $okButton.attr("disabled", true); $backButton.attr("disabled", true);
        }; var onValidation = function (isValid) {
            if (isValid) {
                $nextButton.attr("disabled", promptIndex === numPages - 1);
                $okButton.attr("disabled", promptIndex !== numPages - 1); $backButton.attr("disabled", promptIndex === 0);
            } else {
                $nextButton.attr("disabled", true);
                $okButton.attr("disabled", true); $backButton.attr("disabled", promptIndex === 0);
            }
        }; validation(function (data) {
            onValidation(data.isValid);
        }); switch (page.type) {
            case "Range": renderRange($pageContent, page); break; case "Single": case "Multiple": renderSelect($pageContent, page);
                break; case "FreeText": renderFreeText($pageContent, page); break;
        } _.defer(function () {
            var $textFields = $pageContent.find("input[type=text]");
            if (page.dataType.name !== "DateTime") { $textFields.first().focus(); } $textFields.keydown(function (e) {
                if (e.which === Keys.RETURN) {
                    if ($nextButton.is(":enabled")) {
                        $nextButton.click();
                    } else { if ($okButton.is(":enabled")) { $okButton.click(); } } e.stopPropagation();
                }
            });
        }); var buttons = []; if (numPages > 1) {
            buttons.push($backButton);
            buttons.push($nextButton); $backButton.click(function () { disableButtons(); loadPage(promptIndex - 1); }); $nextButton.click(function () {
                disableButtons();
                loadPage(promptIndex + 1);
            });
        } buttons.push($okButton); $okButton.click(function () {
            disableButtons(); prompt.confirm();
        }); renderFooter(buttons); onValidation(page.isValid);
    };

    var renderError = function (errorTitle, errorDetails, page) {
        $pageContent.append($("<div/>").addClass("sf-connection-prompt-error-title").text(errorTitle));
        if (errorDetails) {
            var $details = Spotfire.Flex.item({ grow: true }); $details.addClass("sf-connection-prompt-error-details sf-enable-selection").text(errorDetails);
            $pageContent.append($details);
        } var buttons = []; var $tryFreeTextButton = $("<button/>").text(Spotfire.Localization.resources.Prompt_TryFreeText).addClass("sf-element-button");
        $tryFreeTextButton.click(function () { $view.off(); $pageContent.empty(); renderPage(page); }); buttons.push($tryFreeTextButton);
        if (promptIndex > 0) {
            buttons.push(separator()); var $backButton = $("<button/>").text(Spotfire.Localization.resources.Back).addClass("sf-element-button sfpc-secondary");
            $backButton.click(function () { $backButton.attr("disabled", true); loadPage(promptIndex - 1); }); buttons.push($backButton);
        } renderFooter(buttons);
    };

    loadPage = function (index) {
        promptIndex = index; ProgressBlocker.block($pageContent);
        prompt.read("GetPromptPage", JSON.stringify({ index: promptIndex }), function (settings) {
            ProgressBlocker.unblock($pageContent);
            $view.off(); renderHeader(); $pageContent.empty(); if (!settings.success) {
                renderError(settings.errorTitle, settings.errorDetails, settings.page);
            } else { renderPage(settings.page); }
        });
    };

    Spotfire.registerNameSpace("Data.Access", {
        initializePrompt: function (viewId, settings) {
            numPages = settings.numPages;
            if (numPages <= 0) { throw "There must be at least one prompt page."; } decimalSeparator = settings.decimalSeparator;
            prompt = Spotfire.Prompt.create(viewId); var $container = Spotfire.Flex.item({ container: "vertical", fill: true, "align-items": "stretch" });
            $container.addClass("sf-connection-prompt-page-container"); $pageContent = Spotfire.Flex.item({ grow: true, container: "vertical", "align-items": "stretch" });
            $pageContent.addClass("sf-connection-prompt-page-content"); $view = $("#" + viewId).addClass("sf-connection-prompt-dialog");
            $pageHeader = Spotfire.Flex.item().addClass("sf-connection-prompt-header"); $pageFooter = Spotfire.Flex.item().addClass("sf-connection-prompt-footer");
            if (numPages > 1) { $container.append($pageHeader); } $container.append($pageContent).append($pageFooter); $view.append($container);
            renderHeader(); renderFooter([]); loadPage(0);
        },
        validatePrompt: function (promptIndex, isValid, errorMessages, validatedValues) {
            validation({ promptIndex: promptIndex, isValid: isValid, errorMessages: errorMessages, validatedValues: validatedValues });
        }
    });
});

// Create Welcome Page
$(function () {
    function WelcomePage(id, settings) {
        var read = function (method, args, callback) {
            Spotfire.Dxp.Web.Forms.AjaxService.Read(id, method, args, callback);
        };

        var modify = function (method, args) {
            Spotfire.Dxp.Web.Forms.AjaxService.Modify(id, method, args);
        };

        var resources = settings.resources;
        var licenses = settings.licenses;
        

        var $body = $(document.body);
        $body.css({ border: "0", margin: "0", padding: "0", overflow: "hidden" });

        var $logoImage = $("<img />");
        $logoImage.attr("src", settings.LogoUrl);

        var $header = $("<div/>");
        $header.addClass("header");
        $header.append($logoImage);

        var $search = $("<div/>").addClass("search");
        var $searchProgress = $("<img/>").addClass("progress").attr("src", "Images/WelcomePage/SearchProgress.gif").hide();
        var $searchResult = $("<div/>").addClass("searchResult").hide();

        var $parent = $("#" + id).addClass("WelcomePage");
        $parent.append($header);
        $parent.append($search);
        $parent.append($searchResult);

        var createSearchInput = function () {

            var resetSearch = function () {
                $searchProgress.hide();
                $searchResult.empty(); $searchResult.hide();
            };
            var closeSearchResults = function (e) {
                var $target = $(e.target);
                if ($target.is($searchResult)) { return; } if ($target.parents(".searchResult").length === 0) {
                    resetSearch(); $body.unbind("mousedown", closeSearchResults);
                } if ($target.is($input)) { $input.focus(); }
            };
            var handleSearchResult = function (content) {
                resetSearch(); if (content.length === 0) {
                    return;
                } $searchResult.show(); $body.bind("mousedown", closeSearchResults); var createResultItem = function (index, item) {
                    var $item = $("<div/>").addClass("result").attr("tabindex", index).attr("title", item.title);
                    var $title = $("<div/>").addClass("title").text(item.title); var $category = $("<div/>").addClass("category").text(item.category);
                    $item.append($title); $item.append($category); $item.click(function () {
                        modify("ExecuteSearchSelection", item.value);
                        resetSearch();
                    }); $item.keydown(function (e) {
                        switch (e.which) {
                            case 13: $(this).click(); break; case 27: resetSearch();
                                $input.focus(); break; case 38: $(this).prev().focus(); break; case 40: $(this).next().focus(); break;
                        } e.preventDefault();
                    }); var onFocus = function () { $(this).addClass("hover"); $(".title", this).addClass("blue"); }; var onBlur = function () {
                        $(this).removeClass("hover");
                        $(".title", this).removeClass("blue");
                    }; $item.focus(onFocus); $item.blur(onBlur); $item.hover(onFocus, onBlur);
                    return $item;
                }; var i; for (i = 0; i < content.length; i++) {
                    $searchResult.append(createResultItem(i, content[i]));
                }
            };
            var defaultText = resources.WelcomePageGhostText;

            var $input = $("<input type='text'/>");
            $input.addClass("ghost");
            $input.val(defaultText);
            $input.focus(function () {
                if ($input.val() === defaultText) {
                    $input.removeClass("ghost");
                    $input.val("");
                }
            });

            var checkDefault = function () {
                if ($input.val() === "") {
                    resetSearch();
                    $input.addClass("ghost");
                    $input.val(defaultText);
                }
            };

            $input.change(checkDefault);
            $input.blur(checkDefault);

            var searchTimer;

            $input.keyup(function (e) {
                if (searchTimer) {
                    window.clearTimeout(searchTimer);
                }

                var text = $input.val();

                if (text === "") {
                    resetSearch();
                    return;
                }

                var performSearch = function () {
                    $searchProgress.show();
                    read("Search", text, handleSearchResult);
                };

                switch (e.which) {
                    case 13:
                        performSearch();
                        break;
                    case 27:
                        break;
                    case 40:
                        $(".result", $searchResult).first().focus();
                        break;
                    default:
                        searchTimer = window.setTimeout(performSearch, 400);
                        break;
                }
            });

            return $input;
        };

        var $searchInput = createSearchInput();
        $search.append($searchInput);
        $search.append($searchProgress);

        $body.bind("dragstart", function (e) { e.preventDefault(); }); var $footer; if (settings.ButtonUrl) {
            $footer = $("<div/>").addClass("footer");
            $footer.click(function () { modify("OpenWebLink", settings.ButtonUrl); }); $footer.text(settings.ButtonText);
            $parent.append($footer);
        } var $tabControl = $("<div/>").addClass("tabControl"); $parent.append($tabControl);
        var $tabsList = $("<ul/>"); $tabControl.append($tabsList); var showTab = function (i) {
            var $tabs = $(".tab", $parent);
            $tabs.hide(); var $tab = $($tabs.get(i - 1)); $tab.show(); $tab.trigger("shown"); var $spans = $("span", $tabControl);
            $spans.removeClass("active"); $($spans.get(i - 1)).addClass("active");
        }; var createTab = function (title) {
            var $tab = $("<div/>");
            $tab.addClass("tab"); $tab.hide(); var $li = $("<li/>"); $tabsList.append($li); var i = $tabsList.children().length;
            var $span = $("<span/>"); $span.text(title); $li.append($span); $span.click(function () {
                showTab(i); modify("SetActiveTab", i.toString());
            }); $parent.append($tab); return $tab;
        }; var $tab1 = createTab(resources.WelcomePageRecentFiles); var $tab2 = createTab(resources.WelcomePageRecentData);
        var $tab3 = createTab(resources.WelcomePageAddData); var $tab4 = createTab(resources.WelcomePageSamples); var createItem = function (func, isTopItem, enabled, method, args) {
            var $div = $("<div/>").addClass("item");
            var $delimiterTop = $("<div/>").addClass("delimiter delimiterTop"); if (isTopItem) {
                $delimiterTop.addClass("separatingLine");
            } var $delimiterBottom = $("<div/>").addClass("delimiter delimiterBottom separatingLine"); func($div); $div.append($delimiterTop);
            $div.append($delimiterBottom); if (enabled) { $div.click(function () { modify(method, args); }); } else {
                var $blocker = $("<div/>").addClass("blocker");
                $div.append($blocker);
            } return $div;
        }; var loadRecentFiles = function (content) {
            $tab1.empty(); var $col1 = $("<div/>").addClass("leftColumn");
            var $col2 = $("<div/>").addClass("rightColumn"); $tab1.append($col1); $tab1.append($col2); $.each(content, function (i, item) {
                var populate = function ($div) {
                    var $thumbnail = $("<div/>").addClass("thumbnail");
                    var src = item.previewUrl || "Images/WelcomePage/DefaultFileIcon.png"; var $img = $("<img/>").attr("src", src);
                    $thumbnail.append($img); var $title = $("<div/>").addClass("title").text(item.title); $div.attr("title", item.title);
                    var $desc = $("<div/>").addClass("desc"); $desc.append($("<span/>").text(item.lastModified).css("color", "#b8b8b8"));
                    $desc.append("<br/>"); if (item.method === "OpenFromLibrary") {
                        $desc.append($("<span/>").text(item.modifiedBy));
                        $desc.append("<br/>");
                    } if (item.description) { $desc.append($("<div/>").text(item.description)); } else {
                        $desc.append($("<div/>").text(item.path));
                    } $("span", $desc).each(function () { var $span = $(this); $span.attr("title", $span.text()); }); $title.width(240);
                    $desc.width(240); $desc.height(48); $div.append($thumbnail); $div.append($title); $div.append($desc);
                }; var isTopItem = i === 0 || i === 1;
                var $item = createItem(populate, isTopItem, true, item.method, item.args); $item.css("padding", "25px"); $item.height(68);
                if (i % 2 === 0) { $item.addClass("rightBorder"); $col1.append($item); } else { $col2.append($item); }
            }); $(".delimiterTop, .delimiterTop2", $col1).css("background-position", "top left");
            $(".delimiterTop, .delimiterTop2", $col2).css("background-position", "top right"); $(".delimiterBottom", $col1).css("background-position", "bottom left");
            $(".delimiterBottom", $col2).css("background-position", "bottom right"); $(".item", $col1).css("background-position", "left");
            $(".item", $col2).css("background-position", "right");
        }; var loadRecentData = function (content) {
            $tab2.empty();
            $.each(content, function (i, item) {
                var populate = function ($div) {
                    $div.attr("title", item.tooltip); var $title = $("<div/>").addClass("title").text(item.title);
                    var $desc = $("<div/>").addClass("desc").text(item.type); $title.css({ "float": "left", width: "479px", "margin-left": "32px" });
                    $desc.css({ width: "170px", "margin-left": "414px" }); $div.append($title); $div.append($desc);
                }; var $item = createItem(populate, i === 0, true, item.method, item.args);
                $item.height(16); $tab2.append($item);
            });
        }; var loadAddData = function (content) {
            $tab3.empty(); var createListItem = function (text, desc, imageUrl, userAction, enabled) {
                var populate = function ($div) {
                    var $img = $("<img/>").attr("src", imageUrl).addClass("icon");
                    var $title = $("<div/>").addClass("title").text(text); var $desc = $("<div/>").addClass("desc").text(desc);
                    $div.attr("title", text); $div.append($img); $div.append($title); $div.append($desc);
                }; $tab3.append(createItem(populate, $tab3.children().length === 0, enabled, "InvokeUserAction", userAction));
            }; createListItem(resources.WelcomePageOpenFile, resources.WelcomePageOpenFileDescription, "Images/WelcomePage/OpenFile.png", "fileOpenFile", licenses.OpenFile);
            if (!settings.serverless) {
                createListItem(resources.WelcomePageOpenFromLibrary, resources.WelcomePageOpenFromLibraryDescription, "Images/WelcomePage/OpenLibrary.png", "fileOpenLibrary", licenses.OpenFromLibrary && settings.isOnline);
            } createListItem(resources.WelcomePageAddDataTables, resources.WelcomePageAddDataTablesDescription, "Images/WelcomePage/AddTable.png", "fileAddDataTable", licenses.ManageDataTables);
            var createAdapterItem = function ($div) {
                var createLink = function (title, method, args) {
                    var onClick = function () {
                        modify(method, args);
                        return false;
                    }; var $link = $("<a href=#></a>"); $link.text(title); $link.attr("title", title); $link.click(onClick);
                    return $link;
                }; var $img = $("<img/>").attr("src", "Images/WelcomePage/DbConnection.png").addClass("icon");
                var $title = $("<div/>").addClass("title").text(resources.WelcomePageDbConnections); var $links = $("<div/>").addClass("linkList");
                var i, item, $a; for (i = 0; i < content.length; i++) {
                    item = content[i]; $a = createLink(item.displayName, "DataAdapterFactory", item.typeId);
                    $links.append($a); $links.append(", ");
                } var text = resources.WelcomePageMoreDbConnections; $links.append(createLink(text, "InvokeUserAction", "fileAddDataTable"));
                $div.attr("title", text); $div.append($img); $div.append($title); $div.append($links);
            }; var $adapters = createItem(createAdapterItem, false, licenses.ManageDataTables, "InvokeUserAction", "fileAddDataTable");
            $tab3.append($adapters); var onShown = function () {
                $(".item", $tab3).each(function (i, elem) {
                    var h = $(".desc, .linkList", elem).height();
                    $(elem).height(23 + h);
                });
            }; $tab3.bind("shown", onShown); onShown();
        }; var loadSamples = function (content) {
            $tab4.empty();
            var $col1 = $("<div/>").addClass("leftColumn"); var $col2 = $("<div/>").addClass("rightColumn"); $tab4.append($col1);
            $tab4.append($col2); $.each(content, function (i, item) {
                var populate = function ($div) {
                    var $thumbnail = $("<div/>").addClass("thumbnail");
                    var src = item.previewUrl || "Images/WelcomePage/DefaultFileIcon.png"; var $img = $("<img/>").attr("src", src);
                    $thumbnail.append($img); var $title = $("<div/>").addClass("title").text(item.title); $div.attr("title", item.title);
                    var $desc = $("<div/>").addClass("sampleDesc"); $desc.append($("<div/>").text(item.description)); $("span", $desc).each(function () {
                        var $span = $(this);
                        $span.attr("title", $span.text());
                    }); $title.width(240); $desc.width(240); $desc.height(48); $div.append($thumbnail);
                    $div.append($title); $div.append($desc);
                }; var isTopItem = i === 0 || i === 1; var $item = createItem(populate, isTopItem, true, item.method, item.args);
                $item.css("padding", "25px"); $item.height(68); if (i % 2 === 0) {
                    $item.addClass("rightBorder"); $col1.append($item);
                } else { $col2.append($item); }
            }); $(".delimiterTop, .delimiterTop2", $col1).css("background-position", "top left");
            $(".delimiterTop, .delimiterTop2", $col2).css("background-position", "top right"); $(".delimiterBottom", $col1).css("background-position", "bottom left");
            $(".delimiterBottom", $col2).css("background-position", "bottom right"); $(".item", $col1).css("background-position", "left");
            $(".item", $col2).css("background-position", "right");
        }; showTab(settings.activeTab); var performLayout = function () {
            var w = $parent.width();
            var center = function ($elem) {
                var left = Math.round((w - $elem.outerWidth()) / 2); if (left < 0) { left = 0; } $elem.css("left", left + "px");
            }; center($header); center($tabControl); center($search); center($searchResult); center($tab1); center($tab2);
            center($tab3); center($tab4); if ($footer) {
                if ($parent.width() < 826 || $parent.height() < 660) {
                    $footer.hide();
                } else { $footer.show(); }
            }
        }; read("GetRecentAnalyses", "", loadRecentFiles); read("GetRecentData", "", loadRecentData);
        read("GetDataAdapters", "", loadAddData); read("GetSamples", "", loadSamples); read("GetOnlineStatus", "", function (status) {
            $("<span/>").text(status.text).attr("title", status.tooltip).appendTo($body).css({ position: "absolute", "font-size": "1.2em", left: "5px", bottom: "5px", cursor: "pointer", color: "#c0c0c0" });
        }); $parent.on("sf-resize", performLayout); Spotfire.DragDrop.initializeWindowsIntegration(id); performLayout();
    } var instance = null; Spotfire.registerNameSpace("WelcomePage", {
        initialize: function (id, settings) {
            if (instance !== null) {
                throw "Attempt to initialize twice.";
            } instance = new WelcomePage(id, settings);
        }
    });
});

// Create SVG pictures
(function (Spotfire) {
    Spotfire.svgCache = {
        "images/axistraycontrol/downarrow.svg": {
            result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 7 4' enable-background='new 0 0 7 4' xml:space='preserve'><polygon points='3.5,4 7,0 0,0 '/></svg>"
        },
        "images/axistraycontrol/handle.svg": {
            result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 9 12' enable-background='new 0 0 9 12' xml:space='preserve'><g><g class='sf-element sf-element-svg-element sfc-bin-thumb-outline' fill='currentColor'><path d='M7,0H2C0.895,0,0,0.923,0,2.062v4.156c0,0.709,0.228,1.037,0.876,1.705L4.5,12l3.624-4.078 C8.772,7.255,9,6.926,9,6.218V2.062C9,0.923,8.105,0,7,0z'/></g><g class='sf-element sf-element-svg-element' fill='currentColor'><path d='M7,1H2C1.449,1,1,1.477,1,2.062V6.22c0,0.313,0,0.397,0.594,1.009L4.5,10.5l2.877-3.239 C8,6.617,8,6.533,8,6.22V2.062C8,1.477,7.551,1,7,1z'/></g></g></svg>"
        },
        "images/axistraycontrol/plus.svg": {
            result: "<svg version='1.1' xmlns:x='&ns_extend;' xmlns:i='&ns_ai;' xmlns:graph='&ns_graphs;' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='7px' height='7px' viewBox='0 0 7 7' enable-background='new 0 0 7 7' xml:space='preserve'><metadata><sfw xmlns='&ns_sfw;'><slices></slices><sliceSourceBounds height='7' width='7' x='0' y='-7' bottomLeftOrigin='true'></sliceSourceBounds></sfw></metadata><g shape-rendering='crispEdges' fill='currentColor'><rect x='0' y='3' width='7' height='1'/><rect x='3' y='0' width='1' height='7'/></g></svg>"
        },
        "images/bookmarks/bookmarkadd.svg": {
        result: "<svg version='1.1' xmlns:x='&ns_extend;' xmlns:i='&ns_ai;' xmlns:graph='&ns_graphs;' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='7px' height='7px' viewBox='0 0 7 7' enable-background='new 0 0 7 7' xml:space='preserve'><metadata><sfw xmlns='&ns_sfw;'><slices></slices><sliceSourceBounds height='7' width='7' x='0' y='-7' bottomLeftOrigin='true'></sliceSourceBounds></sfw></metadata><polygon fill='currentColor' points='7,3 4,3 4,0 3,0 3,3 0,3 0,4 3,4 3,7 4,7 4,4 7,4 '/></svg>" }, "images/bookmarks/bust_16x16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><path fill='currentColor' d='M12.045,10.923c-0.311-0.126-0.604-0.245-0.84-0.385c-0.167-0.099-0.323-0.179-0.467-0.253 c-0.725-0.374-1.175-0.52-1.2-1.644V8.474c0.404-0.34,0.681-0.765,0.885-1.359c0.052-0.069,0.905-1.217,0.355-1.476 C10.934,4.022,9.513,3,8.174,3H8.141C6.802,3,5.38,4.022,5.537,5.639C4.987,5.898,5.839,7.046,5.891,7.115 c0.204,0.594,0.481,1.019,0.885,1.359v0.077c-0.005,1.558-1.138,1.747-2.049,2.018l-0.122,0.036C3.705,10.87,3.186,11.575,3,13h10 C12.833,11.916,12.94,11.284,12.045,10.923z'/></svg>" }, "images/bookmarks/downarrow.svg": { result: "<svg version='1.1' xmlns:x='&ns_extend;' xmlns:i='&ns_ai;' xmlns:graph='&ns_graphs;' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='7px' height='4px' viewBox='0 0 7 4' enable-background='new 0 0 7 4' xml:space='preserve'><metadata><sfw xmlns='&ns_sfw;'><slices></slices><sliceSourceBounds width='13' height='16383' x='0' y='-8194' bottomLeftOrigin='true'></sliceSourceBounds></sfw></metadata><polygon fill='currentColor' points='3.5,4 7,0 0,0 '/></svg>" }, "images/bookmarks/triplebust_16x16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g fill='currentColor'><path d='M11.623,13.139c-0.073-0.052-0.158-0.1-0.257-0.143c-0.137-0.061-0.27-0.12-0.395-0.18c0.125,0.061,0.258,0.12,0.395,0.18 C11.465,13.039,11.55,13.087,11.623,13.139z'/><path d='M7.955,5.35L7.955,5.35c0.147,0,0.296,0.015,0.443,0.045C8.251,5.366,8.102,5.35,7.955,5.35z'/><path d='M11.14,7.539c0.052,0.1,0.092,0.21,0.118,0.326c0.149,0.66-0.189,1.384-0.534,1.914c-0.17,0.495-0.389,0.902-0.673,1.248 c0.025,0.192,0.107,0.238,0.434,0.42l0.134,0.075c0.141,0.079,0.294,0.166,0.46,0.274c0.149,0.097,0.377,0.198,0.619,0.305 c0.315,0.139,0.544,0.317,0.722,0.516H16c-0.147-1.046-0.053-1.656-0.842-2.004c-0.274-0.121-0.533-0.236-0.74-0.371 c-0.147-0.095-0.285-0.173-0.411-0.244c-0.639-0.361-1.036-0.501-1.058-1.587v-0.16c0.356-0.328,0.6-0.738,0.78-1.312 c0.046-0.067,0.798-1.175,0.313-1.424c0.138-1.561-1.115-2.547-2.295-2.547h-0.029c-0.987,0-2.014,0.696-2.246,1.835 c0.347,0.193,0.668,0.437,0.926,0.748C10.856,6.104,11.113,6.798,11.14,7.539z'/><path d='M9.161,10.834C9.173,11.238,9.245,11.5,9.358,11.7C9.245,11.5,9.173,11.238,9.161,10.834z'/><path d='M4.623,7.865c0.026-0.117,0.066-0.226,0.118-0.326c0.026-0.741,0.283-1.434,0.742-1.989c0.34-0.41,0.781-0.714,1.262-0.913 c0.202-0.366,0.438-0.922,0.111-1.091C6.994,1.986,5.741,1,4.561,1H4.531c-1.18,0-2.434,0.986-2.295,2.547 c-0.485,0.25,0.266,1.358,0.312,1.424c0.18,0.573,0.424,0.984,0.78,1.312v0.075C3.324,7.86,2.326,8.043,1.523,8.305L1.415,8.34 C0.622,8.595,0.164,9.275,0,10.65h5.577c-0.162-0.26-0.308-0.54-0.421-0.871C4.812,9.249,4.474,8.523,4.623,7.865z'/><path d='M12.028,13.736c-0.07-0.245-0.185-0.441-0.405-0.597c-0.073-0.052-0.158-0.1-0.257-0.143 c-0.137-0.061-0.27-0.12-0.395-0.18c-0.125-0.061-0.241-0.123-0.345-0.191c-0.005-0.003-0.008-0.005-0.013-0.008 c-0.142-0.091-0.276-0.168-0.399-0.237c-0.08-0.045-0.156-0.087-0.228-0.127c-0.144-0.081-0.272-0.157-0.382-0.247 c-0.1-0.082-0.18-0.185-0.247-0.305c-0.113-0.2-0.185-0.462-0.197-0.866c0-0.015-0.003-0.025-0.003-0.041v0v-0.16 c0.089-0.082,0.171-0.169,0.247-0.263c0.114-0.141,0.211-0.304,0.299-0.478v0C9.791,9.719,9.87,9.535,9.937,9.321 c0.006-0.008,0.022-0.033,0.047-0.07c0.064-0.099,0.177-0.289,0.272-0.495c0.022-0.048,0.041-0.095,0.06-0.144 c0.053-0.137,0.094-0.276,0.096-0.396c0.001-0.034-0.011-0.061-0.017-0.092c-0.017-0.095-0.054-0.179-0.145-0.226 c0.052-0.585-0.092-1.09-0.354-1.492C9.729,6.15,9.513,5.94,9.27,5.773c-0.139-0.096-0.286-0.18-0.44-0.244 C8.69,5.47,8.545,5.425,8.398,5.396C8.251,5.366,8.102,5.35,7.955,5.35H7.925c-0.443,0-0.895,0.139-1.281,0.394 c-0.257,0.17-0.485,0.393-0.66,0.661c-0.078,0.12-0.141,0.252-0.197,0.389c-0.13,0.324-0.194,0.692-0.157,1.103 C5.448,7.99,5.44,8.205,5.504,8.439C5.546,8.596,5.62,8.762,5.696,8.907c0.113,0.218,0.23,0.389,0.247,0.414 c0.135,0.43,0.306,0.768,0.533,1.049c0.076,0.094,0.158,0.181,0.247,0.263v0.017v0.057c0,0.188-0.017,0.355-0.046,0.505 c-0.059,0.299-0.17,0.526-0.316,0.703c-0.364,0.444-0.942,0.576-1.444,0.74L4.809,12.69c-0.397,0.128-0.71,0.362-0.944,0.735 c-0.059,0.093-0.112,0.196-0.161,0.307c-0.098,0.223-0.176,0.483-0.235,0.784C3.44,14.667,3.414,14.828,3.394,15h8.815 C12.135,14.477,12.122,14.063,12.028,13.736z'/><path d='M9.161,10.834c0-0.015-0.003-0.025-0.003-0.041v0C9.158,10.809,9.16,10.819,9.161,10.834z'/><path d='M12.209,15c-0.074-0.523-0.087-0.937-0.18-1.264C12.122,14.063,12.135,14.477,12.209,15L12.209,15z'/><path d='M10.627,12.624c0.104,0.068,0.22,0.13,0.345,0.191C10.847,12.754,10.73,12.692,10.627,12.624 c-0.005-0.003-0.008-0.005-0.013-0.008h0C10.619,12.619,10.622,12.621,10.627,12.624z'/><path d='M6.361,11.915c-0.364,0.444-0.942,0.576-1.444,0.74L4.809,12.69l0.107-0.035C5.419,12.491,5.997,12.359,6.361,11.915z'/><path d='M6.644,5.744c-0.257,0.17-0.485,0.393-0.66,0.661C6.159,6.137,6.387,5.915,6.644,5.744z'/><path d='M4.809,12.69c-0.397,0.128-0.71,0.362-0.944,0.735C4.1,13.051,4.413,12.817,4.809,12.69z'/><path d='M9.987,12.252c0.072,0.041,0.148,0.082,0.228,0.127c0.123,0.069,0.257,0.145,0.399,0.237h0 c-0.142-0.091-0.276-0.168-0.399-0.237C10.136,12.335,10.059,12.293,9.987,12.252z'/></g></svg>" }, "images/buttons/actions.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g shape-rendering='crispEdges' fill='currentColor'> /* Three lines in the middle */ <rect x='2' y='3' width='7' height='1'/><rect x='2' y='6' width='7' height='1'/><rect x='2' y='9' width='5' height='1'/> /* The frame */ <rect x='0' y='12' width='8' height='1'/><rect x='0' y='0' width='11' height='1'/><rect x='0' y='1' width='1' height='11'/><rect x='10' y='1' width='1' height='8'/> /* The triangle down to the right */ <polygon fill='currentColor' points='7.5,10.5 13.5,10.5 10.5,13.5'/></g></svg>" }, "images/buttons/annotations.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><polygon fill='currentColor' points='10.3,14 11.7,14 14,11.7 14,10.3 '/><polygon fill='currentColor' points='10,10 10,13 11,13 11,11 13,11 13,10 '/><polygon fill='currentColor' points='0,0 0,14 10.3,14 11.3,13 1,13 1,1 13,1 13,11.3 14,10.3 14,0 '/><path fill='currentColor' d='M9.6,8.684C9.475,8.565,9.315,8.277,9.12,7.821L7.083,3h-0.08l-2.02,4.691 C4.792,8.139,4.631,8.434,4.5,8.577C4.369,8.721,4.203,8.807,4,8.84V9h1.88V8.84C5.584,8.817,5.4,8.782,5.325,8.736 c-0.128-0.079-0.192-0.2-0.192-0.365c0-0.124,0.039-0.282,0.117-0.473l0.237-0.572h1.996l0.3,0.733 C7.861,8.25,7.903,8.358,7.908,8.384c0.017,0.055,0.025,0.108,0.025,0.16c0,0.087-0.031,0.153-0.092,0.199 C7.753,8.807,7.598,8.84,7.38,8.84H7.267V9H10V8.84C9.828,8.825,9.694,8.773,9.6,8.684z M5.633,7.006L6.5,4.981l0.842,2.025H5.633 z'/></svg>" }, "images/buttons/calculator.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g shape-rendering='crispEdges' fill='currentColor'> /* The frame */ <rect x='2' y='1' width='10' height='1'/><rect x='2' y='12' width='10' height='1'/><rect x='2' y='2' width='1' height='10'/><rect x='11' y='2' width='1' height='10'/> /* The horizontal lines within the keyboard part */ <rect x='3' y='4' width='8' height='1'/><rect x='3' y='6' width='8' height='1'/><rect x='3' y='8' width='8' height='1'/><rect x='3' y='10' width='8' height='1'/> /* The vertical lines within the keyboard part */ <rect x='5' y='5' width='1' height='7'/><rect x='8' y='5' width='1' height='7'/></g></svg>" }, "images/buttons/close.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><rect x='6.118' y='-0.603' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.8995 6.9998)' fill='currentColor' width='1.764' height='15.206'/></g></g><g><g><rect x='-0.603' y='6.118' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.8995 7)' fill='currentColor' width='15.206' height='1.764'/></g></g></g></svg>" }, "images/buttons/edithtml.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><g><polygon fill='currentColor' points='5.933,2.202 4.704,1 0,6.926 0.005,6.931 0,6.936 4.704,13 5.933,11.798 2.168,6.945 '/></g></g><g><g><polygon fill='currentColor' points='14,6.926 9.295,1 8.067,2.202 11.832,6.945 8.067,11.798 9.295,13 14,6.936 13.995,6.931 '/></g></g></svg>" }, "images/buttons/edittextarea.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><g><path fill='currentColor' d='M0,14l4.666-1.255L1.25,9.317L0,14z M10.525,0L8.612,1.921l3.475,3.487L14,3.487L10.525,0z M1.933,8.634l3.475,3.487 l6.049-6.082L7.982,2.552L1.933,8.634z'/></g></g></svg>" }, "images/buttons/error.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><circle fill='currentColor' cx='7' cy='7' r='7' /><rect x='6' y='9' fill='#FEFEFE' width='2' height='2'/><rect x='6' y='3' fill='#FEFEFE' width='2' height='4'/></g></svg>" }, "images/buttons/horizontalcollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 20 20' enable-background='new 0 0 20 20' xml:space='preserve'><g id='Lager_3' fill='currentColor'><rect x='6' y='9' width='8' height='2' transform='rotate(45, 13, 10)'/><rect x='6' y='9' width='8' height='2' transform='rotate(-45, 13, 10)'/></g></svg>" }, "images/buttons/horizontalexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 20 20' enable-background='new 0 0 20 20' xml:space='preserve'><g id='Lager_3' fill='currentColor'><rect x='6' y='9' width='8' height='2' transform='rotate(45, 7, 10)'/><rect x='6' y='9' width='8' height='2' transform='rotate(-45, 7, 10)'/></g></svg>" }, "images/buttons/info.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><circle fill='currentColor' cx='7' cy='7' r='7' /><path fill='#FEFEFE' d='M6,3h2v2h-2V3z M9,11H5v-1h1V7H5v-1h1h0h2v4H9V11z'/></g></svg>" }, "images/buttons/properties.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path fill='currentColor' d='M13.621,5.904l-1.036-0.259c-0.168-0.042-0.303-0.168-0.356-0.332c-0.091-0.284-0.205-0.559-0.339-0.82 c-0.079-0.154-0.072-0.337,0.017-0.486l0.55-0.915c0.118-0.197,0.087-0.449-0.075-0.611l-0.863-0.863 c-0.163-0.162-0.414-0.193-0.611-0.075L9.992,2.092C9.844,2.181,9.66,2.188,9.506,2.109C9.244,1.975,8.97,1.861,8.686,1.77 C8.521,1.717,8.395,1.583,8.353,1.415L8.094,0.379C8.039,0.156,7.839,0,7.609,0H6.39C6.161,0,5.961,0.156,5.905,0.379L5.647,1.415 C5.605,1.582,5.479,1.717,5.314,1.77C5.029,1.861,4.755,1.975,4.493,2.109C4.339,2.188,4.155,2.182,4.007,2.093L3.092,1.544 C2.895,1.426,2.644,1.457,2.481,1.619L1.619,2.481C1.457,2.644,1.426,2.895,1.544,3.092l0.549,0.915 c0.089,0.148,0.095,0.332,0.017,0.486C1.975,4.755,1.861,5.029,1.77,5.314c-0.053,0.165-0.188,0.29-0.355,0.332L0.379,5.905 C0.156,5.961,0.001,6.161,0.001,6.39L0,7.609c0,0.229,0.156,0.43,0.378,0.485l1.036,0.259C1.583,8.396,1.717,8.521,1.77,8.686 c0.091,0.285,0.205,0.559,0.339,0.821c0.079,0.154,0.073,0.337-0.016,0.486l-0.549,0.915c-0.118,0.196-0.087,0.448,0.075,0.61 l0.862,0.863c0.163,0.163,0.415,0.193,0.611,0.075l0.915-0.549c0.148-0.089,0.332-0.095,0.486-0.017 c0.262,0.134,0.537,0.248,0.821,0.339c0.165,0.053,0.291,0.187,0.333,0.355l0.259,1.036C5.961,13.844,6.16,14,6.39,14h1.22 c0.23,0,0.429-0.156,0.485-0.379l0.259-1.036c0.042-0.167,0.168-0.302,0.333-0.355c0.285-0.091,0.559-0.205,0.821-0.339 c0.154-0.079,0.338-0.072,0.486,0.017l0.915,0.549c0.197,0.118,0.448,0.088,0.611-0.075l0.863-0.863 c0.162-0.162,0.193-0.414,0.075-0.611l-0.549-0.915c-0.089-0.148-0.095-0.332-0.017-0.486c0.134-0.262,0.248-0.536,0.339-0.82 c0.053-0.165,0.188-0.291,0.356-0.333l1.036-0.259C13.844,8.039,14,7.839,14,7.609V6.39C14,6.16,13.844,5.96,13.621,5.904z M7,9.5 C5.619,9.5,4.5,8.381,4.5,7c0-1.381,1.119-2.5,2.5-2.5S9.5,5.619,9.5,7C9.5,8.381,8.381,9.5,7,9.5z'/></svg>" }, "images/buttons/refresh.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g><g><path fill='currentColor' d='M2.262,2.999c1.778-1.775,4.656-1.81,6.436-0.089L6.756,5.033h5.22V0L9.697,1.912C7.369-0.347,3.599-0.303,1.27,2.021 C0.716,2.574,0.293,3.207,0,3.882l1.272,0.585C1.496,3.934,1.826,3.433,2.262,2.999z M10.728,7.533 c-0.224,0.533-0.554,1.033-0.99,1.468c-1.778,1.775-4.656,1.81-6.437,0.089l1.943-2.113H0V12l2.303-1.913 c2.327,2.259,6.098,2.216,8.427-0.109c0.554-0.553,0.977-1.186,1.27-1.86L10.728,7.533z'/></g></g></svg>" }, "images/buttons/txt.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g shape-rendering='crispEdges' fill='currentColor'><rect x='4' y='10' width='10' height='2'/><rect y='10' width='2' height='2'/><rect x='4' y='6' width='10' height='2'/><rect y='6' width='2' height='2'/><rect x='4' y='2' width='10' height='2'/><rect y='2' width='2' height='2'/></g></svg>" }, "images/buttons/verticalcollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 20 20' enable-background='new 0 0 20 20' xml:space='preserve'><g id='arrow' fill='currentColor' transform='translate(10, 6) rotate(45)' ><rect x='0' y='0' width='8' height='2'/><rect x='0' y='0' width='2' height='8'/></g></svg>" }, "images/buttons/verticalexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 20 20' enable-background='new 0 0 20 20' xml:space='preserve'><g id='arrow' fill='currentColor' transform='translate(10, 14) rotate(-135)' ><rect x='0' y='0' width='8' height='2'/><rect x='0' y='0' width='2' height='8'/></g></svg>" }, "images/buttons/warning.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 14' enable-background='new 0 0 13 14' xml:space='preserve'><g><path fill='currentColor' d='M12.261,10.187l-3.97-9.416C7.306-0.258,5.707-0.257,4.72,0.774l-3.979,9.425 C-0.246,11.23-0.247,12.97,0.738,14h11.521C13.246,12.969,13.247,11.217,12.261,10.187z M7.62,11.016h-2V9.016h2V11.016z M7.62,8.014h-2V3.016h2V8.014z'/><rect x='5.62' y='3.016' fill='#161616' width='2' height='4.999'/><rect x='5.62' y='9.016' fill='#161616' width='2' height='1.999'/></g></svg>" }, "images/buttons/warning_small.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g id='Bg'><g id='XMLID_14_'><g id='XMLID_46_'><path id='XMLID_47_' fill-rule='evenodd' clip-rule='evenodd' fill='#fadb4a' d='M9.874,8.291L6.056,0.653 c-0.435-0.87-1.677-0.87-2.112,0L0.126,8.291C-0.266,9.076,0.305,10,1.182,10h7.635C9.695,10,10.266,9.076,9.874,8.291z'/></g></g></g><g id='_x21_'><g id='XMLID_2_'><g id='XMLID_22_'><rect id='XMLID_23_' x='4' y='3' fill='#75682d' width='2' height='3'/></g></g><g id='XMLID_7_'><g id='XMLID_29_'><rect id='XMLID_30_' x='4' y='7' fill='#75682d' width='2' height='1'/></g></g></g></svg>" }, "images/comments/add_comment_34x34.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 34 34' enable-background='new 0 0 34 34' xml:space='preserve'><defs><linearGradient id='grad1' x1='0%' y1='0%' x2='0%' y2='100%'><stop class='sf-element-svg-element sfc-stop1' offset='0%' style='stop-color:currentColor;stop-opacity:1' /><stop class='sf-element-svg-element sfc-stop2' offset='100%' style='stop-color:currentColor;stop-opacity:1' /></linearGradient></defs><g id='add_bubble'><g><g fill='url(#grad1)'><path d='M17,3C7.611,3,0,8.214,0,14.646c0,6.432,7.611,11.646,17,11.646c0.591,0,1.175-0.021,1.751-0.062V32l8.181-7.916 C31.207,21.968,34,18.534,34,14.646C34,8.214,26.389,3,17,3z'/></g></g><g><g><polygon fill='#FFFFFF' points='18,14 18,10 16,10 16,14 12,14 12,16 16,16 16,20 18,20 18,16 22,16 22,14 '/></g></g></g></svg>" }, "images/comments/anchorbubble.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 60 60' enable-background='new 0 0 60 60' xml:space='preserve'><g id='fill' class='sf-element sf-element-svg-element sfc-group-background'><g><path fill='currentColor' d='M30,3C15.112,3,3,15.112,3,30c0,14.888,12.112,27,27,27c14.888,0,27-12.112,27-27C57,15.112,44.888,3,30,3 z'/></g></g><g id='outer_line' class='sf-element sf-element-svg-element sfc-group-frame'><g><path fill='currentColor' d='M30,0C13.431,0,0,13.431,0,30s13.431,30,30,30s30-13.431,30-30S46.569,0,30,0z M30,57C15.112,57,3,44.888,3,30 C3,15.112,15.112,3,30,3c14.888,0,27,12.112,27,27C57,44.888,44.888,57,30,57z'/></g></g><g id='bubble_x5F_bottom' class='sf-element sf-element-svg-element sfc-group-right-bubble'><g><path fill='currentColor' d='M35.5,18C29.149,18,24,21.408,24,25.613s5.149,7.613,11.5,7.613c0.404,0,0.803-0.014,1.196-0.041 L36.685,37l5.616-5.258c2.845-1.386,4.7-3.611,4.7-6.129C47,21.408,41.851,18,35.5,18z'/></g></g><g id='bubble_x5F_top' class='sf-element sf-element-svg-element sfc-group-left-bubble'><g><path fill='currentColor' d='M24.5,22C18.149,22,13,25.408,13,29.613s5.149,7.613,11.5,7.613c0.404,0,0.803-0.014,1.196-0.041 L25.685,41l5.616-5.258c2.845-1.386,4.7-3.611,4.7-6.129C36,25.408,30.851,22,24.5,22z'/></g></g></svg>" }, "images/comments/anchorbubblesquare.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 40 40' enable-background='new 0 0 40 40' xml:space='preserve'><g id='Bg'><g class='sf-element sf-element-svg-element sfc-group-background'><g><path fill='currentColor' d='M0,0v40h40V0H0z M39,39H1V1h38V39z'/></g></g><g class='sf-element sf-element-svg-element sfc-group-frame'><g><path fill='currentColor' d='M1,1v38h38V1H1z M37,37H3V3h34V37z'/></g></g><g class='sf-element sf-element-svg-element sfc-group-background'><g><rect x='3' y='3' fill='currentColor' width='34' height='34'/></g></g></g><g id='Bubbles'><g class='sf-element sf-element-svg-element sfc-group-right-bubble'><g><path fill='currentColor' d='M23.5,12c-4.142,0-7.5,2.332-7.5,5.209s3.358,5.209,7.5,5.209c0.263,0,0.524-0.01,0.78-0.028L24.273,25 l3.662-3.598C29.791,20.454,31,18.931,31,17.209C31,14.332,27.642,12,23.5,12z'/></g></g><g class='sf-element sf-element-svg-element sfc-group-left-bubble'><g><path fill='currentColor' d='M16.5,15C12.358,15,9,17.332,9,20.209c0,2.877,3.358,5.209,7.5,5.209c0.263,0,0.524-0.01,0.78-0.028 L17.273,28l3.662-3.598C22.791,23.454,24,21.931,24,20.209C24,17.332,20.642,15,16.5,15z'/></g></g></g></svg>" }, "images/comments/bubble.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill='currentColor' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g><g><path fill-rule='evenodd' clip-rule='evenodd' d='M15.965,7.735C15.965,4.86,12.399,2.53,8,2.53c-4.399,0-7.965,2.331-7.965,5.205 c0,2.875,3.566,5.205,7.965,5.205c0.277,0,0.551-0.009,0.821-0.027L8.813,15.5l3.854-3.552 C14.662,11.002,15.965,9.47,15.965,7.735z'/></g></g></svg>" }, "images/comments/closebtn_10x10.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 10 10' enable-background='new 0 0 10 10' fill='currentColor' xml:space='preserve'><g><g><rect x='4.228' y='-1.299' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.0711 5)' width='1.544' height='12.598'/></g></g><g><g><rect x='-1.299' y='4.228' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.0711 5)' width='12.598' height='1.544'/></g></g></svg>" }, "images/comments/closebtn_16x16canvas.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g id='Lager_1'><g><g><rect x='0.286' y='7.229' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)' width='15.428' height='1.543'/></g></g><g><g><rect x='7.229' y='0.286' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)' width='1.543' height='15.428'/></g></g></g></svg>" }, "images/comments/closebtn_7x7.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 7 7' style='enable-background:new 0 0 7 7;' xml:space='preserve'><g id='XMLID_12_'><g id='XMLID_48_'><rect id='XMLID_49_' x='-0.8' y='2.8' transform='matrix(-0.7071 0.7071 -0.7071 -0.7071 8.4504 3.5003)' width='8.5' height='1.4'/></g></g><g id='XMLID_2_'><g id='XMLID_46_'><rect id='XMLID_47_' x='2.8' y='-0.8' transform='matrix(-0.707 0.7072 -0.7072 -0.707 8.4491 3.4999)' width='1.4' height='8.5'/></g></g></svg>" }, "images/comments/closepanel.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve' fill='currentColor'><g id='Arrows'><g><g><polygon points='7,1.842 8.469,1 13,6.999 8.469,13 7,12.158 10.842,6.999 '/></g></g><g><g><polygon points='0,1.842 1.469,1 6,6.999 1.469,13 0,12.158 3.842,6.999 '/></g></g></g></svg>" }, "images/comments/collapsereplies.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve' fill='currentColor'><g id='Close_arrow'><g><g><polygon points='8.524,8.021 8.508,8 8.5,8.005 8.492,8 8.476,8.021 2,12.243 2.57,13 8.5,9.134 14.43,13 15,12.243 '/></g></g><g><g><polygon points='8.524,3.021 8.508,3 8.5,3.005 8.492,3 8.476,3.021 2,7.243 2.57,8 8.5,4.134 14.43,8 15,7.243 '/></g></g></g></svg>" }, "images/comments/commentspanelempty.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 80 80'><path class='sf-element-svg-element sfc-comments-panel-bg-bubble-back' fill='currentColor' d='M53,14c-14.912,0-27,7.718-27,17.238s12.088,17.238,27,17.238c0.936,0,1.861-0.031,2.773-0.09L55.746,57l13.094-11.807 C75.6,42.06,80,36.978,80,31.238C80,21.718,67.912,14,53,14z'/><path class='sf-element-svg-element sfc-comments-panel-bg-bubble-front' fill='currentColor' d='M27,22C12.088,22,0,29.718,0,39.238s12.088,17.238,27,17.238c0.936,0,1.861-0.031,2.773-0.09L29.746,65 l13.094-11.807C49.6,50.06,54,44.978,54,39.238C54,29.718,41.912,22,27,22z'/></svg>" }, "images/comments/commentstitlepanelicon.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 27 27' enable-background='new 0 0 27 27' xml:space='preserve'><g id='Bubble'><g><g><path d='M13.5,2C6.044,2,0,5.956,0,10.835c0,4.879,6.044,8.835,13.5,8.835c0.47,0,0.933-0.016,1.391-0.047V24l6.497-6.006 C24.782,16.39,27,13.785,27,10.835C27,5.956,20.956,2,13.5,2z'/></g></g></g></svg>" }, "images/comments/expandreplies.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' stroke='currentColor' stroke-miterlimit='10' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><path fill-rule='evenodd' clip-rule='evenodd' d='M7.902,6.167V2.762c0-0.144-0.126-0.262-0.281-0.262 c-0.062,0-0.116,0.023-0.163,0.054L7.456,2.55L0.115,7.527L0.118,7.53C0.048,7.578,0,7.651,0,7.738c0,0.087,0.048,0.16,0.118,0.208 L0.115,7.95l7.341,4.976l0.003-0.004c0.046,0.032,0.101,0.054,0.163,0.054c0.155,0,0.281-0.117,0.281-0.262V9.31 c5.333,0,8.102,4.191,8.102,4.191C16.004,6.167,7.902,6.167,7.902,6.167z'/></svg>" }, "images/comments/indication_reply_with_state.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><polygon fill='currentColor' points='2.2,0.6 2.2,14.9 7.9,10.8 13.8,14.9 13.8,0.6 '/></svg>" }, "images/comments/indication_reply_with_state_small.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 8 9' enable-background='new 0 0 8 9' xml:space='preserve'><g id='XMLID_2_'><g id='XMLID_20_'><path id='XMLID_21_' d='M0,0v9c0,0,2.033-1.409,4.006-3C5.866,7.526,8,9,8,9V0H0z'/></g></g></svg>" }, "images/comments/inplaceminimize.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill='currentColor' x='0px' y='0px' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g id='Lager_2'><g><g><rect y='8' width='10' height='2'/></g></g></g></svg>" }, "images/comments/more.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><path fill-rule='evenodd' clip-rule='evenodd' stroke='currentColor' stroke-miterlimit='10' d='M8.042,0.528 c4.027,0,7.292,3.347,7.292,7.475s-3.265,7.475-7.292,7.475S0.75,12.131,0.75,8.003S4.015,0.528,8.042,0.528z'/><g fill='currentColor'><rect x='5.5' y='7' fill-rule='evenodd' clip-rule='evenodd' width='5' height='1'/><rect x='6.5' y='8' fill-rule='evenodd' clip-rule='evenodd' width='3' height='1'/><rect x='7.5' y='9' fill-rule='evenodd' clip-rule='evenodd' width='1' height='1'/></g></svg>" }, "images/comments/open_all_comments_small_panel_24x24.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Doubble_boubble'><g><g class='sf-element sf-element-svg-element sfc-new-comment' fill='currentColor'><path d='M15.5,4C10.806,4,7,6.513,7,9.614c0,3.101,3.806,5.614,8.5,5.614c0.293,0,0.575-0.01,0.86-0.029V18l4.113-3.84 C22.607,13.14,24,11.486,24,9.614C24,6.513,20.194,4,15.5,4z'/></g></g><g><g class='sf-element sf-element-svg-element' fill='currentColor'><path d='M8.5,6C3.806,6,0,8.513,0,11.614c0,3.101,3.806,5.614,8.5,5.614c0.293,0,0.575-0.01,0.86-0.029V20 l4.113-3.84C15.607,15.14,17,13.486,17,11.614C17,8.513,13.194,6,8.5,6z'/></g></g></g></svg>" }, "images/comments/reloadpanel.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g><g><path d='M9.716,1.9c-2.332-2.245-6.11-2.201-8.444,0.108C0.718,2.557,0.293,3.186,0,3.856l1.275,0.581 c0.225-0.53,0.555-1.027,0.992-1.459C4.049,1.216,6.932,1.18,8.716,2.89L6.769,5H12V0L9.716,1.9z'/></g></g><g><g><path d='M10.728,7.553c-0.224,0.531-0.554,1.029-0.99,1.462c-1.778,1.767-4.656,1.802-6.437,0.089L5.244,7H0v5 l2.303-1.904c2.327,2.249,6.098,2.206,8.427-0.108c0.554-0.55,0.977-1.181,1.27-1.852L10.728,7.553z'/></g></g></svg>" }, "images/comments/replyincontext.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g id='Bg'><g id='XMLID_30_'><g id='XMLID_49_'><path id='XMLID_50_' class='sf-element sf-element-svg-element sfc-comment-inline-reply-arrow-outer' fill='currentColor' d='M0,0v16c0,0,4.334-3.595,5.981-4.923C7.933,12.633,12,16,12,16V0H0z'/></g></g></g><g id='Arrow'><g id='XMLID_34_'><g id='XMLID_56_'><path id='XMLID_58_' class='sf-element sf-element-svg-element sfc-comment-inline-reply-arrow-outer' stroke='currentColor' d='M9.013,4.333V1.238C9.013,1.107,8.911,1,8.785,1C8.734,1,8.69,1.021,8.653,1.049 L8.65,1.046L3.094,5.57l0.002,0.003C3.039,5.616,3,5.683,3,5.762c0,0.079,0.039,0.146,0.096,0.189L3.094,5.954l5.557,4.524 l0.002-0.004c0.038,0.029,0.082,0.049,0.132,0.049c0.126,0,0.228-0.107,0.228-0.238V7.19C13.345,7.19,16,11,16,11 C16,4.333,9.013,4.333,9.013,4.333z'/><path id='XMLID_57_' class='sf-element sf-element-svg-element sfc-comment-inline-reply-arrow-inner' fill='currentColor' d='M9.013,4.333V1.238C9.013,1.107,8.911,1,8.785,1C8.734,1,8.69,1.021,8.653,1.049 L8.65,1.046L3.094,5.57l0.002,0.003C3.039,5.616,3,5.683,3,5.762c0,0.079,0.039,0.146,0.096,0.189L3.094,5.954l5.557,4.524 l0.002-0.004c0.038,0.029,0.082,0.049,0.132,0.049c0.126,0,0.228-0.107,0.228-0.238V7.19C13.345,7.19,16,11,16,11 C16,4.333,9.013,4.333,9.013,4.333z'/></g></g></g></svg>" }, "images/comments/resetfilter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 13' enable-background='new 0 0 13 13' xml:space='preserve'><g id='Lager_2'><g><g><circle class='sf-element sf-element-svg-element sfc-reset-circle' fill='currentColor' cx='6.5' cy='6.5' r='6.5'/></g></g></g><g id='Lager_4'><g><g><polygon class='sf-element sf-element-svg-element sfc-reset-cross' fill='currentColor' points='7.713,6.503 10,4.214 8.787,3 6.5,5.289 4.213,3 3,4.214 5.287,6.503 3.006,8.786 4.219,10 6.5,7.717 8.781,10 9.994,8.786 7.713,6.503 '/></g></g></g></svg>" }, "images/contextualpopout/crosstable/1.sortingarrowup16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M3.284,8H6v4.5a1.5,1.5,0,1,0,3,0V8h2.745a1.132,1.132,0,0,0,0-1.409L8.362,2.431a1.047,1.047,0,0,0-1.693,0L3.284,6.591A1.028,1.028,0,0,0,3.284,8Z'/></svg>" }, "images/contextualpopout/crosstable/10.txtheightcentre16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='1' y='10' width='14' height='1'/><rect x='5' y='7' width='6' height='1'/><rect x='1' y='4' width='14' height='1'/></svg>" }, "images/contextualpopout/crosstable/11.txtdown16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><polygon points='8.997 3 8.997 1 7.997 1 7.997 3 5.997 3 8.497 6 10.997 3 8.997 3'/><rect x='1' y='8' width='14' height='1'/><rect x='5' y='11' width='6' height='1'/><rect x='1' y='14' width='14' height='1'/></svg>" }, "images/contextualpopout/crosstable/12.horizontal16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M5.922,3H6.8V5.471a2,2,0,0,1,.714-0.545,2.163,2.163,0,0,1,.9-0.188,2.209,2.209,0,0,1,1.643.637,2.565,2.565,0,0,1,.631,1.88,3.036,3.036,0,0,1-.622,1.956,2.09,2.09,0,0,1-1.727.779A1.893,1.893,0,0,1,7.3,9.718,2.425,2.425,0,0,1,6.759,9.2V9.833H5.922V3ZM9.393,8.717A2.471,2.471,0,0,0,9.76,7.3,2.177,2.177,0,0,0,9.393,6a1.241,1.241,0,0,0-1.08-.515,1.578,1.578,0,0,0-1.091.422A1.794,1.794,0,0,0,6.754,7.3a2.843,2.843,0,0,0,.192,1.136,1.334,1.334,0,0,0,1.341.821A1.249,1.249,0,0,0,9.393,8.717Z'/><path d='M15.312,5.133A1.9,1.9,0,0,1,16,6.537H15.117a1.442,1.442,0,0,0-.368-0.763,1.222,1.222,0,0,0-.923-0.3,1.279,1.279,0,0,0-1.241.778,2.868,2.868,0,0,0-.242,1.246,2.192,2.192,0,0,0,.343,1.255,1.207,1.207,0,0,0,1.079.509,1.241,1.241,0,0,0,.895-0.315,1.684,1.684,0,0,0,.457-0.866H16a2.119,2.119,0,0,1-.757,1.444,2.5,2.5,0,0,1-1.549.457,2.145,2.145,0,0,1-1.69-.712,2.582,2.582,0,0,1-.631-1.778,2.837,2.837,0,0,1,.691-2.035,2.321,2.321,0,0,1,1.76-.728A2.5,2.5,0,0,1,15.312,5.133Z'/><path d='M3.148,6.828a0.5,0.5,0,0,0,.419-0.241,0.685,0.685,0,0,0,.061-0.321A0.665,0.665,0,0,0,3.3,5.646a1.885,1.885,0,0,0-.944-0.193,1.251,1.251,0,0,0-1.007.354,1.115,1.115,0,0,0-.216.582H0.282A1.4,1.4,0,0,1,.93,5.108a2.831,2.831,0,0,1,1.444-.36,3.142,3.142,0,0,1,1.547.334,1.112,1.112,0,0,1,.59,1.038V8.98a0.345,0.345,0,0,0,.058.21,0.3,0.3,0,0,0,.245.078c0.04,0,.086,0,0.136-0.006s0.1-.012.161-0.021V9.857a2.668,2.668,0,0,1-.323.069,2.535,2.535,0,0,1-.3.015A0.769,0.769,0,0,1,3.8,9.635a1.116,1.116,0,0,1-.156-0.46,2.293,2.293,0,0,1-.8.58A2.653,2.653,0,0,1,1.7,10,1.789,1.789,0,0,1,.477,9.581,1.336,1.336,0,0,1,0,8.533a1.3,1.3,0,0,1,.469-1.07A2.341,2.341,0,0,1,1.7,7ZM1.236,9.083a1.134,1.134,0,0,0,.681.209,2.23,2.23,0,0,0,.928-0.2A1.143,1.143,0,0,0,3.6,7.981V7.31a1.638,1.638,0,0,1-.428.163,3.885,3.885,0,0,1-.513.093l-0.549.065a2.274,2.274,0,0,0-.742.19,0.728,0.728,0,0,0-.421.694A0.664,0.664,0,0,0,1.236,9.083Z'/></svg>" }, "images/contextualpopout/crosstable/13.vertical16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M4,10.078V9.2H6.471a2,2,0,0,1-.545-0.714,2.163,2.163,0,0,1-.188-0.9,2.209,2.209,0,0,1,.637-1.643,2.565,2.565,0,0,1,1.88-.631,3.036,3.036,0,0,1,1.956.622,2.09,2.09,0,0,1,.779,1.727A1.893,1.893,0,0,1,10.718,8.7a2.425,2.425,0,0,1-.519.542h0.634v0.837H4ZM9.717,6.607A2.471,2.471,0,0,0,8.3,6.24,2.177,2.177,0,0,0,7,6.607a1.241,1.241,0,0,0-.515,1.08,1.578,1.578,0,0,0,.422,1.091A1.794,1.794,0,0,0,8.3,9.246a2.843,2.843,0,0,0,1.136-.192,1.334,1.334,0,0,0,.821-1.341A1.249,1.249,0,0,0,9.717,6.607Z'/><path d='M6.133,0.688A1.9,1.9,0,0,1,7.537,0V0.883a1.442,1.442,0,0,0-.763.368,1.222,1.222,0,0,0-.3.923,1.279,1.279,0,0,0,.778,1.241,2.868,2.868,0,0,0,1.246.242,2.192,2.192,0,0,0,1.255-.343,1.207,1.207,0,0,0,.509-1.079A1.241,1.241,0,0,0,9.943,1.34,1.684,1.684,0,0,0,9.076.883V0a2.119,2.119,0,0,1,1.444.757,2.5,2.5,0,0,1,.457,1.549,2.145,2.145,0,0,1-.712,1.69,2.582,2.582,0,0,1-1.778.631,2.837,2.837,0,0,1-2.035-.691,2.321,2.321,0,0,1-.728-1.76A2.5,2.5,0,0,1,6.133.688Z'/><path d='M7.828,12.852a0.5,0.5,0,0,0-.241-0.419,0.685,0.685,0,0,0-.321-0.061,0.665,0.665,0,0,0-.621.33,1.885,1.885,0,0,0-.193.944,1.251,1.251,0,0,0,.354,1.007,1.115,1.115,0,0,0,.582.216v0.847a1.4,1.4,0,0,1-1.281-.647,2.831,2.831,0,0,1-.36-1.444,3.142,3.142,0,0,1,.334-1.547,1.112,1.112,0,0,1,1.038-.59H9.98a0.345,0.345,0,0,0,.21-0.058,0.3,0.3,0,0,0,.078-0.245c0-.04,0-0.086-0.006-0.136s-0.012-.1-0.021-0.161h0.618a2.668,2.668,0,0,1,.069.323,2.535,2.535,0,0,1,.015.3,0.769,0.769,0,0,1-.306.681,1.116,1.116,0,0,1-.46.156,2.293,2.293,0,0,1,.58.8A2.653,2.653,0,0,1,11,14.3a1.789,1.789,0,0,1-.419,1.228A1.336,1.336,0,0,1,9.533,16a1.3,1.3,0,0,1-1.07-.469A2.341,2.341,0,0,1,8,14.3Zm2.255,1.912a1.134,1.134,0,0,0,.209-0.681,2.23,2.23,0,0,0-.2-0.928A1.143,1.143,0,0,0,8.981,12.4H8.31a1.638,1.638,0,0,1,.163.428,3.885,3.885,0,0,1,.093.513l0.065,0.549a2.274,2.274,0,0,0,.19.742,0.728,0.728,0,0,0,.694.421A0.664,0.664,0,0,0,10.083,14.764Z'/></svg>" }, "images/contextualpopout/crosstable/14.hide16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path class='cls-2' d='M5.081,10.343A3.468,3.468,0,0,0,8,11.968a3.557,3.557,0,0,0,3.5-3.612,3.665,3.665,0,0,0-.382-1.61'/><path d='M13.35,5.545L11.223,6.812A3.331,3.331,0,0,1,11.5,8.356,3.557,3.557,0,0,1,8,11.968a3.256,3.256,0,0,1-2.8-1.605L3.278,11.506A9.579,9.579,0,0,0,8,13c3.714,0,8-3.405,8-4.644C16,7.718,14.962,6.571,13.35,5.545Z'/><path d='M5.964,9.979a2.3,2.3,0,0,0,2.042.957A2.5,2.5,0,0,0,10.5,8.351,2.053,2.053,0,0,0,10.3,7.4Z'/><path d='M14.22,3L11.257,4.439A8.678,8.678,0,0,0,8,3.713a8.718,8.718,0,0,0-3.3.741l-0.075.03v0C2.1,5.566,0,7.49,0,8.356A3.577,3.577,0,0,0,1.454,10.28L0,11.207,0.5,12.1l14.483-8.36ZM8.02,5.777A2.5,2.5,0,0,0,5.549,7.84l-1.04.62c0-.035-0.009-0.068-0.009-0.1A3.557,3.557,0,0,1,8,4.745,3.352,3.352,0,0,1,9.818,5.3L8.79,5.909A2.421,2.421,0,0,0,8.02,5.777Z'/></svg>" }, "images/contextualpopout/crosstable/15.markvaluesvertical16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M12,3H4A2,2,0,0,0,2,5v6a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V5A2,2,0,0,0,12,3Zm1,8a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V5A1,1,0,0,1,4,4h8a1,1,0,0,1,1,1v6Z'/><path style='fill:#f99b15' d='M9,1H7A2,2,0,0,0,5,3V13a2,2,0,0,0,2,2H9a2,2,0,0,0,2-2V3A2,2,0,0,0,9,1ZM9,14H7a1,1,0,0,1-1-1V3A1,1,0,0,1,7,2H9a1,1,0,0,1,1,1V13h0A1,1,0,0,1,9,14Z'/></svg>" }, "images/contextualpopout/crosstable/16.markvalueshorizontal16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M12.167,3H3.833A1.922,1.922,0,0,0,2,5v6a1.922,1.922,0,0,0,1.833,2h8.333A1.922,1.922,0,0,0,14,11V5A1.922,1.922,0,0,0,12.167,3Zm0.917,8a0.961,0.961,0,0,1-.917,1H3.833a0.961,0.961,0,0,1-.917-1V5a0.961,0.961,0,0,1,.917-1h8.333a0.961,0.961,0,0,1,.917,1v6Z'/><path style='fill:#f99b15' d='M14,5H2A2,2,0,0,0,0,7V9a2,2,0,0,0,2,2H14a2,2,0,0,0,2-2V7A2,2,0,0,0,14,5Zm1,4a1,1,0,0,1-1,1H2A1,1,0,0,1,1,9V7A1,1,0,0,1,2,6H14a1,1,0,0,1,1,1V9Z'/></svg>" }, "images/contextualpopout/crosstable/2.sortingarrowdown16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M11.718,8H9V3.5a1.5,1.5,0,0,0-3,0V8H3.256a1.132,1.132,0,0,0,0,1.409l3.385,4.161a1.047,1.047,0,0,0,1.693,0l3.385-4.161A1.028,1.028,0,0,0,11.718,8Z'/></svg>" }, "images/contextualpopout/crosstable/3.sizewidthtofit16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M14.623,7.261L10.983,4.252a0.889,0.889,0,0,0-1.233,0V7H6.25V4.227a0.978,0.978,0,0,0-1.232,0L1.377,7.236a0.939,0.939,0,0,0,0,1.5l3.641,3.009a0.889,0.889,0,0,0,1.233,0V9h3.5v2.774a0.978,0.978,0,0,0,1.233,0l3.641-3.009A0.939,0.939,0,0,0,14.623,7.261Z'/><rect class='cls-2' x='15' y='2' width='1' height='12'/><rect y='2' width='1' height='12'/></svg>" }, "images/contextualpopout/crosstable/4.columnwidth16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M15.713,7.445L12.939,5.189a0.685,0.685,0,0,0-.939,0V7H10V2H9V14h1V9h2v1.83a0.755,0.755,0,0,0,.939,0l2.774-2.257A0.7,0.7,0,0,0,15.713,7.445Z' transform='translate(0)'/><path d='M6,2V7H4V5.189a0.685,0.685,0,0,0-.939,0L0.287,7.445a0.7,0.7,0,0,0,0,1.128L3.061,10.83a0.755,0.755,0,0,0,.939,0V9H6v5H7V2H6Z' transform='translate(0)'/></svg>" }, "images/contextualpopout/crosstable/5.adjustrowheighttocontent16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='2' width='1' height='1' transform='translate(2 3) rotate(-90)'/><rect x='4' width='1' height='1' transform='translate(4 5) rotate(-90)'/><rect x='6' width='1' height='1' transform='translate(6 7) rotate(-90)'/><rect x='8' width='1' height='1' transform='translate(8 9) rotate(-90)'/><rect x='10' width='1' height='1' transform='translate(10 11) rotate(-90)'/><rect x='12' width='1' height='1' transform='translate(12 13) rotate(-90)'/><rect x='14' width='1' height='1' transform='translate(14 15) rotate(-90)'/><rect x='2' y='15' width='1' height='1' transform='translate(-13 18) rotate(-90)'/><rect x='4' y='15' width='1' height='1' transform='translate(-11 20) rotate(-90)'/><rect x='6' y='15' width='1' height='1' transform='translate(-9 22) rotate(-90)'/><rect x='8' y='15' width='1' height='1' transform='translate(-7 24) rotate(-90)'/><rect x='10' y='15' width='1' height='1' transform='translate(-5 26) rotate(-90)'/><rect x='12' y='15' width='1' height='1' transform='translate(-3 28) rotate(-90)'/><rect x='14' y='15' width='1' height='1' transform='translate(-1 30) rotate(-90)'/><path d='M9,10V6h2.773a0.9,0.9,0,0,0,0-1.174L8.765,1.359a0.968,0.968,0,0,0-1.5,0L4.252,4.826A0.818,0.818,0,0,0,4.252,6H7v4H4.227a0.9,0.9,0,0,0,0,1.174l3.009,3.467a0.968,0.968,0,0,0,1.5,0l3.009-3.467a0.818,0.818,0,0,0,0-1.174H9Z' transform='translate(0 0)'/></svg>" }, "images/contextualpopout/crosstable/6.txtleft16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='1' y='13' width='14' height='1'/><rect x='1' y='10' width='6' height='1'/><rect x='1' y='7' width='9' height='1'/><rect x='1' y='4.002' width='6' height='1'/><rect x='1' y='1' width='14' height='1'/></svg>" }, "images/contextualpopout/crosstable/7.txtwidthcenter16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='1' y='13' width='14' height='1'/><rect x='6.004' y='10' width='4' height='1'/><rect x='2.999' y='7' width='10' height='1'/><rect x='5' y='4.003' width='6' height='1'/><rect x='1' y='1' width='14' height='1'/></svg>" }, "images/contextualpopout/crosstable/8.txtright16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='1' y='13' width='14' height='1'/><rect x='9' y='10' width='6' height='1'/><rect x='6' y='7' width='9' height='1'/><rect x='9' y='4.002' width='6' height='1'/><rect x='1' y='1' width='14' height='1'/></svg>" }, "images/contextualpopout/crosstable/9.txtup16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><polygon points='7.503 10 5.003 13 7.003 13 7.003 15 8.003 15 8.003 13 10.003 13 7.503 10'/><rect x='1' y='7' width='14' height='1'/><rect x='5' y='4' width='6' height='1'/><rect x='1' y='1' width='14' height='1'/></svg>" }, "images/contextualpopout/plotinteraction/1.general_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M13.9,3.98l-0.753-.862a0.325,0.325,0,0,0-.5,0L7.245,9.3l-2.887-3.3a0.325,0.325,0,0,0-.5,0L3.1,6.854a0.451,0.451,0,0,0,0,.575l3.891,4.453a0.325,0.325,0,0,0,.5,0l6.4-7.326A0.451,0.451,0,0,0,13.9,3.98Z'/></svg>" }, "images/contextualpopout/plotinteraction/10.referencelinevertical_16x16.svg": { result: "<svg data-name='Layer 4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><rect style='opacity:0.7;' width='1' height='16'/><rect style='opacity:0.7;' x='1' y='15' width='15' height='1'/><rect x='7' width='2' height='16'/></svg>'Mark values (Alt+click)'Sort header 'Select sorting mode (Shift+click)'ta bort shift+click p?options'Adapt column width to content (double-click divider)''Specify column width''Specify alignment and orientation''Specify alignment'" }, "images/contextualpopout/plotinteraction/11.stacked_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/><rect style='fill:#f99b15' x='11' y='9.004' width='2' height='6'/><rect style='fill:#f99b15' x='7' y='12.002' width='2' height='3'/><rect style='fill:#f99b15' x='3' y='11.005' width='2' height='4'/><rect x='11' y='1.001' width='2' height='7'/><rect x='7' y='4.003' width='2' height='7'/><rect x='3' y='6.001' width='2' height='4'/></svg>" }, "images/contextualpopout/plotinteraction/12.sidebysidebars_16x16.svg": { result: "<svg data-name='Layer 4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='3' y='5' width='2' height='10'/><rect x='9' y='8' width='2' height='7'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/><rect style='fill:#f99b15' x='6' y='11' width='2' height='4'/><rect style='fill:#f99b15' x='12' y='5' width='2' height='10'/></svg>" }, "images/contextualpopout/plotinteraction/13.label16x16.svg": { result: "<svg data-name='Layer 5' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/><rect x='11' y='11' width='2' height='4'/><rect x='7' y='11' width='2' height='4'/><rect x='3' y='8' width='2' height='7'/><rect style='fill:#f99b15' x='11' width='2' height='10'/><rect style='fill:#f99b15' x='7' width='2' height='10'/><rect style='fill:#f99b15' x='3' width='2' height='7'/></svg>" }, "images/contextualpopout/plotinteraction/14.100stacked16x16.svg": { result: "<svg data-name='Layer 5' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='11' y='3' width='2' height='12'/><rect x='3' y='4' width='2' height='11'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/><rect style='fill:#f99b15;' x='7' y='8' width='2' height='7'/></svg>" }, "images/contextualpopout/plotinteraction/15.horizontalbars_16x16.svg": { result: "<svg data-name='Layer 5' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='1' y='3' width='12' height='2'/><rect x='1' y='11' width='11' height='2'/><rect y='15' width='16' height='1'/><rect width='1' height='15'/><rect style='fill:#f99b15' x='1' y='7' width='7' height='2'/></svg>" }, "images/contextualpopout/plotinteraction/16.onlytop_16x16.svg": { result: "<svg data-name='Layer 3' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><title>16.OnlyTop_16x16</title><rect x='11' y='12' width='2' height='3'/><rect x='3' y='4' width='2' height='11'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/><rect x='7' y='8' width='2' height='7'/></svg>" }, "images/contextualpopout/plotinteraction/17.label_16x16.svg": { result: "<svg data-name='Layer 4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='3' y='3' width='2' height='12'/><g><rect style='fill:#fbb95c' x='12' y='11' width='2' height='4'/><rect style='opacity:0.7;' x='9' y='8' width='2' height='7'/></g><rect style='fill:#f99b15' x='6' y='6' width='2' height='9'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/></svg>" }, "images/contextualpopout/plotinteraction/18.markers_16x16.svg": { result: "<svg data-name='Layer 7' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><circle style='fill:#f99b15' cx='14' cy='10' r='1'/><circle style='fill:#f99b15' cx='9' cy='4' r='1'/><circle style='fill:#f99b15' cx='4' cy='10.999' r='1'/><rect y='15' width='16' height='1'/><rect width='1' height='15'/><rect x='10.97' y='5.909' width='1.061' height='3.182' transform='translate(-1.935 10.328) rotate(-45)'/><polygon points='7.829 6 5 9.2 5.707 10 8.536 6.8 7.829 6'/></svg>" }, "images/contextualpopout/plotinteraction/19.reverse_16x16.svg": { result: "<svg data-name='Layer 3' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='3' y='12' width='2' height='3'/><rect style='fill:#f99b15' x='7' y='8' width='2' height='7'/><rect x='11' y='4' width='2' height='11'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/></svg>" }, "images/contextualpopout/plotinteraction/2.numbers_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><path d='M5,10.043L7.143,8.022C8,7.224,8.308,6.78,8.308,6.159a0.983,0.983,0,0,0-1-1.075A1.8,1.8,0,0,0,5.862,6.12l-0.773-.67A2.516,2.516,0,0,1,7.383,4,1.954,1.954,0,0,1,9.437,6.061V6.08c0,1.085-.517,1.676-1.619,2.672L6.538,9.935H9.5V11H5V10.043Z'/><path d='M2.387,5.241l-1.149.348L1,4.6,2.715,4H3.5v7H2.387V5.241Z'/><path d='M10,9.791L10.838,9a2.219,2.219,0,0,0,1.793.9,1.072,1.072,0,0,0,1.18-1.042V8.847c0-.678-0.614-1.062-1.57-1.062H11.687l-0.2-.757,1.842-1.976H10.38V4h4.513V4.9l-1.9,1.966A1.974,1.974,0,0,1,15,8.807v0.02A2.191,2.191,0,0,1,12.612,11,3.224,3.224,0,0,1,10,9.791Z'/></svg>" }, "images/contextualpopout/plotinteraction/20.date_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M12,2H4A2,2,0,0,0,2,4v8a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V4A2,2,0,0,0,12,2ZM10,3h2V5H10V3ZM4,3H6V5H4V3Zm9,9a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V7A1,1,0,0,1,4,6h8a1,1,0,0,1,1,1v5Z'/><polygon points='10.373 7 9 7.425 9.19 8.135 10.109 7.887 10.109 12 11 12 11 7 10.373 7'/><path d='M6.594,9.051l1.331-1.4V7H4.766V7.751H6.833L5.544,9.163,5.68,9.7H6.069a0.9,0.9,0,0,1,1.1.758v0.015a0.756,0.756,0,0,1-.825.744,1.545,1.545,0,0,1-1.256-.646L4.5,11.136A2.24,2.24,0,0,0,6.328,12,1.547,1.547,0,0,0,8,10.448V10.434A1.4,1.4,0,0,0,6.594,9.051Z'/></svg>" }, "images/contextualpopout/plotinteraction/21.011_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M1,8.017V8C1,6.343,2,5,3.508,5S6,6.326,6,7.984V8c0,1.658-1,3-2.508,3S1,9.674,1,8.017Zm3.959,0V8c0-1.144-.582-2.08-1.468-2.08s-1.451.912-1.451,2.063V8c0,1.143.574,2.081,1.467,2.081S4.959,9.16,4.959,8.017Z'/><path d='M11,7h1V8H11V7Zm0,2h1v1H11V9Z'/><path d='M14.109,6.063l-0.919.3L13,5.51,14.372,5H15v6H14.109V6.063Z'/><rect x='7' y='7' width='1' height='1'/><path d='M7,9H8v1H7V9Z'/><path d='M9.11,6.063l-0.92.3L8,5.51,9.373,5H10v6H9.11V6.063Z'/></svg>" }, "images/contextualpopout/plotinteraction/3.percentage_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><path d='M3,5.528V5.5A2.319,2.319,0,0,1,5.2,3,2.29,2.29,0,0,1,7.383,5.472V5.5A2.319,2.319,0,0,1,5.178,8,2.29,2.29,0,0,1,3,5.528Zm7.742-2.417h1.315l-6.8,9.777H3.943ZM6.2,5.528V5.5A1.253,1.253,0,0,0,5.178,4.075a1.206,1.206,0,0,0-1,1.4V5.5A1.245,1.245,0,0,0,5.2,6.925,1.205,1.205,0,0,0,6.2,5.528Zm2.416,5V10.5A2.32,2.32,0,0,1,10.822,8,2.29,2.29,0,0,1,13,10.473V10.5A2.319,2.319,0,0,1,10.8,13,2.29,2.29,0,0,1,8.617,10.529Zm3.2,0V10.5A1.254,1.254,0,0,0,10.8,9.076a1.205,1.205,0,0,0-1,1.4V10.5a1.244,1.244,0,0,0,1.022,1.425A1.206,1.206,0,0,0,11.818,10.529Z'/></svg>" }, "images/contextualpopout/plotinteraction/4.currency_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M8.761,6.991V4.327a5.3,5.3,0,0,1,2.03.9l0.836-1.318A5.926,5.926,0,0,0,8.82,2.841V2h-1.3V2.813c-1.865.14-3.134,1.164-3.134,2.678V5.519c0,1.57,1.015,2.341,3.194,2.874V11.14A5.563,5.563,0,0,1,4.955,9.935L4,11.21A7.173,7.173,0,0,0,7.522,12.6V14h1.3V12.612c1.9-.154,3.18-1.177,3.18-2.705V9.879C12,8.379,11.03,7.523,8.761,6.991ZM7.582,6.7C6.432,6.374,6.149,6,6.149,5.42V5.393A1.288,1.288,0,0,1,7.582,4.229V6.7ZM10.239,10A1.317,1.317,0,0,1,8.761,11.2V8.659c1.164,0.323,1.478.7,1.478,1.318V10Z'/></svg>" }, "images/contextualpopout/plotinteraction/5.scientific_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><polygon points='4.059 5 2 5.596 2.285 6.589 3.664 6.241 3.664 12 5 12 5 5 4.059 5'/><path d='M9.01,5C7.2,5,6,6.566,6,8.5V8.519C6,10.453,7.18,12,8.99,12S12,10.433,12,8.5V8.481C12,6.547,10.81,5,9.01,5Zm1.741,3.519c0,1.334-.669,2.408-1.741,2.408S7.25,9.834,7.25,8.5V8.481c0-1.344.679-2.408,1.74-2.408S10.752,7.166,10.752,8.5V8.519Z'/><polygon points='15 3.812 14.188 3 13 4.188 11.812 3 11 3.812 12.188 5 11 6.188 11.812 7 13 5.812 14.188 7 15 6.188 13.812 5 15 3.812'/></svg>" }, "images/contextualpopout/plotinteraction/6.ab12_16x16.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><defs></defs><path d='M13.367,10.087l1.139-1.014c0.98-.854,1.438-1.361,1.438-2.291V6.766A1.706,1.706,0,0,0,14.118,5a2.245,2.245,0,0,0-2.04,1.242l0.687,0.575a1.6,1.6,0,0,1,1.281-.887,0.857,0.857,0,0,1,.894.921,2.194,2.194,0,0,1-1.036,1.6L12,10.18V11h4V10.087H13.367Z'/><polygon points='10.372 5 9 5.51 9.19 6.362 10.109 6.064 10.109 11 11 11 11 5 10.372 5'/><path d='M7.2,6.547a1.52,1.52,0,0,0-1.311.8V5H5v5.911H5.887V10.247A1.541,1.541,0,0,0,7.2,11,1.972,1.972,0,0,0,9,8.782V8.765A1.976,1.976,0,0,0,7.2,6.547ZM8.1,8.782A1.208,1.208,0,0,1,6.993,10.15,1.237,1.237,0,0,1,5.865,8.782V8.765A1.241,1.241,0,0,1,6.993,7.4,1.222,1.222,0,0,1,8.1,8.765V8.782Z'/><path d='M2.063,6a3.51,3.51,0,0,0-1.679.4L0.66,7.289a2.848,2.848,0,0,1,1.261-.3A0.955,0.955,0,0,1,3.006,8.02V8.111a3.426,3.426,0,0,0-1.219-.2A1.558,1.558,0,0,0,0,9.492V9.51A1.461,1.461,0,0,0,1.57,11,1.724,1.724,0,0,0,3,10.305V10.9H4V8.038A1.782,1.782,0,0,0,2.063,6Zm0.96,3.153a1.06,1.06,0,0,1-1.169,1.015A0.749,0.749,0,0,1,1,9.455V9.437a0.833,0.833,0,0,1,1.011-.749,2.664,2.664,0,0,1,1.01.192V9.153Z'/></svg>" }, "images/contextualpopout/plotinteraction/7.gridlineshorizontal16x16.svg": { result: "<svg data-name='Layer 3' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='2' y='4' width='1' height='1'/><rect x='5' y='4' width='1' height='1'/><rect x='8' y='4' width='1' height='1'/><rect x='11' y='4' width='1' height='1'/><rect x='14' y='4' width='1' height='1'/><rect x='2' y='9' width='1' height='1'/><rect x='5' y='9' width='1' height='1'/><rect x='8' y='9' width='1' height='1'/><rect x='11' y='9' width='1' height='1'/><rect x='14' y='9' width='1' height='1'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/></svg>" }, "images/contextualpopout/plotinteraction/8.gridlinesvertical16x16.svg": { result: "<svg data-name='Layer 3' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='10' y='1' width='1' height='1'/><rect x='10' y='4' width='1' height='1'/><rect x='10' y='7' width='1' height='1'/><rect x='10' y='10' width='1' height='1'/><rect x='10' y='13' width='1' height='1'/><rect x='5' y='1' width='1' height='1'/><rect x='5' y='4' width='1' height='1'/><rect x='5' y='7' width='1' height='1'/><rect x='5' y='10' width='1' height='1'/><rect x='5' y='13' width='1' height='1'/><rect width='1' height='16'/><rect x='1' y='15' width='15' height='1'/></svg>" }, "images/contextualpopout/plotinteraction/9.referencelinehorizontal_16x16.svg": { result: "<svg data-name='Layer 4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect style='opacity:0.7;' width='1' height='16'/><rect style='opacity:0.7;' x='1' y='15' width='15' height='1'/><rect y='7' width='16' height='2'/></svg>" }, "images/controls/styleddropdownarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 21 20' enable-background='new 0 0 21 20' xml:space='preserve'><path fill='currentColor' d='M7,8l3.5,4L14,8C11.614,8,7,8,7,8z'/></svg>" }, "images/data/addcolumn.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 13' enable-background='new 0 0 13 13' xml:space='preserve'><g><g><path fill='currentColor' d='M6.5,0C2.91,0,0,2.91,0,6.5S2.91,13,6.5,13S13,10.09,13,6.5S10.09,0,6.5,0z M6.5,12C3.467,12,1,9.533,1,6.5S3.467,1,6.5,1 S12,3.467,12,6.5S9.533,12,6.5,12z'/></g></g><g><g><rect fill='currentColor' x='6' y='6' width='1' height='1'/></g></g><g><g><rect fill='currentColor' x='6' y='4' width='1' height='2'/></g></g><g><g><rect fill='currentColor' x='7' y='6' width='2' height='1'/></g></g><g><g><rect fill='currentColor' x='6' y='7' width='1' height='2'/></g></g><g><g><rect fill='currentColor' x='4' y='6' width='2' height='1'/></g></g></svg>" }, "images/data/binary.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 9 9' enable-background='new 0 0 9 9' xml:space='preserve'><g><path fill='currentColor' d='M1.7,0H0.3C0.1,0,0,0.1,0,0.3v1.5C0,1.9,0.1,2,0.3,2h1.5C1.9,2,2,1.9,2,1.7V0.3C2,0.1,1.9,0,1.7,0z'/></g><g><path fill='currentColor' d='M1.7,3.5H0.3C0.1,3.5,0,3.6,0,3.8v1.5c0,0.1,0.1,0.3,0.3,0.3h1.5C1.9,5.5,2,5.4,2,5.2V3.8 C2,3.6,1.9,3.5,1.7,3.5z'/></g><g><path fill='currentColor' d='M1.7,7H0.3C0.1,7,0,7.1,0,7.3v1.5C0,8.9,0.1,9,0.3,9h1.5C1.9,9,2,8.9,2,8.7V7.3C2,7.1,1.9,7,1.7,7z'/></g><g><path fill='currentColor' d='M5.2,0H3.8C3.6,0,3.5,0.1,3.5,0.3v1.5C3.5,1.9,3.6,2,3.8,2h1.5c0.1,0,0.3-0.1,0.3-0.3V0.3 C5.5,0.1,5.4,0,5.2,0z'/></g><g><path fill='currentColor' d='M5.2,3.5H3.8c-0.1,0-0.3,0.1-0.3,0.3v1.5c0,0.1,0.1,0.3,0.3,0.3h1.5c0.1,0,0.3-0.1,0.3-0.3V3.8 C5.5,3.6,5.4,3.5,5.2,3.5z'/></g><g opacity='0.65'><path fill='currentColor' d='M5.2,7H3.8C3.6,7,3.5,7.1,3.5,7.3v1.5C3.5,8.9,3.6,9,3.8,9h1.5c0.1,0,0.3-0.1,0.3-0.3V7.3 C5.5,7.1,5.4,7,5.2,7z'/></g><g><path fill='currentColor' d='M8.7,0H7.3C7.1,0,7,0.1,7,0.3v1.5C7,1.9,7.1,2,7.3,2h1.5C8.9,2,9,1.9,9,1.7V0.3C9,0.1,8.9,0,8.7,0z'/></g><g opacity='0.65'><path fill='currentColor' d='M8.7,3.5H7.3C7.1,3.5,7,3.6,7,3.8v1.5c0,0.1,0.1,0.3,0.3,0.3h1.5C8.9,5.5,9,5.4,9,5.2V3.8 C9,3.6,8.9,3.5,8.7,3.5z'/></g><g><path fill='currentColor' d='M8.7,7H7.3C7.1,7,7,7.1,7,7.3v1.5C7,8.9,7.1,9,7.3,9h1.5C8.9,9,9,8.9,9,8.7V7.3C9,7.1,8.9,7,8.7,7z'/></g></svg>" }, "images/data/categories.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 13' enable-background='new 0 0 14 13' xml:space='preserve'><path fill='currentColor' d='M7.248,7C7.182,7,7.116,6.986,7.054,6.958L0.557,3.96C0.402,3.888,0.3,3.736,0.294,3.567 C0.287,3.397,0.377,3.238,0.527,3.155l5.587-3.098C6.244-0.014,6.4-0.019,6.533,0.042l6.497,2.998 c0.155,0.072,0.257,0.223,0.264,0.393c0.007,0.169-0.084,0.328-0.233,0.411L7.473,6.942C7.403,6.981,7.326,7,7.248,7z M1.753,3.513 L7.229,6.04l4.604-2.553L6.358,0.96L1.753,3.513z'/><path fill='currentColor' d='M7.32,10.013c-0.069,0-0.138-0.014-0.202-0.042L0.266,6.968C0.033,6.866-0.066,6.61,0.046,6.397 C0.157,6.183,0.438,6.093,0.67,6.195l6.634,2.908l6.002-3.037c0.227-0.115,0.511-0.039,0.636,0.168 c0.125,0.207,0.043,0.467-0.183,0.582L7.546,9.959C7.476,9.995,7.398,10.013,7.32,10.013z'/><path fill='currentColor' d='M7.32,13c-0.069,0-0.138-0.014-0.202-0.042L0.266,9.956c-0.233-0.102-0.332-0.358-0.22-0.571 C0.157,9.17,0.438,9.081,0.67,9.183l6.635,2.908l6.001-3.037c0.228-0.115,0.51-0.039,0.636,0.168 c0.125,0.207,0.043,0.468-0.183,0.582l-6.212,3.143C7.476,12.982,7.398,13,7.32,13z'/></svg>" }, "images/data/clearsearch.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><g><g><path d='M7,0C3.134,0,0,3.134,0,7c0,3.866,3.134,7,7,7s7-3.134,7-7C14,3.134,10.866,0,7,0z M9.468,8.44 c0.341,0.341,0.387,0.847,0.103,1.131S8.781,9.809,8.44,9.468L7,8.029L5.457,9.571c-0.284,0.284-0.745,0.284-1.029,0 c-0.284-0.284-0.284-0.745,0-1.029L5.971,7l-1.44-1.44C4.191,5.219,4.145,4.713,4.429,4.429S5.219,4.191,5.56,4.531L7,5.971 l1.543-1.543c0.284-0.284,0.745-0.284,1.029,0s0.284,0.744,0,1.029L8.029,7L9.468,8.44z'/></g></g></svg>" }, "images/data/closedataoverview.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 22 12' enable-background='new 0 0 22 12' xml:space='preserve'><g id='Lager_2'><g><g><polygon fill='currentColor' points='16.776,2 18,2.701 15.799,5.999 18,9.299 16.776,10 14,5.999 '/></g></g><g><g><polygon fill='currentColor' points='20.776,2 22,2.701 19.799,5.999 22,9.299 20.776,10 18,5.999 '/></g></g></g><g id='Lager_3'><g><g><path fill='currentColor' d='M11.675,5.061l-0.888-0.222c-0.144-0.036-0.259-0.144-0.305-0.285c-0.078-0.244-0.176-0.479-0.291-0.703 c-0.067-0.132-0.062-0.289,0.014-0.417l0.471-0.785c0.101-0.169,0.075-0.385-0.065-0.524l-0.739-0.74 C9.734,1.248,9.518,1.221,9.349,1.323L8.564,1.793C8.438,1.87,8.28,1.875,8.148,1.808c-0.224-0.115-0.459-0.212-0.703-0.29 C7.304,1.472,7.196,1.357,7.16,1.213L6.938,0.325C6.89,0.134,6.719,0,6.522,0H5.477C5.281,0,5.109,0.134,5.062,0.325L4.84,1.213 C4.804,1.356,4.696,1.472,4.555,1.517C4.311,1.595,4.076,1.693,3.851,1.808C3.719,1.875,3.562,1.87,3.435,1.794L2.65,1.323 C2.481,1.223,2.266,1.249,2.126,1.388L1.388,2.127C1.249,2.266,1.222,2.482,1.323,2.651l0.47,0.784 C1.87,3.561,1.875,3.719,1.808,3.851c-0.115,0.225-0.213,0.46-0.291,0.704C1.472,4.696,1.356,4.804,1.213,4.84L0.325,5.062 C0.134,5.109,0,5.281,0,5.477l0,1.045c0,0.197,0.134,0.368,0.324,0.416l0.888,0.222c0.144,0.036,0.259,0.144,0.305,0.285 c0.078,0.244,0.175,0.479,0.29,0.704C1.875,8.281,1.87,8.438,1.794,8.565l-0.47,0.784C1.222,9.518,1.249,9.734,1.388,9.873 l0.739,0.74c0.139,0.139,0.355,0.166,0.524,0.064l0.784-0.47c0.127-0.076,0.285-0.082,0.416-0.014 c0.225,0.115,0.46,0.213,0.704,0.291c0.141,0.045,0.249,0.16,0.285,0.304l0.222,0.888C5.109,11.866,5.28,12,5.477,12h1.046 c0.197,0,0.368-0.134,0.416-0.325l0.222-0.888c0.036-0.143,0.144-0.259,0.285-0.304c0.244-0.078,0.479-0.176,0.703-0.291 c0.132-0.067,0.29-0.062,0.416,0.014l0.784,0.47c0.169,0.101,0.384,0.075,0.524-0.064l0.739-0.74 c0.139-0.139,0.166-0.355,0.065-0.524l-0.471-0.784c-0.076-0.127-0.082-0.285-0.014-0.416c0.115-0.225,0.212-0.46,0.29-0.703 c0.046-0.141,0.161-0.249,0.305-0.285l0.888-0.222C11.866,6.891,12,6.719,12,6.522V5.477C12,5.28,11.866,5.109,11.675,5.061z M6,8.143C4.816,8.143,3.857,7.184,3.857,6c0-1.184,0.959-2.143,2.143-2.143S8.143,4.816,8.143,6 C8.143,7.184,7.184,8.143,6,8.143z'/></g></g></g></svg>" }, "images/data/collapsed.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve' fill='currentColor'><g id='Lager_1'><g><g><polygon points='5.5,4 5.5,11 9.5,7.5 '/></g></g></g></svg>" }, "images/data/cube.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path d='M12.817,3.351L7.183,0.035c-0.092-0.047-0.229-0.047-0.366,0L1.183,3.351C1.092,3.398,1,3.538,1,3.678v6.632 c0,0.14,0.092,0.234,0.183,0.327l5.634,3.316C6.863,14,6.954,14,7,14c0.046,0,0.137,0,0.183-0.047l5.634-3.316 C12.908,10.59,13,10.45,13,10.31V3.678C12.954,3.538,12.908,3.398,12.817,3.351z M7,0.782l4.901,2.896L8.237,5.827L7,6.527 L5.763,5.827L2.099,3.678L7,0.782z M1.733,4.285l3.664,2.148l1.237,0.701v5.791l-4.901-2.849V4.285z M12.267,10.077l-4.901,2.896 V7.181L8.603,6.48l3.664-2.148V10.077z' fill='currentColor'/></svg>" }, "images/data/currency.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><path fill='currentColor' d='M13.239,14c-0.149,0-0.296-0.072-0.386-0.204c-0.405-0.594-1.682-2.158-2.717-2.26c-0.802-0.078-1.577,0.161-2.487,0.547 c-1.366,0.577-2.077,0.679-3.067,0.679c-2.234,0-3.586-0.905-3.939-1.229l-0.16-0.118c-0.207-0.154-0.25-0.446-0.097-0.653 c0.154-0.207,0.445-0.25,0.653-0.097l0.271,0.225v0c0.011,0,1.129,0.94,3.272,0.94c0.792,0,1.368-0.041,2.703-0.605 c0.901-0.382,1.879-0.722,2.942-0.616c1.652,0.162,3.224,2.408,3.397,2.663c0.145,0.213,0.089,0.503-0.124,0.648 C13.421,13.973,13.329,14,13.239,14z'/><path fill='currentColor' d='M13.533,12.036c-0.118,0-0.235-0.045-0.323-0.13l-0.784-0.753c-1.31-1.565-3.174-1.654-5.323-0.659 c-1.016,0.47-2.013,0.708-2.963,0.708c-2.53,0-3.833-1.632-3.974-1.818L0.092,9.282C0.032,9.202,0,9.104,0,9.004V0.466 c0-0.201,0.129-0.38,0.32-0.443c0.191-0.062,0.401,0.003,0.521,0.164l0.798,1.071C1.672,1.302,2.493,2.356,4.14,2.356 c0.673,0,1.404-0.18,2.171-0.535C7.5,1.271,8.654,0.992,9.739,0.992c2.486,0,3.822,1.451,4.065,1.742l0.086,0.103 C13.961,2.92,14,3.027,14,3.137v8.432c0,0.187-0.112,0.356-0.284,0.429C13.657,12.024,13.595,12.036,13.533,12.036z M9.739,8.905 c1.294,0,2.474,0.555,3.327,1.564V3.307c-0.247-0.285-1.324-1.382-3.327-1.382c-0.949,0-1.971,0.25-3.037,0.743 C5.812,3.08,4.95,3.289,4.14,3.289c-1.916,0-2.985-1.152-3.207-1.419v6.979c0.156,0.194,1.22,1.42,3.207,1.42 c0.813,0,1.678-0.209,2.571-0.622C7.775,9.154,8.794,8.905,9.739,8.905z'/><g><path fill='currentColor' d='M7,4.058c-1.034,0-1.872,0.887-1.872,1.981c0,1.095,0.838,1.982,1.872,1.982c1.034,0,1.872-0.887,1.872-1.982 C8.872,4.945,8.034,4.058,7,4.058z M7.272,7.418c-0.571,0-0.959-0.342-1.105-0.851H5.825V6.192h0.28 C6.101,6.156,6.101,6.118,6.101,6.078c0-0.045,0-0.093,0.004-0.138h-0.28V5.565h0.35c0.153-0.49,0.534-0.836,1.086-0.836 c0.462,0,0.72,0.201,0.918,0.475L7.746,5.531c-0.142-0.19-0.28-0.294-0.497-0.294c-0.22,0-0.38,0.123-0.473,0.327h0.686V5.94 H6.686C6.682,5.981,6.682,6.025,6.682,6.07c0,0.041,0,0.086,0.004,0.122h0.777v0.375H6.768C6.866,6.787,7.037,6.91,7.272,6.91 c0.216,0,0.339-0.104,0.504-0.305l0.41,0.301C7.966,7.214,7.701,7.418,7.272,7.418z'/></g></g></svg>" }, "images/data/dataaccesssettingscollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Lager_3' shape-rendering='crispEdges' fill='currentColor'><g><g><polygon points='6,3 4.8,4.167 10.8,10 12,8.833 '/></g></g><g><g><polygon points='6,3 0,8.833 1.2,10 7.2,4.167 '/></g></g></g></svg>" }, "images/data/dataaccesssettingsexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Lager_3' shape-rendering='crispEdges' fill='currentColor'><g><g><polygon points='1.2,3 0,4.167 6,10 7.2,8.833 '/></g></g><g><g><polygon points='10.8,3 4.8,8.833 6,10 12,4.167 '/></g></g></g></svg>" }, "images/data/dataaccesssettingstablecollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><g><g><path d='M7,0C3.134,0,0,3.134,0,7c0,3.866,3.134,7,7,7s7-3.134,7-7C14,3.134,10.866,0,7,0z M10.5,8h-7V6h7V8z'/></g></g></svg>" }, "images/data/dataaccesssettingstableexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><style type='text/css'> .st0{fill:#FFFFFF;}</style><g id='Cirkle'><circle cx='7' cy='7' r='7'/></g><g id='Add'><rect x='6' y='3.5' class='st0' width='2' height='7'/><rect x='6' y='3.5' transform='matrix(3.910809e-11 1 -1 3.910809e-11 14 -2.742118e-10)' class='st0' width='2' height='7'/></g></svg>" }, "images/data/dataoverviewdelete.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Thrash'><g><g><path fill='currentColor' d='m1.632,4l0.796,6.955c0.001,0.577 0.427,1.045 0.953,1.045l5.238,0c0.526,0 0.952,-0.468 0.952,-1.045l0.796,-6.955l-8.735,0z'/></g></g><g><g><path fill='currentColor' d='m10.543,2l-2.4,0l0,-0.953c0,-0.578 -0.427,-1.047 -0.953,-1.047l-2.381,0c-0.525,0 -0.952,0.469 -0.952,1.047l0,0.953l-2.4,0c-0.253,0 -0.457,0.227 -0.457,0.508c0,0.253 0.169,0.453 0.386,0.492l9.229,0c0.216,-0.039 0.385,-0.239 0.385,-0.492c0,-0.281 -0.204,-0.508 -0.457,-0.508zm-2.876,0l-3.334,0l0,-0.953c0,-0.289 0.213,-0.523 0.476,-0.523l2.381,0c0.263,0 0.476,0.234 0.476,0.523l0,0.953l0.001,0z'/></g></g></g></svg>" }, "images/data/dataoverviewedit.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Edit'><g><g><path fill='currentColor' d='m8.418,1l-1.578,1.569l2.582,2.567l1.578,-1.569l-2.582,-2.567zm-6.363,6.516l2.582,2.567l4.199,-4.364l-2.583,-2.567l-4.198,4.364zm-2.055,4.484l3.867,-1.32l-2.538,-2.523l-1.329,3.843z'/></g></g></g></svg>" }, "images/data/dataoverviewsortmode.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 26 14' enable-background='new 0 0 26 14' xml:space='preserve'><g id='Sort_mode_icon'><g><g><rect fill='currentColor' x='10' y='2' width='6' height='1'/></g></g><g><g><rect fill='currentColor' x='10' y='5' width='4' height='1'/></g></g><g><g><rect fill='currentColor' x='10' y='8' width='3' height='1'/></g></g><g><g><rect fill='currentColor' x='10' y='11' width='1' height='1'/></g></g><g><g><polygon fill='currentColor' points='5,9 5,2 3,2 3,9 0,9 4,13 8,9 '/></g></g><g><g><polygon fill='currentColor' points='19,5 22.5,9 26,5 '/></g></g></g></svg>" }, "images/data/datatableview.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 150 150' style='enable-background:new 0 0 150 150;' xml:space='preserve'><g><g><path d='M92,50H58c-1.657,0-3,1.343-3,3v46c0,1.657,1.343,3,3,3h34c1.657,0,3-1.343,3-3V53C95,51.343,93.657,50,92,50z M92,97 c0,0.552-0.448,1-1,1H59c-0.552,0-1-0.448-1-1v-5c0-0.552,0.448-1,1-1h32c0.552,0,1,0.448,1,1V97z M92,87c0,0.552-0.448,1-1,1H59 c-0.552,0-1-0.448-1-1v-5c0-0.552,0.448-1,1-1h32c0.552,0,1,0.448,1,1V87z M92,77c0,0.552-0.448,1-1,1H59c-0.552,0-1-0.448-1-1v-5 c0-0.552,0.448-1,1-1h32c0.552,0,1,0.448,1,1V77z M92,67c0,0.552-0.448,1-1,1H59c-0.552,0-1-0.448-1-1v-5c0-0.552,0.448-1,1-1h32 c0.552,0,1,0.448,1,1V67z'/></g></g><g><g><path d='M75,0C33.579,0,0,33.579,0,75c0,41.421,33.579,75,75,75c41.421,0,75-33.579,75-75C150,33.579,116.421,0,75,0z M75,148 c-40.252,0-73-32.748-73-73S34.748,2,75,2s73,32.748,73,73S115.252,148,75,148z'/></g></g></svg>" }, "images/data/detailview.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 130 130' style='enable-background:new 0 0 130 130;' xml:space='preserve'><g><g><path d='M82,41H48c-1.657,0-3,1.343-3,3v42c0,1.657,1.343,3,3,3h34c1.657,0,3-1.343,3-3V44C85,42.343,83.657,41,82,41z M55.317,80 L52,76.843l0.774-0.784l2.397,2.233L59.066,74L60,74.774L55.317,80z M55.317,69L52,65.843l0.774-0.784l2.397,2.233L59.066,63 L60,63.774L55.317,69z M55.317,58L52,54.843l0.774-0.784l2.397,2.233L59.066,52L60,52.774L55.317,58z M78,77H63v-1h15V77z M78,66 H63v-1h15V66z M78,55H63v-1h15V55z'/></g></g><g><g><path class='st0' d='M65,0C29.102,0,0,29.102,0,65s29.102,65,65,65s65-29.102,65-65S100.898,0,65,0z M65,128 C30.262,128,2,99.738,2,65C2,30.262,30.262,2,65,2c34.738,0,63,28.262,63,63C128,99.738,99.738,128,65,128z'/></g></g></svg>" }, "images/data/dimension.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><rect x='2.245' y='2.75' width='1' height='8' fill='currentColor'/><rect x='2.245' y='10.75' width='9.01' height='1' fill='currentColor'/><rect x='6.082' y='2.637' transform='matrix(0.7071 0.7071 -0.7071 0.7071 7.1457 -2.4927)' width='1' height='9.485' fill='currentColor'/><polygon points='0.743,2.75 2.745,0.748 4.747,2.75 ' fill='currentColor'/><polygon points='11.255,9.248 13.257,11.25 11.255,13.252 ' fill='currentColor'/><polygon points='8.496,2.625 11.327,2.617 11.335,5.448 ' fill='currentColor'/></svg>" }, "images/data/errorexclamation.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><g id='Cirkle'><g><g><circle style='fill:#E14F4E;' cx='7' cy='7' r='7'/></g></g></g><g id='_x21_'><g><g><rect x='6' y='9' style='fill:#FFFFFF;' width='2' height='2'/></g></g><g><g><rect x='6' y='3' style='fill:#FFFFFF;' width='2' height='5'/></g></g></g></svg>" }, "images/data/expanded.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve' fill='currentColor'><g id='Lager_1'><g><g><polygon points='4,5 7.5,9 11,5 '/></g></g></g></svg>" }, "images/data/filter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 11' enable-background='new 0 0 12 11' xml:space='preserve'><path fill='currentColor' d='M7.286,6.579v3.571C7.286,10.619,6.947,11,6,11c-0.947,0-1.286-0.381-1.286-0.85V6.579c0,0-4.714-3.178-4.714-4.879 C0,0.761,2.686,0,6,0c3.314,0,6,0.761,6,1.701C12,3.401,7.286,6.579,7.286,6.579z M6.092,1.021c-2.594,0-4.698,0.482-4.698,0.997 c0,0.515,2.103,1.066,4.698,1.066c2.594,0,4.698-0.551,4.698-1.066C10.789,1.503,8.686,1.021,6.092,1.021z'/></svg>" }, "images/data/folder_closed.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path d='M13.481,1.8H5.892L4.494,0.2l0,0C4.394,0.1,4.194,0,4.094,0l0,0H0.499C0.2,0,0,0.2,0,0.5v12.9l0,0C0,13.7,0.2,14,0.499,14 h2.397h2.397h8.189c0.3,0,0.499-0.2,0.499-0.5l0,0V2.3C14.08,2,13.781,1.8,13.481,1.8z' fill='currentColor'/></svg>" }, "images/data/folder_opened.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path d='M12.71,3.2V4H3.324C3.129,4,2.933,4.2,2.835,4.5L0,13.1c0-0.1,0-0.2,0-0.3V1.2C0,0.5,0.293,0,0.782,0h2.933 c0.196,0,0.391,0.1,0.489,0.3L5.182,2h6.844C12.416,2,12.71,2.5,12.71,3.2z' fill='currentColor'/><path d='M3.911,5.1h9.483c0.489,0,0.782,0.8,0.489,1.4l-2.249,7c-0.098,0.3-0.293,0.5-0.489,0.5H0.684l2.737-8.4 C3.52,5.3,3.715,5.1,3.911,5.1z' fill='currentColor'/></svg>" }, "images/data/hamburger.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><rect fill='currentColor' width='12' height='2'/><rect fill='currentColor' y='5' width='12' height='2'/><rect fill='currentColor' y='10' width='12' height='2'/></svg>" }, "images/data/hierarchy.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path d='M9,1v2H5V1H9 M10,0H4v4h6V0L10,0z' fill='currentColor'/><path d='M3,11v2H1v-2H3 M4,10H0v4h4V10L4,10z' fill='currentColor'/><path d='M13,11v2h-2v-2H13 M14,10h-4v4h4V10L14,10z' fill='currentColor'/><path d='M8,11v2H6v-2H8 M9,10H5v4h4V10L9,10z' fill='currentColor'/><rect y='6' width='14' height='1' fill='currentColor'/><rect y='7' width='1' height='1' fill='currentColor'/><rect x='13' y='7' width='1' height='1' fill='currentColor'/><rect x='6.001' y='5' width='1.997' height='1' fill='currentColor'/></svg>" }, "images/data/hierarchycollapsed.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve' fill='currentColor'><g id='Lager_1'><g opacity='0.3'><g><rect x='11' y='2' width='1' height='9'/></g></g><g opacity='0.3'><g><rect x='3' y='2' width='1' height='9'/></g></g><g><g><rect x='7' y='4' width='1' height='5'/></g></g><g><g><rect x='5' y='6' width='5' height='1'/></g></g><g opacity='0.3'><g><rect x='4' y='2' width='7' height='1'/></g></g><g opacity='0.3'><g><rect x='4' y='10' width='7' height='1'/></g></g></g></svg>" }, "images/data/hierarchyexpanded.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve' fill='currentColor'><g id='Lager_1'><g opacity='0.3'><g><rect x='11' y='2' width='1' height='9'/></g></g><g opacity='0.3'><g><rect x='3' y='2' width='1' height='9'/></g></g><g><g><rect x='5' y='6' width='5' height='1'/></g></g><g opacity='0.3'><g><rect x='4' y='2' width='7' height='1'/></g></g><g opacity='0.3'><g><rect x='4' y='10' width='7' height='1'/></g></g></g></svg>" }, "images/data/hierarchy_level_1.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='7' cy='7' r='1.622'/></svg>" }, "images/data/hierarchy_level_2.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='9.439' cy='7' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='4.561' cy='7' r='1.622'/></svg>" }, "images/data/hierarchy_level_3.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='9.439' cy='9.385' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='7' cy='4.615' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='4.561' cy='9.385' r='1.622'/></svg>" }, "images/data/hierarchy_level_4.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='4.561' cy='9.385' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='4.561' cy='4.615' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='9.439' cy='4.615' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='9.439' cy='9.385' r='1.622'/></svg>" }, "images/data/hierarchy_level_5.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='11.868' cy='9.379' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='2.122' cy='9.379' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='6.99' cy='9.379' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='9.429' cy='4.61' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='4.551' cy='4.61' r='1.622'/></svg>" }, "images/data/hierarchy_level_6.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><rect x='9.75' y='8.742' width='4.25' height='1.391' fill='currentColor'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='2.122' cy='4.61' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='11.868' cy='4.61' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='7' cy='4.61' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='2.122' cy='9.379' r='1.622'/><circle fill='none' stroke='currentColor' stroke-miterlimit='10' cx='7' cy='9.379' r='1.622'/><rect x='11.173' y='7.262' width='1.391' height='4.25' fill='currentColor'/></svg>" }, "images/data/identifiers.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Key'><path fill='currentColor' d='M13.841,3.769l-1.695-1.585l0.312-0.298c0.212-0.202,0.213-0.53,0.001-0.734c-0.212-0.203-0.555-0.204-0.766-0.001 L6.095,6.491C5.44,6.011,4.652,5.738,3.812,5.738c-0.004,0-0.008,0-0.012,0C2.787,5.741,1.834,6.121,1.117,6.809 c-1.483,1.42-1.489,3.724-0.014,5.136C1.837,12.648,2.803,13,3.772,13c0.974,0,1.951-0.357,2.696-1.069 c1.341-1.283,1.462-3.283,0.386-4.7l2.443-2.177l1.063,1.123c0.106,0.101,0.245,0.152,0.383,0.152c0.139,0,0.277-0.051,0.383-0.152 c0.212-0.203,0.212-0.531,0-0.734l-1.061-1.122l1.314-1.406l1.696,1.586c0.106,0.101,0.245,0.152,0.383,0.152 c0.139,0,0.277-0.051,0.383-0.152C14.053,4.3,14.053,3.971,13.841,3.769z M5.701,11.197c-1.061,1.015-2.78,1.021-3.833,0.014 c-1.053-1.008-1.046-2.653,0.014-3.669c0.514-0.493,1.196-0.764,1.92-0.767c0.003,0,0.006,0,0.009,0 c0.72,0,1.395,0.267,1.903,0.753C6.768,8.536,6.762,10.182,5.701,11.197z'/></g></svg>" }, "images/data/images.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 11' enable-background='new 0 0 14 11' xml:space='preserve'><g><g><path fill='currentColor' d='M12.183,11H1.817C0.815,11,0,10.199,0,9.215V3.271c0-0.984,0.815-1.785,1.817-1.785h1.728 c0.02-0.03,0.23-0.271,0.355-0.414C4.272,0.644,4.833,0,5.704,0h2.592c0.871,0,1.432,0.644,1.803,1.07 c0.128,0.146,0.337,0.386,0.427,0.427l1.658-0.012C13.185,1.486,14,2.287,14,3.271v5.943C14,10.199,13.185,11,12.183,11z M1.817,2.403c-0.487,0-0.883,0.389-0.883,0.868v5.943c0,0.479,0.396,0.868,0.883,0.868h10.367c0.487,0,0.883-0.389,0.883-0.868 V3.271c0-0.479-0.396-0.868-0.883-0.868h-1.728c-0.422,0-0.733-0.356-1.062-0.732C9.084,1.315,8.737,0.917,8.296,0.917H5.704 c-0.441,0-0.773,0.381-1.094,0.75C4.278,2.046,3.967,2.403,3.544,2.403H1.817z'/></g><path fill='currentColor' d='M7,8.665c-1.476,0-2.676-1.116-2.676-2.488S5.524,3.69,7,3.69s2.676,1.116,2.676,2.487S8.476,8.665,7,8.665z M7,4.608 c-0.961,0-1.743,0.704-1.743,1.57S6.039,7.748,7,7.748s1.743-0.705,1.743-1.57S7.961,4.608,7,4.608z'/><path fill='currentColor' d='M11.132,5.023c-0.385,0-0.698-0.308-0.698-0.686c0-0.378,0.313-0.686,0.698-0.686s0.698,0.308,0.698,0.686 C11.83,4.715,11.517,5.023,11.132,5.023z'/></g></svg>" }, "images/data/info28x28.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 28 28'><circle fill='currentColor' cx='14' cy='14' r='14'/><polygon points='16 20 16 12 12 12 10 12 10 14 12 14 12 20 10 20 10 22 18 22 18 20 16 20' style='fill:#ffffff'/><rect x='12' y='6' width='4' height='4' style='fill:#ffffff'/></svg>" }, "images/data/location.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 14' enable-background='new 0 0 12 14' xml:space='preserve'><g><path fill='currentColor' d='M6.13,6.733c-0.82,0-1.487-0.657-1.487-1.464S5.31,3.804,6.13,3.804c0.82,0,1.487,0.657,1.487,1.464S6.95,6.733,6.13,6.733 z'/><g><path fill='currentColor' d='M6,14l-0.912-0.871C3.522,11.724,0,8.239,0,5.242C0,2.449,2.804,0,6,0s6,2.449,6,5.242c0,2.994-3.521,6.48-5.035,7.84 L6,14z M6,1.087c-2.275,0-4.819,1.777-4.819,4.155c0,2.656,3.582,6.078,4.681,7.064L6,12.434l0.14-0.13 c1.098-0.986,4.679-4.409,4.679-7.062C10.819,2.863,8.275,1.087,6,1.087z'/></g></g></svg>" }, "images/data/measure.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><polygon points='12,10.48 12,13 2,13 2,12.28 6.27,7 2,1.48 2,1 12,1 12,3.76 10.427,1.84 4.921,1.84 8.742,6.4 4.921,11.08 4.921,11.68 10.539,11.68 ' fill='currentColor'/></svg>" }, "images/data/numbers.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 12' enable-background='new 0 0 14 12' xml:space='preserve'><g><g><path fill='currentColor' d='M1.383,7.106V2.088H0V1.144h0.128c0.922,0,1.49-0.361,1.627-1.144h1.04v7.106H1.383z'/></g><g><path fill='currentColor' d='M8.758,9.701H4.482c0-1.265,0.5-2.138,1.53-3.111l0.569-0.542c0.617-0.572,0.725-0.893,0.725-1.625 c0-0.592-0.245-0.883-0.687-0.883c-0.706,0-0.774,0.631-0.784,1.385H4.482V4.653c0-1.315,0.677-2.058,2.157-2.058 c1.392,0,2.079,0.713,2.079,1.937c0,0.923-0.285,1.526-1.079,2.259L6.855,7.533C6.443,7.914,6.208,8.306,6.14,8.576h2.618V9.701z' /></g><g><path fill='currentColor' d='M11.039,9.782c0.02,0.823,0.157,1.275,0.775,1.275c0.686,0,0.774-0.523,0.774-1.144 c0-0.633-0.137-1.215-0.912-1.215h-0.471V7.755h0.461c0.588,0,0.804-0.542,0.804-1.125c0-0.662-0.216-0.933-0.677-0.933 c-0.608,0-0.716,0.481-0.716,1.154H9.783c0-1.396,0.726-2.098,2.04-2.098c1.255,0,2,0.573,2,1.827 c0,0.854-0.402,1.415-1.059,1.565v0.02C13.657,8.307,14,8.95,14,9.842C14,10.796,13.618,12,11.696,12 c-1.343,0-2.01-0.833-2.01-2.188V9.782H11.039z'/></g></g></svg>" }, "images/data/opendataoverview.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 22 12' enable-background='new 0 0 22 12' xml:space='preserve'><g id='Lager_2'><g><g><polygon fill='currentColor' points='19.224,2 18,2.701 20.201,5.999 18,9.299 19.224,10 22,5.999 '/></g></g><g><g><polygon fill='currentColor' points='15.224,2 14,2.701 16.201,5.999 14,9.299 15.224,10 18,5.999 '/></g></g></g><g id='Lager_3'><g><g><path fill='currentColor' d='M11.675,5.061l-0.888-0.222c-0.144-0.036-0.259-0.144-0.305-0.285c-0.078-0.244-0.176-0.479-0.291-0.703 c-0.067-0.132-0.062-0.289,0.014-0.417l0.471-0.785c0.101-0.169,0.075-0.385-0.065-0.524l-0.739-0.74 C9.734,1.248,9.518,1.221,9.349,1.323L8.564,1.793C8.438,1.87,8.28,1.875,8.148,1.808c-0.224-0.115-0.459-0.212-0.703-0.29 C7.304,1.472,7.196,1.357,7.16,1.213L6.938,0.325C6.89,0.134,6.719,0,6.522,0H5.477C5.281,0,5.109,0.134,5.062,0.325L4.84,1.213 C4.804,1.356,4.696,1.472,4.555,1.517C4.311,1.595,4.076,1.693,3.851,1.808C3.719,1.875,3.562,1.87,3.435,1.794L2.65,1.323 C2.481,1.223,2.266,1.249,2.126,1.388L1.388,2.127C1.249,2.266,1.222,2.482,1.323,2.651l0.47,0.784 C1.87,3.561,1.875,3.719,1.808,3.851c-0.115,0.225-0.213,0.46-0.291,0.704C1.472,4.696,1.356,4.804,1.213,4.84L0.325,5.062 C0.134,5.109,0,5.281,0,5.477l0,1.045c0,0.197,0.134,0.368,0.324,0.416l0.888,0.222c0.144,0.036,0.259,0.144,0.305,0.285 c0.078,0.244,0.175,0.479,0.29,0.704C1.875,8.281,1.87,8.438,1.794,8.565l-0.47,0.784C1.222,9.518,1.249,9.734,1.388,9.873 l0.739,0.74c0.139,0.139,0.355,0.166,0.524,0.064l0.784-0.47c0.127-0.076,0.285-0.082,0.416-0.014 c0.225,0.115,0.46,0.213,0.704,0.291c0.141,0.045,0.249,0.16,0.285,0.304l0.222,0.888C5.109,11.866,5.28,12,5.477,12h1.046 c0.197,0,0.368-0.134,0.416-0.325l0.222-0.888c0.036-0.143,0.144-0.259,0.285-0.304c0.244-0.078,0.479-0.176,0.703-0.291 c0.132-0.067,0.29-0.062,0.416,0.014l0.784,0.47c0.169,0.101,0.384,0.075,0.524-0.064l0.739-0.74 c0.139-0.139,0.166-0.355,0.065-0.524l-0.471-0.784c-0.076-0.127-0.082-0.285-0.014-0.416c0.115-0.225,0.212-0.46,0.29-0.703 c0.046-0.141,0.161-0.249,0.305-0.285l0.888-0.222C11.866,6.891,12,6.719,12,6.522V5.477C12,5.28,11.866,5.109,11.675,5.061z M6,8.143C4.816,8.143,3.857,7.184,3.857,6c0-1.184,0.959-2.143,2.143-2.143S8.143,4.816,8.143,6 C8.143,7.184,7.184,8.143,6,8.143z'/></g></g></g></svg>" }, "images/data/plus.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' style='enable-background:new 0 0 12 12;' xml:space='preserve'><g><g><rect x='5' width='2' height='12'/></g></g><g><g><rect y='5' width='12' height='2'/></g></g></svg>" }, "images/data/preview.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><g><circle style='fill:#309FE0;' cx='7' cy='7' r='7'/></g><g><g><g><path style='fill:#FFFFFF' d='M9.034,8.406C9.586,7.833,9.922,7.073,9.922,6.24C9.922,4.451,8.372,3,6.461,3C4.55,3,3,4.451,3,6.24 C3,8.03,4.55,9.48,6.461,9.48c0.609,0,1.181-0.147,1.678-0.406L10.195,11L11,10.247L9.034,8.406z M6.461,8.404 c-1.276,0-2.311-0.969-2.311-2.164c0-1.195,1.035-2.164,2.311-2.164c1.277,0,2.311,0.969,2.311,2.164 C8.772,7.435,7.737,8.404,6.461,8.404z'/></g></g></g></svg>" }, "images/data/prompt.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' class='sf-element-svg-element sf-element-icon sfc-selected'><path d='M7.965,9.557v0l0.019,0L8,9.56H8l0.011,0,0.019,0v0c3.67-.034,4.126-4.784,4.17-5.814,0-.1,0-0.213,0-0.219C12.086,1.358,9.928.021,8.035,0L8,0H8L7.965,0C6.072,0.021,3.914,1.358,3.8,3.523c0,0.008,0,.123,0,0.219C3.838,4.773,4.294,9.523,7.965,9.557ZM16,13.994a3.283,3.283,0,0,0-1.461-2.69,7.29,7.29,0,0,0-1.1-.571,8.61,8.61,0,0,1-1.13-.533c-0.224-.138-0.434-0.248-0.627-0.35-0.093-.05-0.168-0.1-0.253-0.147A3.684,3.684,0,0,1,8.04,12.122v0l-0.013,0H7.97l-0.013,0v0A3.685,3.685,0,0,1,4.568,9.7c-0.085.048-.16,0.1-0.253,0.146-0.19.1-.4,0.213-0.624,0.35a8.61,8.61,0,0,1-1.13.533,7.216,7.216,0,0,0-1.1.571A3.283,3.283,0,0,0,0,13.994l0.01,0.035,0.1,0L0,14.042V16H16V14.042H15.986A0.3,0.3,0,0,0,16,13.994Z'/></svg>" }, "images/data/replacedatatable.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 13 12'><g fill='currentColor'><path d='M11,0H2A2,2,0,0,0,0,2v8a2,2,0,0,0,2,2h9a2,2,0,0,0,2-2V2A2,2,0,0,0,11,0Zm1,11H1V3H12v8Z'/><path d='M8.025,4s-0.011.937-.018,2H4.993C4.985,4.937,4.975,4,4.975,4L2,6.429,4.975,9C5,9,5,8.063,5,7H8c0,1.063,0,2,.024,2L11,6.429Z'/></g></svg>" }, "images/data/resizehandle.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 3 23' enable-background='new 0 0 3 23' xml:space='preserve'><g><g><rect fill='currentColor' y='22' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='20' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='18' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='16' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='14' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='12' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='10' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='8' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='6' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='4' width='3' height='1'/></g></g><g><g><rect fill='currentColor' y='2' width='3' height='1'/></g></g><g><g><rect fill='currentColor' width='3' height='1'/></g></g></svg>" }, "images/data/search.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' style='enable-background:new 0 0 14 14;' xml:space='preserve'><g><g><path d='M10.56,9.461c0.965-1.005,1.553-2.334,1.553-3.791C12.113,2.539,9.402,0,6.057,0C2.712,0,0,2.539,0,5.67 c0,3.132,2.712,5.67,6.057,5.67c1.066,0,2.067-0.258,2.937-0.71L12.592,14L14,12.682L10.56,9.461z M6.057,9.457 c-2.234,0-4.045-1.695-4.045-3.787c0-2.092,1.811-3.787,4.045-3.787c2.234,0,4.045,1.695,4.045,3.787 C10.101,7.762,8.291,9.457,6.057,9.457z'/></g></g></svg>" }, "images/data/set.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><path d='M2,6.491c1.273,0,1.4-0.636,1.4-1.273c0-0.509,0-1.018-0.127-1.4c0-0.509-0.127-1.018-0.127-1.527 C3.145,0.636,4.164,0,5.691,0h0.382v1.018H5.691c-1.018,0-1.4,0.509-1.4,1.527c0,0.382,0,0.764,0.127,1.273 C4.545,4.2,4.545,4.582,4.545,5.091c0,1.145-0.509,1.655-1.273,1.909l0,0c0.764,0.255,1.273,0.764,1.273,1.909 c0,0.509,0,0.891-0.127,1.273c0,0.509-0.127,0.891-0.127,1.273c0,1.018,0.382,1.527,1.4,1.527h0.255V14H5.691 c-1.4,0-2.545-0.636-2.545-2.418c0-0.509,0.127-0.891,0.127-1.4C3.4,9.673,3.4,9.291,3.4,8.782S3.273,7.509,2,7.509V6.491z' fill='currentColor'/><path d='M12,7.509c-1.273,0-1.4,0.636-1.4,1.273c0,0.509,0,1.018,0.127,1.4c0,0.509,0.127,1.018,0.127,1.527 c0,1.655-1.018,2.291-2.545,2.291H7.927v-1.018h0.382c1.018,0,1.4-0.509,1.4-1.527c0-0.382,0-0.764-0.127-1.273 C9.455,9.8,9.455,9.418,9.455,8.909c0-1.145,0.509-1.655,1.273-1.909l0,0C9.964,6.745,9.455,6.236,9.455,5.091 c0-0.509,0-0.891,0.127-1.273c0-0.509,0.127-0.891,0.127-1.273c0-1.018-0.382-1.527-1.4-1.527H8.055V0l0.255,0 c1.4,0,2.545,0.636,2.545,2.418c0,0.509-0.127,0.891-0.127,1.4C10.6,4.327,10.6,4.709,10.6,5.218s0.127,1.273,1.4,1.273V7.509z' fill='currentColor'/></svg>" }, "images/data/smallarrowdown.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 7 5' enable-background='new 0 0 7 5' xml:space='preserve'><path fill='currentColor' d='M3.455,5L0,0.948l1.017-0.944l2.445,2.95L5.99,0L7,0.951L3.455,5z'/></svg>" }, "images/data/smallarrowup.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 7 5' enable-background='new 0 0 7 5' xml:space='preserve'><path fill='currentColor' d='M3.545,0L7,4.052L5.983,4.996L3.538,2.047L1.01,5L0,4.049L3.545,0z'/></svg>" }, "images/data/text.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 12' enable-background='new 0 0 14 12' xml:space='preserve'><path fill='currentcolor' d='M12.069,12C10.23,12,10,10.547,10,8.5C10,6.453,10.23,5,12.069,5c1.754,0,1.88,1.425,1.88,2.405h-1.226 c0-0.98-0.179-1.406-0.732-1.406c-0.621,0-0.766,0.689-0.766,2.595c0,2.037,0.256,2.406,0.784,2.406 c0.442,0,0.765-0.256,0.765-1.708H14C14,10.744,13.677,12,12.069,12'/><g><path fill='currentcolor' d='M5.35,2h2.068C8.431,2,9.16,2.432,9.16,3.775c0,0.755-0.317,1.333-0.926,1.53v0.019 C8.911,5.432,9.35,6.02,9.35,6.951C9.35,8.049,8.877,9,7.435,9H5.35V2z M6.586,4.873h0.352c0.678,0,0.987-0.265,0.987-0.921 c0-0.667-0.283-0.912-0.893-0.912H6.586V4.873z M6.586,7.961h0.481c0.592,0,0.995-0.244,0.995-1.059 c0-0.813-0.403-1.048-0.944-1.048H6.586V7.961z'/></g><g><path fill='currentcolor' d='M2.905,0H1.496L0,7h1.187l0.414-1.891h1.282L3.213,7H4.4L2.905,0z M2.766,4.016H1.656l0.312-2.359h0.469 L2.766,4.016z'/></g></svg>" }, "images/data/time.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g><path fill='currentColor' d='M7,14c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7S10.86,14,7,14z M7,1.183C3.792,1.183,1.183,3.792,1.183,7 S3.792,12.817,7,12.817S12.817,10.208,12.817,7S10.208,1.183,7,1.183z'/><path fill='currentColor' d='M8.24,10.196c-0.161,0-0.323-0.066-0.44-0.195L5.77,7.749V3.751c0-0.327,0.265-0.592,0.592-0.592 c0.327,0,0.592,0.265,0.592,0.592v3.544L8.68,9.209c0.219,0.243,0.199,0.617-0.043,0.836C8.523,10.146,8.382,10.196,8.24,10.196z' /></g></svg>" }, "images/data/viewsinconnectionremovetable.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 10 10' style='enable-background:new 0 0 10 10;' xml:space='preserve'><g><g><rect x='4.228' y='-1.299' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.0711 5.0004)' width='1.544' height='12.598'/></g></g><g><g><rect x='-1.299' y='4.228' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.0711 5)' width='12.598' height='1.544'/></g></g></svg>" }, "images/data/viewsinconnectionreport.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' style='enable-background:new 0 0 16 16;' xml:space='preserve'><g id='Lager_1'><g><g><circle class='sf-element sf-element-svg-element sfc-icon-bg' cx='8' cy='8' r='8'/></g></g></g><g id='Lager_4'><g><g><rect x='7' y='8.997' class='sf-element sf-element-svg-element sfc-icon-fg' width='4' height='0.999'/></g></g><g><g><rect x='5' y='9' class='sf-element sf-element-svg-element sfc-icon-fg' width='1' height='1'/></g></g><g><g><rect x='7' y='6.999' class='sf-element sf-element-svg-element sfc-icon-fg' width='4' height='1'/></g></g><g><g><rect x='5' y='7' class='sf-element sf-element-svg-element sfc-icon-fg' width='1' height='1'/></g></g><g><g><rect x='7' y='5' class='sf-element sf-element-svg-element sfc-icon-fg' width='4' height='0.999'/></g></g><g><g><rect x='5' y='5' class='sf-element sf-element-svg-element sfc-icon-fg' width='1' height='0.999'/></g></g></g></svg>" }, "images/data/viewsinconnectiontable.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' style='enable-background:new 0 0 16 16;' xml:space='preserve'><g id='Lager_1'><g><g><circle class='sf-element sf-element-svg-element sfc-icon-bg' cx='8' cy='8' r='8'/></g></g></g><g id='Lager_5'><g><g><path class='sf-element sf-element-svg-element sfc-icon-fg' d='M10,4H6H5v8h1h4h1V4H10z M10,11H6V9.999h4V11z M10,9H6V8h4V9z M10,7H6V6h4V7z'/></g></g></g></svg>" }, "images/data/connectors/generic.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M20.972,36.952A31.792,31.792,0,0,0,29.194,35.9c-0.018-.025-0.039-0.051-0.056-0.076a12.153,12.153,0,0,1-.821-1.377A11.823,11.823,0,0,1,27,29c0-.313.022-0.627,0.047-0.942a36.457,36.457,0,0,1-6.075.5c-7.557,0-14.024-2.2-16.972-5.464v5.876C4,33.14,11.581,36.952,20.972,36.952Zm0-20.1C30.361,16.855,38,13.594,38,9.586S30.389,3,21,3,4,5.568,4,9.586,11.581,16.855,20.972,16.855Zm0,10.048a32.782,32.782,0,0,0,6.349-.611c0.012-.045.021-0.09,0.034-0.135l0.046-.169a11.942,11.942,0,0,1,.589-1.752c0.122-.281.265-0.573,0.436-0.892,0.116-.217.236-0.432,0.365-0.64A12.119,12.119,0,0,1,29.8,21.312q0.275-.329.573-0.638a12.132,12.132,0,0,1,1.273-1.146A11.849,11.849,0,0,1,38,17.041V13.048c-2.949,3.268-9.471,5.464-17.028,5.464S6.949,16.316,4,13.048v5.877C4,23.092,11.581,26.9,20.972,26.9Zm9.434,10.443a34.183,34.183,0,0,1-9.434,1.264c-7.557,0-14.024-2.2-16.972-5.464v5.876C4,43.189,11.581,47,20.972,47c7.939,0,14.668-2.76,16.555-6.1a11.971,11.971,0,0,1-6.619-3.059C30.741,37.684,30.574,37.52,30.406,37.346Zm16.1-16.366a11.062,11.062,0,0,0-2.926-1.966q-0.405-.186-0.828-0.341T41.9,18.4c-0.27-.074-0.552-0.117-0.829-0.172-0.336-.066-0.675-0.123-1.019-0.163A9,9,0,0,0,39,18c-0.337,0-.67.018-1,0.047a10.934,10.934,0,0,0-5.743,2.27,11.1,11.1,0,0,0-1.168,1.051q-0.273.283-.525,0.585a11.074,11.074,0,0,0-.922,1.277c-0.118.191-.228,0.388-0.335,0.587-0.143.267-.279,0.538-0.4,0.818a10.575,10.575,0,0,0-.482,1.412c-0.018.065-.04,0.129-0.057,0.194-0.052.2-.112,0.391-0.153,0.593q-0.1.511-.156,1.037a10.853,10.853,0,0,0,1.147,6.116,11.1,11.1,0,0,0,.753,1.264c0.084,0.121.182,0.231,0.273,0.348,0.129,0.167.253,0.338,0.391,0.5a11.729,11.729,0,0,0,.87.909c0.032,0.03.059,0.066,0.092,0.1a10.965,10.965,0,0,0,6.341,2.846C38.279,39.982,38.637,40,39,40c0.322,0,.638-0.019.953-0.047A11.007,11.007,0,0,0,50,29,10.946,10.946,0,0,0,46.509,20.98ZM45.52,26.351a0.692,0.692,0,0,1-.159.231l-2.633,2.532c0.455,0.438.811,0.779,1.044,1,0.164,0.156.275,0.262,0.278,0.262h0L41.426,32.9l-1.531,1.472a1.9,1.9,0,0,1-.972.5,1.979,1.979,0,0,1-.36.033h0A1.238,1.238,0,0,1,38,34.8a1.861,1.861,0,0,1-.771-0.428l-0.112-.107-0.152-.146-0.683-.657-0.594-.571-0.411-.4L32.871,30.18a1.767,1.767,0,0,1-.24-2.279,1.819,1.819,0,0,1,.24-0.284l2.549-2.451,0.661-.636,0.945-.909,0.22,0.212L37.4,23.986,38,24.561l0.34,0.328,2.63-2.53a0.725,0.725,0,0,1,.24-0.153,0.75,0.75,0,0,1,.214-0.04c0.02,0,.04-0.011.06-0.011a0.759,0.759,0,0,1,.274.051,0.725,0.725,0,0,1,.24.153l0.068,0.066a0.683,0.683,0,0,1,0,.99l-0.643.619-1.988,1.912,1.889,1.819,0.3,0.293,1.224-1.177,1.409-1.355a0.751,0.751,0,0,1,1.029,0l0.068,0.066a0.693,0.693,0,0,1,.159.231A0.682,0.682,0,0,1,45.52,26.351Z'/></svg>" }, "images/data/connectors/library.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='-1 -3 50 50' style='enable-background:new 0 0 47 44;' xml:space='preserve'><g><path d='M24,6.198V42c0,0,4.138-8.522,23-1.283v-3.254V4.916C28.138-2.324,24,6.198,24,6.198z'/><path d='M0,4.916v32.548v3.254C18.98,33.478,23,42,23,42V6.198C23,6.198,18.98-2.324,0,4.916z'/></g></svg>" }, "images/data/connectors/local-file.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='-6 -3 50 50' style='enable-background:new 0 0 37 44;' xml:space='preserve'><g><path d='M28.854,22.5c0-5.709-4.645-10.354-10.354-10.354c-5.709,0-10.354,4.645-10.354,10.354 c0,2.7,1.047,5.153,2.745,6.998c-0.005-0.017-0.009-0.031-0.009-0.034c0.055-1.212,0.634-2.106,1.383-2.59 c0.339-0.219,0.696-0.404,1.043-0.551c0.396-0.168,0.769-0.326,1.069-0.513c0.212-0.132,0.411-0.239,0.594-0.338 c0.087-0.047,0.159-0.094,0.24-0.141c0.556,1.226,1.522,2.312,3.208,2.328v0.003c0.004,0,0.008-0.001,0.012-0.001 c0.002,0,0.004,0,0.006,0c0.002,0,0.004,0,0.006,0c0.002,0,0.004,0,0.006,0c0.003,0,0.006,0,0.009,0.001 c0.003,0,0.006-0.001,0.009-0.001c0.002,0,0.004,0,0.006,0c0.002,0,0.004,0,0.006,0c0.002,0,0.004,0,0.006,0 c0.004,0,0.008,0.001,0.012,0.001V27.66c1.686-0.016,2.652-1.102,3.208-2.328c0.08,0.047,0.152,0.094,0.24,0.141 c0.183,0.098,0.382,0.206,0.594,0.338c0.3,0.187,0.673,0.345,1.069,0.513c0.347,0.147,0.704,0.331,1.043,0.551 c0.749,0.485,1.328,1.378,1.383,2.59c0,0.008-0.024,0.081-0.057,0.179C27.754,27.784,28.854,25.27,28.854,22.5z M22.439,19.592 c-0.04,0.992-0.473,5.566-3.948,5.599v0.003c-0.006,0-0.012-0.001-0.018-0.001c-0.004,0-0.008,0-0.011,0.001v0.001 c-0.001,0-0.002,0-0.003,0c-0.001,0-0.002,0-0.003,0v-0.001c-0.004,0-0.007-0.001-0.011-0.001c-0.006,0-0.012,0.001-0.018,0.001 v-0.003c-3.475-0.033-3.908-4.607-3.948-5.599c-0.004-0.092,0-0.204,0-0.211c0.111-2.084,2.155-3.372,3.948-3.391 c0,0,0.028-0.001,0.032-0.001h0.001h0.001c0.003,0,0.032,0.001,0.032,0.001c1.793,0.019,3.837,1.306,3.948,3.391 C22.439,19.388,22.442,19.5,22.439,19.592z'/><path d='M28,10V0H3C1.343,0,0,1.343,0,3v38c0,1.657,1.343,3,3,3h31c1.657,0,3-1.343,3-3V10H28z M18.5,34 C12.149,34,7,28.851,7,22.5S12.149,11,18.5,11S30,16.149,30,22.5S24.851,34,18.5,34z'/><path d='M29,1.001v8h7C36.052,9.001,29,1.001,29,1.001z'/></g></svg>" }, "images/data/edittable/addcolumns.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><rect x='35' y='16' width='11' height='30' style='fill:#68bef3'/><path d='M4,24H16V16H4v8Zm14-8v8H33V16H18ZM4,35H16V27H4v8Zm14,0H33V27H18v8ZM4,46H16V38H4v8Zm14,0H33V38H18v8Z' style='fill:#aaa;fill-rule:evenodd'/><path d='M4,24H16V16H4v8Zm14-8v8H33V16H18ZM4,35H16V27H4v8Zm14,0H33V27H18v8ZM4,46H16V38H4v8Zm14,0H33V38H18v8Z' style='fill:none'/><path d='M4,24H16V16H4v8Zm14-8v8H33V16H18ZM4,35H16V27H4v8Zm14,0H33V27H18v8ZM4,46H16V38H4v8Zm14,0H33V38H18v8Z' style='fill:none'/><path d='M47.064,0H2.946A2.974,2.974,0,0,0,0,3V47a2.974,2.974,0,0,0,2.941,3H47.064A2.974,2.974,0,0,0,50,47V3A2.974,2.974,0,0,0,47.064,0Zm0.98,47a0.993,0.993,0,0,1-.98,1H2.946a0.993,0.993,0,0,1-.98-1V14H48.044V47Zm0-35H1.966V3a0.993,0.993,0,0,1,.98-1H47.064a0.993,0.993,0,0,1,.98,1v9Z' style='fill:#aaa'/><polygon points='41 31 41 29 40 29 40 31 38 31 38 32 40 32 40 34 41 34 41 32 43 32 43 31 41 31' style='fill:#fff'/><polygon points='41 31 41 29 40 29 40 31 38 31 38 32 40 32 40 34 41 34 41 32 43 32 43 31 41 31' style='fill:none'/><polygon points='41 31 41 29 40 29 40 31 38 31 38 32 40 32 40 34 41 34 41 32 43 32 43 31 41 31' style='fill:none'/></svg>" }, "images/data/edittable/addrows.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><rect x='3.995' y='37' width='42' height='9' style='fill:#79d79d'/><path d='M4,24H16V16H4v8Zm30-8v8H46V16H34ZM18,24H32V16H18v8ZM4,35H16V27H4v8Zm30-.042H46v-8H34v8ZM18,35H32V27H18v8Z' style='fill:#aaa;fill-rule:evenodd'/><path d='M47.059,0H2.941A2.974,2.974,0,0,0,0,3V47a2.974,2.974,0,0,0,2.941,3H47.059A2.974,2.974,0,0,0,50,47V3A2.974,2.974,0,0,0,47.059,0Zm0.98,47a0.993,0.993,0,0,1-.98,1H2.941a0.993,0.993,0,0,1-.98-1V14H48.039V47Zm0-35H1.961V3a0.993,0.993,0,0,1,.98-1H47.059a0.993,0.993,0,0,1,.98,1v9Z'style='fill:#aaa'/><polygon points='25 41 25 39 24 39 24 41 22 41 22 42 24 42 24 44 25 44 25 42 27 42 27 41 25 41' style='fill:#fff'/></svg>" }, "images/data/edittable/cachingcached.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M3.675,7.069a0.509,0.509,0,0,0-.509-0.509H1.77a0.509,0.509,0,0,0,0,1.018h1.4A0.51,0.51,0,0,0,3.675,7.069Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M3.991,4.638h0a0.527,0.527,0,0,0,.372.158,0.442,0.442,0,0,0,.448-0.447,0.532,0.532,0,0,0-.159-0.373L3.7,3.025a0.53,0.53,0,0,0-.371-0.158h0a0.444,0.444,0,0,0-.448.45,0.528,0.528,0,0,0,.158.37Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M11.131,3.131A0.446,0.446,0,0,0,10.816,3h0a0.531,0.531,0,0,0-.371.158L9.5,4.1a0.49,0.49,0,0,0-.028.689,0.446,0.446,0,0,0,.318.128,0.527,0.527,0,0,0,.371-0.157L11.1,3.819a0.531,0.531,0,0,0,.157-0.373A0.445,0.445,0,0,0,11.131,3.131Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M6.976,1.354a0.51,0.51,0,0,0-.509.51v1.4a0.509,0.509,0,1,0,1.018,0v-1.4A0.51,0.51,0,0,0,6.976,1.354Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M4.007,9.6l-0.941.94a0.529,0.529,0,0,0-.158.371,0.442,0.442,0,0,0,.445.446h0A0.53,0.53,0,0,0,3.726,11.2l0.94-.94A0.468,0.468,0,1,0,4.007,9.6Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M10.5,6C8.015,6,6,6.6,6,7.538,6,8.319,7.4,8.97,9.3,9.168l3.043-3.043A13.259,13.259,0,0,0,10.5,6Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M6,9.382v1.372a1.3,1.3,0,0,0,.727.987L8.088,10.38A4.616,4.616,0,0,1,6,9.382Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M10.493,16c2.348,0,4.3-.8,4.507-1.7V12.765a6.9,6.9,0,0,1-4.507,1.276,9.7,9.7,0,0,1-2.84-.4L6.413,14.884A6.58,6.58,0,0,0,10.493,16Z' class='sf-element-svg-element sfc-primary-gray-color'/><path d='M10.493,12.618c2.347,0,4.3-.8,4.507-1.7V9.382a6.783,6.783,0,0,1-4.357,1.271L8.822,12.474A9.756,9.756,0,0,0,10.493,12.618Z' class='sf-element-svg-element sfc-primary-gray-color'/><path d='M15,7.538A0.944,0.944,0,0,0,14.492,6.8l-2.3,2.3C13.834,8.856,15,8.248,15,7.538Z' class='sf-element-svg-element sfc-primary-gray-color'/></svg>" }, "images/data/edittable/cachingembedded.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M5.5,2.485V3.529c0,0.74,1.561,1.417,3.494,1.417,1.826,0,3.345-.612,3.506-1.3V2.485a5.453,5.453,0,0,1-3.506.971A5.416,5.416,0,0,1,5.5,2.485Zm3.494-.024c1.933,0,3.506-.58,3.506-1.292S10.933,0,9,0s-3.5.456-3.5,1.17S7.061,2.461,8.994,2.461ZM5.5,4.972V6.015c0,0.74,1.561,1.417,3.494,1.417,1.826,0,3.345-.612,3.506-1.3V4.972a5.453,5.453,0,0,1-3.506.971A5.416,5.416,0,0,1,5.5,4.972Z' class='sf-element-svg-element sfc-accent3-color'/><path d='M2,6.984H4.5v-6H4.287Zm11.76-6H13.5v6H16Z' class='sf-element-svg-element sfc-primary-gray-color'/><rect x='2.5' y='11.5' width='13' height='4' class='sf-element-svg-element sfc-secondary-gray-color'/><path d='M15,12v3H3V12H15m1-1H2v5H16V11h0Z' class='sf-element-svg-element sfc-primary-gray-color'/><rect x='7.085' y='13' width='4' height='1' class='sf-element-svg-element sfc-primary-gray-color'/><rect x='2.5' y='7.484' width='13' height='4' class='sf-element-svg-element sfc-secondary-gray-color'/><path d='M15,7.984v3H3v-3H15m1-1H2v5H16v-5h0Z' class='sf-element-svg-element sfc-primary-gray-color'/><rect x='7.085' y='8.984' width='4' height='1' class='sf-element-svg-element sfc-primary-gray-color'/></svg>" }, "images/data/edittable/cachinglinked.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' class='sf-element-svg-element sfc-accent3-color'><path d='M3.675,7.069a0.509,0.509,0,0,0-.509-0.509H1.77a0.509,0.509,0,0,0,0,1.018h1.4A0.51,0.51,0,0,0,3.675,7.069Z'/><path d='M3.991,4.638h0a0.527,0.527,0,0,0,.372.158,0.442,0.442,0,0,0,.448-0.447,0.532,0.532,0,0,0-.159-0.373L3.7,3.025a0.53,0.53,0,0,0-.371-0.158h0a0.444,0.444,0,0,0-.448.45,0.528,0.528,0,0,0,.158.37Z'/><path d='M11.131,3.131A0.446,0.446,0,0,0,10.816,3h0a0.531,0.531,0,0,0-.371.158L9.5,4.1a0.49,0.49,0,0,0-.028.689,0.446,0.446,0,0,0,.318.128,0.527,0.527,0,0,0,.371-0.157L11.1,3.819a0.531,0.531,0,0,0,.157-0.373A0.445,0.445,0,0,0,11.131,3.131Z'/><path d='M6.976,1.354a0.51,0.51,0,0,0-.509.51v1.4a0.509,0.509,0,1,0,1.018,0v-1.4A0.51,0.51,0,0,0,6.976,1.354Z'/><path d='M4.007,9.6l-0.941.94a0.529,0.529,0,0,0-.158.371,0.442,0.442,0,0,0,.445.446h0A0.53,0.53,0,0,0,3.726,11.2l0.94-.94A0.468,0.468,0,1,0,4.007,9.6Z'/><path d='M6,12.765v1.372C6,15.11,8.007,16,10.493,16c2.348,0,4.3-.8,4.507-1.7V12.765a6.9,6.9,0,0,1-4.507,1.276A6.857,6.857,0,0,1,6,12.765Zm4.493-3.529c2.485,0,4.507-.762,4.507-1.7S12.985,6,10.5,6,6,6.6,6,7.538,8.007,9.236,10.493,9.236ZM6,9.382v1.372c0,0.973,2.007,1.863,4.493,1.863,2.347,0,4.3-.8,4.507-1.7V9.382a6.9,6.9,0,0,1-4.507,1.276A6.857,6.857,0,0,1,6,9.382Z'/></svg>" }, "images/data/edittable/calculation.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M47.059,0H2.941A2.974,2.974,0,0,0,0,3V47a2.974,2.974,0,0,0,2.941,3H47.059A2.974,2.974,0,0,0,50,47V3A2.974,2.974,0,0,0,47.059,0ZM17,44H7V38H17v6Zm0-10H7V28H17v6Zm0-9H7V19H17v6ZM30,44H20V38H30v6Zm0-10H20V28H30v6Zm0-9H20V19H30v6ZM43,44H33V38H43v6Zm0-10H33V28H43v6Zm0-9H33V19H43v6Zm0-9H7V6H43V16Z' style='fill:#c9bdeb'/></svg>" }, "images/data/edittable/clipboard.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M31.25,3.124H28.125V6.25H25.086a6.284,6.284,0,0,0-12.569,0h-2.29V3.124H6.818A6.775,6.775,0,0,0,0,9.855V40.144a6.775,6.775,0,0,0,6.818,6.731H20.052V43.509H6.818a3.391,3.391,0,0,1-3.409-3.365V9.855A3.391,3.391,0,0,1,6.818,6.49H9.375V9.375h18.75V6.7H31.25a3.375,3.375,0,0,1,3.125,3.572v2.3H37.5v-2.3C37.5,6.322,34.7,3.124,31.25,3.124ZM15.663,6.25A3.137,3.137,0,0,1,18.79,3.128l0,0H18.81l-0.008,0A3.139,3.139,0,0,1,21.94,6.25H15.663Z' style='fill:#aaa'/><path d='M42.605,12.611v7.395H50C50.055,20.005,42.605,12.611,42.605,12.611ZM39.518,22.3V12.564H23.461c-1.676,0-3.41.768-3.41,2.178V47.073c0,1.41,1.733,2.927,3.41,2.927H47.339A2.793,2.793,0,0,0,50,47.073V22.3H39.518Zm0.749,18.718H25.293V38.769H40.267v2.246Zm4.492-5.241H25.293V33.528H44.759v2.246Zm0-5.241H25.293V28.287H44.759v2.246Z' style='fill:#218ecf'/></svg>" }, "images/data/edittable/dataconnection.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M18.448,39.038a34.442,34.442,0,0,0,8.937-1.15c-0.019-.027-0.042-0.056-0.061-0.083a13.271,13.271,0,0,1-.892-1.5A12.936,12.936,0,0,1,25,30.364c0-.341.024-0.684,0.051-1.027a39.489,39.489,0,0,1-6.6.548c-8.215,0-15.243-2.4-18.448-5.961v6.411C0,34.88,8.24,39.038,18.448,39.038ZM28.7,39.468a37.029,37.029,0,0,1-10.254,1.379c-8.215,0-15.243-2.4-18.448-5.961V41.3C0,45.842,8.24,50,18.448,50c8.629,0,15.944-3.011,17.995-6.657a12.991,12.991,0,0,1-7.194-3.337C29.066,39.837,28.885,39.658,28.7,39.468ZM43.231,31.58c0.178,0.171.3,0.285,0.3,0.285h0S43.41,31.752,43.231,31.58ZM18.479,2C8.271,2,0,4.8,0,9.185s8.24,7.929,18.448,7.929,18.509-3.558,18.509-7.929S28.684,2,18.479,2ZM18.448,18.923c-8.215,0-15.243-2.4-18.448-5.961v6.411c0,4.546,8.24,8.7,18.448,8.7a35.508,35.508,0,0,0,6.9-.666c0.013-.049.023-0.1,0.037-0.147l0.05-.185a13.062,13.062,0,0,1,.641-1.911c0.133-.307.288-0.625,0.474-0.973,0.126-.237.257-0.471,0.4-0.7a13.212,13.212,0,0,1,1.093-1.519q0.3-.359.622-0.7a13.206,13.206,0,0,1,1.384-1.25,12.853,12.853,0,0,1,6.91-2.714V12.962C33.752,16.527,26.663,18.923,18.448,18.923Z' style='fill:#aaa'/><path d='M46.205,21.614a12.023,12.023,0,0,0-3.181-2.145q-0.44-.2-0.9-0.371t-0.934-.3c-0.294-.081-0.6-0.128-0.9-0.188-0.365-.072-0.734-0.134-1.107-0.178a9.75,9.75,0,0,0-1.139-.07c-0.366,0-.728.019-1.086,0.052a11.86,11.86,0,0,0-6.242,2.476,12.08,12.08,0,0,0-1.27,1.147q-0.3.309-.571,0.638a12.083,12.083,0,0,0-1,1.393c-0.129.209-.248,0.423-0.364,0.64-0.156.291-.3,0.587-0.435,0.892a11.557,11.557,0,0,0-.524,1.541c-0.019.071-.043,0.14-0.062,0.212-0.056.215-.122,0.427-0.166,0.647q-0.111.557-.17,1.132A11.878,11.878,0,0,0,27.4,35.8a12.112,12.112,0,0,0,.818,1.379c0.091,0.132.2,0.252,0.3,0.379,0.141,0.182.276,0.368,0.424,0.543a12.772,12.772,0,0,0,.946.991c0.035,0.033.064,0.072,0.1,0.1a11.9,11.9,0,0,0,6.892,3.1c0.384,0.038.774,0.058,1.168,0.058,0.349,0,.694-0.021,1.035-0.051A11.993,11.993,0,0,0,46.205,21.614Zm-1.074,5.859a0.755,0.755,0,0,1-.173.252L42.1,30.488c0.495,0.477.882,0.85,1.135,1.092,0.179,0.172.3,0.287,0.3,0.285h0L40.68,34.619l-1.664,1.606a2.058,2.058,0,0,1-1.057.541,2.149,2.149,0,0,1-.392.036h0a1.341,1.341,0,0,1-.611-0.11,2.021,2.021,0,0,1-.838-0.467L36,36.108l-0.165-.159-0.742-.716-0.646-.623L34,34.177l-2.617-2.526a1.933,1.933,0,0,1-.261-2.487,1.982,1.982,0,0,1,.261-0.309l2.77-2.674,0.719-.694L35.9,24.5l0.239,0.231,0.172,0.166,0.649,0.628,0.37,0.358,2.859-2.76a0.788,0.788,0,0,1,.261-0.167,0.811,0.811,0,0,1,.233-0.043c0.022,0,.043-0.012.065-0.012a0.822,0.822,0,0,1,.3.056,0.788,0.788,0,0,1,.261.167l0.074,0.072a0.747,0.747,0,0,1,0,1.08l-0.7.675-2.161,2.086,2.053,1.984,0.331,0.32,1.331-1.284,1.531-1.478a0.814,0.814,0,0,1,1.119,0l0.074,0.072a0.755,0.755,0,0,1,.173.252A0.746,0.746,0,0,1,45.131,27.474Z' style='fill:#79d79d'/></svg>" }, "images/data/edittable/datafunction.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M30.151,16.971a1.211,1.211,0,0,0-.2-0.661H23.826q0.1-.354.588-1.98,1.029-3.506,1.888-5.742a20.167,20.167,0,0,1,2.132-4.116Q30.3,1.728,32.257,1.728a2.694,2.694,0,0,1,2.011.94,4.654,4.654,0,0,1,.98,3.023,1.366,1.366,0,0,0,.221.558,0.535,0.535,0,0,0,.467.254,1.95,1.95,0,0,0,1.373-1.016,3.591,3.591,0,0,0,.735-2.134A2.935,2.935,0,0,0,36.841.94,4.44,4.44,0,0,0,34.024,0,9.935,9.935,0,0,0,29.66,1.016a11.392,11.392,0,0,0-3.873,3.2,21.989,21.989,0,0,0-3.138,5.208,55.376,55.376,0,0,0-2.3,6.884H16.128a1.388,1.388,0,0,0-.636,1.17,0.885,0.885,0,0,0,.294.711h4.068Q18.777,21.9,16.863,30.131q-2.108,8.945-3.48,13.568a8.947,8.947,0,0,1-1.5,3.3,2.226,2.226,0,0,1-1.594.914A3.164,3.164,0,0,1,8.7,47.409a3.7,3.7,0,0,1-1.348-1.372,1.206,1.206,0,0,0-.834-0.762,0.972,0.972,0,0,0-.588.3,2.954,2.954,0,0,0-.662.711A2.006,2.006,0,0,0,5,47.409a2.528,2.528,0,0,0,.834,1.728A3.124,3.124,0,0,0,8.186,50a6.48,6.48,0,0,0,3.31-.838,9.544,9.544,0,0,0,2.279-1.753q1.913-1.781,3.873-8.333,0.882-3.1,2.746-9.91L22.256,22.2q0.2-.71.54-1.879,0.441-1.728.588-2.136h6.079A1.484,1.484,0,0,0,30.151,16.971Zm14.422,6.836a1.4,1.4,0,0,0-1.2-.593,3.147,3.147,0,0,0-1.974.868A21.607,21.607,0,0,0,38.773,26.9q-0.817.973-1.222,1.5t-1.018,1.333q-0.407.507-.529,0.634l-1.751-4.95a5.487,5.487,0,0,0-.833-1.693,1.239,1.239,0,0,0-.957-0.508,3.147,3.147,0,0,0-1.953,1.418,8.993,8.993,0,0,0-1.709,3.11q0,0.676.448,0.677a0.636,0.636,0,0,0,.283-0.084,4.69,4.69,0,0,0,.285-0.508,11.557,11.557,0,0,1,.835-1.227,0.95,0.95,0,0,1,.712-0.422c0.245,0,.6.579,1.059,1.734a1.261,1.261,0,0,1,.081.255l1.709,4.569c-0.055.084-.325,0.424-0.814,1.015q-1.75,2.159-2.688,3.216a3.546,3.546,0,0,1-1.628,1.313q-0.487,0-.733-1.186a0.942,0.942,0,0,0-.162-0.381,0.33,0.33,0,0,0-.244-0.169,1.373,1.373,0,0,0-.9.465,3.47,3.47,0,0,0-.856,1.184,3.323,3.323,0,0,0-.325,1.355,1.581,1.581,0,0,0,.387,1.08,1.35,1.35,0,0,0,1.078.444,3.4,3.4,0,0,0,1.749-.719,14.417,14.417,0,0,0,2.646-2.625q1.141-1.436,1.832-2.305T34.7,34.09l1.547,4.019a11.452,11.452,0,0,0,1.118,2.244,1.524,1.524,0,0,0,1.282.719,2.706,2.706,0,0,0,2.1-1.524,10.58,10.58,0,0,0,1.445-3.681,0.384,0.384,0,0,0-.448-0.422,0.536,0.536,0,0,0-.406.169,18.656,18.656,0,0,1-1.1,1.861,1.185,1.185,0,0,1-.814.634,0.889,0.889,0,0,1-.652-0.571,14.512,14.512,0,0,1-.814-1.84l-1.507-4.021q1.548-1.9,2.4-2.961c0.57-.7,1.051-1.27,1.445-1.692a5.819,5.819,0,0,1,.976-0.889,1.286,1.286,0,0,1,.672-0.253,1.106,1.106,0,0,1,.854,1.058,0.768,0.768,0,0,0,.57.719,1.47,1.47,0,0,0,1.078-.719A2.775,2.775,0,0,0,45,25.2,2.322,2.322,0,0,0,44.573,23.807Z' style='fill:#fbb95d'/></svg>" }, "images/data/edittable/datasource.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M5,34.615v6.525C5,45.768,13.919,50,24.967,50,35.4,50,44.083,46.177,45,41.9V34.615c-3.469,3.629-11.142,6.068-20.033,6.068S8.469,38.244,5,34.615ZM24.967,15.385C36.012,15.385,45,11.763,45,7.313S36.045,0,25,0,5,2.852,5,7.313,13.919,15.385,24.967,15.385ZM5,11.538v6.525c0,4.627,8.919,8.859,19.967,8.859C35.4,26.923,44.083,23.1,45,18.82V11.538c-3.469,3.629-11.142,6.068-20.033,6.068S8.469,15.167,5,11.538ZM5,23.077V29.6c0,4.627,8.919,8.859,19.967,8.859,10.434,0,19.116-3.823,20.033-8.1V23.077c-3.469,3.629-11.142,6.068-20.033,6.068S8.469,26.706,5,23.077Z' style='fill:#aaa'/></svg>" }, "images/data/edittable/datatable.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M4,24H24V16H4v8Zm22-8v8H46V16H26ZM4,34H24V26H4v8Zm22,0H46V26H26v8ZM4,44H24V36H4v8Zm22,0H46V36H26v8Z' style='fill:#aaa;fill-rule:evenodd'/><path d='M47.059,0H2.941A2.974,2.974,0,0,0,0,3V47a2.974,2.974,0,0,0,2.941,3H47.059A2.974,2.974,0,0,0,50,47V3A2.974,2.974,0,0,0,47.059,0Zm0.98,47a0.993,0.993,0,0,1-.98,1H2.941a0.993,0.993,0,0,1-.98-1V14H48.039V47Zm0-35H1.961V3a0.993,0.993,0,0,1,.98-1H47.059a0.993,0.993,0,0,1,.98,1v9Z' style='fill:#aaa'/></svg>" }, "images/data/edittable/datatabledatasource.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M18.448,39.038a34.442,34.442,0,0,0,8.937-1.15c-0.019-.027-0.042-0.056-0.061-0.083a13.271,13.271,0,0,1-.892-1.5A12.936,12.936,0,0,1,25,30.364c0-.341.024-0.684,0.051-1.027a39.489,39.489,0,0,1-6.6.548c-8.215,0-15.243-2.4-18.448-5.961v6.411C0,34.88,8.24,39.038,18.448,39.038Zm0-21.924c10.2,0,18.509-3.558,18.509-7.929S28.684,2,18.479,2,0,4.8,0,9.185,8.24,17.114,18.448,17.114ZM28.7,39.468a37.029,37.029,0,0,1-10.254,1.379c-8.215,0-15.243-2.4-18.448-5.961V41.3C0,45.842,8.24,50,18.448,50c8.629,0,15.944-3.011,17.995-6.657a12.991,12.991,0,0,1-7.194-3.337C29.066,39.837,28.885,39.658,28.7,39.468ZM18.448,18.923c-8.215,0-15.243-2.4-18.448-5.961v6.411c0,4.546,8.24,8.7,18.448,8.7a35.508,35.508,0,0,0,6.9-.666c0.013-.049.023-0.1,0.037-0.147l0.05-.185a13.062,13.062,0,0,1,.641-1.911c0.133-.307.288-0.625,0.474-0.973,0.126-.237.257-0.471,0.4-0.7a13.212,13.212,0,0,1,1.093-1.519q0.3-.359.622-0.7a13.206,13.206,0,0,1,1.384-1.25,12.853,12.853,0,0,1,6.91-2.714V12.962C33.752,16.527,26.663,18.923,18.448,18.923Z' style='fill:#aaa'/><path d='M39,35h4V33H39v2Zm-6-4h4V29H33v2Zm0,4h4V33H33v2ZM46.2,21.615A12.023,12.023,0,0,0,43.02,19.47q-0.44-.2-0.9-0.371t-0.934-.3c-0.294-.081-0.6-0.128-0.9-0.188-0.365-.072-0.734-0.134-1.107-0.178a9.75,9.75,0,0,0-1.139-.07c-0.366,0-.728.019-1.086,0.052a11.86,11.86,0,0,0-6.242,2.476,12.08,12.08,0,0,0-1.27,1.147q-0.3.309-.571,0.638a12.083,12.083,0,0,0-1,1.393c-0.129.209-.248,0.423-0.364,0.64C27.348,25,27.2,25.3,27.069,25.6a11.557,11.557,0,0,0-.524,1.541c-0.019.071-.043,0.14-0.062,0.212-0.056.215-.122,0.427-0.166,0.647q-0.111.557-.17,1.132A11.878,11.878,0,0,0,27.394,35.8a12.112,12.112,0,0,0,.818,1.379c0.091,0.132.2,0.252,0.3,0.379,0.141,0.182.276,0.368,0.424,0.543a12.772,12.772,0,0,0,.946.991c0.035,0.033.064,0.072,0.1,0.1a11.9,11.9,0,0,0,6.892,3.1c0.384,0.038.774,0.058,1.168,0.058,0.349,0,.694-0.021,1.035-0.051A11.993,11.993,0,0,0,46.2,21.615ZM45,36.524c0,0.463-.331.476-0.785,0.476H31.862C31.408,37,31,36.987,31,36.524V24.2a1.261,1.261,0,0,1,.862-1.2H44.215A1.2,1.2,0,0,1,45,24.2v12.32ZM39,31h4V29H39v2Zm-6-4H43V25H33v2Z' style='fill:#79d79d'/></svg>" }, "images/data/edittable/filedatasource.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M35,0V10H45C45.074,10,35,0,35,0ZM30.135,13.636V0H9.054C6.815,0,5,1.526,5,3.409V46.591C5,48.474,6.815,50,9.054,50H40.946C43.185,50,45,48.474,45,46.591V13.636H30.135Z' style='fill:#69bff3'/></svg>" }, "images/data/edittable/frozen.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M25.014,2.185l3.085,1.7V7.118l-3.085,1.7-3.085-1.7V3.882l3.085-1.7m0-2.185-5,2.75v5.5l5,2.75,5-2.75V2.75l-5-2.75h0Z' style='fill:#218ecf'/><path d='M25.014,41.185l3.085,1.7v3.236l-3.085,1.7-3.085-1.7V42.882l3.085-1.7m0-2.185-5,2.75v5.5l5,2.75,5-2.75v-5.5l-5-2.75h0Z' style='fill:#218ecf'/><path d='M41.956,12.032L44.939,13.9l0.016,3.521L42.128,19l-2.982-1.872L39.129,13.6l2.828-1.573m0.059-2.224-4.807,2.673,0.027,5.706,4.833,3.033,4.807-2.673-0.027-5.706L42.015,9.808h0Z' style='fill:#218ecf'/><path d='M7.872,30.987l2.982,1.872,0.016,3.521L8.044,37.952,5.061,36.08,5.045,32.559l2.828-1.573m0.059-2.224L3.125,31.436l0.027,5.706,4.833,3.033L12.792,37.5,12.765,31.8,7.931,28.763h0Z' style='fill:#218ecf'/><path d='M41.819,31.789L44.568,33.5l-0.186,3.516-3.069,1.726-2.749-1.707,0.186-3.516,3.069-1.726m0.048-2.224-4.974,2.8-0.3,5.7,4.672,2.9,4.974-2.8,0.3-5.7-4.672-2.9h0Z' style='fill:#218ecf'/><path d='M8.688,11.214l2.749,1.707-0.186,3.516L8.182,18.163,5.433,16.456,5.619,12.94l3.069-1.726M8.737,8.99l-4.974,2.8-0.3,5.7,4.672,2.9,4.974-2.8,0.3-5.7L8.737,8.99h0Z' style='fill:#218ecf'/><rect x='24' y='8.976' width='2' height='32' transform='translate(-9.407 33.037) rotate(-58.159)' style='fill:#218ecf'/><rect x='24.013' y='9' width='2' height='32' style='fill:#218ecf'/><rect x='9' y='23.992' width='32' height='2' transform='translate(-8.999 15.313) rotate(-29.099)' style='fill:#218ecf'/><rect x='7.013' y='24' width='36' height='2' style='fill:#218ecf'/><rect x='2.013' y='24' width='46' height='2' transform='translate(-8.973 34.776) rotate(-61.032)' style='fill:#218ecf'/><rect x='24.014' y='2' width='2' height='45.999' transform='translate(-9.458 17.102) rotate(-32.079)' style='fill:#218ecf'/><polygon points='17.514 20.75 25.014 16.5 32.514 20.75 32.514 29.25 25.014 33.5 17.514 29.25 17.514 20.75' style='fill:#218ecf'/></svg>" }, "images/data/edittable/informationlink.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M42.678,7.322A25.042,25.042,0,0,0,1.709,34.258,27.336,27.336,0,0,0,16.171,48.719c9.016,3.608,19.173,1.293,26.507-6.041A25.028,25.028,0,0,0,42.678,7.322ZM41.334,41.334c-6.778,6.778-16.141,8.928-24.438,5.61a25.48,25.48,0,0,1-13.41-13.41A23.11,23.11,0,1,1,41.334,41.334ZM35.8,13.526a5.03,5.03,0,0,0-7.1,0l-3.5,3.5a5.015,5.015,0,0,0-.418,6.593l-1.155,1.155a5.015,5.015,0,0,0-6.592.418l-3.5,3.5a5.03,5.03,0,0,0,0,7.105L14.2,36.474a5.03,5.03,0,0,0,7.105,0l3.5-3.5a5.015,5.015,0,0,0,.418-6.592l1.155-1.155a5.015,5.015,0,0,0,6.593-.418l3.5-3.5a5.03,5.03,0,0,0,0-7.1ZM23.392,31.557l-3.5,3.5a3.027,3.027,0,0,1-4.277,0l-0.673-.673a3.027,3.027,0,0,1,0-4.277l3.5-3.5A3.026,3.026,0,0,1,22.2,26.2l-2.254,2.254a1.134,1.134,0,0,0,1.6,1.6L23.8,27.8A3.026,3.026,0,0,1,23.392,31.557ZM35.06,19.89l-3.5,3.5A3.026,3.026,0,0,1,27.8,23.8l2.254-2.254a1.134,1.134,0,0,0-1.6-1.6L26.2,22.2a3.026,3.026,0,0,1,.411-3.757l3.5-3.5a3.027,3.027,0,0,1,4.276,0l0.673,0.673A3.027,3.027,0,0,1,35.06,19.89Z' style='fill:#68bef2'/></svg>" }, "images/data/edittable/logfile.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M30,0.062V10H40C40.073,10,30,.062,30,0.062ZM18.145,22H40V13H26V0H4.554C2.315,0,0,1.026,0,2.909V46.091C0,47.974,2.315,50,4.554,50H36.446A3.73,3.73,0,0,0,40,46.091V44H18.145C15.3,44,13,40.7,13,37.855V28.145C13,25.3,15.3,22,18.145,22Z' style='fill:#aaa'/><rect x='16' y='25.4' width='34' height='15' rx='4.108' ry='4.108' style='fill:#79d79d'/><path d='M23.3,29.38H21.854v7.1h5.039V35.273H23.3V29.38Zm15.732,3.262v1.206h1.655v0.908a3.113,3.113,0,0,1-.783.432,2.5,2.5,0,0,1-.911.178,1.893,1.893,0,0,1-1.484-.637,2.806,2.806,0,0,1-.566-1.912,2.529,2.529,0,0,1,.56-1.782,1.958,1.958,0,0,1,1.506-.6,1.719,1.719,0,0,1,1.043.305,1.514,1.514,0,0,1,.568.833l1.436-.269a2.523,2.523,0,0,0-.964-1.545,3.423,3.423,0,0,0-2.083-.559,3.7,3.7,0,0,0-1.714.356,3.159,3.159,0,0,0-1.372,1.333,4.12,4.12,0,0,0-.469,1.987,4.364,4.364,0,0,0,.42,1.907,3,3,0,0,0,1.255,1.348,3.921,3.921,0,0,0,1.958.471,4.789,4.789,0,0,0,1.746-.334,3.925,3.925,0,0,0,1.315-.774V32.641H39.031ZM31.092,29.2a3.93,3.93,0,0,0-1.543.283,2.79,2.79,0,0,0-.925.645,3.36,3.36,0,0,0-.667.981,4.558,4.558,0,0,0-.327,1.836,3.7,3.7,0,0,0,.942,2.683,3.37,3.37,0,0,0,2.539.974,3.333,3.333,0,0,0,2.52-.979,3.746,3.746,0,0,0,.942-2.712,3.762,3.762,0,0,0-.949-2.729A3.363,3.363,0,0,0,31.092,29.2Zm1.434,5.544a1.931,1.931,0,0,1-2.845,0,2.684,2.684,0,0,1-.562-1.843,2.706,2.706,0,0,1,.547-1.848,2,2,0,0,1,2.874-.007,2.694,2.694,0,0,1,.539,1.836A2.737,2.737,0,0,1,32.525,34.743Z' style='fill:#fff'/></svg>" }, "images/data/edittable/nonodeselected.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 110 110'><path d='M55,2A53,53,0,1,1,2,55,53.06,53.06,0,0,1,55,2m0-2a55,55,0,1,0,55,55A55,55,0,0,0,55,0h0Z' style='fill:#dadada'/><rect x='46' y='29.542' width='18' height='23' rx='2.495' ry='2.495' style='fill:#949494'/><path d='M37.5,48.542a2.006,2.006,0,0,1-2,2h-10a2.006,2.006,0,0,1-2-2v-15a2.006,2.006,0,0,1,2-2h10a2.006,2.006,0,0,1,2,2v15Z' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><rect x='25.5' y='33.542' width='10' height='9' style='fill:silver'/><rect x='25.5' y='44.542' width='10' height='4' style='fill:silver'/><rect x='48' y='31.542' width='14' height='19' rx='2' ry='2' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><rect x='50' y='33.542' width='10' height='9' style='fill:silver'/><rect x='50' y='44.542' width='10' height='4' style='fill:silver'/><rect x='72.5' y='31.542' width='14' height='19' rx='2' ry='2' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><rect x='74.5' y='33.542' width='10' height='9' style='fill:silver'/><rect x='74.5' y='44.542' width='10' height='4' style='fill:silver'/><rect x='35' y='60.958' width='14' height='19' rx='2' ry='2' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><rect x='37' y='62.958' width='10' height='9' style='fill:silver'/><rect x='37' y='73.958' width='10' height='4' style='fill:silver'/><path d='M55,50.541V65.229s0.291,5.229-2.723,5.229H49' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><line x1='48' y1='41.042' x2='37.5' y2='41.042' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/><line x1='72.5' y1='41.042' x2='62' y2='41.042' style='fill:none;stroke:#dadada;stroke-miterlimit:10'/></svg>" }, "images/data/edittable/reload.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' class='sf-element-svg-element sfc-accent3-color' viewBox='-2 -2 16 16' enable-background='new 0 0 12 12' xml:space='preserve'><g><g><path d='M9.716,1.9c-2.332-2.245-6.11-2.201-8.444,0.108C0.718,2.557,0.293,3.186,0,3.856l1.275,0.581 c0.225-0.53,0.555-1.027,0.992-1.459C4.049,1.216,6.932,1.18,8.716,2.89L6.769,5H12V0L9.716,1.9z'/></g></g><g><g><path d='M10.728,7.553c-0.224,0.531-0.554,1.029-0.99,1.462c-1.778,1.767-4.656,1.802-6.437,0.089L5.244,7H0v5 l2.303-1.904c2.327,2.249,6.098,2.206,8.427-0.108c0.554-0.55,0.977-1.181,1.27-1.852L10.728,7.553z'/></g></g></svg>" }, "images/data/edittable/sbdf.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M25,0A25.052,25.052,0,0,0,1.984,15.259,25.55,25.55,0,0,0,1.984,35h0A25.04,25.04,0,1,0,25,0Zm0,48.136A22.76,22.76,0,0,1,4.133,35H36.3A7.737,7.737,0,0,0,44,27.08V22.92A7.737,7.737,0,0,0,36.3,15H4.133A22.756,22.756,0,0,1,25,1.867,23.134,23.134,0,1,1,25,48.136Z' style='fill:#79d79d'/><path d='M14.251,24.755a7.023,7.023,0,0,0-1.561-.515,3.806,3.806,0,0,1-1.328-.479,0.552,0.552,0,0,1-.215-0.435,0.523,0.523,0,0,1,.229-0.444,1.654,1.654,0,0,1,.986-0.259,1.459,1.459,0,0,1,.916.242,1.227,1.227,0,0,1,.4.793l1.445-.063a2.084,2.084,0,0,0-.715-1.577,3.022,3.022,0,0,0-2.029-.591,3.579,3.579,0,0,0-1.408.249,1.935,1.935,0,0,0-.894.725,1.838,1.838,0,0,0-.311,1.023,1.863,1.863,0,0,0,.659,1.44,3.928,3.928,0,0,0,1.631.708q0.9,0.225,1.157.313a1.192,1.192,0,0,1,.521.31,0.654,0.654,0,0,1,.148.432,0.88,0.88,0,0,1-.354.691,1.612,1.612,0,0,1-1.053.3,1.557,1.557,0,0,1-1.047-.332,1.717,1.717,0,0,1-.516-1.04l-1.406.137a2.734,2.734,0,0,0,.869,1.829,3.1,3.1,0,0,0,2.085.627,4.048,4.048,0,0,0,1.558-.261,2.047,2.047,0,0,0,.967-0.8,2.1,2.1,0,0,0,.342-1.152,2.127,2.127,0,0,0-.285-1.14A2.009,2.009,0,0,0,14.251,24.755Zm14.592-2.41a2.387,2.387,0,0,0-1.079-.659,5.151,5.151,0,0,0-1.362-.137H23.76v7.158h2.72a4.363,4.363,0,0,0,1.279-.151,2.534,2.534,0,0,0,1.016-.571,3.151,3.151,0,0,0,.767-1.265,4.7,4.7,0,0,0,.22-1.523,5.284,5.284,0,0,0-.234-1.692A3.123,3.123,0,0,0,28.843,22.345Zm-0.723,4.1a1.518,1.518,0,0,1-.378.691,1.338,1.338,0,0,1-.584.3,3.942,3.942,0,0,1-.874.068H25.205V22.76h0.649a6.559,6.559,0,0,1,1.187.068,1.374,1.374,0,0,1,.669.337,1.637,1.637,0,0,1,.41.693,4.278,4.278,0,0,1,.146,1.274A4.671,4.671,0,0,1,28.12,26.444ZM21.187,24.9a1.695,1.695,0,0,0,1.006-1.553,1.621,1.621,0,0,0-.22-0.837,1.838,1.838,0,0,0-.549-0.6,1.862,1.862,0,0,0-.747-0.3,8.252,8.252,0,0,0-1.268-.071H16.548v7.158h2.437q1.383-.01,1.743-0.049a2.05,2.05,0,0,0,.97-0.339,1.917,1.917,0,0,0,.62-0.737,2.126,2.126,0,0,0,.227-0.95,1.724,1.724,0,0,0-.352-1.079A1.882,1.882,0,0,0,21.187,24.9Zm-3.193-2.163h0.83q1.021,0,1.235.024a0.83,0.83,0,0,1,.545.251,0.785,0.785,0,0,1,.183.54,0.756,0.756,0,0,1-.212.559,0.955,0.955,0,0,1-.584.256q-0.205.024-1.05,0.024H17.993V22.741Zm2.854,4.431a0.9,0.9,0,0,1-.525.286,6.529,6.529,0,0,1-.991.044H17.993V25.587H19.16a4.913,4.913,0,0,1,1.282.1,0.881,0.881,0,0,1,.451.327,0.932,0.932,0,0,1,.156.547A0.881,0.881,0,0,1,20.848,27.172ZM35.9,22.76V21.549H31v7.158h1.445V25.666H35.43V24.455H32.441V22.76H35.9Z' style='fill:#fff'/></svg>" }, "images/data/edittable/stdf.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M25,0A25.052,25.052,0,0,0,1.984,15.259,25.55,25.55,0,0,0,1.984,35h0A25.04,25.04,0,1,0,25,0Zm0,48.136A22.76,22.76,0,0,1,4.133,35H36.3A7.737,7.737,0,0,0,44,27.08V22.92A7.737,7.737,0,0,0,36.3,15H4.133A22.756,22.756,0,0,1,25,1.867,23.134,23.134,0,1,1,25,48.136Z' style='fill:#f58585'/><path d='M14.251,24.755a7.023,7.023,0,0,0-1.561-.515,3.806,3.806,0,0,1-1.328-.479,0.552,0.552,0,0,1-.215-0.435,0.523,0.523,0,0,1,.229-0.444,1.654,1.654,0,0,1,.986-0.259,1.459,1.459,0,0,1,.916.242,1.227,1.227,0,0,1,.4.793l1.445-.063a2.084,2.084,0,0,0-.715-1.577,3.022,3.022,0,0,0-2.029-.591,3.579,3.579,0,0,0-1.408.249,1.935,1.935,0,0,0-.894.725,1.838,1.838,0,0,0-.311,1.023,1.863,1.863,0,0,0,.659,1.44,3.928,3.928,0,0,0,1.631.708q0.9,0.225,1.157.313a1.192,1.192,0,0,1,.521.31,0.654,0.654,0,0,1,.148.432,0.88,0.88,0,0,1-.354.691,1.612,1.612,0,0,1-1.053.3,1.557,1.557,0,0,1-1.047-.332,1.717,1.717,0,0,1-.516-1.04l-1.406.137a2.734,2.734,0,0,0,.869,1.829,3.1,3.1,0,0,0,2.085.627,4.048,4.048,0,0,0,1.558-.261,2.047,2.047,0,0,0,.967-0.8,2.1,2.1,0,0,0,.342-1.152,2.127,2.127,0,0,0-.285-1.14A2.009,2.009,0,0,0,14.251,24.755ZM16.03,22.76h2.124v5.947H19.6V22.76h2.119V21.549H16.03V22.76Zm11.7-.415a2.387,2.387,0,0,0-1.079-.659,5.151,5.151,0,0,0-1.362-.137H22.646v7.158h2.72a4.363,4.363,0,0,0,1.279-.151,2.534,2.534,0,0,0,1.016-.571,3.151,3.151,0,0,0,.767-1.265,4.7,4.7,0,0,0,.22-1.523,5.284,5.284,0,0,0-.234-1.692A3.123,3.123,0,0,0,27.729,22.345Zm-0.723,4.1a1.518,1.518,0,0,1-.378.691,1.338,1.338,0,0,1-.584.3,3.942,3.942,0,0,1-.874.068H24.092V22.76h0.649a6.559,6.559,0,0,1,1.187.068,1.374,1.374,0,0,1,.669.337,1.637,1.637,0,0,1,.41.693,4.278,4.278,0,0,1,.146,1.274A4.671,4.671,0,0,1,27.007,26.444ZM34.79,22.76V21.549H29.883v7.158h1.445V25.666h2.988V24.455H31.328V22.76H34.79Z' style='fill:#fff'/></svg>" }, "images/data/edittable/textfile.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M35.123,0.062V9.938H45C45.073,9.938,35.123.062,35.123,0.062ZM31,13V0H9.554C7.315,0,5,1.026,5,2.909V46.091C5,47.974,7.315,50,9.554,50H41.446A3.73,3.73,0,0,0,45,46.091V13H31Zm1,25H12V35H32v3Zm6-7H12V28H38v3Zm0-7H12V21H38v3Z' style='fill:#69bff3'/></svg>" }, "images/data/edittable/unknowndatasource.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50'><path d='M18.451,39.038a34.442,34.442,0,0,0,8.937-1.15c-0.019-.027-0.042-0.056-0.061-0.083a13.271,13.271,0,0,1-.892-1.5A12.936,12.936,0,0,1,25,30.364c0-.341.024-0.684,0.051-1.027a39.489,39.489,0,0,1-6.6.548c-8.215,0-15.243-2.4-18.448-5.961v6.411C0,34.88,8.243,39.038,18.451,39.038Zm0-21.924c10.2,0,18.509-3.558,18.509-7.929S28.686,2,18.481,2,0,4.8,0,9.185,8.243,17.114,18.451,17.114ZM28.7,39.468a37.029,37.029,0,0,1-10.254,1.379c-8.215,0-15.243-2.4-18.448-5.961V41.3C0,45.842,8.243,50,18.451,50c8.629,0,15.944-3.011,17.995-6.657a12.991,12.991,0,0,1-7.194-3.337C29.068,39.837,28.887,39.658,28.7,39.468ZM18.451,18.923c-8.215,0-15.243-2.4-18.448-5.961v6.411c0,4.546,8.24,8.7,18.448,8.7a35.508,35.508,0,0,0,6.9-.666c0.013-.049.023-0.1,0.037-0.147l0.05-.185a13.062,13.062,0,0,1,.641-1.911c0.133-.307.288-0.625,0.474-0.973,0.126-.237.257-0.471,0.4-0.7a13.212,13.212,0,0,1,1.093-1.519q0.3-.359.622-0.7a13.206,13.206,0,0,1,1.384-1.25,12.853,12.853,0,0,1,6.91-2.714V12.962C33.754,16.527,26.665,18.923,18.451,18.923Z' style='fill:#aaa'/><path d='M46.2,21.615a12.023,12.023,0,0,0-3.181-2.145q-0.44-.2-0.9-0.371t-0.934-.3c-0.294-.081-0.6-0.128-0.9-0.188-0.365-.072-0.734-0.134-1.107-0.178a9.75,9.75,0,0,0-1.139-.07c-0.366,0-.728.019-1.086,0.052a11.86,11.86,0,0,0-6.242,2.476,12.08,12.08,0,0,0-1.27,1.147q-0.3.309-.571,0.638a12.083,12.083,0,0,0-1,1.393c-0.129.209-.248,0.423-0.364,0.64C27.351,25,27.2,25.3,27.071,25.6a11.557,11.557,0,0,0-.524,1.541c-0.019.071-.043,0.14-0.062,0.212-0.056.215-.122,0.427-0.166,0.647q-0.111.557-.17,1.132A11.878,11.878,0,0,0,27.4,35.8a12.112,12.112,0,0,0,.818,1.379c0.091,0.132.2,0.252,0.3,0.379,0.141,0.182.276,0.368,0.424,0.543a12.772,12.772,0,0,0,.946.991c0.035,0.033.064,0.072,0.1,0.1a11.9,11.9,0,0,0,6.892,3.1c0.384,0.038.774,0.058,1.168,0.058,0.349,0,.694-0.021,1.035-0.051A11.993,11.993,0,0,0,46.2,21.615ZM39.04,36.991a1.583,1.583,0,0,1-2.041,0,1.138,1.138,0,0,1,0-1.778,1.583,1.583,0,0,1,2.041,0A1.138,1.138,0,0,1,39.04,36.991Zm3.369-8.817a3.776,3.776,0,0,1-.681,1.023l-1.319,1.186-0.222.172c-0.234.191-.427,0.354-0.566,0.488a1.825,1.825,0,0,0-.341.421,1.539,1.539,0,0,0-.188.488,3.663,3.663,0,0,0-.091.669V33H37V32.3a3.576,3.576,0,0,1,.081-0.86,2.12,2.12,0,0,1,.257-0.622,2.483,2.483,0,0,1,.472-0.536q0.3-.258.735-0.622,0.351-.287.7-0.583a6.56,6.56,0,0,0,.637-0.612,3.284,3.284,0,0,0,.472-0.669A1.678,1.678,0,0,0,40.543,27a1.8,1.8,0,0,0-.187-0.813,2.073,2.073,0,0,0-.494-0.641,2.275,2.275,0,0,0-.735-0.421,2.692,2.692,0,0,0-.911-0.153,2.535,2.535,0,0,0-1.745.593,2.438,2.438,0,0,0-.8,1.549l-2.239-.191a3.907,3.907,0,0,1,1.592-2.611,5.369,5.369,0,0,1,3.238-.947,6,6,0,0,1,1.723.239,4.34,4.34,0,0,1,1.394.689A3.165,3.165,0,0,1,42.65,26.9,3.118,3.118,0,0,1,42.408,28.174Z' style='fill:#79d79d'/></svg>" }, "images/dialog/close.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12'><g fill='currentColor'><polygon points='12 1.092 10.908 0 6 4.908 1.092 0 0 1.092 4.908 6 0 10.908 1.092 12 6 7.092 10.908 12 12 10.908 7.092 6 12 1.092'/></g></svg>" }, "images/dialog/help.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='4 4 16 16' enable-background='new 4 4 16 16' xml:space='preserve'><g id='Lager_2'><path d='M12,4c-4.418,0-8,3.582-8,8c0,4.418,3.582,8,8,8s8-3.582,8-8C20,7.582,16.418,4,12,4z M12.712,15.766 c-0.2,0.155-0.44,0.234-0.715,0.234c-0.275,0-0.515-0.079-0.714-0.234c-0.205-0.159-0.309-0.354-0.309-0.578 c0-0.224,0.104-0.419,0.309-0.578c0.199-0.155,0.44-0.234,0.714-0.234c0.275,0,0.515,0.079,0.715,0.234 c0.205,0.16,0.309,0.354,0.309,0.578C13.021,15.412,12.917,15.606,12.712,15.766z M14.84,10.828 c-0.106,0.213-0.256,0.414-0.445,0.599l-0.008,0.007l-0.826,0.664l-0.137,0.096c-0.141,0.103-0.256,0.192-0.338,0.263 c-0.077,0.067-0.139,0.136-0.182,0.207c-0.043,0.07-0.073,0.149-0.088,0.235c-0.017,0.093-0.026,0.212-0.026,0.354v0.578h-1.555 v-0.759c0-0.2,0.02-0.37,0.058-0.506c0.04-0.139,0.1-0.266,0.179-0.378c0.079-0.112,0.186-0.22,0.317-0.322 c0.124-0.096,0.278-0.213,0.46-0.347c0.146-0.106,0.291-0.214,0.436-0.323c0.14-0.105,0.269-0.216,0.384-0.33 c0.111-0.11,0.204-0.228,0.276-0.349c0.067-0.114,0.102-0.245,0.102-0.389c0-0.144-0.035-0.28-0.103-0.402 c-0.07-0.124-0.163-0.233-0.277-0.322c-0.115-0.089-0.256-0.161-0.419-0.214c-0.164-0.052-0.341-0.079-0.526-0.079 c-0.413,0-0.751,0.102-1.005,0.302c-0.257,0.203-0.407,0.462-0.458,0.793l-0.016,0.104L9,10.187l0.023-0.119 c0.123-0.643,0.473-1.155,1.039-1.522C10.622,8.184,11.324,8,12.148,8c0.393,0,0.765,0.046,1.106,0.137 c0.344,0.092,0.649,0.226,0.906,0.4c0.259,0.176,0.466,0.396,0.615,0.654C14.924,9.45,15,9.748,15,10.076 C15,10.36,14.946,10.613,14.84,10.828z'/></g></svg>" }, "images/dialog/resize.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 11.006 11'><g fill='currentColor'><rect y='10' width='1' height='1'/><rect x='1.001' y='8.999' width='1' height='1'/><rect x='4.003' y='10' width='1' height='1'/><rect x='2.001' y='7.999' width='1' height='1'/><rect x='5.003' y='8.999' width='1' height='1'/><rect x='3.002' y='6.998' width='1' height='1'/><rect x='6.004' y='7.999' width='1' height='1'/><rect x='4.003' y='5.997' width='1' height='1'/><rect x='7.004' y='6.998' width='1' height='1'/><rect x='5.003' y='4.997' width='1' height='1'/><rect x='8.005' y='5.997' width='1' height='1'/><rect x='6.004' y='3.996' width='1' height='1'/><rect x='9.006' y='4.997' width='1' height='1'/><rect x='7.004' y='2.996' width='1' height='1'/><rect x='10.006' y='3.996' width='1' height='1'/><rect x='8.005' y='1.995' width='1' height='1'/><rect x='8.005' y='10' width='1' height='1'/><rect x='9.006' y='8.999' width='1' height='1'/><rect x='10.006' y='7.999' width='1' height='1'/><rect x='9.999' width='1' height='1'/><rect x='8.999' y='1.001' width='1' height='1'/></g></svg>" }, "images/filters/calendar.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_6' shape-rendering='crispEdges' fill='currentColor'><g><g><rect y='4' width='1' height='7'/></g></g><g><g><rect x='12' y='4' width='1' height='7'/></g></g><g><g><rect y='2' width='3' height='2'/></g></g><g><g><rect x='4' y='2' width='5' height='2'/></g></g><g><g><rect x='3' y='5' width='1' height='2'/></g></g><g><g><rect x='6' y='5' width='1' height='2'/></g></g><g><g><rect x='9' y='5' width='1' height='2'/></g></g><g><g><rect x='9' y='8' width='1' height='2'/></g></g><g><g><rect x='6' y='8' width='1' height='2'/></g></g><g><g><rect x='3' y='8' width='1' height='2'/></g></g><g><g><rect x='10' y='2' width='3' height='2'/></g></g><g><g><rect x='1' y='7' width='11' height='1'/></g></g><g><g><rect x='1' y='4' width='11' height='1'/></g></g><g><g><rect x='1' y='10' width='11' height='1'/></g></g></g><g id='Lager_5' shape-rendering='crispEdges'><g><g><rect x='7' y='8' fill='#3D9DD7' width='2' height='2'/></g></g></g></svg>" }, "images/filters/checkmark.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 11 11' xml:space='preserve'><g fill='currentColor'><path d='M7.608,2l-2.522,4.835l-2.331,-1.835l-0.755,1.234l3.478,2.766l3.522,-6.124z'></path></g></svg>" }, "images/filters/downarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' xml:space='preserve'><g fill='currentColor'><path d='M3,5.5 l8,0 l-4,4 z'></path></g></svg>" }, "images/filters/filtergroupcollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 9 9' enable-background='new 0 0 9 9' xml:space='preserve'><g shape-rendering='crispEdges' fill='currentColor'><g><rect x='2' y='4' width='5' height='1'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='8' width='1' height='9'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect width='1' height='9'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='1' y='0' width='7' height='1'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='1' y='8' width='7' height='1'/></g></g></svg>" }, "images/filters/filtergroupexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 9 9' enable-background='new 0 0 9 9' xml:space='preserve'><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='8' width='1' height='9'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect width='1' height='9'/></g></g><g shape-rendering='crispEdges' fill='currentColor'><g><rect x='4' y='2' width='1' height='5'/></g></g><g shape-rendering='crispEdges' fill='currentColor'><g><rect x='2' y='4' width='5' height='1'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='1' y='0' width='7' height='1'/></g></g><g opacity='0.3' shape-rendering='crispEdges' fill='currentColor'><g><rect x='1' y='8' width='7' height='1'/></g></g></svg>" }, "images/filters/filtertablegroupcollapse.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Lager_3' shape-rendering='crispEdges' fill='currentColor'><g><g><polygon points='6,3 4.8,4.167 10.8,10 12,8.833 '/></g></g><g><g><polygon points='6,3 0,8.833 1.2,10 7.2,4.167 '/></g></g></g></svg>" }, "images/filters/filtertablegroupexpand.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g id='Lager_3' shape-rendering='crispEdges' fill='currentColor'><g><g><polygon points='1.2,3 0,4.167 6,10 7.2,8.833 '/></g></g><g><g><polygon points='10.8,3 4.8,8.833 6,10 12,4.167 '/></g></g></g></svg>" }, "images/filters/hierarchyfiltersearchalllevels.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='23px' height='14px'><rect x='5' y='3' width='3' height='3'/><rect x='6' y='4' width='1' height='5'/><rect x='6' y='9' width='5' height='1'/><rect x='10' y='8' width='3' height='3'/><path d='M14.5,5 l6,0 l-3,3 z'/></svg>" }, "images/filters/leftarrow.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='10px' height='10px'><path d='M 6,2 l0,6 l-3,-3 z' stroke-width='1' transform='scale(1,1)'/></svg>" }, "images/filters/rightarrow.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='10px' height='10px'><path d='M 4,2 l0,6 l3,-3 z' stroke-width='1' transform='scale(1,1)'/></svg>" }, "images/formatting/boolean.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M3,4.9V4.881A2.614,2.614,0,0,1,5.449,2,2.592,2.592,0,0,1,7.883,4.865V4.881A2.613,2.613,0,0,1,5.433,7.762,2.587,2.587,0,0,1,3,4.9Zm3.866,0V4.881c0-1.1-.568-2-1.433-2s-1.417.875-1.417,1.982V4.881c0,1.1.56,2,1.433,2S6.866,6,6.866,4.9Z'/><path d='M10,9h1v5H10V9Z'/><path d='M12,5.646L5.813,11.284l-0.672-.6,6.187-5.638Z'/></svg>" }, "images/formatting/currency.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M8.761,6.991V4.327a5.3,5.3,0,0,1,2.03.9l0.836-1.318A5.926,5.926,0,0,0,8.82,2.841V2h-1.3V2.813c-1.865.14-3.134,1.164-3.134,2.678V5.519c0,1.57,1.015,2.341,3.194,2.874V11.14A5.563,5.563,0,0,1,4.955,9.935L4,11.21A7.173,7.173,0,0,0,7.522,12.6V14h1.3V12.612c1.9-.154,3.18-1.177,3.18-2.705V9.879C12,8.379,11.03,7.523,8.761,6.991ZM7.582,6.7C6.432,6.374,6.149,6,6.149,5.42V5.393A1.288,1.288,0,0,1,7.582,4.229V6.7ZM10.239,10A1.317,1.317,0,0,1,8.761,11.2V8.659c1.164,0.323,1.478.7,1.478,1.318V10Z'/></svg>" }, "images/formatting/custom.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M5.23,3.216l2.5,2.5a0.166,0.166,0,0,1,0,.234L5.95,7.73a0.166,0.166,0,0,1-.234,0l-2.5-2.5a3.131,3.131,0,0,0,.954,3.479,3.337,3.337,0,0,0,3.948.5l3.543,3.543A0.837,0.837,0,0,0,12.8,12.8h0a0.837,0.837,0,0,0-.048-1.138L9.209,8.119a3.336,3.336,0,0,0-.5-3.948A3.13,3.13,0,0,0,5.23,3.216Z'/></svg>" }, "images/formatting/date.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M12,2H4A2,2,0,0,0,2,4v8a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V4A2,2,0,0,0,12,2ZM10,3h2V5H10V3ZM4,3H6V5H4V3Zm9,9a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V7A1,1,0,0,1,4,6h8a1,1,0,0,1,1,1v5Z'/><polygon points='10.373 7 9 7.425 9.19 8.135 10.109 7.887 10.109 12 11 12 11 7 10.373 7'/><path d='M6.594,9.051l1.331-1.4V7H4.766V7.751H6.833L5.544,9.163,5.68,9.7H6.069a0.9,0.9,0,0,1,1.1.758v0.015a0.756,0.756,0,0,1-.825.744,1.545,1.545,0,0,1-1.256-.646L4.5,11.136A2.24,2.24,0,0,0,6.328,12,1.547,1.547,0,0,0,8,10.448V10.434A1.4,1.4,0,0,0,6.594,9.051Z'/></svg>" }, "images/formatting/datepart.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M12,2H4A2,2,0,0,0,2,4v8a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V4A2,2,0,0,0,12,2ZM10,3h2V5H10V3ZM4,3H6V5H4V3Zm9,9a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V7A1,1,0,0,1,4,6h8a1,1,0,0,1,1,1v5Z'/><polygon points='10.373 7 9 7.425 9.19 8.135 10.109 7.887 10.109 12 11 12 11 7 10.373 7'/><path d='M6.594,9.051l1.331-1.4V7H4.766V7.751H6.833L5.544,9.163,5.68,9.7H6.069a0.9,0.9,0,0,1,1.1.758v0.015a0.756,0.756,0,0,1-.825.744,1.545,1.545,0,0,1-1.256-.646L4.5,11.136A2.24,2.24,0,0,0,6.328,12,1.547,1.547,0,0,0,8,10.448V10.434A1.4,1.4,0,0,0,6.594,9.051Z'/></svg>" }, "images/formatting/datetime.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect x='4' y='3' width='2' height='2'/><polygon points='14 5.501 14 5.496 14 5.506 14 5.501'/><rect x='4' y='3' width='2' height='2'/><path d='M13,9.24V12a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V7A1,1,0,0,1,4,6H6.05A4.41,4.41,0,0,1,6,5.5,4.475,4.475,0,0,1,7.708,2H4A2,2,0,0,0,2,4v8a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V8.3A4.518,4.518,0,0,1,13,9.24ZM4,3H6V5H4V3Z'/><path d='M11,12V10c-0.185.018-.37,0.037-0.561,0.037-0.15,0-.292-0.025-0.439-0.036v2h1Z'/><path d='M4.766,7V7.751H6.647A4.439,4.439,0,0,1,6.3,7H4.766Z'/><path d='M5.543,9.163L5.68,9.7H6.069a0.9,0.9,0,0,1,1.1.758v0.015a0.756,0.756,0,0,1-.825.744,1.545,1.545,0,0,1-1.256-.646L4.5,11.136A2.24,2.24,0,0,0,6.328,12,1.547,1.547,0,0,0,8,10.448V10.434A1.4,1.4,0,0,0,6.594,9.051l0.563-.594a4.459,4.459,0,0,1-.436-0.583Z'/><path d='M12.972,3.025C12.962,3.015,12.951,3.009,12.941,3a3.523,3.523,0,0,0-.487-0.4c-0.039-.026-0.083-0.042-0.123-0.067a3.475,3.475,0,0,0-.471-0.256c-0.1-.044-0.216-0.067-0.325-0.1a3.389,3.389,0,0,0-.331-0.1A3.5,3.5,0,0,0,7,5.5a3.456,3.456,0,0,0,.05.5,3.485,3.485,0,0,0,.315,1h0c0,0.007.009,0.012,0.012,0.018A3.488,3.488,0,1,0,12.972,3.025ZM12,7H9V4h1V6h2V7Z'/></svg>" }, "images/formatting/general.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M13.9,3.98l-0.753-.862a0.325,0.325,0,0,0-.5,0L7.245,9.3l-2.887-3.3a0.325,0.325,0,0,0-.5,0L3.1,6.854a0.451,0.451,0,0,0,0,.575l3.891,4.453a0.325,0.325,0,0,0,.5,0l6.4-7.326A0.451,0.451,0,0,0,13.9,3.98Z'/></svg>" }, "images/formatting/number.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M5,10.043L7.143,8.022C8,7.224,8.308,6.78,8.308,6.159a0.983,0.983,0,0,0-1-1.075A1.8,1.8,0,0,0,5.862,6.12l-0.773-.67A2.516,2.516,0,0,1,7.383,4,1.954,1.954,0,0,1,9.437,6.061V6.08c0,1.085-.517,1.676-1.619,2.672L6.538,9.935H9.5V11H5V10.043Z'/><path d='M2.387,5.241l-1.149.348L1,4.6,2.715,4H3.5v7H2.387V5.241Z'/><path d='M10,9.791L10.838,9a2.219,2.219,0,0,0,1.793.9,1.072,1.072,0,0,0,1.18-1.042V8.847c0-.678-0.614-1.062-1.57-1.062H11.687l-0.2-.757,1.842-1.976H10.38V4h4.513V4.9l-1.9,1.966A1.974,1.974,0,0,1,15,8.807v0.02A2.191,2.191,0,0,1,12.612,11,3.224,3.224,0,0,1,10,9.791Z'/></svg>" }, "images/formatting/percentage.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M3,5.528V5.5A2.319,2.319,0,0,1,5.2,3,2.29,2.29,0,0,1,7.383,5.472V5.5A2.319,2.319,0,0,1,5.178,8,2.29,2.29,0,0,1,3,5.528Zm7.742-2.417h1.315l-6.8,9.777H3.943ZM6.2,5.528V5.5A1.253,1.253,0,0,0,5.178,4.075a1.206,1.206,0,0,0-1,1.4V5.5A1.245,1.245,0,0,0,5.2,6.925,1.205,1.205,0,0,0,6.2,5.528Zm2.416,5V10.5A2.32,2.32,0,0,1,10.822,8,2.29,2.29,0,0,1,13,10.473V10.5A2.319,2.319,0,0,1,10.8,13,2.29,2.29,0,0,1,8.617,10.529Zm3.2,0V10.5A1.254,1.254,0,0,0,10.8,9.076a1.205,1.205,0,0,0-1,1.4V10.5a1.244,1.244,0,0,0,1.022,1.425A1.206,1.206,0,0,0,11.818,10.529Z'/></svg>" }, "images/formatting/scientific.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><polygon points='4.059 5 2 5.596 2.285 6.589 3.664 6.241 3.664 12 5 12 5 5 4.059 5'/><path d='M9.01,5C7.2,5,6,6.566,6,8.5V8.519C6,10.453,7.18,12,8.99,12S12,10.433,12,8.5V8.481C12,6.547,10.81,5,9.01,5Zm1.741,3.519c0,1.334-.669,2.408-1.741,2.408S7.25,9.834,7.25,8.5V8.481c0-1.344.679-2.408,1.74-2.408S10.752,7.166,10.752,8.5V8.519Z'/><polygon points='15 3.812 14.188 3 13 4.188 11.812 3 11 3.812 12.188 5 11 6.188 11.812 7 13 5.812 14.188 7 15 6.188 13.812 5 15 3.812'/></svg>" }, "images/formatting/time.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M8,2a6,6,0,1,0,6,6A6,6,0,0,0,8,2Zm3,7H7V4H8V8h3V9Z'/></svg>" }, "images/formatting/timespan.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path d='M1,8.017V8C1,6.343,2,5,3.508,5S6,6.326,6,7.984V8c0,1.658-1,3-2.508,3S1,9.674,1,8.017Zm3.959,0V8c0-1.144-.582-2.08-1.468-2.08s-1.451.912-1.451,2.063V8c0,1.143.574,2.081,1.467,2.081S4.959,9.16,4.959,8.017Z'/><path d='M11,7h1V8H11V7Zm0,2h1v1H11V9Z'/><path d='M14.109,6.063l-0.919.3L13,5.51,14.372,5H15v6H14.109V6.063Z'/><rect x='7' y='7' width='1' height='1'/><path d='M7,9H8v1H7V9Z'/><path d='M9.11,6.063l-0.92.3L8,5.51,9.373,5H10v6H9.11V6.063Z'/></svg>" }, "images/legend/bar.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='currentColor'><rect x='1' y='8' width='3' height='4'/><rect x='5' y='5' width='3' height='7'/><rect x='9' y='1' width='3' height='11'/></g><g stroke='black' fill='none' stroke-width='1' stroke-opacity='0.25' ><rect x='1.5' y='8.5' width='2' height='3'/><rect x='5.5' y='5.5' width='2' height='6'/><rect x='9.5' y='1.5' width='2' height='10'/></g></svg>" }, "images/legend/line.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='currentColor'><polygon points='10.443,2 7.718,6.045 5.371,4.337 3.815,3.204 2.725,4.822 0,8.867 1.557,10 4.281,5.955 8.173,8.787 8.185,8.796 12,3.133'/></g><g fill='#000000' opacity='0.5'><path d='M10.443,2L7.718,6.045L5.371,4.337L3.815,3.204l-1.09,1.618L0,8.867L1.557,10l2.725-4.045l3.892,2.832l0.012,0.009 L12,3.133L10.443,2z M8.06,8.087L4.576,5.551L4.156,5.245l-0.29,0.43L1.432,9.291L0.684,8.746L3.14,5.101l0.8-1.188l1.137,0.828 l2.347,1.708l0.419,0.305l0.29-0.43l2.435-3.615l0.748,0.544L8.06,8.087z'/></g></svg>" }, "images/legend/shapes/circle.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><circle cx='6' cy='6' r='5.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><circle cx='6' cy='6' r='5.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><circle cx='6' cy='6' r='5.5' /></g></svg>" }, "images/legend/shapes/cross.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='3.18,1.04 6,3.87 8.82,1.04 10.96,3.18 8.13,6 10.96,8.82 8.82,10.96 6,8.13 3.18,10.96 1.04,8.82 3.87,6 1.04,3.18' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='3.18,1.04 6,3.87 8.82,1.04 10.96,3.18 8.13,6 10.96,8.82 8.82,10.96 6,8.13 3.18,10.96 1.04,8.82 3.87,6 1.04,3.18' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='3.18,1.04 6,3.87 8.82,1.04 10.96,3.18 8.13,6 10.96,8.82 8.82,10.96 6,8.13 3.18,10.96 1.04,8.82 3.87,6 1.04,3.18' /></g></svg>" }, "images/legend/shapes/crossline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1'><line x1='0.5' x2='10.5' y1='0.5' y2='10.5' /><line y1='10.5' y2='0.5' x1='0.5' x2='10.5' /></g></svg>" }, "images/legend/shapes/diamond.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='6,0.7071 11.2929,6 6,11.2929 0.7071,6' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='6,0.7071 11.2929,6 6,11.2929 0.7071,6' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='6,0.7071 11.2929,6 6,11.2929 0.7071,6' /></g></svg>" }, "images/legend/shapes/downpointingarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g transform='rotate(180 6 6)'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g></g></svg>" }, "images/legend/shapes/downpointingarrowline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1' transform='rotate(180 6 6) translate(1 1)'><line x1='5.5' y1='0.7' x2='5.5' y2='11' /><path d='M0.5 5.5 l5 -4.8 l5 4.8' /></g></svg>" }, "images/legend/shapes/horizontalline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1'><line x1='0' x2='12' y1='5.5' y2='5.5' /></g></svg>" }, "images/legend/shapes/horizontalrectangle.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='11.5,4.5 11.5,7.5 0.5,7.5 0.5,4.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='11.5,4.5 11.5,7.5 0.5,7.5 0.5,4.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='11.5,4.5 11.5,7.5 0.5,7.5 0.5,4.5' /></g></svg>" }, "images/legend/shapes/leftpointingarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g transform='rotate(270 6 6)'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g></g></svg>" }, "images/legend/shapes/leftpointingarrowline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1' transform='rotate(270 6 6) translate(1 0)'><line x1='5.5' y1='0.7' x2='5.5' y2='11' /><path d='M0.5 5.5 l5 -4.8 l5 4.8' /></g></svg>" }, "images/legend/shapes/pentagon.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,1 0.27,4.80 2.27,10.95 8.73,10.94 10.73,4.90' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,1 0.27,4.80 2.27,10.95 8.73,10.94 10.73,4.90' /></g><g stroke='currentColor' fill='none' stroke-width='0.8'><polygon points='5.5,1 0.27,4.80 2.27,10.95 8.73,10.94 10.73,4.90' /></g></svg>" }, "images/legend/shapes/plus.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='4.5,0.5 7.5,0.5 7.5,4.5 11.5,4.5 11.5,7.5 7.5,7.5 7.5,11.5 4.5,11.5 4.5,7.5 0.5,7.5 0.5,4.5 4.5,4.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='4.5,0.5 7.5,0.5 7.5,4.5 11.5,4.5 11.5,7.5 7.5,7.5 7.5,11.5 4.5,11.5 4.5,7.5 0.5,7.5 0.5,4.5 4.5,4.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='4.5,0.5 7.5,0.5 7.5,4.5 11.5,4.5 11.5,7.5 7.5,7.5 7.5,11.5 4.5,11.5 4.5,7.5 0.5,7.5 0.5,4.5 4.5,4.5' /></g></svg>" }, "images/legend/shapes/plusline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1'><line x1='0' x2='11' y1='5.5' y2='5.5' /><line y1='0' y2='11' x1='5.5' x2='5.5' /></g></svg>" }, "images/legend/shapes/rightpointingarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g transform='rotate(90 6 6)'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g></g></svg>" }, "images/legend/shapes/rightpointingarrowline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1' transform='rotate(90 6 6)'><line x1='5.5' y1='0.7' x2='5.5' y2='11' /><path d='M0.5 5.5 l5 -4.8 l5 4.8' /></g></svg>" }, "images/legend/shapes/square.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><rect x='0.5' y='0.5' width='11' height='11'/></g><g fill='currentColor' opacity='0.7' class='shape-fill'><rect x='0.5' y='0.5' width='11' height='11'/></g><g stroke='currentColor' fill='none' stroke-width='1'><rect x='0.5' y='0.5' width='11' height='11'/></g></svg>" }, "images/legend/shapes/starfive.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,1 3.85,4.23 0.27,4.80 2.84,7.37 2.27,10.95 5.5,9.3 8.73,10.94 8.16,7.37 10.73,4.90 7.14,4.23' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,1 3.85,4.23 0.27,4.80 2.84,7.37 2.27,10.95 5.5,9.3 8.73,10.94 8.16,7.37 10.73,4.90 7.14,4.23' /></g><g stroke='currentColor' fill='none' stroke-width='0.8'><polygon points='5.5,1 3.85,4.23 0.27,4.80 2.84,7.37 2.27,10.95 5.5,9.3 8.73,10.94 8.16,7.37 10.73,4.90 7.14,4.23' /></g></svg>" }, "images/legend/shapes/starfour.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,0.5 6.8,4.2 10.5,5.5 6.8,6.8 5.5,10.5,4.2,6.8 0.5,5.5 4.2,4.2 ' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,0.5 6.8,4.2 10.5,5.5 6.8,6.8 5.5,10.5,4.2,6.8 0.5,5.5 4.2,4.2 ' /></g><g stroke='currentColor' fill='none' stroke-width='0.8'><polygon points='5.5,0.5 6.8,4.2 10.5,5.5 6.8,6.8 5.5,10.5,4.2,6.8 0.5,5.5 4.2,4.2 ' /></g></svg>" }, "images/legend/shapes/starsixline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1' transform='translate(0.5)'><line x1='5.5' y1='0' x2='5.5' y2='11' /><line x1='0.74' y1='2.75' x2='10.26' y2='8.25' /><line x1='0.74' y1='8.25' x2='10.26' y2='2.75' /></g></svg>" }, "images/legend/shapes/triangledown.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='1,2.5 11,2.5 6,10' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='1,2.5 11,2.5 6,10' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='1,2.5 11,2.5 6,10' /></g></svg>" }, "images/legend/shapes/triangleleft.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='9.5,1 9.5,11 2,6' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='9.5,1 9.5,11 2,6' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='9.5,1 9.5,11 2,6' /></g></svg>" }, "images/legend/shapes/triangleright.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='2.5,1 10,6 2.5,11' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='2.5,1 10,6 2.5,11' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='2.5,1 10,6 2.5,11' /></g></svg>" }, "images/legend/shapes/triangleup.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='6,2 11,9.5 1,9.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='6,2 11,9.5 1,9.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='6,2 11,9.5 1,9.5' /></g></svg>" }, "images/legend/shapes/uppointingarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='5.5,0.7 10.5,5.5 7.5,5.5 7.5,11.5 3.5,11.5 3.5,5.5 0.5,5.5' /></g></svg>" }, "images/legend/shapes/uppointingarrowline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1'><line x1='5.5' y1='0.7' x2='5.5' y2='11' /><path d='M0.5 5.5 l5 -4.8 l5 4.8' /></g></svg>" }, "images/legend/shapes/verticalline.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g stroke='currentColor' fill='none' stroke-width='1'><line y1='0' y2='12' x1='5.5' x2='5.5' /></g></svg>" }, "images/legend/shapes/verticalrectangle.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><g fill='#ffffff' class='shape-fill'><polygon points='4.5,0.5 7.5,0.5 7.5,11.5 4.5,11.5' /></g><g fill='currentColor' opacity='0.7' class='shape-fill'><polygon points='4.5,0.5 7.5,0.5 7.5,11.5 4.5,11.5' /></g><g stroke='currentColor' fill='none' stroke-width='1'><polygon points='4.5,0.5 7.5,0.5 7.5,11.5 4.5,11.5' /></g></svg>" }, "images/navigationbar3d/reset.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><path style='fill:currentColor' d='M10.965,4.373L13,6.425V1H7.622L9.643,3.039,7.7,5H6.283L4.359,3.048,6.425,1H1V6.378L3.025,4.37,5,6.375V7.658L3.038,9.63,1,7.574V13H6.378L4.361,10.964,6.316,9H7.674l1.958,1.959L7.574,13H13V7.622L10.967,9.636,9,7.667v-1.3ZM8,8H6V6H8V8Z' /></svg>" }, "images/navigationbar3d/rotatedown.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><g style='opacity:0.4'><rect style='fill:currentColor' y='6' width='14' height='1'/></g><path style='fill:currentColor' d='M10,6.3A7.6,7.6,0,0,0,6.336,0l-1.2,1.566A5.736,5.736,0,0,1,7.934,6.3a5.744,5.744,0,0,1-2.771,4.708L3,9v5H8.378L6.646,12.39A7.542,7.542,0,0,0,10,6.3Z'/></svg>" }, "images/navigationbar3d/rotateleft.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><g style='opacity:0.4'><rect style='fill:currentColor' x='7' width='1' height='14'/></g><path style='fill:currentColor' d='M12.434,5.139A5.736,5.736,0,0,1,7.7,7.933,5.744,5.744,0,0,1,2.989,5.162L5,3H0V8.378L1.61,6.646A7.542,7.542,0,0,0,7.7,10,7.6,7.6,0,0,0,14,6.335Z'/></svg>" }, "images/navigationbar3d/rotateright.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><g style='opacity:0.4'><rect style='fill:currentColor' x='6' width='1' height='14'/></g><path style='fill:currentColor' d='M9,3l2.011,2.162A5.744,5.744,0,0,1,6.3,7.934,5.736,5.736,0,0,1,1.566,5.14L0,6.336A7.6,7.6,0,0,0,6.3,10,7.542,7.542,0,0,0,12.39,6.647L14,8.379V3H9Z'/></svg>" }, "images/navigationbar3d/rotateup.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><g style='opacity:0.4'><rect style='fill:currentColor' y='7' width='14' height='1'/></g><path style='fill:currentColor' d='M7.838,2.989L10,5V0H4.622L6.354,1.61A7.542,7.542,0,0,0,3,7.7,7.6,7.6,0,0,0,6.665,14l1.2-1.566A5.736,5.736,0,0,1,5.067,7.7,5.744,5.744,0,0,1,7.838,2.989Z'/></svg>" }, "images/navigationbar3d/zoomin.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><path style='fill:currentColor' d='M7.965,0A6.031,6.031,0,0,0,3.02,9.49l-3.02,3L1.481,14l3.033-3.017A6.034,6.034,0,1,0,7.965,0Zm0,10.347a4.311,4.311,0,1,1,4.311-4.311A4.316,4.316,0,0,1,7.965,10.347Z'/><path style='fill:currentColor' d='M9,9H7V7H9V9Z' /><path style='fill:currentColor' d='M9,7H7V5H9V7Z' /><path style='fill:currentColor' d='M11,7H9V5h2V7Z' /><path style='fill:currentColor' d='M7,7H5V5H7V7Z' /><path style='fill:currentColor' d='M9,5H7V3H9V5Z' /></svg>" }, "images/navigationbar3d/zoomout.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 14 14'><rect style='fill:currentColor' x='5' y='5' width='6' height='2'/><path style='fill:currentColor' d='M7.965,0A6.031,6.031,0,0,0,3.02,9.49l-3.02,3L1.481,14l3.033-3.017A6.034,6.034,0,1,0,7.965,0Zm0,10.346a4.311,4.311,0,1,1,4.311-4.311A4.316,4.316,0,0,1,7.965,10.346Z'/></svg>" }, "images/panel/close.svg": { result: "<svg version='1.1' xmlns:x='&ns_extend;' xmlns:i='&ns_ai;' xmlns:graph='&ns_graphs;' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='12px' height='12px' viewBox='0 0 12 12' enable-background='new 0 0 12 12' xml:space='preserve'><polygon fill='currentColor' points='12,1.092 10.91,0 6,4.908 1.092,0 0,1.092 4.91,6 0,10.909 1.092,12.001 6,7.093 10.91,12.001 12,10.909 7.092,6'/></svg>" }, "images/panel/pindocked.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 7 7' enable-background='new 0 0 7 7' xml:space='preserve'><g fill='currentColor'><path d='M4.962,3.838l-0.81-0.589L4.15,0.902h0.592c0.141,0,0.256-0.112,0.256-0.253V0.253C4.998,0.115,4.884,0,4.743,0H1.257 C1.115,0,1,0.113,1,0.253v0.396c0,0.139,0.115,0.253,0.257,0.253h0.611v2.346L1.039,3.836c-0.024,0.023-0.038,0.055-0.038,0.09 c0,0.07,0.057,0.142,0.128,0.142h1.641v2.237L2.992,7l0.243-0.698V4.068h1.636C4.943,4.068,5,3.997,5,3.927 C5,3.892,4.986,3.861,4.962,3.838z'/></g></svg>" }, "images/panel/pinundocked.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 7 7' enable-background='new 0 0 7 7' xml:space='preserve'><g fill='currentColor'><path d='M6.942,2.997L4.395,0.095c-0.1-0.1-0.3-0.15-0.4,0l-0.35,0.3c-0.1,0.1-0.1,0.3,0,0.4l0.449,0.5L2.198,3.147l-1.049-0.25 c-0.05,0-0.05,0-0.1,0.05c-0.1,0.05-0.1,0.15-0.05,0.2l1.199,1.351L0.4,6.249L0,7l0.749-0.35l1.798-1.751L3.746,6.25 c0.05,0.05,0.15,0.05,0.2,0s0.05-0.05,0.05-0.1l-0.1-1.151l1.898-1.851l0.45,0.5c0.1,0.1,0.3,0.15,0.4,0l0.3-0.3 C6.992,3.297,7.042,3.147,6.942,2.997z'/></g></svg>" }, "images/panel/resetfilters.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='3 -4 13 14' enable-background='new 3 -4 13 14' xml:space='preserve'><g fill='currentColor'><path d='M9.64-2.219C9.608-2.219,9.575-2.22,9.542-2.22V-4L5.205-1.483l4.338,2.515v-1.814c0.027,0,0.055,0.001,0.082,0.001 c2.68,0.065,4.841,2.132,4.841,4.67c0,2.576-2.23,4.674-4.97,4.674c-2.743,0-4.973-2.098-4.973-4.674H2.995 C2.995,7.258,5.912,10,9.496,10c3.581,0,6.498-2.742,6.498-6.111C15.994,0.566,13.155-2.146,9.64-2.219z'/></g></svg>" }, "images/panel/filteroverview/arrowdown.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 8' enable-background='new 0 0 13 8' xml:space='preserve'><g id='Lager_1'><polygon fill='currentColor' points='6.455,8 0,0.948 1.017,0.004 6.462,5.953 11.99,0 13,0.951 '/></g><g id='Lager_2'></g></svg>" }, "images/panel/filteroverview/arrowup.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 8' enable-background='new 0 0 13 8' xml:space='preserve'><g id='Lager_1'><polygon fill='currentColor' points='6.545,0 13,7.052 11.983,7.996 6.538,2.047 1.01,8 0,7.049 '/></g><g id='Lager_2'></g></svg>" }, "images/panel/filteroverview/cirklearrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 10 12' enable-background='new 0 0 10 12' xml:space='preserve'><path fill='currentColor' d='M10,7.056c0-2.713-2.225-4.922-4.963-4.942V0L1.701,2.711l3.337,2.813V3.278 c2.091,0.02,3.787,1.706,3.787,3.779c0,2.084-1.715,3.781-3.823,3.781c-2.11,0-3.826-1.697-3.826-3.781H0C0,9.782,2.244,12,5.002,12 C7.756,12,10,9.782,10,7.056z'/></svg>" }, "images/panel/filteroverview/resetfilter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 13' enable-background='new 0 0 13 13' xml:space='preserve'><g id='Lager_2'><g><g><circle class='sf-element sf-element-svg-element sfc-reset-circle' fill='currentColor' cx='6.5' cy='6.5' r='6.5'/></g></g></g><g id='Lager_4'><g><g><polygon class='sf-element sf-element-svg-element sfc-reset-cross' fill='currentColor' points='7.713,6.503 10,4.214 8.787,3 6.5,5.289 4.213,3 3,4.214 5.287,6.503 3.006,8.786 4.219,10 6.5,7.717 8.781,10 9.994,8.786 7.713,6.503 '/></g></g></g></svg>" }, "images/plots/webmapchart/layerhandlerwidget/eye.svg": { result: "<svg version='1.1' width='16' height='10' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g transform='scale(1.1)'><g><path class='background' d='M7.2,8.4c-0.5,0-0.9,0-1.4-0.1C4.6,8,3.3,7.3,2,6.2c-0.6-0.5-1.1-1-1.5-1.4c-0.3-0.3-0.3-0.7,0-1 c0.1-0.2,0.3-0.3,0.5-0.5c0.9-0.9,1.9-1.6,2.9-2.2c0.8-0.4,1.5-0.7,2.2-0.8c0.4-0.1,0.8-0.1,1.2-0.1c0.5,0,0.9,0,1.4,0.1 c1.3,0.3,2.6,0.9,3.9,2c0.6,0.5,1.1,1,1.5,1.4c0.1,0.1,0.2,0.2,0.2,0.4l0,0.1l0,0.1c0,0.2-0.1,0.3-0.2,0.4 c-0.1,0.2-0.3,0.3-0.5,0.5c-0.9,0.9-1.9,1.6-2.9,2.2C9.9,7.9,9.1,8.1,8.4,8.3C8,8.3,7.6,8.4,7.2,8.4z M7.3,2C6,2,4.9,3,4.9,4.3 c0,1.3,1.1,2.3,2.3,2.3c1.3,0,2.3-1.1,2.3-2.3C9.6,3,8.5,2,7.3,2z' /></g><circle class='background' cx='7.3' cy='4.3' r='0.9' /></g></svg>" }, "images/plots/webmapchart/layerhandlerwidget/pointer.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='10' height='16' xml:space='preserve'><g><path class='background' d='M6.1,15c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.4-0.3-0.5-0.5L4,11.1C3.9,11,3.9,11,3.8,11c0,0,0,0-0.1,0 c-0.1,0-0.1,0-0.2,0.1l-1.7,1.3c-0.2,0.2-0.4,0.2-0.6,0.2c-0.1,0-0.2,0-0.3-0.1c-0.3-0.1-0.5-0.5-0.5-0.9l0-10.2 c0-0.5,0.2-0.7,0.3-0.8C1,0.5,1.1,0.5,1.2,0.5c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.3,0.2,0.4,0.3l6.8,7.3C9,8.5,9.1,8.8,9,9.2 S8.6,9.7,8.2,9.7L6,10C6,10,5.9,10,5.9,10.1s0,0.1,0,0.2l1.3,3.3c0.1,0.2,0.1,0.5,0,0.8c-0.1,0.3-0.3,0.5-0.6,0.6 C6.4,15,6.3,15,6.1,15z' /><path class='border' d='M1.2,0.7c0.1,0,0.1,0,0.2,0c0.1,0,0.2,0.1,0.3,0.2l6.8,7.3c0.1,0.1,0.3,0.4,0.2,0.7C8.6,9.4,8.3,9.5,8.1,9.5 L6,9.7c-0.2,0-0.3,0.1-0.4,0.2c-0.1,0.1-0.1,0.3,0,0.4l1.3,3.3c0.1,0.2,0.1,0.4,0,0.6c-0.1,0.2-0.2,0.4-0.4,0.4 c-0.1,0-0.2,0.1-0.3,0.1c-0.1,0-0.2,0-0.3-0.1c-0.2-0.1-0.3-0.2-0.4-0.4L4.2,11c-0.1-0.1-0.2-0.3-0.3-0.3c0,0-0.1,0-0.1,0 c-0.1,0-0.2,0-0.3,0.1l-1.7,1.3c-0.2,0.1-0.3,0.2-0.5,0.2c-0.1,0-0.1,0-0.2,0c-0.2-0.1-0.3-0.4-0.3-0.7l0-10.2 C0.8,1,0.9,0.9,1,0.8C1.1,0.8,1.1,0.7,1.2,0.7 M1.2,0.2C1,0.2,0.9,0.3,0.7,0.4c-0.2,0.1-0.5,0.4-0.5,1l0,10.2c0,0.5,0.2,1,0.6,1.1 c0.1,0.1,0.3,0.1,0.4,0.1c0.3,0,0.5-0.1,0.8-0.3l1.7-1.3L5,14.5c0.1,0.3,0.3,0.5,0.6,0.7c0.2,0.1,0.3,0.1,0.5,0.1 c0.2,0,0.3,0,0.5-0.1c0.3-0.1,0.6-0.4,0.7-0.7c0.1-0.3,0.1-0.6,0-1l-1.3-3.3L8.2,10c0.5-0.1,0.9-0.3,1-0.7c0.1-0.4,0-0.9-0.3-1.2 L2.1,0.7C1.9,0.5,1.8,0.4,1.6,0.3C1.5,0.3,1.3,0.2,1.2,0.2L1.2,0.2z' /></g></svg>" }, "images/plots/webmapchart/navigationwidget/cursor.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='10' height='16' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.2 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g filter='url(#f1)'><path class='background' d='M6.1,15c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.4-0.3-0.5-0.5L4,11.1C3.9,11,3.9,11,3.8,11c0,0,0,0-0.1,0 c-0.1,0-0.1,0-0.2,0.1l-1.7,1.3c-0.2,0.2-0.4,0.2-0.6,0.2c-0.1,0-0.2,0-0.3-0.1c-0.3-0.1-0.5-0.5-0.5-0.9l0-10.2 c0-0.5,0.2-0.7,0.3-0.8C1,0.5,1.1,0.5,1.2,0.5c0.1,0,0.2,0,0.3,0.1c0.1,0.1,0.3,0.2,0.4,0.3l6.8,7.3C9,8.5,9.1,8.8,9,9.2 S8.6,9.7,8.2,9.7L6,10C6,10,5.9,10,5.9,10.1s0,0.1,0,0.2l1.3,3.3c0.1,0.2,0.1,0.5,0,0.8c-0.1,0.3-0.3,0.5-0.6,0.6 C6.4,15,6.3,15,6.1,15z'/><path class='border' d='M1.2,0.7c0.1,0,0.1,0,0.2,0c0.1,0,0.2,0.1,0.3,0.2l6.8,7.3c0.1,0.1,0.3,0.4,0.2,0.7C8.6,9.4,8.3,9.5,8.1,9.5 L6,9.7c-0.2,0-0.3,0.1-0.4,0.2c-0.1,0.1-0.1,0.3,0,0.4l1.3,3.3c0.1,0.2,0.1,0.4,0,0.6c-0.1,0.2-0.2,0.4-0.4,0.4 c-0.1,0-0.2,0.1-0.3,0.1c-0.1,0-0.2,0-0.3-0.1c-0.2-0.1-0.3-0.2-0.4-0.4L4.2,11c-0.1-0.1-0.2-0.3-0.3-0.3c0,0-0.1,0-0.1,0 c-0.1,0-0.2,0-0.3,0.1l-1.7,1.3c-0.2,0.1-0.3,0.2-0.5,0.2c-0.1,0-0.1,0-0.2,0c-0.2-0.1-0.3-0.4-0.3-0.7l0-10.2 C0.8,1,0.9,0.9,1,0.8C1.1,0.8,1.1,0.7,1.2,0.7 M1.2,0.2C1,0.2,0.9,0.3,0.7,0.4c-0.2,0.1-0.5,0.4-0.5,1l0,10.2c0,0.5,0.2,1,0.6,1.1 c0.1,0.1,0.3,0.1,0.4,0.1c0.3,0,0.5-0.1,0.8-0.3l1.7-1.3L5,14.5c0.1,0.3,0.3,0.5,0.6,0.7c0.2,0.1,0.3,0.1,0.5,0.1 c0.2,0,0.3,0,0.5-0.1c0.3-0.1,0.6-0.4,0.7-0.7c0.1-0.3,0.1-0.6,0-1l-1.3-3.3L8.2,10c0.5-0.1,0.9-0.3,1-0.7c0.1-0.4,0-0.9-0.3-1.2 L2.1,0.7C1.9,0.5,1.8,0.4,1.6,0.3C1.5,0.3,1.3,0.2,1.2,0.2L1.2,0.2z'/></g></svg>" }, "images/plots/webmapchart/navigationwidget/down.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' width='12' height='8' xml:space='preserve'><path fill='currentColor' d='M5.6,7.8c0.2,0.3,0.6,0.3,0.9,0l5.4-6.4c0.3-0.3,0.3-0.8,0-1.1s-0.7-0.3-1,0L6.4,5.5c-0.2,0.3-0.6,0.3-0.9,0 L1.2,0.2c-0.3-0.3-0.7-0.3-1,0s-0.3,0.8,0,1.1L5.6,7.8z'/></svg>" }, "images/plots/webmapchart/navigationwidget/hand.svg": { result: "<svg version='1.1' width='11' height='15' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' xml:space='preserve'><g><path class='background' d='M9.4,4.3V7c0,0.2-0.2,0.3-0.4,0.3C8.8,7.3,8.7,7.2,8.6,7v-3c0-0.5-0.5-0.9-1.1-0.9c-0.1,0-0.2,0-0.3,0 c0,0,0,0,0,0v3.5C7.3,6.9,7.2,7,6.9,7S6.5,6.9,6.5,6.8V4c0,0,0,0,0,0V2.7c0-0.5-0.5-0.9-1-0.9c-0.1,0-0.2,0-0.3,0c0,0,0,0,0,0v4.7 c0,0.2-0.2,0.3-0.4,0.3c-0.2,0-0.4-0.1-0.4-0.3V1.5C4.5,1,4,0.7,3.5,0.7C3,0.7,2.6,1,2.6,1.5v5.6v1.7c0,0.2-0.2,0.3-0.4,0.3 S1.8,9,1.8,8.8V4.8c-0.6,0-1,0.4-1,0.9c0,0,0,5.1,0,5.1c0,1,2.6,2.7,2.6,3.5c0.9,0,3.9,0,5.2,0c0-0.9,1.6-2.4,1.6-3.9 c0-1.4,0-5.5,0-5.5C10.2,4.6,9.9,4.3,9.4,4.3z'/><path class='border' fill-opacity='0.8' d='M9.4,3.6L9.4,3.6C9.1,3,8.4,2.5,7.6,2.5c-0.1,0-0.2,0-0.3,0C7.2,1.7,6.4,1.1,5.5,1.1c-0.1,0-0.2,0-0.3,0 C5,0.5,4.3,0,3.5,0C2.6,0,1.8,0.7,1.8,1.5v2.6h0C0.8,4.1,0,4.8,0,5.7l0,5.1c0,0.8,0.8,1.5,1.6,2.4c0.4,0.4,1,1,1,1.2V15h0.8h5.2h0.8 v-0.7c0-0.3,0.3-0.8,0.6-1.2c0.5-0.8,1-1.7,1-2.6C11,9,11,5,11,5C11,4.2,10.3,3.6,9.4,3.6z M8.6,14.3c-1.4,0-4.3,0-5.2,0 c0-0.9-2.6-2.5-2.6-3.5c0,0,0-5.1,0-5.1c0-0.5,0.5-0.9,1-0.9v4.1C1.8,9,2,9.1,2.2,9.1S2.6,9,2.6,8.8V7.1V1.5C2.6,1,3,0.7,3.5,0.7 C4,0.7,4.5,1,4.5,1.5v5.1c0,0.1,0.2,0.3,0.4,0.3c0.2,0,0.4-0.1,0.4-0.3V1.9c0,0,0,0,0,0c0.1,0,0.2,0,0.3,0c0.6,0,1,0.4,1,0.9v1.4 c0,0,0,0,0,0v2.7C6.5,6.9,6.7,7,6.9,7s0.4-0.1,0.4-0.3V3.2c0,0,0,0,0,0c0.1,0,0.2,0,0.3,0c0.6,0,1.1,0.4,1.1,0.9v3 c0,0.1,0.2,0.3,0.4,0.3c0.2,0,0.4-0.1,0.4-0.3V4.3c0.4,0,0.8,0.3,0.8,0.7c0,0,0,4,0,5.5C10.2,11.9,8.6,13.4,8.6,14.3z'/></g></svg>" }, "images/plots/webmapchart/navigationwidget/left.svg": { result: "<svg version='1.1' width='8' height='12' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><path fill='currentColor' d='M6.6,11.8c0.3,0.3,0.8,0.3,1.1,0c0.3-0.3,0.3-0.7,0-1L2.5,6.4c-0.3-0.2-0.3-0.6,0-0.9l5.3-4.4 c0.3-0.3,0.3-0.7,0-1s-0.8-0.3-1.1,0L0.2,5.6c-0.3,0.2-0.3,0.6,0,0.9L6.6,11.8z'/></svg>" }, "images/plots/webmapchart/navigationwidget/markinglasso.svg": { result: "<svg version='1.1' width='14' height='15' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='-255 334 14 14' style='enable-background:new -255 334 14 14;' xml:space='preserve'><path stroke='currentColor' stroke-width='0.1' fill='currentColor' d='M-241,338.4c0-2.4-3.1-4.4-7-4.4s-7,2-7,4.4c0,2.1,2.4,3.9,5.6,4.3c0.2,0.1,0.5,0.3,0.8,0.4c-0.2,0.2-0.5,0.5-0.7,0.8 c-1.2,1.9-0.5,3.7-0.5,3.8c0.1,0.2,0.3,0.3,0.6,0.2c0.2-0.1,0.3-0.3,0.3-0.5c0,0-0.6-1.5,0.4-3.1c0.3-0.4,0.6-0.7,0.9-0.9 c0.3,0.1,0.5,0.1,0.7,0.1c0.6,0,1.2-0.4,1.3-0.9C-242.9,342-241,340.4-241,338.4z M-248,342.6c-0.3-0.1-0.6-0.3-0.6-0.4 c0-0.3,1-0.5,1.3-0.5c0.2,0,0.5,0.1,0.5,0.3C-247,342.1-247.5,342.3-248,342.6z M-245.6,341.8c-0.2-0.5-0.7-0.9-1.4-0.9 c-0.4,0-1.2,0.1-1.9,0.3l0,0c0,0,0,0,0,0c-0.1,0-0.1,0-0.2,0.1c-0.2,0-0.6,0.1-1.2-0.1c0,0,0,0,0,0c0,0,0,0,0,0 c-0.2-0.1-0.5,0-0.5,0.3c0,0.1-0.1,0.2-0.1,0.3c-2-0.6-3.3-1.8-3.3-3.2c0-2,2.8-3.6,6.2-3.6s6.2,1.6,6.2,3.6 C-241.9,340-243.4,341.3-245.6,341.8z' /></svg>" }, "images/plots/webmapchart/navigationwidget/markingradius.svg": { result: "<svg width='15' height='15' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' xml:space='preserve'><circle cx='7' cy='8' r='6' fill='none' stroke='currentColor' stroke-width='1.1' /></svg>" }, "images/plots/webmapchart/navigationwidget/markingrectangle.svg": { result: "<svg width='14' height='15' version='1.1' shape-rendering='crispEdges' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' xml:space='preserve'><g transform='translate(0 0.5)'><rect stroke='none' fill='currentColor' width='13' height='1'></rect><rect stroke='none' fill='currentColor' x='13' width='1' height='14'></rect><rect stroke='none' fill='currentColor' y='13' width='13' height='1'></rect><rect stroke='none' fill='currentColor' width='1' height='14'></rect></g></svg>" }, "images/plots/webmapchart/navigationwidget/navmodebg.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='63' height='31' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g transform='translate(1 1)' filter='url(#f1)'><rect id='border' fill='blue' width='59' height='29' rx='4' ry='4' /><rect class='background-left' fill='green' x='1' y='1' width='30' height='27' rx='3' ry='3' /><rect class='background-right' fill='purple' x='28.5' y='1' width='30' height='27' rx='3' ry='3' /><rect id='separator' fill='yellow' x='29' y='1' width='1' height='27' rx='3' ry='3' shape-rendering='crispEdges' /></g></svg>" }, "images/plots/webmapchart/navigationwidget/navroot.svg": { result: "<svg version='1.1' width='78' height='78' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><circle cx='40' cy='40' r='29' filter='url(#f1)'/></svg>" }, "images/plots/webmapchart/navigationwidget/reset.svg": { result: "<svg version='1.1' width='8' height='8' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><circle fill='currentColor' cx='4' cy='4' r='4'/></svg>" }, "images/plots/webmapchart/navigationwidget/right.svg": { result: "<svg version='1.1' width='8' height='12' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><path fill='currentColor' d='M7.8,6.4c0.3-0.2,0.3-0.6,0-0.9L1.4,0.2c-0.3-0.3-0.8-0.3-1.1,0s-0.3,0.7,0,1l5.3,4.4c0.3,0.2,0.3,0.6,0,0.9 l-5.3,4.4c-0.3,0.3-0.3,0.7,0,1c0.3,0.3,0.8,0.3,1.1,0L7.8,6.4z'/></svg>" }, "images/plots/webmapchart/navigationwidget/submenuarrow.svg": { result: "<svg width='4' height='3' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' xml:space='preserve'><g><path d='M0 0 L4 0 L2 3 Z' fill='currentColor' /></g></svg>" }, "images/plots/webmapchart/navigationwidget/up.svg": { result: "<svg width='12' height='8' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><path fill='currentColor' d='M6.4,0.2c-0.2-0.3-0.6-0.3-0.9,0L0.2,6.6c-0.3,0.3-0.3,0.8,0,1.1c0.3,0.3,0.7,0.3,1,0l4.4-5.3 c0.2-0.3,0.6-0.3,0.9,0l4.4,5.3c0.3,0.3,0.7,0.3,1,0c0.3-0.3,0.3-0.8,0-1.1L6.4,0.2z'/></svg>" }, "images/plots/webmapchart/navigationwidget/zoomin.svg": { result: "<svg width='26' height='26' version='1.1' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g filter='url(#f1)' transform='translate(2 2)'><g id='background'><circle cx='11' cy='11' r='11'/></g><g id='center' transform='translate(6 6)'><rect x='0' y='4' width='10' height='2'></rect><rect x='4' y='0' width='2' height='10'></rect></g></g></svg>" }, "images/plots/webmapchart/navigationwidget/zoomline.svg": { result: "<svg width='6' height='100' version='1.1' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g id='background' filter='url(#f1)' transform='translate(2 0)'><rect x='0' y='0' width='2' height='100%'></rect></g><g id='border'><rect x='1' y='0' width='1' height='100%'></rect><rect x='4' y='0' width='1' height='100%'></rect></g></svg>" }, "images/plots/webmapchart/navigationwidget/zoomout.svg": { result: "<svg width='26' height='26' version='1.1' xmlns='http://www.w3.org/2000/svg' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g filter='url(#f1)' transform='translate(2 2)'><g id='background'><circle cx='11' cy='11' r='11'/></g><g id='center' transform='translate(6 6)'><rect x='0' y='4' width='10' height='2'></rect></g></g></svg>" }, "images/plots/webmapchart/navigationwidget/zoomthumb.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' width='23' height='12' xml:space='preserve'><filter id='f1' x='-1' y='-1' width='3' height='3'><feColorMatrix in='SourceGraphic' result='colorOut' values='0 0 0 0 0, 0 0 0 0 0, 0 0 0 0 0, 0 0 0 0.9 0'></feColorMatrix><feGaussianBlur in='colorOut' result='blurOut' stdDeviation='1'></feGaussianBlur><feBlend in='SourceGraphic' in2='blurOut'></feBlend></filter><g filter='url(#f1)'><g><path id='background' d='M1,9.5C0.7,9.5,0.5,9.3,0.5,9V1c0-0.3,0.2-0.5,0.5-0.5h20c0.3,0,0.5,0.2,0.5,0.5v8c0,0.3-0.2,0.5-0.5,0.5H1z' /><path id='border' d='M21,1L21,1v8L1,9l0-8H21 M21,0H1C0.4,0,0,0.4,0,1v8c0,0.6,0.4,1,1,1h20c0.6,0,1-0.4,1-1V1C22,0.4,21.6,0,21,0 L21,0z'/></g><rect id='center' x='6' y='4' width='10' height='2'/></g></svg>" }, "images/progress/analysisready.svg": { result: "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' enable-background='new 0 0 12 12'><circle fill='currentColor' cx='6' cy='6' r='5.5'/></svg>" }, "images/progress/circularprogressanimation.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 70 70' enable-background='new 0 0 70 70' xml:space='preserve'><g fill='currentColor'><circle class='sf-svg-loader-anim' cx='34.5' cy='7.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='55.5' cy='15.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='62.5' cy='35.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='55.5' cy='55.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='34.5' cy='62.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='14.5' cy='55.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='7.5' cy='35.5' r='6.5'/><circle class='sf-svg-loader-anim' cx='14.5' cy='15.5' r='6.5'/></g></svg>" }, "images/recommendations/back.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g fill='currentColor'><polygon points='6.789,0 2.031,5.002 3.242,6.249 8,1.247'/><polygon points='3.211,3.751 2,4.998 6.757,10 7.967,8.752'/></g></svg>" }, "images/recommendations/barchart.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 110 110' enable-background='new 0 0 110 110' xml:space='preserve'><g><g><polygon fill='#E4E4E4' points='0.888,109.05 0.888,0 0,0 0,110 110,110 110,109.05 '/></g></g><g><g><rect x='11' y='42' fill='#DEF1FC' width='23' height='63'/></g></g><g><g><rect x='44' y='10' fill='#E2F6EA' width='23' height='95'/></g></g><g><g><rect x='77' y='53' fill='#FDF9E3' width='23' height='52'/></g></g></svg>" }, "images/recommendations/color.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 11 11' enable-background='new 0 0 11 11' xml:space='preserve'><g><circle fill='#F08485' cx='2' cy='8' r='2'/><circle fill='#6CBCEA' cx='6' cy='3' r='2'/><circle fill='#84C598' cx='9' cy='8' r='2'/></g></svg>" }, "images/recommendations/explanationarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 32 32' enable-background='new 0 0 32 32' xml:space='preserve'><g fill='currentColor'><path d='M17.553,9.974c0.156,0,0.311,0.062,0.429,0.186v12.675c-0.121,0.127-0.303,0.191-0.483,0.191 c-0.178,0-0.355-0.062-0.473-0.186l-6.599-5.837c-0.238-0.25-0.235-0.659,0.005-0.911l6.684-5.927 C17.236,10.038,17.395,9.974,17.553,9.974 M17.553,9c-0.431,0-0.849,0.172-1.154,0.472l-6.66,5.905l-0.032,0.029l-0.432,0.456 c-0.367,0.386-0.366,0.992,0.001,1.378l0.428,0.449l0.032,0.028l6.575,5.816C16.614,23.831,17.044,24,17.498,24 c0.478,0,0.928-0.186,1.237-0.51L19,23.211v-0.377V10.16V9.783l-0.265-0.279C18.43,9.184,17.999,9,17.553,9L17.553,9z'/><path d='M16,32C7.178,32,0,24.822,0,16C0,7.178,7.178,0,16,0c8.822,0,16,7.178,16,16C32,24.822,24.822,32,16,32z M16,0.97C7.712,0.97,0.97,7.712,0.97,16S7.712,31.03,16,31.03S31.03,24.288,31.03,16S24.288,0.97,16,0.97z'/></g></svg>" }, "images/recommendations/marker.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 11 11' enable-background='new 0 0 11 11' xml:space='preserve'><g fill='currentColor'><path d='M5.5,0C2.462,0,0,2.462,0,5.5S2.462,11,5.5,11S11,8.538,11,5.5S8.538,0,5.5,0z M5.5,10 c-1.063,0-2.028-0.386-2.798-1.004c-0.22-0.16-0.706-0.708-0.706-0.708C1.382,7.519,1,6.558,1,5.5C1,3.019,3.019,1,5.5,1 S10,3.019,10,5.5S7.981,10,5.5,10z'/><circle cx='7' cy='6' r='1'/><circle cx='4' cy='7' r='1'/><circle cx='5' cy='4' r='1'/></g></svg>" }, "images/recommendations/norecommendations.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 80 80' enable-background='new 0 0 80 80' xml:space='preserve'><g><g><circle fill='#DADADA' cx='40' cy='40' r='40'/></g></g><g><g><path fill='#FFFFFF' d='M42.034,60h-4.068c-0.81,0-1.466,0.672-1.466,1.5s0.656,1.5,1.466,1.5h4.068 c0.809,0,1.466-0.672,1.466-1.5S42.843,60,42.034,60z'/></g></g><g><g><path fill='#FFFFFF' d='M43.651,55h-7.302C35.604,55,35,55.672,35,56.5c0,0.828,0.604,1.5,1.349,1.5h7.302 C44.396,58,45,57.328,45,56.5C45,55.672,44.396,55,43.651,55z'/></g></g><g><g><path fill='#FFFFFF' d='M54.996,29.071C55.238,17.292,44.418,15.127,40.01,15H39.99c-4.408,0.127-15.228,2.292-14.986,14.071 c0.02,2.114,0.857,6.663,3.123,9.752c3.88,6.49,5.306,5.407,5.653,12.883l-0.008-0.008c0,0.046,0.009,0.089,0.014,0.134 C33.856,52.487,34.423,53,35.121,53h9.757c0.698,0,1.266-0.513,1.336-1.168c0.005-0.045,0.014-0.088,0.014-0.134l-0.008,0.008 c0.347-7.476,1.773-6.393,5.653-12.883C54.139,35.735,54.976,31.185,54.996,29.071z'/></g></g><g><g><g><path fill='#C0C0C0' d='M41.164,38.813c-0.325-0.318-0.717-0.48-1.164-0.48c-0.448,0-0.839,0.162-1.163,0.48 c-0.334,0.327-0.503,0.727-0.503,1.187c0,0.46,0.169,0.859,0.503,1.186c0.325,0.319,0.716,0.481,1.164,0.481 c0.447,0,0.839-0.162,1.164-0.481c0.333-0.328,0.502-0.727,0.502-1.186C41.667,39.54,41.498,39.141,41.164,38.813z'/></g></g><g><g><path fill='#C0C0C0' d='M46.165,26.057c-0.331-0.59-0.791-1.093-1.367-1.495c-0.57-0.397-1.247-0.704-2.013-0.914 c-0.758-0.209-1.585-0.314-2.458-0.314c-1.83,0-3.389,0.42-4.634,1.25c-1.259,0.839-2.036,2.009-2.309,3.479l-0.051,0.272 l3.646,0.286l0.036-0.237c0.114-0.756,0.447-1.349,1.018-1.813c0.563-0.458,1.314-0.691,2.232-0.691 c0.41,0,0.804,0.061,1.168,0.18c0.362,0.12,0.675,0.284,0.931,0.488c0.255,0.204,0.462,0.452,0.617,0.736 c0.152,0.28,0.229,0.589,0.229,0.919c0,0.329-0.076,0.628-0.226,0.889c-0.159,0.278-0.365,0.547-0.612,0.798 c-0.257,0.26-0.544,0.514-0.854,0.754c-0.322,0.25-0.645,0.496-0.969,0.74c-0.403,0.306-0.746,0.573-1.022,0.793 c-0.292,0.233-0.529,0.481-0.704,0.736c-0.176,0.256-0.31,0.546-0.398,0.863c-0.086,0.31-0.13,0.699-0.13,1.157v1.735h3.456 v-1.322c0-0.324,0.019-0.596,0.058-0.809c0.035-0.197,0.101-0.378,0.196-0.538c0.097-0.162,0.234-0.322,0.405-0.474 c0.184-0.163,0.438-0.367,0.752-0.602l0.304-0.218l1.835-1.517l0.018-0.017c0.422-0.422,0.755-0.883,0.99-1.368 c0.237-0.493,0.357-1.072,0.357-1.72C46.667,27.329,46.498,26.648,46.165,26.057z'/></g></g></g></svg>" }, "images/recommendations/piechart.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 104 105' enable-background='new 0 0 104 105' xml:space='preserve'><g><g><path fill='#DEF1FC' d='M51.903,1C24.055,1,1.326,23.16,0,51h49.343L86,13.917C76.873,5.879,64.955,1,51.903,1z'/></g></g><g><g><path fill='#FDF9E3' d='M49.386,55H0c1.38,27.293,24.103,49,51.932,49C64.968,104,76.874,99.226,86,91.356L49.386,55z'/></g></g><g><g><path fill='#E2F6EA' d='M89.808,16L54,52.022L89.763,88C98.583,78.596,104,65.926,104,51.976C104,38.05,98.602,25.399,89.808,16z M50.408,52.583l0.014-0.014l-0.014-0.014V52.583z'/></g></g></svg>" }, "images/recommendations/shape.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 13 11' enable-background='new 0 0 13 11' xml:space='preserve'><g fill='currentColor'><path d='M9,3C8.335,3,7.717,3.178,7.166,3.465l0.529,0.847C8.091,4.118,8.53,4,9,4c1.654,0,3,1.346,3,3 c0,1.654-1.346,3-3,3c-1.302,0-2.401-0.839-2.816-2H5.141C5.588,9.722,7.138,11,9,11c2.209,0,4-1.791,4-4C13,4.791,11.209,3,9,3z' /><path d='M5,0L0,8h10L5,0z M5,1.887L8.196,7H1.804L5,1.887z'/></g></svg>" }, "images/recommendations/size.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 11 11' enable-background='new 0 0 11 11' xml:space='preserve'><g fill='currentColor'><rect x='1.803' y='6.824' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -4.1048 4.7379)' width='3.728' height='1'/><polygon points='2.985,4.005 6.985,8.005 6.985,4.005 '/><path d='M5.5,0C2.462,0,0,2.462,0,5.5S2.462,11,5.5,11S11,8.538,11,5.5S8.538,0,5.5,0z M5.5,10 c-1.063,0-2.028-0.386-2.798-1.004L1.995,8.288C1.382,7.519,1,6.558,1,5.5C1,3.019,3.019,1,5.5,1S10,3.019,10,5.5S7.981,10,5.5,10 z'/></g></svg>" }, "images/recommendations/treemap.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 110 110' enable-background='new 0 0 110 110' xml:space='preserve'><g><g><rect fill='#DEF1FC' width='44' height='110'/></g></g><g><g><rect x='49' fill='#E2F6EA' width='61' height='76'/></g></g><g><g><rect x='49' y='81' fill='#FDF9E3' width='61' height='29'/></g></g></svg>" }, "images/recommendations/trellis.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 11 11' enable-background='new 0 0 11 11' xml:space='preserve'><g fill='currentColor'><rect width='11' height='2'/><rect y='5' width='11' height='2'/><rect y='2' width='1' height='3'/><rect x='5' y='2' width='1' height='3'/><rect x='10' y='2' width='1' height='3'/><rect y='7' width='1' height='3'/><rect x='5' y='7' width='1' height='3'/><rect x='10' y='7' width='1' height='3'/><rect y='10' width='11' height='1'/></g></svg>" }, "images/recommendations/trellisedplot.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 110 110' enable-background='new 0 0 110 110' xml:space='preserve'><g><g><path fill='#E4E4E4' d='M110,54.883v-0.82h-0.043V0.994h0.012V0H0.012v0.062H0V110h0.901v-0.062h108.11V110h0.946v-0.062h0.012 v-0.919h-0.012V54.883H110z M109.011,109.018H0.901V54.883h108.11V109.018z M109.011,54.063H0.901V0.994h108.11V54.063z'/></g></g><g><g><rect x='18' y='29' fill-rule='evenodd' clip-rule='evenodd' fill='#DEF1FC' width='16' height='24'/></g></g><g><g><rect x='76' y='72' fill-rule='evenodd' clip-rule='evenodd' fill='#DEF1FC' width='16' height='36'/></g></g><g><g><rect x='47' y='29' fill-rule='evenodd' clip-rule='evenodd' fill='#E2F6EA' width='16' height='24'/></g></g><g><g><rect x='47' y='92' fill-rule='evenodd' clip-rule='evenodd' fill='#E2F6EA' width='16' height='16'/></g></g><g><g><rect x='76' y='16' fill-rule='evenodd' clip-rule='evenodd' fill='#FDF9E3' width='16' height='37'/></g></g><g><g><rect x='18' y='76' fill-rule='evenodd' clip-rule='evenodd' fill='#FDF9E3' width='16' height='32'/></g></g></svg>" }, "images/styleeditor/closebtn_16x16canvas.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g id='Lager_1'><g><g><rect x='0.286' y='7.229' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)' fill='#ffffff' width='15.428' height='1.543'/></g></g><g><g><rect x='7.229' y='0.286' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)' fill='#ffffff' width='1.543' height='15.428'/></g></g></g></svg>" }, "images/styleeditor/textaligncenter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g id='Lager_1'><g><g><rect x='0' y='0' width='10' height='1'/></g></g><g><g><rect x='2' y='3' width='6' height='1'/></g></g><g><g><rect x='3' y='6' width='4' height='1'/></g></g><g><g><rect x='0' y='9' width='10' height='1'/></g></g></g></svg>" }, "images/styleeditor/textalignleft.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g id='Lager_1'><g><g><rect x='0' y='0' width='10' height='1'/></g></g><g><g><rect x='0' y='3' width='6' height='1'/></g></g><g><g><rect x='0' y='6' width='4' height='1'/></g></g><g><g><rect x='0' y='9' width='10' height='1'/></g></g></g></svg>" }, "images/styleeditor/textalignright.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 10 10' enable-background='new 0 0 10 10' xml:space='preserve'><g id='Lager_1'><g><g><rect x='0' y='0' width='10' height='1'/></g></g><g><g><rect x='4' y='3' width='6' height='1'/></g></g><g><g><rect x='6' y='6' width='4' height='1'/></g></g><g><g><rect x='0' y='9' width='10' height='1'/></g></g></g></svg>" }, "images/tabcontrol/addpage.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><rect x='6' y='2' width='2' height='10'/></g></g><g><g><rect x='2' y='6' width='10' height='2'/></g></g></g></svg>" }, "images/tabcontrol/downarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><polygon points='3,5 7.388,10 12,5 '/></g></g></g></svg>" }, "images/tabcontrol/leftarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><polygon points='8.833,1 3,7 4.167,8.2 10,2.2 '/></g></g><g><g><polygon points='4.167,5.8 3,7 8.833,13 10,11.8 '/></g></g></g></svg>" }, "images/tabcontrol/removetab.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><rect x='6.247' y='2.096' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.8995 7.0005)' width='1.506' height='9.808'/></g></g><g><g><rect x='2.096' y='6.247' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -2.8995 7)' width='9.808' height='1.506'/></g></g></g></svg>" }, "images/tabcontrol/rightarrow.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 14' enable-background='new 0 0 14 14' xml:space='preserve'><g id='Lager_1'><g><g><polygon points='8.833,5.8 3,11.8 4.167,13 10,7 '/></g></g><g><g><polygon points='4.167,1 3,2.2 8.833,8.2 10,7 '/></g></g></g></svg>" }, "images/toolbar/analysiscontentexpired.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_3'><g><g><g><path d='M16.792,7.558L12.064,4v2.754c-3.8-0.037-6.934,2.394-7.06,5.442c-0.03,0.725,0.116,1.42,0.406,2.061l1.556-0.417 c-0.236-0.502-0.355-1.048-0.331-1.619c0.096-2.327,2.527-4.184,5.428-4.16v2.839L16.792,7.558z'/></g></g><g><g><path d='M18.59,9.744l-1.556,0.417c0.236,0.502,0.355,1.048,0.331,1.619c-0.096,2.327-2.527,4.184-5.428,4.161v-2.839 l-4.729,3.341L11.936,20v-2.754c3.8,0.037,6.934-2.394,7.06-5.442C19.026,11.079,18.88,10.384,18.59,9.744z'/></g></g></g></g></svg>" }, "images/toolbar/bookmarks.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_1'><g><g><path d='M17.977,19.593V4.407C17.977,4.182,18,4.313,18,4H5.008C5.008,4.188,5,4.182,5,4.407v15.187 C5,19.818,5.008,19.469,5.008,20l6.521-3.3L18,20C18,19.406,17.977,19.818,17.977,19.593z M14.249,15.042l-2.72-2.104v0 l-2.72,2.104l0.974-3.454L7.054,9.403h3.396l1.079-3.373l1.079,3.373h3.396l-2.729,2.185L14.249,15.042z'/></g></g></g></svg>" }, "images/toolbar/close.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_1'><g><g><rect x='11.092' y='3.008' transform='matrix(0.706 -0.7082 0.7082 0.706 -4.9706 12.0258)' width='1.815' height='17.984'/></g></g><g><g><rect x='3.008' y='11.092' transform='matrix(0.7072 -0.707 0.707 0.7072 -4.9706 11.9974)' width='17.984' height='1.815'/></g></g></g></svg>" }, "images/toolbar/collaboration.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Http'><g><g><path d='M4,4v16h17V4H4z M5,5h12v2H5V5z M8,16H7v-2H6v2H5v-5h1v2h1v-2h1V16z M12,12h-1v4h-1v-4H9v-1h3V12z M16,12 h-1v4h-1v-4h-1v-1h3V12z M20,14h-2v2h-1v-5h3V14z M20,7h-2V5h2V7z M19,12h-1v1h1V12z'/></g></g></g></svg>" }, "images/toolbar/commentstoolbaricon.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='right_bubble'><g opacity='0.65'><g><path d='M16,4c-2.127,0-4.055,0.544-5.488,1.426c4.044,0.261,7.202,2.482,7.202,5.185 c0,1.33-0.774,2.536-2.034,3.455c-0.12,0.118-0.271,0.221-0.405,0.332c0.239,0.014,0.48,0.024,0.724,0.024 c0.278,0,0.553-0.009,0.824-0.028L16.816,17l3.896-3.584C22.702,12.468,24,10.94,24,9.211C24,6.333,20.418,4,16,4z'/></g></g></g><g id='left_bubble'><g><g><path d='M9,6C6.645,6,4.534,6.667,3.07,7.722C1.788,8.646,1,9.867,1,11.211c0,2.878,3.582,5.211,8,5.211 c0.278,0,0.553-0.009,0.824-0.028L9.816,19l3.896-3.584c0.774-0.369,1.439-0.827,1.968-1.349c0.831-0.82,1.32-1.799,1.32-2.855 C17,8.333,13.418,6,9,6z'/></g></g></g></svg>" }, "images/toolbar/dod.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_2'><g><g><rect x='3' y='4' width='3' height='1'/></g></g><g><g><rect x='16' y='4' width='3' height='1'/></g></g><g><g><rect x='3' y='19' width='3' height='1'/></g></g><g><g><rect x='16' y='19' width='3' height='1'/></g></g><g><g><rect x='9' y='4' width='4' height='1'/></g></g><g><g><rect x='3' y='10' width='1' height='4'/></g></g><g><g><rect x='3' y='5' width='1' height='2'/></g></g><g><g><rect x='18' y='5' width='1' height='2'/></g></g><g><g><rect x='3' y='17' width='1' height='2'/></g></g><g><g><rect x='18' y='17' width='1' height='2'/></g></g><g><g><rect x='18' y='10' width='1' height='4'/></g></g><g><g><rect x='9' y='19' width='4' height='1'/></g></g><g opacity='0.6'><g><rect x='12' y='11' width='2' height='2'/></g></g><g><g><rect x='15' y='14' width='2' height='2'/></g></g><g opacity='0.6'><g><rect x='20' y='14' width='2' height='2'/></g></g></g></svg>" }, "images/toolbar/filter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_1'><g><g><path d='M12,4C7.582,4,4,5.023,4,6.286c0,2.286,6.286,7.772,6.286,7.772v4.799C10.286,19.488,10.738,20,12,20 c1.262,0,1.714-0.512,1.714-1.143v-4.799c0,0,6.286-5.486,6.286-7.772C20,5.023,16.418,4,12,4z M12.122,8.145 c-3.459,0-6.263-0.741-6.263-1.433c0-0.692,2.804-1.34,6.263-1.34c3.459,0,6.263,0.648,6.263,1.34 C18.385,7.404,15.581,8.145,12.122,8.145z'/></g></g></g></svg>" }, "images/toolbar/help.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_2'><g><g><path d='M12,4c-4.418,0-8,3.582-8,8c0,4.418,3.582,8,8,8s8-3.582,8-8C20,7.582,16.418,4,12,4z M12.712,15.766 c-0.2,0.155-0.44,0.234-0.715,0.234c-0.275,0-0.515-0.079-0.714-0.234c-0.205-0.159-0.309-0.354-0.309-0.578 c0-0.224,0.104-0.419,0.309-0.578c0.199-0.155,0.44-0.234,0.714-0.234c0.275,0,0.515,0.079,0.715,0.234 c0.205,0.16,0.309,0.354,0.309,0.578C13.021,15.412,12.917,15.606,12.712,15.766z M14.84,10.828 c-0.106,0.213-0.256,0.414-0.445,0.599l-0.008,0.007l-0.826,0.664l-0.137,0.096c-0.141,0.103-0.256,0.192-0.338,0.263 c-0.077,0.067-0.139,0.136-0.182,0.207c-0.043,0.07-0.073,0.149-0.088,0.235c-0.017,0.093-0.026,0.212-0.026,0.354v0.578h-1.555 v-0.759c0-0.2,0.02-0.37,0.058-0.506c0.04-0.139,0.1-0.266,0.179-0.378c0.079-0.112,0.186-0.22,0.317-0.322 c0.124-0.096,0.278-0.213,0.46-0.347c0.146-0.106,0.291-0.214,0.436-0.323c0.14-0.105,0.269-0.216,0.384-0.33 c0.111-0.11,0.204-0.228,0.276-0.349c0.067-0.114,0.102-0.245,0.102-0.389c0-0.144-0.035-0.28-0.103-0.402 c-0.07-0.124-0.163-0.233-0.277-0.322c-0.115-0.089-0.256-0.161-0.419-0.214c-0.164-0.052-0.341-0.079-0.526-0.079 c-0.413,0-0.751,0.102-1.005,0.302c-0.257,0.203-0.407,0.462-0.458,0.793l-0.016,0.104L9,10.187l0.023-0.119 c0.123-0.643,0.473-1.155,1.039-1.522C10.622,8.184,11.324,8,12.148,8c0.393,0,0.765,0.046,1.106,0.137 c0.344,0.092,0.649,0.226,0.906,0.4c0.259,0.176,0.466,0.396,0.615,0.654C14.924,9.45,15,9.748,15,10.076 C15,10.36,14.946,10.613,14.84,10.828z'/></g></g></g></svg>" }, "images/toolbar/menu.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_1'><g><g><rect x='4' y='5' width='16' height='2'/></g></g><g><g><rect x='4' y='11' width='16' height='2'/></g></g><g><g><rect x='4' y='17' width='16' height='2'/></g></g></g></svg>" }, "images/toolbar/more.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='More'><g><g><path d='M12,4c-4.418,0-8,3.582-8,8s3.582,8,8,8s8-3.582,8-8S16.418,4,12,4z M8,13c-0.552,0-1-0.448-1-1c0-0.552,0.448-1,1-1 s1,0.448,1,1C9,12.552,8.552,13,8,13z M12,13c-0.552,0-1-0.448-1-1c0-0.552,0.448-1,1-1s1,0.448,1,1C13,12.552,12.552,13,12,13z M16,13c-0.552,0-1-0.448-1-1c0-0.552,0.448-1,1-1s1,0.448,1,1C17,12.552,16.552,13,16,13z'/></g></g></g></svg>" }, "images/toolbar/twitter.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 24 24' enable-background='new 0 0 24 24' xml:space='preserve'><g id='Lager_1'><g><g><path d='M21,5.776c-0.662,0.301-1.374,0.505-2.121,0.596c0.763-0.469,1.348-1.211,1.624-2.095 c-0.714,0.434-1.504,0.749-2.345,0.919C17.484,4.46,16.524,4,15.462,4c-2.04,0-3.693,1.695-3.693,3.787 c0,0.297,0.033,0.586,0.096,0.863c-3.069-0.158-5.79-1.666-7.612-3.957c-0.318,0.559-0.5,1.21-0.5,1.904 c0,1.314,0.652,2.473,1.643,3.152c-0.605-0.02-1.175-0.19-1.673-0.474c0,0.016,0,0.032,0,0.048c0,1.835,1.273,3.365,2.962,3.713 c-0.31,0.087-0.636,0.133-0.973,0.133c-0.238,0-0.469-0.024-0.695-0.068c0.47,1.505,1.834,2.599,3.45,2.63 c-1.264,1.016-2.856,1.621-4.586,1.621c-0.298,0-0.592-0.018-0.881-0.053C4.634,18.373,6.575,19,8.661,19 c6.793,0,10.507-5.77,10.507-10.774c0-0.164-0.004-0.328-0.011-0.49C19.879,7.202,20.505,6.535,21,5.776z'/></g></g></g></svg>" }, "images/webplayertoolbar/analysiscontentexpiredw14h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 16' enable-background='new 0 0 14 16' xml:space='preserve'><g><g><path d='M13.59,5.744L12.034,6.16c0.236,0.502,0.355,1.048,0.331,1.619c-0.096,2.327-2.527,4.184-5.428,4.161V9.101l-4.729,3.341 L6.936,16v-2.754c3.8,0.037,6.934-2.394,7.06-5.442C14.026,7.079,13.88,6.384,13.59,5.744z M7.064,4.06v2.839l4.729-3.341L7.064,0 v2.754c-3.8-0.037-6.934,2.394-7.06,5.442c-0.03,0.725,0.116,1.42,0.406,2.061L1.966,9.84C1.731,9.338,1.611,8.792,1.635,8.221 C1.732,5.894,4.162,4.037,7.064,4.06z'/></g></g></svg>" }, "images/webplayertoolbar/bookmarksw13h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 13 16' enable-background='new 0 0 13 16' xml:space='preserve'><g><g><path d='M12.977,15.593V0.407C12.977,0.182,13,0.313,13,0H0.008C0.008,0.188,0,0.182,0,0.407v15.187 C0,15.818,0.008,15.469,0.008,16l6.521-3.3L13,16C13,15.406,12.977,15.818,12.977,15.593z M9.249,11.042l-2.72-2.104v0 l-2.72,2.104l0.974-3.454L2.054,5.403H5.45L6.529,2.03l1.079,3.373h3.396L8.275,7.588L9.249,11.042z'/></g></g></svg>" }, "images/webplayertoolbar/closew14h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 14 16' enable-background='new 0 0 14 16' xml:space='preserve'><g id='Lager_1'><polygon points='14,2.286 12.718,1 7,6.717 1.282,1 0,2.286 5.716,8 0,13.714 1.282,15 7,9.283 12.718,15 14,13.714 8.284,8 '/></g></svg>" }, "images/webplayertoolbar/collaborationw23h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 23 16' enable-background='new 0 0 23 16' xml:space='preserve'><g id='bubbles'><g opacity='0.65'><g><path d='M15,0c-2.127,0-4.055,0.544-5.488,1.426c4.044,0.261,7.202,2.482,7.202,5.185 c0,1.33-0.774,2.536-2.034,3.455c-0.12,0.118-0.271,0.221-0.405,0.332c0.239,0.014,0.48,0.024,0.724,0.024 c0.278,0,0.553-0.009,0.824-0.028L15.816,13l3.896-3.584C21.702,8.468,23,6.94,23,5.211C23,2.333,19.418,0,15,0z'/></g></g><g><g><path d='M8,2C5.645,2,3.534,2.667,2.07,3.722C0.788,4.646,0,5.867,0,7.211c0,2.878,3.582,5.211,8,5.211 c0.278,0,0.553-0.009,0.824-0.028L8.816,15l3.896-3.584c0.774-0.369,1.439-0.827,1.968-1.349C15.511,9.247,16,8.268,16,7.211 C16,4.333,12.418,2,8,2z'/></g></g></g></svg>" }, "images/webplayertoolbar/detailsondemandw19h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 19 16' enable-background='new 0 0 19 16' xml:space='preserve'><g><g><rect width='3' height='1'/></g></g><g><g><rect x='13' width='3' height='1'/></g></g><g><g><rect y='15' width='3' height='1'/></g></g><g><g><rect x='13' y='15' width='3' height='1'/></g></g><g><g><rect x='6' width='4' height='1'/></g></g><g><g><rect y='6' width='1' height='4'/></g></g><g><g><rect y='1' width='1' height='2'/></g></g><g><g><rect x='15' y='1' width='1' height='2'/></g></g><g><g><rect y='13' width='1' height='2'/></g></g><g><g><rect x='15' y='13' width='1' height='2'/></g></g><g><g><rect x='15' y='6' width='1' height='4'/></g></g><g><g><rect x='6' y='15' width='4' height='1'/></g></g><g opacity='0.6'><g><rect x='9' y='7' width='2' height='2'/></g></g><g><g><rect x='12' y='10' width='2' height='2'/></g></g><g opacity='0.6'><g><rect x='17' y='10' width='2' height='2'/></g></g></svg>" }, "images/webplayertoolbar/filterw16h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g><g><path d='M8,0C3.582,0,0,1.023,0,2.286c0,2.286,6.286,7.772,6.286,7.772v4.799C6.286,15.488,6.738,16,8,16 c1.262,0,1.714-0.512,1.714-1.143v-4.799c0,0,6.286-5.486,6.286-7.772C16,1.023,12.418,0,8,0z M8.122,4.145 c-3.459,0-6.263-0.741-6.263-1.433c0-0.692,2.804-1.34,6.263-1.34c3.459,0,6.263,0.648,6.263,1.34 C14.385,3.404,11.581,4.145,8.122,4.145z'/></g></g></svg>" }, "images/webplayertoolbar/hamburgerw16h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g id='Lager_1'><g><g><rect y='1' width='16' height='2'/></g></g><g><g><rect y='7' width='16' height='2'/></g></g><g><g><rect y='13' width='16' height='2'/></g></g></g></svg>" }, "images/webplayertoolbar/helpw16h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g><g><path d='M8,0C3.582,0,0,3.582,0,8c0,4.418,3.582,8,8,8s8-3.582,8-8C16,3.582,12.418,0,8,0z M8.712,11.766 C8.512,11.921,8.272,12,7.997,12c-0.275,0-0.515-0.079-0.714-0.234c-0.205-0.159-0.309-0.354-0.309-0.578 c0-0.224,0.104-0.419,0.309-0.578c0.199-0.155,0.44-0.234,0.714-0.234c0.275,0,0.515,0.079,0.715,0.234 c0.205,0.16,0.309,0.354,0.309,0.578C9.021,11.412,8.917,11.606,8.712,11.766z M10.84,6.828c-0.106,0.213-0.256,0.414-0.445,0.599 l-0.008,0.007L9.56,8.098L9.424,8.194C9.282,8.297,9.168,8.386,9.085,8.457C9.008,8.524,8.946,8.594,8.903,8.665 C8.86,8.734,8.83,8.814,8.815,8.9C8.797,8.993,8.789,9.112,8.789,9.254v0.578H7.233V9.073c0-0.2,0.02-0.37,0.058-0.506 c0.04-0.139,0.1-0.266,0.179-0.378C7.55,8.078,7.656,7.97,7.788,7.868c0.124-0.096,0.278-0.213,0.46-0.347 c0.146-0.106,0.291-0.214,0.436-0.323c0.14-0.105,0.269-0.216,0.384-0.33c0.111-0.11,0.204-0.228,0.276-0.349 C9.411,6.404,9.445,6.273,9.445,6.13c0-0.144-0.035-0.28-0.103-0.402c-0.07-0.124-0.163-0.233-0.277-0.322 C8.949,5.316,8.809,5.245,8.646,5.192C8.482,5.14,8.305,5.114,8.12,5.114c-0.413,0-0.751,0.102-1.005,0.302 C6.858,5.619,6.709,5.878,6.657,6.209L6.641,6.312L5,6.187l0.023-0.119c0.123-0.643,0.473-1.155,1.039-1.522 C6.622,4.184,7.324,4,8.148,4C8.54,4,8.913,4.046,9.254,4.137c0.344,0.092,0.649,0.226,0.906,0.4 c0.259,0.176,0.466,0.396,0.615,0.654C10.924,5.45,11,5.748,11,6.076C11,6.36,10.946,6.613,10.84,6.828z'/></g></g></svg>" }, "images/webplayertoolbar/morew16h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 16 16' enable-background='new 0 0 16 16' xml:space='preserve'><g><circle fill='none' cx='12' cy='8' r='1'/><circle fill='none' cx='4' cy='8' r='1'/><circle fill='none' cx='8' cy='8' r='1'/><path d='M8,0C3.582,0,0,3.582,0,8s3.582,8,8,8s8-3.582,8-8S12.418,0,8,0z M4,9C3.448,9,3,8.552,3,8c0-0.552,0.448-1,1-1 s1,0.448,1,1C5,8.552,4.552,9,4,9z M8,9C7.448,9,7,8.552,7,8c0-0.552,0.448-1,1-1s1,0.448,1,1C9,8.552,8.552,9,8,9z M12,9 c-0.552,0-1-0.448-1-1c0-0.552,0.448-1,1-1s1,0.448,1,1C13,8.552,12.552,9,12,9z'/></g></svg>" }, "images/webplayertoolbar/webpagepanelw17h16.svg": { result: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' fill='currentColor' viewBox='0 0 17 16' enable-background='new 0 0 17 16' xml:space='preserve'><g><g><path fill='#030404' d='M0,0v16h17V0H0z M1,1h12v2H1V1z M4,12H3v-2H2v2H1V7h1v2h1V7h1V12z M8,8H7v4H6V8H5V7h3V8z M12,8h-1v4h-1V8 H9V7h3V8z M16,10h-2v2h-1V7h3V10z M16,3h-2V1h2V3z M15,8h-1v1h1V8z'/></g></g></svg>" },
    };
}(Spotfire || {}));
